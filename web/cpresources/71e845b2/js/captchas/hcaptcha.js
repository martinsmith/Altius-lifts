!function(){"use strict";var t={3495:function(t,e,i){i.d(e,{v:function(){return o}});class o{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=t.$form,this.form=this.$form.form,this.settings=t,setTimeout((()=>{this.initObserver()}),500)}initObserver(){const t=new IntersectionObserver((t=>{for(const e of t){const t=e.target;0===e.intersectionRatio?this.onHide(t):this.onShow(t)}}),{root:this.$form,rootMargin:"50px"});this.getPlaceholders().forEach((e=>t.observe(e)))}getPlaceholders(){return[]}onShow(t){}onHide(t){}createContainer(t){const e=document.createElement("div");return t.innerHTML="",t.appendChild(e),e}destroyContainer(t){t.innerHTML=""}}window.FormieCaptchaProvider=o}},e={};function i(o){var r=e[o];if(void 0!==r)return r.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}i.d=function(t,e){for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t=i(3495);const e=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.random().toString(36).substr(2,5)),`${t}.${e}`},o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const i=Date.now(),o=function(r,s){window[t]?r(window[t]):e&&Date.now()-i>=e?s(new Error("timeout")):setTimeout(o.bind(this,r,s),30)};return new Promise(o)};class r extends t.v{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.$form=t.$form,this.form=this.$form.form,this.siteKey=t.siteKey,this.size=t.size,this.language=t.language,this.loadingMethod=t.loadingMethod,this.scriptId="FORMIE_HCAPTCHA_SCRIPT",this.providerName="Hcaptcha",this.widgetIds=new Map}getPlaceholders(){return this.$form.querySelectorAll("[data-hcaptcha-placeholder]")}onShow(t){super.onShow(t),this.initCaptcha(t)}onHide(t){super.onHide(t),this.destroyCaptcha(t)}initCaptcha(t){if(document.getElementById(this.scriptId))o("hcaptcha").then((()=>{this.renderCaptcha(t)}));else{const e=document.createElement("script");e.id=this.scriptId,e.src=`https://js.hcaptcha.com/1/api.js?recaptchacompat=off&render=explicit&hl=${this.language}`,this.loadingMethod.includes("async")&&(e.async=!0),this.loadingMethod.includes("defer")&&(e.defer=!0),e.onload=()=>{o("hcaptcha",5e3).then((()=>{this.renderCaptcha(t)}))},document.body.appendChild(e)}}destroyCaptcha(t){this.destroyContainer(t),this.form.removeEventListener(e("onFormieCaptchaValidate",this.providerName)),this.form.removeEventListener(e("onAfterFormieSubmit",this.providerName))}renderCaptcha(t){this.token=null,this.submitHandler=null,this.$activePlaceholder=t;const i=this.createContainer(t);this.form.addEventListener(this.$form,e("onFormieCaptchaValidate",this.providerName),this.onValidate.bind(this)),this.form.addEventListener(this.$form,e("onAfterFormieSubmit",this.providerName),this.onAfterSubmit.bind(this));try{const e=hcaptcha.render(i,{sitekey:this.siteKey,size:this.size,callback:this.onVerify.bind(this),"expired-callback":this.onExpired.bind(this),"chalexpired-callback":this.onChallengeExpired.bind(this),"error-callback":this.onError.bind(this),"close-callback":this.onClose.bind(this)});this.widgetIds.set(t,e)}catch(t){console.error("Failed to render Hcaptcha:",t)}}onValidate(t){if(this.$form.form.formTheme||(t.preventDefault(),this.form.submitAction=this.$form.querySelector('[name="submitAction"]').value||"submit"),"submit"!==this.form.submitAction)return;if(t.detail.invalid)return;if(t.preventDefault(),this.submitHandler=t.detail.submitHandler,!this.$activePlaceholder)return void console.warn("No visible captcha placeholder found to execute.");const e=this.widgetIds.get(this.$activePlaceholder);void 0!==e?this.token?this.onVerify(this.token):hcaptcha.execute(e):console.warn("No widget ID found for the visible captcha placeholder.")}onVerify(t){this.token=t,this.submitHandler&&this.submitHandler.validatePayment()&&this.submitHandler.validateCustom()&&this.submitHandler.submitForm()}onAfterSubmit(){const{hasMultiplePages:t}=this.form.settings;!t&&this.$activePlaceholder&&setTimeout((()=>{this.destroyCaptcha(this.$activePlaceholder),this.renderCaptcha(this.$activePlaceholder)}),300)}onExpired(){if(console.log("hCaptcha has expired - reloading."),!this.$activePlaceholder)return;const t=this.widgetIds.get(this.$activePlaceholder);void 0!==t&&hcaptcha.reset(t),this.token=null}onChallengeExpired(){if(console.log("hCaptcha has expired challenge - reloading."),!this.$activePlaceholder)return;const t=this.widgetIds.get(this.$activePlaceholder);void 0!==t&&hcaptcha.reset(t),this.token=null}onError(t){console.error("hCaptcha was unable to load")}onClose(){this.$form.form.formTheme&&this.$form.form.formTheme.removeLoading(),this.token=null}}window.FormieHcaptcha=r}()}();