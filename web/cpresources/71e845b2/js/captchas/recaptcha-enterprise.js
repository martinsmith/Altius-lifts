!function(){"use strict";var e={3495:function(e,t,r){r.d(t,{v:function(){return i}});class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=e.$form,this.form=this.$form.form,this.settings=e,setTimeout((()=>{this.initObserver()}),500)}initObserver(){const e=new IntersectionObserver((e=>{for(const t of e){const e=t.target;0===t.intersectionRatio?this.onHide(e):this.onShow(e)}}),{root:this.$form,rootMargin:"50px"});this.getPlaceholders().forEach((t=>e.observe(t)))}getPlaceholders(){return[]}onShow(e){}onHide(e){}createContainer(e){const t=document.createElement("div");return e.innerHTML="",e.appendChild(t),t}destroyContainer(e){e.innerHTML=""}}window.FormieCaptchaProvider=i}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,r),s.exports}r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=r(3495);const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||(t=Math.random().toString(36).substr(2,5)),`${e}.${t}`},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const r=Date.now(),i=function(o,s){window[e]?o(window[e]):t&&Date.now()-r>=t?s(new Error("timeout")):setTimeout(i.bind(this,o,s),30)};return new Promise(i)};class o extends e.v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.$form=e.$form,this.form=this.$form.form,this.siteKey=e.siteKey,this.badge=e.badge,this.language=e.language,this.loadingMethod=e.loadingMethod,this.type=e.enterpriseType,this.scriptId="FORMIE_RECAPTCHA_SCRIPT",this.providerName="RecaptchaEnterprise",this.widgetIds=new Map}getPlaceholders(){return this.$form.querySelectorAll("[data-recaptcha-placeholder]")}onShow(e){super.onShow(e),this.initCaptcha(e)}onHide(e){super.onHide(e),this.destroyCaptcha(e)}initCaptcha(e){if(document.getElementById(this.scriptId))i("grecaptcha").then((()=>{this.renderCaptcha(e)}));else{const t=document.createElement("script");t.id=this.scriptId,t.src=`https://www.google.com/recaptcha/enterprise.js?render=explicit&hl=${this.language}`,this.loadingMethod.includes("async")&&(t.async=!0),this.loadingMethod.includes("defer")&&(t.defer=!0),t.onload=()=>{i("grecaptcha",5e3).then((()=>{this.renderCaptcha(e)}))},document.body.appendChild(t)}}destroyCaptcha(e){this.destroyContainer(e),this.form.removeEventListener(t("onFormieCaptchaValidate",this.providerName)),this.form.removeEventListener(t("onAfterFormieSubmit",this.providerName))}renderCaptcha(e){this.$activePlaceholder=e;const r=this.createContainer(e);this.$form.addEventListener("onBeforeFormieSubmit",this.onBeforeSubmit.bind(this)),this.form.addEventListener(this.$form,t("onFormieCaptchaValidate",this.providerName),this.onValidate.bind(this)),this.form.addEventListener(this.$form,t("onAfterFormieSubmit",this.providerName),this.onAfterSubmit.bind(this));try{grecaptcha.enterprise.ready((()=>{const t="checkbox"===this.type?"":"invisible",i=grecaptcha.enterprise.render(r,{sitekey:this.siteKey,badge:this.badge,size:t,callback:this.onVerify.bind(this),"expired-callback":this.onExpired.bind(this),"error-callback":this.onError.bind(this)});this.widgetIds.set(e,i)}))}catch(e){console.error("Failed to render ReCAPTCHA:",e)}}onBeforeSubmit(e){this.submitHandler=e.detail.submitHandler,this.removeError()}onValidate(e){if(this.$form.form.formTheme||(e.preventDefault(),this.form.submitAction=this.$form.querySelector('[name="submitAction"]').value||"submit"),"submit"!==this.form.submitAction)return;if(e.detail.invalid)return;if("checkbox"===this.type){const t=this.$form.querySelector('[name="g-recaptcha-response"]');return void(t&&t.value.length||(this.addError(),e.preventDefault()))}if(e.preventDefault(),this.submitHandler=e.detail.submitHandler,!this.$activePlaceholder)return void console.warn("No visible captcha placeholder found to execute.");const t=this.widgetIds.get(this.$activePlaceholder);void 0!==t?grecaptcha.enterprise.execute(t):console.warn("No widget ID found for the visible captcha placeholder.")}onVerify(e){"checkbox"!==this.type&&this.submitHandler&&this.submitHandler.validatePayment()&&this.submitHandler.validateCustom()&&this.submitHandler.submitForm()}onAfterSubmit(){const{hasMultiplePages:e}=this.form.settings;!e&&this.$activePlaceholder&&setTimeout((()=>{this.destroyCaptcha(this.$activePlaceholder),this.renderCaptcha(this.$activePlaceholder)}),300)}addError(){if(!this.$activePlaceholder)return;this.submitHandler&&this.submitHandler.formSubmitError();const e=document.createElement("div");e.className=this.form.getClasses("fieldError"),e.setAttribute("data-recaptcha-error",""),e.textContent=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.FormieTranslations&&(e=window.FormieTranslations[e]||e),e.replace(/{([a-zA-Z0-9]+)}/g,((e,r)=>t[r]?t[r]:e))}("This field is required."),this.$activePlaceholder.appendChild(e)}removeError(){if(!this.$activePlaceholder)return;const e=this.$activePlaceholder.querySelector("[data-recaptcha-error]");e&&e.remove()}onExpired(){if(console.log("ReCAPTCHA has expired - reloading."),!this.$activePlaceholder)return;const e=this.widgetIds.get(this.$activePlaceholder);void 0!==e&&grecaptcha.enterprise.reset(e)}onError(e){console.error("ReCAPTCHA was unable to load")}}window.FormieRecaptchaEnterprise=o}()}();