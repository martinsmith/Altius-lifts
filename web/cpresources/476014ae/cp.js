/*! For license information please see cp.js.LICENSE.txt */
(function(){var __webpack_modules__={0:function(){function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.Uploader=Craft.BaseUploader.extend({uploader:null,_totalFileCounter:0,_validFileCounter:0,_onFileAdd:null,init:function(e,n){var i=this;n=$.extend({},Craft.Uploader.defaults,n),this.base(e,n),delete this.settings.events,this.uploader=this.$element.fileupload(this.settings),Object.entries(this.events).forEach((function(e){var n=t(e,2),r=n[0],a=n[1];i.$element.on(r,a)})),this._onFileAdd=this.onFileAdd.bind(this),this.$element.on("fileuploadadd",this._onFileAdd)},setParams:function(t){this.base(t),this.uploader.data("blueimpFileupload")&&this.uploader.fileupload("option",{formData:this.formData})},getInProgress:function(){return this.uploader.fileupload("active")},onFileAdd:function(t,e){var n=this;t.stopPropagation();var i=!1;return this.allowedKinds&&(this._extensionList||this._createExtensionList(),i=!0),e.process().done((function(){var t=e.files[0],r=!0;if(i){var a=t.name.match(/\.([a-z0-4_]+)$/i)[1];-1===$.inArray(a.toLowerCase(),n._extensionList)&&(r=!1,n._rejectedFiles.type.push("“"+t.name+"”"))}t.size>n.settings.maxFileSize&&(n._rejectedFiles.size.push("“"+t.name+"”"),r=!1),r&&"function"==typeof n.settings.canAddMoreFiles&&!n.settings.canAddMoreFiles(n._validFileCounter)&&(n._rejectedFiles.limit.push("“"+t.name+"”"),r=!1),r&&(n._validFileCounter++,e.submit()),++n._totalFileCounter===e.originalFiles.length&&(n._totalFileCounter=0,n._validFileCounter=0,n.processErrorMessages())})),!0},destroy:function(){var e=this;this.uploader.fileupload("instance")&&this.uploader.fileupload("destroy"),this.$element.off("fileuploadadd",this._onFileAdd),Object.entries(this.events).forEach((function(n){var i=t(n,2),r=i[0],a=i[1];e.$element.off(r,a)}))}},{defaults:{autoUpload:!1,sequentialUploads:!0,maxFileSize:Craft.maxUploadSize,replaceFileInput:!1,createAction:"assets/upload",replaceAction:"assets/replace-file",deleteAction:"assets/delete-asset"}})},9:function(){Craft.Structure=Garnish.Base.extend({id:null,$container:null,state:null,structureDrag:null,init:function(t,e,n){this.id=t,this.$container=$(e),this.setSettings(n,Craft.Structure.defaults),this.$container.data("structure")&&(console.warn("Double-instantiating a structure on an element"),this.$container.data("structure").destroy()),this.$container.data("structure",this),this.state={},this.settings.storageKey&&$.extend(this.state,Craft.getLocalStorage(this.settings.storageKey,{})),void 0===this.state.collapsedElementIds&&(this.state.collapsedElementIds=[]);for(var i=this.$container.find("ul").prev(".row"),r=0;r<i.length;r++){var a=$(i[r]),s=a.parent(),o=$('<div class="toggle" title="'+Craft.t("app","Show/hide children")+'"/>').prependTo(a);-1!==$.inArray(a.children(".element").data("id"),this.state.collapsedElementIds)&&s.addClass("collapsed"),this.initToggle(o)}this.settings.sortable&&(this.structureDrag=new Craft.StructureDrag(this,this.settings.maxLevels)),this.settings.newChildUrl&&this.initNewChildMenus(this.$container.find(".add"))},initToggle:function(t){var e=this;t.on("click",(function(t){var n=$(t.currentTarget).closest("li"),i=n.children(".row").find(".element:first").data("id"),r=$.inArray(i,e.state.collapsedElementIds);n.hasClass("collapsed")?(n.removeClass("collapsed"),-1!==r&&e.state.collapsedElementIds.splice(r,1)):(n.addClass("collapsed"),-1===r&&e.state.collapsedElementIds.push(i)),e.settings.storageKey&&Craft.setLocalStorage(e.settings.storageKey,e.state)}))},initNewChildMenus:function(t){this.addListener(t,"click","onNewChildMenuClick")},onNewChildMenuClick:function(t){var e=$(t.currentTarget);if(!e.data("menubtn")){var n=e.parent().children(".element").data("id"),i=Craft.getUrl(this.settings.newChildUrl,"parentId="+n);$('<div class="menu"><ul><li><a href="'+i+'">'+Craft.t("app","New child")+"</a></li></ul></div>").insertAfter(e),new Garnish.MenuBtn(e).showMenu()}},getIndent:function(t){return Craft.Structure.baseIndent+(t-1)*Craft.Structure.nestedIndent},addElement:function(t){var e=$('<li data-level="1"/>').appendTo(this.$container),n=$('<div class="row" style="margin-'+Craft.left+": -"+Craft.Structure.baseIndent+"px; padding-"+Craft.left+": "+Craft.Structure.baseIndent+'px;">').appendTo(e);if(n.append(t),this.settings.sortable&&(n.append('<a class="move icon" title="'+Craft.t("app","Move")+'"></a>'),this.structureDrag.addItems(e)),this.settings.newChildUrl){var i=$('<a class="add icon" title="'+Craft.t("app","New child")+'"></a>').appendTo(n);this.initNewChildMenus(i)}n.css("margin-bottom",-30),n.velocity({"margin-bottom":0},"fast")},removeElement:function(t){var e,n=this,i=t.parent().parent();this.settings.sortable&&this.structureDrag.removeItems(i),i.siblings().length||(e=i.parent()),i.css("visibility","hidden").velocity({marginBottom:-i.height()},"fast",(function(){i.remove(),void 0!==e&&n._removeUl(e)}))},_removeUl:function(t){t.siblings(".row").children(".toggle").remove(),t.remove()},destroy:function(){this.$container.removeData("structure"),this.base()}},{baseIndent:8,nestedIndent:35,defaults:{storageKey:null,sortable:!1,newChildUrl:null,maxLevels:null}})},146:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}var i,r;Craft.EntrySelectInput=Craft.BaseElementSelectInput.extend({get section(){var t=this;return this.settings.sectionId?Craft.publishableSections.find((function(e){return e.id===t.settings.sectionId})):null},canCreateElements:function(){return!!this.section},createElement:(i=e().mark((function t(n){var i,r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.sendActionRequest("POST","entries/create",{data:{siteId:this.settings.criteria.siteId,section:this.section.handle,authorId:Craft.userId,title:n}});case 2:return i=t.sent,r=i.data.entry,t.prev=4,t.next=7,this.showElementEditor(r);case 7:t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(4),t.abrupt("return",null);case 12:return t.abrupt("return",r.id);case 13:case"end":return t.stop()}}),t,this,[[4,9]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,a){var s=i.apply(t,e);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))},function(t){return r.apply(this,arguments)}),showElementEditor:function(t){var e=this;return new Promise((function(n,i){var r=Craft.createElementEditor("craft\\elements\\Entry",{siteId:e.settings.criteria.siteId,elementId:t.id,draftId:t.draftId,params:{fresh:1}}),a=!1;r.on("submit",(function(){a=!0,n()})),r.on("close",(function(){a||i()}))}))}})},258:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}Craft.AssetImageEditor=Garnish.Modal.extend({$body:null,$footer:null,$imageTools:null,$buttons:null,$cancelBtn:null,$replaceBtn:null,$saveBtn:null,$focalPointBtn:null,$editorContainer:null,$straighten:null,$croppingCanvas:null,$fabricElementEditBtn:null,$spinner:null,$constraintContainer:null,$constraintRadioInputs:null,$orientationField:null,$customConstraints:null,canvas:null,image:null,viewport:null,focalPoint:null,prevFocalPoint:null,focalPointInnerCircle:null,focalPointOuterCircle:null,focalPointPickedIndicator:null,grid:null,croppingCanvas:null,clipper:null,handleFocusIndicator:null,croppingRectangle:null,cropperHandles:null,cropperGrid:null,croppingShade:null,mediumBlueColor:null,moveIcon:null,imageStraightenAngle:0,viewportRotation:0,originalWidth:0,originalHeight:0,imageVerticeCoords:null,zoomRatio:1,animationInProgress:!1,currentView:"",assetId:null,cacheBust:null,draggingCropper:!1,movingCropper:!1,scalingCropper:!1,handlePicked:!1,draggingFocal:!1,cropperPickedUp:!1,focusedEditButton:null,focalPickedUp:!1,focalClicked:!1,cropperClicked:!1,previousMouseX:0,previousMouseY:0,shiftKeyHeld:!1,editorHeight:0,editorWidth:0,cropperState:!1,scaleFactor:1,flipData:{},focalPointState:!1,maxImageSize:null,lastLoadedDimensions:null,imageIsLoading:!1,mouseMoveEvent:null,croppingConstraint:!1,constraintOrientation:"landscape",showingCustomConstraint:!1,rectangleHasFocusOutline:!1,saving:!1,dragEditMode:!0,announcerTimeout:null,renderImage:null,renderCropper:null,_queue:null,init:function(t,e){var n=this;this._queue=new Craft.Queue,this.cacheBust=Date.now(),this.setSettings(e,Craft.AssetImageEditor.defaults),null===this.settings.allowDegreeFractions&&(this.settings.allowDegreeFractions=Craft.isImagick),Garnish.prefersReducedMotion()&&(this.settings.animationDuration=1),this.assetId=t,this.flipData={x:0,y:0},this.$container=$('<form class="modal fitted imageeditor"></form>').appendTo(Garnish.$bod),this.$body=$('<div class="body"></div>').appendTo(this.$container),this.$footer=$('<div class="footer"/>').appendTo(this.$container),this.base(this.$container,this.settings),this.$buttons=$('<div class="buttons right"/>').appendTo(this.$footer),this.$cancelBtn=$("<button/>",{type:"button",class:"btn cancel",text:Craft.t("app","Cancel")}).appendTo(this.$buttons),this.settings.allowSavingAsNew&&(this.$saveBtn=Craft.ui.createButton({class:"save copy",label:Craft.t("app","Save as a new {type}",{type:Craft.elementTypeNames["craft\\elements\\Asset"][2]}),spinner:!0}).appendTo(this.$buttons),this.addListener(this.$saveBtn,"activate",this.saveImage)),this.$replaceBtn=Craft.ui.createSubmitButton({class:"save replace",label:Craft.t("app","Save"),spinner:!0}).appendTo(this.$buttons),this.addListener(this.$replaceBtn,"activate",this.saveImage),this.addListener(this.$cancelBtn,"activate",this.hide),this.removeListener(this.$shade,"click"),this.maxImageSize=this.getMaxImageSize(),Craft.sendActionRequest("POST","assets/image-editor",{data:{assetId:t}}).then((function(t){return n.loadEditor(t.data)}));var i=document.documentElement,r=window.getComputedStyle(i);this.mediumBlueColor=r.getPropertyValue("--blue-500"),this.addLiveRegion()},getMaxImageSize:function(){var t=Garnish.$doc.get(0).documentElement.clientWidth,e=Garnish.$doc.get(0).documentElement.clientHeight;return Math.max(e,t)*(window.devicePixelRatio>1?2:1)},loadEditor:function(t){var e=this;t.html||Craft.cp.displayError(Craft.t("app","Could not load the image editor.")),this.$body.html(t.html),this.$tabs=$(".tabs li",this.$body),this.$viewsContainer=$(".views",this.$body),this.$views=$("> div",this.$viewsContainer),this.$imageTools=$(".image-container .image-tools",this.$body),this.$editorContainer=$(".image-container .image",this.$body),this.$constraintContainer=$(".constraint-group",this.$body),this.$constraintRadioInputs=$('[name="constraint"]',this.$constraintContainer),this.$orientationField=$("#orientation",this.$body),this.$focalPointBtn=$(".focal-point",this.$body),this.editorHeight=this.$editorContainer.innerHeight(),this.editorWidth=this.$editorContainer.innerWidth(),this.$fabricElementEditBtn=$("[data-fabric-element]",this.$body);var n=$("#move-icon-wrapper svg").prop("outerHTML");fabric.loadSVGFromString(n,(function(t,n){var i=fabric.util.groupSVGElements(t,n);i.set({left:0,top:0,scaleX:.03,scaleY:.03,originX:"center",originY:"center",fill:"white"}),e.moveIcon=i})),this._showSpinner(),this.updateSizeAndPosition(),$customConstraintWrapper=this.$constraintRadioInputs.filter('[value="custom"]').parent(),$customConstraintGroupLabel=$customConstraintWrapper.find("label"),this.$customConstraints=$("<div/>",{class:"constraint custom hidden","data-constraint":"custom",role:"group","aria-labelledby":$customConstraintGroupLabel.attr("id")}).append($("<input/>",{type:"text",class:"custom-constraint-w",size:3,value:1,"aria-label":Craft.t("app","Width unit")})).append($("<span/>",{class:"custom-constraint-spacer",text:"x","aria-hidden":"true"})).append($("<input/>",{type:"text",class:"custom-constraint-h",size:3,value:1,"aria-label":Craft.t("app","Height unit")})).appendTo($customConstraintWrapper),this.$constraintRadioInputs.filter((function(){var t=$(this).val();return/^\d*\.\d+$/.test(t)})).addClass("flip"),this.canvas=new fabric.StaticCanvas("image-canvas"),this.$croppingCanvas=$("#cropping-canvas",this.$editorContainer),this.$croppingCanvas.width(this.editorWidth),this.$croppingCanvas.height(this.editorHeight),this.canvas.enableRetinaScaling=!0,this.renderImage=function(){Garnish.requestAnimationFrame(e.canvas.renderAll.bind(e.canvas))};var i=Craft.getActionUrl("assets/edit-image",{assetId:this.assetId,size:this.maxImageSize,cacheBust:this.cacheBust});fabric.Image.fromURL(i,(function(n){e.image=n,e.image.set({originX:"center",originY:"center",left:e.editorWidth/2,top:e.editorHeight/2}),e.canvas.add(e.image),e.originalHeight=e.image.getHeight(),e.originalWidth=e.image.getWidth(),e.zoomRatio=1,e.lastLoadedDimensions=e.getScaledImageDimensions(),e._setFittedImageVerticeCoordinates(),e._repositionEditorElements();var i={imageDimensions:e.getScaledImageDimensions(),offsetX:0,offsetY:0},r=!1;if(t.focalPoint){var a=t.focalPoint,s=i.imageDimensions.width*a.x,o=i.imageDimensions.height*a.y;i.offsetX=s-i.imageDimensions.width/2,i.offsetY=o-i.imageDimensions.height/2,r=!0}e.storeFocalPointState(i),r&&e._createFocalPoint(),e._createViewport(),e.storeCropperState(),e._addControlListeners(),e.addListener(e.$croppingCanvas,"mousemove,touchmove",e._handleMouseMove),e.addListener(e.$croppingCanvas,"mousedown,touchstart",e._handleMouseDown),e.addListener(e.$croppingCanvas,"mouseup,touchend",e._handleMouseUp),e.addListener(e.$croppingCanvas,"mouseout,touchcancel",e._handleMouseOut),e._hideSpinner(),e.renderImage(),e.$tabs.first().trigger("click")}))},_reloadImage:function(){var t=this;if(!this.imageIsLoading){this.imageIsLoading=!0,this.maxImageSize=this.getMaxImageSize();var e=Craft.getActionUrl("assets/edit-image",{assetId:this.assetId,size:this.maxImageSize,cacheBust:this.cacheBust});this.image.setSrc(e,(function(e){t.originalHeight=e.getHeight(),t.originalWidth=e.getWidth(),t.lastLoadedDimensions={width:t.originalHeight,height:t.originalWidth},t.updateSizeAndPosition(),t.renderImage(),t.imageIsLoading=!1}))}},updateSizeAndPosition:function(){if(this.$container){var t=window.innerWidth,e=window.innerHeight;this.$container.css({width:t,"min-width":t,left:0,height:e,"min-height":e,top:0}),this.$body.css({height:e-(this.$footer.outerHeight()-1)}),t<e?this.$container.addClass("vertical"):this.$container.removeClass("vertical"),this.$editorContainer&&this.image&&this._repositionEditorElements()}},_repositionEditorElements:function(){var t={width:this.editorWidth,height:this.editorHeight};this.editorHeight=this.$editorContainer.innerHeight(),this.editorWidth=this.$editorContainer.innerWidth(),this.canvas.setDimensions({width:this.editorWidth,height:this.editorHeight});var e=this.getScaledImageDimensions();if("crop"===this.currentView){this.zoomRatio=this.getZoomToFitRatio(this.getScaledImageDimensions());var n=this._getBoundingRectangle(this.imageVerticeCoords);this._setFittedImageVerticeCoordinates(),this._repositionCropper(n)}else this.zoomRatio=this.getZoomToCoverRatio(this.getScaledImageDimensions())*this.scaleFactor;this._repositionImage(t),this._repositionViewport(),this._repositionFocalPoint(t),this._zoomImage(),this.renderImage(),(e.width/this.lastLoadedDimensions.width>1.5||e.height/this.lastLoadedDimensions.height>1.5)&&this._reloadImage()},_repositionImage:function(t){this.image.set({left:this.image.left-(t.width-this.editorWidth)/2,top:this.image.top-(t.height-this.editorHeight)/2})},_createViewport:function(){this.viewport=new fabric.Rect({width:this.image.width,height:this.image.height,fill:"rgba(127,0,0,1)",originX:"center",originY:"center",globalCompositeOperation:"destination-in",left:this.image.left,top:this.image.top}),this.canvas.add(this.viewport),this.renderImage()},_createFocalPoint:function(){var t=this.focalPointState,e=this.getScaledImageDimensions().width/t.imageDimensions.width,n=t.offsetX*e*this.zoomRatio*this.scaleFactor,i=t.offsetY*e*this.zoomRatio*this.scaleFactor;n+=this.image.left,i+=this.image.top;var r=0,a=0;this.viewport&&0===t.offsetX&&0===t.offsetY&&("crop"!==this.currentView?(r=this.viewport.left-this.image.left,a=this.viewport.top-this.image.top):(r=this.clipper.left-this.image.left,a=this.clipper.top-this.image.top),n+=r,i+=a,t.offsetX+=r/(e*this.zoomRatio*this.scaleFactor),t.offsetY+=a/(e*this.zoomRatio*this.scaleFactor)),this.focalPointOuterCircle=new fabric.Circle({radius:8,fill:"rgba(0,0,0,0.5)",strokeWidth:2,stroke:"rgba(255,255,255,0.8)",left:0,top:0,originX:"center",originY:"center"}),this.focalPointInnerCircle=new fabric.Circle({radius:1,fill:"rgba(255,255,255,0)",strokeWidth:2,stroke:"rgba(255,255,255,0.8)",left:0,top:0,originX:"center",originY:"center"}),this.focalPointPickedIndicator=new fabric.Circle({radius:12,strokeWidth:0,stroke:"rgba(255,255,255,0.8)",left:0,top:0,originX:"center",originY:"center"}),this.focalPoint=new fabric.Group([this.focalPointPickedIndicator,this.focalPointOuterCircle,this.focalPointInnerCircle],{originX:"center",originY:"center",left:n,top:i}),this.storeFocalPointState(t),this.canvas.add(this.focalPoint)},toggleFocalPoint:function(){this.focalPoint?(this.prevFocalPoint=this.focalPoint,this.canvas.remove(this.focalPoint),this.focalPoint=null):(this._createFocalPoint(),this.prevFocalPoint=null),this.renderImage()},_repositionViewport:function(){if(this.viewport){var t={left:this.editorWidth/2,top:this.editorHeight/2};if("crop"===this.currentView)t.width=this.editorWidth,t.height=this.editorHeight;else if(this.cropperState){var e=this.cropperState,n=this.getScaledImageDimensions().width/e.imageDimensions.width;t.width=e.width*n*this.zoomRatio,t.height=e.height*n*this.zoomRatio,this.image.set({left:this.editorWidth/2-e.offsetX*n,top:this.editorHeight/2-e.offsetY*n})}else $.extend(t,this.getScaledImageDimensions());this.viewport.set(t)}},_repositionFocalPoint:function(t){if(this.focalPoint){var e=this.focalPoint.left-this.editorWidth/2,n=this.focalPoint.top-this.editorHeight/2,i=this.image.width,r=this.getScaledImageDimensions().width*this.zoomRatio/i/this.scaleFactor;e-=(t.width-this.editorWidth)/2,n-=(t.height-this.editorHeight)/2,e*=r,n*=r,this.focalPoint.set({left:this.editorWidth/2+e,top:this.editorHeight/2+n})}},hasOrientationChanged:function(){return this.viewportRotation%180!=0},getScaledImageDimensions:function(){return void 0===this.getScaledImageDimensions._&&(this.getScaledImageDimensions._={}),this.getScaledImageDimensions._.imageRatio=this.originalHeight/this.originalWidth,this.getScaledImageDimensions._.editorRatio=this.editorHeight/this.editorWidth,this.getScaledImageDimensions._.dimensions={},this.getScaledImageDimensions._.imageRatio>this.getScaledImageDimensions._.editorRatio?(this.getScaledImageDimensions._.dimensions.height=Math.min(this.editorHeight,this.originalHeight),this.getScaledImageDimensions._.dimensions.width=Math.round(this.originalWidth/(this.originalHeight/this.getScaledImageDimensions._.dimensions.height))):(this.getScaledImageDimensions._.dimensions.width=Math.min(this.editorWidth,this.originalWidth),this.getScaledImageDimensions._.dimensions.height=Math.round(this.originalHeight*(this.getScaledImageDimensions._.dimensions.width/this.originalWidth))),this.getScaledImageDimensions._.dimensions},_zoomImage:function(){void 0===this._zoomImage._&&(this._zoomImage._={}),this._zoomImage._.imageDimensions=this.getScaledImageDimensions(),this.image.set({width:this._zoomImage._.imageDimensions.width*this.zoomRatio,height:this._zoomImage._.imageDimensions.height*this.zoomRatio})},_getPrevTab:function(){var t,e=this._getActiveTabIndex();if(!(e<0))return t=e>0?e-1:this.$tabs.length-1,this.$tabs.eq(t)},_getNextTab:function(){var t,e=this._getActiveTabIndex();if(!(e<0))return t=e<this.$tabs.length-1?e+1:0,this.$tabs.eq(t)},_getActiveTab:function(){return this.$tabs.filter('[aria-selected="true"]')},_getActiveTabIndex:function(){var t=this._getActiveTab();if(t.length)return t.index()},_addControlListeners:function(){var t=this;this.addListener(this.$tabs,"click",this._handleTabClick),this.addListener(this.$tabs,"keydown",(function(e){switch(e.keyCode){case Garnish.LEFT_KEY:case Garnish.UP_KEY:e.preventDefault();var n=t._getPrevTab();t.activateTab(n);break;case Garnish.RIGHT_KEY:case Garnish.DOWN_KEY:e.preventDefault();var i=t._getNextTab();t.activateTab(i)}})),this.addListener($(".rotate-left"),"click",(function(){this.rotateImage(-90)})),this.addListener($(".rotate-right"),"click",(function(){this.rotateImage(90)})),this.addListener($(".flip-vertical"),"click",(function(){this.flipImage("y")})),this.addListener($(".flip-horizontal"),"click",(function(){this.flipImage("x")})),this.addListener(this.$fabricElementEditBtn,"click",(function(e){t._handleEditButtonClick(e)})),this.addListener(this.$fabricElementEditBtn,"keydown",(function(e){t.dragEditMode=!1,t._handleKeydownOnFabricElementEditBtn(e)})),this.addListener(Garnish.$doc,"focusin",(function(e){var n=$(e.target).is(t.$fabricElementEditBtn),i=t.handleFocusIndicator||t.rectangleHasFocusOutline;(n||i&&!n)&&(t.focusedEditButton=n?$(e.target):null,t._resetEditState(),t.clipper&&(t._redrawCropperElements(),t.renderCropper()))})),this.straighteningInput=new Craft.SlideRuleInput("slide-rule",{onStart:function(){t._showGrid()},onChange:function(e){t.straighten(e)},onEnd:function(){t._hideGrid(),t._cleanupFocalPointAfterStraighten()}}),this.addListener(Garnish.$doc,"keydown",(function(t){t.keyCode===Garnish.SHIFT_KEY&&(this.shiftKeyHeld=!0)})),this.addListener(Garnish.$doc,"keyup",(function(t){t.keyCode===Garnish.SHIFT_KEY&&(this.shiftKeyHeld=!1)})),this.addListener(this.$constraintRadioInputs,"change",this._handleConstraintChange),this.orientationBtnGroup=new Craft.Listbox(this.$orientationField,{onChange:function(e){t._handleOrientationClick(e)}}),this.addListener($(".constraint-group .custom input",this.$container),"keyup",this._applyCustomConstraint)},_handleConstraintClick:function(t){var e=$(t.currentTarget).data("constraint"),n=$(t.currentTarget);if(n.siblings().removeClass("active"),n.addClass("active"),"custom"==e)return this._showCustomConstraint(),void this._applyCustomConstraint();this._hideCustomConstraint(),this.setCroppingConstraint(e),this.enforceCroppingConstraint()},_handleConstraintChange:function(t){var e=$(t.target).val();if("custom"==e)return this._showCustomConstraint(),void this._applyCustomConstraint();this._hideCustomConstraint(),this.setCroppingConstraint(e),this.enforceCroppingConstraint()},_handleOrientationClick:function(t){if(t.data("value")!==this.constraintOrientation){this.constraintOrientation=t.data("value");for(var e=$(".flip",this.$constraintContainer),n=0;n<e.length;n++){var i=$(e[n]),r='label[for="'+i.attr("id")+'"]',a=$(r,this.$constraintContainer);i.val(1/i.val()),a.html(a.text().split(":").reverse().join(":").replace(/\s/g,""))}e.filter(":checked").trigger("change")}},_applyCustomConstraint:function(){var t=this._getCustomConstraint();t.w>0&&t.h>0&&(this.setCroppingConstraint(t.w/t.h),this.enforceCroppingConstraint())},_getCustomConstraint:function(){var t=parseFloat($(".custom-constraint-w").val()),e=parseFloat($(".custom-constraint-h").val());return{w:isNaN(t)?0:t,h:isNaN(e)?0:e}},_setCustomConstraint:function(t,e){$(".custom-constraint-w").val(parseFloat(t)),$(".custom-constraint-h").val(parseFloat(e))},_hideCustomConstraint:function(){this.showingCustomConstraint=!1,this.$customConstraints.addClass("hidden"),$(".orientation",this.$container).removeClass("hidden")},_showCustomConstraint:function(){this.showingCustomConstraint||(this.showingCustomConstraint=!0,this.$customConstraints.removeClass("hidden"),$(".orientation",this.$container).addClass("hidden"))},_handleTabClick:function(t){if(!this.animationInProgress){var e=$(t.currentTarget);this.activateTab(e)}},activateTab:function(t){var e=$(t).data("view");this.$tabs.removeClass("selected").attr({"aria-selected":"false",tabindex:"-1"}),$(t).addClass("selected").attr({"aria-selected":"true",tabindex:"0"}).focus(),this.showView(e)},showView:function(t){var e=this;this.currentView!==t&&(this.$views.addClass("hidden"),this.$views.filter('[data-view="'+t+'"]').removeClass("hidden"),"rotate"===t?this.enableSlider():this.disableSlider(),this.updateSizeAndPosition(),"crop"===this.currentView&&"crop"!==t?this._queue.push((function(){return new Promise((function(t,n){e.disableCropMode(),t()}))})):"crop"!==this.currentView&&"crop"===t&&this._queue.push((function(){return new Promise((function(t,n){e.enableCropMode(),t()}))})),this.currentView=t)},storeCropperState:function(t){void 0===this.storeCropperState._&&(this.storeCropperState._={}),t?this.cropperState=t:this.clipper?(this.storeCropperState._.zoomFactor=1/this.zoomRatio,this.cropperState={offsetX:(this.clipper.left-this.image.left)*this.storeCropperState._.zoomFactor,offsetY:(this.clipper.top-this.image.top)*this.storeCropperState._.zoomFactor,height:this.clipper.height*this.storeCropperState._.zoomFactor,width:this.clipper.width*this.storeCropperState._.zoomFactor,imageDimensions:this.getScaledImageDimensions()}):(this.storeCropperState._.dimensions=this.getScaledImageDimensions(),this.cropperState={offsetX:0,offsetY:0,height:this.storeCropperState._.dimensions.height,width:this.storeCropperState._.dimensions.width,imageDimensions:this.storeCropperState._.dimensions})},storeFocalPointState:function(t){void 0===this.storeFocalPointState._&&(this.storeFocalPointState._={}),t?this.focalPointState=t:this.focalPoint&&(this.storeFocalPointState._.zoomFactor=1/this.zoomRatio,this.focalPointState={offsetX:(this.focalPoint.left-this.image.left)*this.storeFocalPointState._.zoomFactor/this.scaleFactor,offsetY:(this.focalPoint.top-this.image.top)*this.storeFocalPointState._.zoomFactor/this.scaleFactor,imageDimensions:this.getScaledImageDimensions()})},rotateImage:function(t){var e=this;if(!this.animationInProgress){if(90!==t&&-90!==t)return!1;this.animationInProgress=!0,this.viewportRotation+=t,this.viewportRotation=parseInt((this.viewportRotation+360)%360,10);var n,i=this.image.angle+t,r=this.getScaledImageDimensions();n=this.hasOrientationChanged()?this.getZoomToCoverRatio({height:r.width,width:r.height}):this.getZoomToCoverRatio(r),this.zoomRatio>n&&(n=this.zoomRatio);var a={angle:90===t?"+=90":"-=90"},s={angle:i,width:r.width*n,height:r.height*n},o=1;this.scaleFactor<1?(o=1/this.scaleFactor,this.scaleFactor=1):(this.viewport.width>this.editorHeight?o=this.editorHeight/this.viewport.width:this.viewport.height>this.editorWidth&&(o=this.editorWidth/this.viewport.height),this.scaleFactor=o),o<1&&(s.width*=o,s.height*=o);var l=this.cropperState,c=l.offsetX,u=l.offsetY,h=t*(Math.PI/180),d=c*Math.cos(h)-u*Math.sin(h),f=c*Math.sin(h)+u*Math.cos(h),p=r.width/l.imageDimensions.width,g=d*p*this.zoomRatio*this.scaleFactor,m=f*p*this.zoomRatio*this.scaleFactor;s.left=this.editorWidth/2-g,s.top=this.editorHeight/2-m,l.offsetX=d,l.offsetY=f;var v=l.width;l.width=l.height,l.height=v,this.storeCropperState(l),this.focalPoint&&this.canvas.remove(this.focalPoint),this.viewport.animate(a,{duration:this.settings.animationDuration,onComplete:function(){var t=e.viewport.height*o;e.viewport.height=e.viewport.width*o,e.viewport.width=t,e.viewport.set({angle:0})}}),this.image.animate(s,{onChange:this.canvas.renderAll.bind(this.canvas),duration:this.settings.animationDuration,onComplete:function(){var n=parseFloat((e.image.angle+360)%360);e.image.set({angle:n}),e.animationInProgress=!1,e.focalPoint?(e._adjustFocalPointByAngle(t),e.straighten(e.straighteningInput),e.canvas.add(e.focalPoint)):e._resetFocalPointPosition()}})}},flipImage:function(t){var e=this;if(!this.animationInProgress){this.animationInProgress=!0,this.hasOrientationChanged()&&(t="y"===t?"x":"y"),this.focalPoint?this.canvas.remove(this.focalPoint):this._resetFocalPointPosition();var n={x:this.editorWidth/2,y:this.editorHeight/2};this.straighteningInput.setValue(-this.imageStraightenAngle),this.imageStraightenAngle=-this.imageStraightenAngle;var i,r,a={angle:this.viewportRotation+this.imageStraightenAngle},s=this.cropperState,o=this.focalPointState;"y"===t&&this.hasOrientationChanged()||"y"!==t&&!this.hasOrientationChanged()?(s.offsetX=-s.offsetX,o.offsetX=-o.offsetX,r=this.image.left-n.x,a.left=n.x-r):(s.offsetY=-s.offsetY,o.offsetY=-o.offsetY,i=this.image.top-n.y,a.top=n.y-i),"y"===t?(a.scaleY=-1*this.image.scaleY,this.flipData.y=1-this.flipData.y):(a.scaleX=-1*this.image.scaleX,this.flipData.x=1-this.flipData.x),this.storeCropperState(s),this.storeFocalPointState(o),this.image.animate(a,{onChange:this.canvas.renderAll.bind(this.canvas),duration:this.settings.animationDuration,onComplete:function(){e.animationInProgress=!1,e.focalPoint&&(e._adjustFocalPointByAngle(0),e.canvas.add(e.focalPoint))}})}},straighten:function(t){if(!this.animationInProgress){this.animationInProgress=!0;var e=this.image.angle;this.imageStraightenAngle=(this.settings.allowDegreeFractions?parseFloat(t.value):Math.round(parseFloat(t.value)))%360,this.image.set({angle:this.viewportRotation+this.imageStraightenAngle}),this.zoomRatio=this.getZoomToCoverRatio(this.getScaledImageDimensions())*this.scaleFactor,this._zoomImage(),this.cropperState&&this._adjustEditorElementsOnStraighten(e),this.renderImage(),this.animationInProgress=!1}},_adjustEditorElementsOnStraighten:function(t){var e,n,i,r,a,s=this.getScaledImageDimensions(),o=this.image.angle-t,l=this.cropperState,c=this.zoomRatio,u=1;do{var h=l.offsetX,d=l.offsetY,f=o*(Math.PI/180);i=h*Math.cos(f)-d*Math.sin(f),r=h*Math.sin(f)+d*Math.cos(f),e=i*c*(a=s.width/l.imageDimensions.width),n=r*c*a;var p=this.getImageVerticeCoords(c),g={width:this.viewport.width,height:this.viewport.height,left:this.editorWidth/2-this.viewport.width/2+e,top:this.editorHeight/2-this.viewport.height/2+n};c*=u=this._getZoomRatioToFitRectangle(g,p)}while(1!==u);this.image.set({left:this.editorWidth/2-e,top:this.editorHeight/2-n}),l.offsetX=i,l.offsetY=r,l.width=this.viewport.width/c/a,l.height=this.viewport.height/c/a,this.storeCropperState(l),this.zoomRatio=c,this.focalPoint?(this._adjustFocalPointByAngle(o),this._isCenterInside(this.focalPoint,this.viewport)?this.focalPoint.set({opacity:1}):this.focalPoint.set({opacity:0})):0!==o&&this._resetFocalPointPosition(),this._zoomImage()},_cleanupFocalPointAfterStraighten:function(){if(this.focalPoint&&!this._isCenterInside(this.focalPoint,this.viewport)){this.focalPoint.set({opacity:1});var t=this.focalPointState;t.offsetX=0,t.offsetY=0,this.storeFocalPointState(t),this.toggleFocalPoint()}},_resetFocalPointPosition:function(){var t=this.focalPointState;t.offsetX=0,t.offsetY=0,this.storeFocalPointState(t)},_isCenterInside:function(t,e){return t.left>e.left-e.width/2&&t.top>e.top-e.height/2&&t.left<e.left+e.width/2&&t.top<e.top+e.height/2},_adjustFocalPointByAngle:function(t){var e=t*(Math.PI/180),n=this.focalPointState,i=n.offsetX,r=n.offsetY,a=i*Math.cos(e)-r*Math.sin(e),s=i*Math.sin(e)+r*Math.cos(e),o=this.getScaledImageDimensions().width/n.imageDimensions.width,l=a*o*this.zoomRatio,c=s*o*this.zoomRatio;this.focalPoint.left=this.image.left+l,this.focalPoint.top=this.image.top+c,n.offsetX=a,n.offsetY=s,this.storeFocalPointState(n)},_getZoomRatioToFitRectangle:function(t,e){for(var n,i,r=this._getRectangleVertices(t),a=0;a<r.length&&(n=r[a],this.arePointsInsideRectangle([n],e));a++)n=!1;if(n){var s=this._getEdgeCrossed(e,n),o={x:t.left+t.width/2,y:t.top+t.height/2},l=Math.abs((s[1].y-s[0].y)*n.x-(s[1].x-s[0].x)*n.y+s[1].x*s[0].y-s[1].y*s[0].x)/Math.sqrt(Math.pow(s[1].y-s[0].y,2)+Math.pow(s[1].x-s[0].x,2)),c=Math.abs((s[1].y-s[0].y)*o.x-(s[1].x-s[0].x)*o.y+s[1].x*s[0].y-s[1].y*s[0].x)/Math.sqrt(Math.pow(s[1].y-s[0].y,2)+Math.pow(s[1].x-s[0].x,2));i=(l+c)/c}else i=1;return i},saveImage:function(t){var e=this,n=$(t.currentTarget);if(this.saving)return!1;this.saving=!0,n.addClass("loading");var i=n.hasClass("replace"),r={assetId:this.assetId,viewportRotation:this.viewportRotation,imageRotation:this.imageStraightenAngle,replace:i?1:0};if(this.cropperState){var a={};a.height=this.cropperState.height,a.width=this.cropperState.width,a.offsetX=this.cropperState.offsetX,a.offsetY=this.cropperState.offsetY,r.imageDimensions=this.cropperState.imageDimensions,r.cropData=a}else r.imageDimensions=this.getScaledImageDimensions();this.focalPoint&&(r.focalPoint=this.focalPointState),r.flipData=this.flipData,r.zoom=this.zoomRatio,Craft.sendActionRequest("POST","assets/save-image",{data:r}).then((function(t){var n=t.data;e.onSave(n),i&&Craft.broadcaster&&Craft.broadcaster.postMessage({event:"saveElement",id:e.assetId}),e.hide(),Craft.cp.runQueue(),Craft.Preview.refresh()})).catch((function(t){var e=t.response;Craft.cp.displayError(e.data.message)})).finally((function(){e.$buttons.find(".btn").removeClass("loading"),e.saving=!1}))},getZoomToCoverRatio:function(t){var e=Math.abs(this.imageStraightenAngle)*(Math.PI/180),n=Math.sin(e)*t.height+Math.cos(e)*t.width,i=Math.sin(e)*t.width+Math.cos(e)*t.height;return Math.max(n/t.width,i/t.height)},getZoomToFitRatio:function(t){var e=this._getImageBoundingBox(t),n=1;if(e.height>this.editorHeight||e.width>this.editorWidth){var i=this.editorHeight/e.height,r=this.editorWidth/e.width;n=Math.min(r,i)}return n},getCombinedZoomRatio:function(t){return this.getZoomToCoverRatio(t)/this.getZoomToFitRatio(t)},_showGrid:function(){if(!this.grid){var t,e={strokeWidth:1,stroke:"rgba(255,255,255,0.5)"},n=this.viewport.width,i=this.viewport.height,r=n/9,a=i/9,s=[new fabric.Rect({strokeWidth:2,stroke:this.settings.colors.white,originX:"center",originY:"center",width:n,height:i,left:n/2,top:i/2,fill:"rgba(255,255,255,0)"})];for(t=1;t<=8;t++)s.push(new fabric.Line([t*r,0,t*r,i],e));for(t=1;t<=8;t++)s.push(new fabric.Line([0,t*a,n,t*a],e));this.grid=new fabric.Group(s,{left:this.editorWidth/2,top:this.editorHeight/2,originX:"center",originY:"center",angle:this.viewport.angle}),this.canvas.add(this.grid),this.renderImage()}},_hideGrid:function(){this.canvas.remove(this.grid),this.grid=null,this.renderImage()},onFadeOut:function(){this.destroy()},show:function(){this.base(),Garnish.$bod.addClass("no-scroll")},hide:function(){this.removeAllListeners(),this.straighteningInput.removeAllListeners(),Garnish.$bod.removeClass("no-scroll"),this.base()},onSave:function(t){this.settings.onSave(t),this.trigger("save")},enableSlider:function(){this.$imageTools.removeClass("hidden")},disableSlider:function(){this.$imageTools.addClass("hidden")},enableCropMode:function(){var t=this,e=this.getScaledImageDimensions();this.zoomRatio=this.getZoomToFitRatio(e);var n={width:this.editorWidth,height:this.editorHeight},i={width:e.width*this.zoomRatio,height:e.height*this.zoomRatio,left:this.editorWidth/2,top:this.editorHeight/2};this._editorModeTransition((function(){t._setFittedImageVerticeCoordinates();var e=t.cropperState,n=t.getScaledImageDimensions(),i=n.width/e.imageDimensions.width,r={left:t.image.left+e.offsetX*i*t.zoomRatio,top:t.image.top+e.offsetY*i*t.zoomRatio,width:e.width*i*t.zoomRatio,height:e.height*i*t.zoomRatio};t._showCropper(r),t.focalPoint&&(i=n.width/t.focalPointState.imageDimensions.width,t.focalPoint.left=t.image.left+t.focalPointState.offsetX*i*t.zoomRatio,t.focalPoint.top=t.image.top+t.focalPointState.offsetY*i*t.zoomRatio,t.canvas.add(t.focalPoint))}),i,n)},disableCropMode:function(){var t=this,e={};this._hideCropper();var n=this.getScaledImageDimensions(),i=this.getZoomToCoverRatio(n)*this.scaleFactor,r=i/this.zoomRatio;this.zoomRatio=i;var a={width:n.width*this.zoomRatio,height:n.height*this.zoomRatio,left:this.editorWidth/2,top:this.editorHeight/2},s=(this.clipper.left-this.image.left)*r,o=(this.clipper.top-this.image.top)*r;a.left=this.editorWidth/2-s,a.top=this.editorHeight/2-o,e.height=this.clipper.height*r,e.width=this.clipper.width*r,(!this.focalPoint||this.focalPoint&&!this._isCenterInside(this.focalPoint,this.clipper))&&(this.focalPoint&&this.toggleFocalPoint(),this._resetFocalPointPosition()),this._editorModeTransition((function(){if(t.focalPoint){var e=t.getScaledImageDimensions().width/t.focalPointState.imageDimensions.width;t.focalPoint.left=t.image.left+t.focalPointState.offsetX*e*t.zoomRatio,t.focalPoint.top=t.image.top+t.focalPointState.offsetY*e*t.zoomRatio,t.canvas.add(t.focalPoint)}}),a,e)},_editorModeTransition:function(t,e,n){var i=this;this._queue.pause(),this.animationInProgress||(this.animationInProgress=!0,this.focalPoint&&(this.canvas.remove(this.focalPoint),this.renderImage()),this.image.animate(e,{onChange:this.canvas.renderAll.bind(this.canvas),duration:this.settings.animationDuration,onComplete:function(){t(),i.animationInProgress=!1,i.renderImage(),i._queue.resume()}}),this.viewport.animate(n,{duration:this.settings.animationDuration}))},_showSpinner:function(){this.$spinner||(this.$spinner=$('<div class="spinner big spinner-absolute"/>')),this.$spinner.appendTo(this.$container.find(".image"))},_hideSpinner:function(){this.$spinner.remove()},_showCropper:function(t){this._setupCropperLayer(t),this._redrawCropperElements(),this.renderCropper()},_hideCropper:function(){this.clipper&&(this.croppingCanvas.remove(this.clipper),this.croppingCanvas.remove(this.croppingShade),this.croppingCanvas.remove(this.cropperHandles),this.croppingCanvas.remove(this.cropperGrid),this.croppingCanvas.remove(this.croppingRectangle),this.croppingCanvas=null,this.renderCropper=null)},_setupCropperLayer:function(t){var e=this;this.croppingCanvas=new fabric.StaticCanvas("cropping-canvas",{backgroundColor:this.settings.colors.transparent,hoverCursor:"default",selection:!1}),this.croppingCanvas.setDimensions({width:this.editorWidth,height:this.editorHeight}),this.renderCropper=function(){return Garnish.requestAnimationFrame(e.croppingCanvas.renderAll.bind(e.croppingCanvas))},$("#cropping-canvas",this.$editorContainer).css({position:"absolute",top:0,left:0}),this.croppingShade=new fabric.Rect({left:this.editorWidth/2,top:this.editorHeight/2,originX:"center",originY:"center",width:this.editorWidth,height:this.editorHeight,fill:this.settings.colors.transparentBlack});var n=this.getScaledImageDimensions(),i=0===this.imageStraightenAngle?1:1.2*this.getCombinedZoomRatio(n),r=n.width/i,a=n.height/i;if(this.hasOrientationChanged()){var s=a;a=r,r=s}this.clipper=new fabric.Rect({left:this.editorWidth/2,top:this.editorHeight/2,originX:"center",originY:"center",width:r,height:a,stroke:"black",fill:"rgba(128,0,0,1)",strokeWidth:0}),t&&this.clipper.set(t),this.clipper.globalCompositeOperation="destination-out",this.croppingCanvas.add(this.croppingShade),this.croppingCanvas.add(this.clipper)},_redrawCropperElements:function(){this.croppingCanvas&&(void 0===this._redrawCropperElements._&&(this._redrawCropperElements._={}),this.cropperHandles&&(this.croppingCanvas.remove(this.cropperHandles),this.croppingCanvas.remove(this.cropperGrid),this.croppingCanvas.remove(this.croppingRectangle)),this.handleFocusIndicator&&(this.croppingCanvas.remove(this.handleFocusIndicator),this.handleFocusIndicator=null),this._redrawCropperElements._.lineOptions={strokeWidth:4,stroke:this.settings.colors.white,fill:!1},this._redrawCropperElements._.gridOptions={strokeWidth:2,stroke:"rgba(255,255,255,0.5)"},this._redrawCropperElements._.pathGroup=[new fabric.Path("M 0,10 L 0,0 L 10,0",this._redrawCropperElements._.lineOptions),new fabric.Path("M "+(this.clipper.width-8)+",0 L "+(this.clipper.width+4)+",0 L "+(this.clipper.width+4)+",10",this._redrawCropperElements._.lineOptions),new fabric.Path("M "+(this.clipper.width+4)+","+(this.clipper.height-8)+" L"+(this.clipper.width+4)+","+(this.clipper.height+4)+" L "+(this.clipper.width-8)+","+(this.clipper.height+4),this._redrawCropperElements._.lineOptions),new fabric.Path("M 10,"+(this.clipper.height+4)+" L 0,"+(this.clipper.height+4)+" L 0,"+(this.clipper.height-8),this._redrawCropperElements._.lineOptions)],this.cropperHandles=new fabric.Group(this._redrawCropperElements._.pathGroup,{left:this.clipper.left,top:this.clipper.top,originX:"center",originY:"center"}),this.handleFocusIndicator=this._getHandleFocusIndicator(),this.croppingRectangle=this._getCroppingRectangle(),this.cropperGrid=new fabric.Group([new fabric.Line([.33*this.clipper.width,0,.33*this.clipper.width,this.clipper.height],this._redrawCropperElements._.gridOptions),new fabric.Line([.66*this.clipper.width,0,.66*this.clipper.width,this.clipper.height],this._redrawCropperElements._.gridOptions),new fabric.Line([0,.33*this.clipper.height,this.clipper.width,.33*this.clipper.height],this._redrawCropperElements._.gridOptions),new fabric.Line([0,.66*this.clipper.height,this.clipper.width,.66*this.clipper.height],this._redrawCropperElements._.gridOptions)],{left:this.clipper.left,top:this.clipper.top,originX:"center",originY:"center"}),this._redrawCropperElements._.cropTextTop=this.croppingRectangle.top+this.clipper.height/2+12,this._redrawCropperElements._.cropTextBackgroundColor=this.settings.colors.transparent,this._redrawCropperElements._.cropTextTop+12>this.editorHeight-2&&(this._redrawCropperElements._.cropTextTop-=24,this._redrawCropperElements._.cropTextBackgroundColor="rgba(0,0,0,0.5)"),this.croppingCanvas.add(this.croppingRectangle),this.croppingCanvas.add(this.cropperHandles),this.croppingCanvas.add(this.cropperGrid),this.handleFocusIndicator&&this.croppingCanvas.add(this.handleFocusIndicator))},_resetEditState:function(){this.cropperPickedUp=!1,this.handlePicked=!1,this.focalPickedUp=!1},_getRectangleButtonIsFocused:function(){if(this.focusedEditButton)return"rectangle"===this._getElementHandleFromButton(this.focusedEditButton)},_getHandleButtonIsFocused:function(){if(this.focusedEditButton){var t=this._getElementHandleFromButton(this.focusedEditButton);return"rectangle"!==t&&"focalpoint"!==t}},_getCroppingRectangle:function(){var t=this.clipper.width,e=this.clipper.height;this.rectangleHasFocusOutline=!1;var i={fill:this.settings.colors.transparent,top:0,left:0,strokeWidth:2,originX:"center",originY:"center"},r=new fabric.Rect(n({width:t+8,height:e+8,stroke:null},i)),a=new fabric.Rect(n({width:t+4,height:e+4,stroke:null},i)),s=new fabric.Rect(n({width:t,height:e,stroke:this.settings.colors.white},i)),o=new fabric.Group([r,a,s],{originX:"center",originY:"center",left:this.clipper.left,top:this.clipper.top});if((this.cropperPickedUp||this._getRectangleButtonIsFocused())&&(this.rectangleHasFocusOutline=!0,r.set({stroke:this.settings.colors.white}),a.set({stroke:this.mediumBlueColor}),this.cropperPickedUp)){var l=new fabric.Circle({fill:this.settings.colors.black,top:0,left:0,radius:15,stroke:this.settings.colors.white,strokeWidth:2,originX:"center",originY:"center"});o.add(l),o.add(this.moveIcon)}return o},_getHandleFocusIndicator:function(){if(!this.dragEditMode&&(this._getHandleButtonIsFocused()||this.handlePicked)){var t=this.handlePicked?this.handlePicked:this._getElementHandleFromButton(this.focusedEditButton),e=this._getClipperHandlePosition(t),i={fill:null,strokeWidth:3,left:0,top:0,originX:"center",originY:"center"},r=new fabric.Circle(n({radius:12,stroke:this.mediumBlueColor},i)),a=new fabric.Circle(n({radius:15,stroke:this.settings.colors.white},i)),s=new fabric.Circle(n({radius:18,stroke:this.mediumBlueColor},i)),o=new fabric.Group([s,a,r],{originX:"center",originY:"center",left:e.x,top:e.y});return this.handlePicked&&(o.add(this.moveIcon),o.item(0).set({fill:this.settings.colors.transparentBlack})),o}},_repositionCropper:function(t){if(this.croppingCanvas){var e=this.clipper.left-this.croppingCanvas.width/2,n=this.clipper.top-this.croppingCanvas.height/2;this.croppingCanvas.setDimensions({width:this.editorWidth,height:this.editorHeight});var i=this._getBoundingRectangle(this.imageVerticeCoords).width/t.width;this.clipper.width=Math.round(this.clipper.width*i),this.clipper.height=Math.round(this.clipper.height*i),this.clipper.left=this.editorWidth/2+e*i,this.clipper.top=this.editorHeight/2+n*i,this.croppingShade.set({width:this.editorWidth,height:this.editorHeight,left:this.editorWidth/2,top:this.editorHeight/2}),this._redrawCropperElements(),this.renderCropper()}},_getBoundingRectangle:function(t){return{width:Math.max(t.a.x,t.b.x,t.c.x,t.d.x)-Math.min(t.a.x,t.b.x,t.c.x,t.d.x),height:Math.max(t.a.y,t.b.y,t.c.y,t.d.y)-Math.min(t.a.y,t.b.y,t.c.y,t.d.y)}},_handleEditButtonClick:function(t){var e=$(t.target.closest("button")),n="true"===e.attr("aria-pressed"),i=this._getElementHandleFromButton(e);"focalpoint"===i&&this.toggleFocalPoint(),n?this._dropFabricElement(i):(this.dragEditMode=!1,this._pickUpFabricElement(i))},_getRelativePositionMessage:function(t){if(t.left&&t.top){var e=((t.left-this.image.left+this.image.width/2)/this.image.width*100).toFixed(1),n=((t.top-this.image.top+this.image.height/2)/this.image.height*100).toFixed(1);return"Centered at X axis: ".concat(e,"%, Y axis: ").concat(n,"%.")}},_getSizeAndRelativePositionMessage:function(t){var e=this._getRelativePositionMessage(t),n="Crop rectangle width: ".concat(t.width,"px, height:").concat(t.height,"px.");return"".concat(n," ").concat(e)},_announce:function(t){var e=this;this.announceTimeout&&clearTimeout(this.announceTimeout),this.announceTimeout=setTimeout((function(){Craft.cp.announce(t),e.announceTimeout=null}),300)},_getElementHandleFromButton:function(t){return $(t).attr("data-fabric-element")},_getEditButtonFromElementHandle:function(t){return this.$fabricElementEditBtn.filter('[data-fabric-element="'.concat(t,'"]'))},_pickUpFabricElement:function(t){this._resetEditState();var e,n="",i="",r=this._getEditButtonFromElementHandle(t);r.attr("aria-pressed","true");var a=r.attr("data-item-name");"rectangle"===t?(this.cropperPickedUp=!0,n=this._getRelativePositionMessage(this.clipper)):"focalpoint"===t?(this.focalPickedUp=!0,n=this._getRelativePositionMessage(this.focalPoint)):this.handlePicked=t,e=Craft.t("app","{item} picked up.",{item:a}),i+=Craft.t("app","Use the arrow keys to change position, Tab or Spacebar to drop."),this._announce("".concat(e," ").concat(n," ").concat(i)),this.renderCropper&&(this._redrawCropperElements(),this.renderCropper())},_dropFabricElement:function(t){var e=this._getEditButtonFromElementHandle(t),n=e.attr("data-item-name"),i="";"rectangle"===t?i=this._getRelativePositionMessage(this.clipper):"focalpoint"===t&&(i=this._getRelativePositionMessage(this.prevFocalPoint)),this._resetEditState(),e.attr("aria-pressed","false");var r=Craft.t("app","{item} dropped.",{item:n});this._announce("".concat(r," ").concat(i)),this.renderCropper&&(this._redrawCropperElements(),this.renderCropper())},_toggleFocalModeStyles:function(){var t,e;this.focalPickedUp?(t=2,e="rgba(0,0,0,0.5)",$(".body").css("cursor","grabbing")):(t=0,e=this.settings.colors.transparent,$(".body").css("cursor","pointer")),this.focalPointPickedIndicator.set({strokeWidth:t,fill:e}),this.canvas.renderAll()},_handleKeydownOnFabricElementEditBtn:function(t){t.target,(this.focalPoint||this.cropperPickedUp||this.handlePicked)&&[Garnish.LEFT_KEY,Garnish.RIGHT_KEY,Garnish.UP_KEY,Garnish.DOWN_KEY].includes(t.keyCode)&&(event.preventDefault(),this._handleFabricElementKeyboardEdit(t))},_handleMouseDown:function(t){this.dragEditMode=!0;var e=this.focalPoint&&this._isMouseOver(t,this.focalPoint),n=this.croppingCanvas&&this._isMouseOver(t,this.clipper),i=this.croppingCanvas&&this._cropperHandleHitTest(t);(i||n||e)&&(this.previousMouseX=t.pageX,this.previousMouseY=t.pageY,e?this.focalClicked=!0:i?this.handlePicked=i:n&&(this.cropperClicked=!0))},_handleMouseMove:function(t){null!==this.mouseMoveEvent&&Garnish.requestAnimationFrame(this._handleMouseMoveInternal.bind(this)),this.mouseMoveEvent=t},_handleMouseMoveInternal:function(){null!==this.mouseMoveEvent&&(this.dragEditMode&&(this.focalPoint&&this.focalClicked?(this.draggingFocal=!0,this._handleFocalDrag(this.mouseMoveEvent),this.storeFocalPointState(),this.renderImage()):(this.cropperClicked||this.handlePicked)&&(this.cropperClicked?(this.draggingCropper=!0,this._handleCropperDrag(this.mouseMoveEvent)):(this.scalingCropper=!0,this._handleCropperResize(this.mouseMoveEvent)),this._redrawCropperElements(),this.storeCropperState(),this.renderCropper())),this._setMouseCursor(this.mouseMoveEvent),this.previousMouseX=this.mouseMoveEvent.pageX,this.previousMouseY=this.mouseMoveEvent.pageY,this.mouseMoveEvent=null)},_handleMouseUp:function(t){this.focalClicked?this.draggingFocal||(this.focalPickedUp=!this.focalPickedUp,this._toggleFocalModeStyles()):!this.focalPickedUp||this.draggingFocal||this.draggingCropper||this.scalingCropper||this._handleFocalClickToMove(t),this.draggingCropper=!1,this.cropperClicked=!1,this.scalingCropper=!1,this.handlePicked=!1,this.draggingFocal=!1,this.focalClicked=!1},_handleMouseOut:function(t){this._handleMouseUp(t),this.mouseMoveEvent=t,this._handleMouseMoveInternal()},_handleFocalClickToMove:function(t){if(void 0===this._handleFocalClickToMove._&&(this._handleFocalClickToMove._={}),this.focalPoint){this.focalPoint.get("left"),this.focalPoint.get("top");var e=this.$croppingCanvas.offset(),n=e.left,i=e.top;if(this._handleFocalClickToMove._.newX=t.pageX-n,this._handleFocalClickToMove._.newY=t.pageY-i,"crop"===this.currentView){if(!this.arePointsInsideRectangle([{x:this._handleFocalClickToMove._.newX,y:this._handleFocalClickToMove._.newY}],this.imageVerticeCoords))return}else if(!this.isPointInsideViewport({x:this._handleFocalClickToMove._.newX,y:this._handleFocalClickToMove._.newY}))return;this.focalPoint.set({left:this._handleFocalClickToMove._.newX,top:this._handleFocalClickToMove._.newY}),this.storeFocalPointState(),this.renderImage()}},_getClipperRectProperties:function(){return{left:this.clipper.left-this.clipper.width/2,top:this.clipper.top-this.clipper.height/2,width:this.clipper.width,height:this.clipper.height}},_getClipperHandlePosition:function(t){var e={x:null,y:null};switch(t){case"tl":e.x=this.clipper.left-this.clipper.width/2,e.y=this.clipper.top-this.clipper.height/2;break;case"t":e.x=this.clipper.left,e.y=this.clipper.top-this.clipper.height/2;break;case"b":e.x=this.clipper.left,e.y=this.clipper.top+this.clipper.height/2;break;case"tr":e.x=this.clipper.left+this.clipper.width/2,e.y=this.clipper.top-this.clipper.height/2;break;case"r":e.x=this.clipper.left+this.clipper.width/2,e.y=this.clipper.top;break;case"l":e.x=this.clipper.left-this.clipper.width/2,e.y=this.clipper.top;break;case"br":e.x=this.clipper.left+this.clipper.width/2,e.y=this.clipper.top+this.clipper.height/2;break;case"bl":e.x=this.clipper.left-this.clipper.width/2,e.y=this.clipper.top+this.clipper.height/2}return e},_handleFabricElementKeyboardEdit:function(t){var e;switch(t.keyCode){case Garnish.LEFT_KEY:e="left";break;case Garnish.RIGHT_KEY:e="right";break;case Garnish.UP_KEY:e="up";break;case Garnish.DOWN_KEY:e="down"}var n=this._getDeltaValuesFromDirection(e);this.cropperPickedUp?this._moveCropperByDelta(n.deltaX,n.deltaY):this.handlePicked?this._resizeCropperByHandleAndDeltas(this.handlePicked,{x:n.deltaX,y:n.deltaY}):this.focalPickedUp&&(this._moveFocalPointByDelta(n.deltaX,n.deltaY),this.storeFocalPointState(),this.renderImage())},_resizeCropperByHandleAndDeltas:function(t,e){void 0===this._resizeCropperByHandleAndDeltas._&&(this._resizeCropperByHandleAndDeltas._={}),this._resizeCropperByHandleAndDeltas._.startingRectangle=this._getClipperRectProperties(),this._resizeCropperByHandleAndDeltas._.rectangle=this._calculateNewCropperSizeByDeltas(this._resizeCropperByHandleAndDeltas._.startingRectangle,e.x,e.y,t),this._resizeCropperByHandleAndDeltas._.rectangle.height<30||this._resizeCropperByHandleAndDeltas._.rectangle.width<30||this.arePointsInsideRectangle(this._getRectangleVertices(this._resizeCropperByHandleAndDeltas._.rectangle),this.imageVerticeCoords)&&(this.clipper.set({top:this._resizeCropperByHandleAndDeltas._.rectangle.top+this._resizeCropperByHandleAndDeltas._.rectangle.height/2,left:this._resizeCropperByHandleAndDeltas._.rectangle.left+this._resizeCropperByHandleAndDeltas._.rectangle.width/2,width:this._resizeCropperByHandleAndDeltas._.rectangle.width,height:this._resizeCropperByHandleAndDeltas._.rectangle.height}),this._redrawCropperElements(),this._announce(this._getSizeAndRelativePositionMessage(this.clipper)))},_getDeltaValuesFromDirection:function(t){var e={deltaX:0,deltaY:0};switch(t){case"up":e.deltaY=-5;break;case"down":e.deltaY=5;break;case"left":e.deltaX=-5;break;case"right":e.deltaX=5}return e},_moveCropperByDelta:function(t,e){void 0===this._moveCropperByDelta._&&(this._moveCropperByDelta._={}),this._moveCropperByDelta._.deltaX=t,this._moveCropperByDelta._.deltaY=e,this._moveCropperByDelta._.rectangle=this._getClipperRectProperties();var n=this._getRectangleVertices(this._moveCropperByDelta._.rectangle,this._moveCropperByDelta._.deltaX,this._moveCropperByDelta._.deltaY);if(!this.arePointsInsideRectangle(n,this.imageVerticeCoords)){var i=this._getFarthestAllowedDeltasForRectangle(this._moveCropperByDelta._.rectangle,{x:this._moveCropperByDelta._.deltaX,y:this._moveCropperByDelta._.deltaY}),r=i.farthest,a=i.farthestDeltas;if(0==r)return;this._moveCropperByDelta._.deltaX=a.x,this._moveCropperByDelta._.deltaY=a.y}this.clipper.set({left:this.clipper.left+this._moveCropperByDelta._.deltaX,top:this.clipper.top+this._moveCropperByDelta._.deltaY}),this._announce(this._getRelativePositionMessage(this.clipper)),this._redrawCropperElements(),this.storeCropperState(),this.renderCropper()},_moveFocalPointByDelta:function(t,e){if(void 0===this._moveFocalPointByDelta._&&(this._moveFocalPointByDelta._={}),this.focalPoint){if(0===t&&0===e)return;if(this._moveFocalPointByDelta._.newX=this.focalPoint.left+t,this._moveFocalPointByDelta._.newY=this.focalPoint.top+e,"crop"===this.currentView){if(!this.arePointsInsideRectangle([{x:this._moveFocalPointByDelta._.newX,y:this._moveFocalPointByDelta._.newY}],this.imageVerticeCoords))return}else if(!this.isPointInsideViewport({x:this._moveFocalPointByDelta._.newX,y:this._moveFocalPointByDelta._.newY}))return;this.focalPoint.set({left:this.focalPoint.left+t,top:this.focalPoint.top+e}),this._announce(this._getRelativePositionMessage(this.focalPoint))}},_getFarthestAllowedDeltasForRectangle:function(t,e){var n=0,i=0,r=(e.x,e.y,{farthest:0,farthestDeltas:{}});for(n=Math.min(Math.abs(e.x),10);n>=0;n--)for(i=Math.min(Math.abs(e.y),10);i>=0;i--){var a=this._getRectangleVertices(t,n*(e.x>0?1:-1),i*(e.y>0?1:-1));this.arePointsInsideRectangle(a,this.imageVerticeCoords)&&n+i>r.farthest&&(r.farthest=n+i,r.farthestDeltas={x:n*(e.x>0?1:-1),y:i*(e.y>0?1:-1)})}return r},_handleCropperDrag:function(t){if(void 0===this._handleCropperDrag._&&(this._handleCropperDrag._={}),this._handleCropperDrag._.deltaX=t.pageX-this.previousMouseX,this._handleCropperDrag._.deltaY=t.pageY-this.previousMouseY,0===this._handleCropperDrag._.deltaX&&0===this._handleCropperDrag._.deltaY)return!1;if(this._handleCropperDrag._.rectangle=this._getClipperRectProperties(),this._handleCropperDrag._.vertices=this._getRectangleVertices(this._handleCropperDrag._.rectangle,this._handleCropperDrag._.deltaX,this._handleCropperDrag._.deltaY),!this.arePointsInsideRectangle(this._handleCropperDrag._.vertices,this.imageVerticeCoords)){var e=this._getFarthestAllowedDeltasForRectangle(this._handleCropperDrag._.rectangle,{x:this._handleCropperDrag._.deltaX,y:this._handleCropperDrag._.deltaY}),n=e.farthest,i=e.farthestDeltas;if(0==n)return;this._handleCropperDrag._.deltaX=i.x,this._handleCropperDrag._.deltaY=i.y}this.clipper.set({left:this.clipper.left+this._handleCropperDrag._.deltaX,top:this.clipper.top+this._handleCropperDrag._.deltaY})},_handleFocalDrag:function(t){void 0===this._handleFocalDrag._&&(this._handleFocalDrag._={}),this.focalPoint&&(this._handleFocalDrag._.deltaX=t.pageX-this.previousMouseX,this._handleFocalDrag._.deltaY=t.pageY-this.previousMouseY,this._moveFocalPointByDelta(this._handleFocalDrag._.deltaX,this._handleFocalDrag._.deltaY))},isPointInsideViewport:function(t){return this.viewport.left-this.viewport.width/2-t.x<0&&this.viewport.left+this.viewport.width/2-t.x>0&&this.viewport.top-this.viewport.height/2-t.y<0&&this.viewport.top+this.viewport.height/2-t.y>0},setCroppingConstraint:function(t){switch(this.updateSizeAndPosition(),t){case"none":this.croppingConstraint=!1;break;case"original":this.croppingConstraint=this.originalWidth/this.originalHeight;break;case"current":this.croppingConstraint=this.clipper.width/this.clipper.height;break;case"custom":break;default:this.croppingConstraint=parseFloat(t)}},enforceCroppingConstraint:function(){var t=this;void 0===this.enforceCroppingConstraint._&&(this.enforceCroppingConstraint._={}),!this.animationInProgress&&this.croppingConstraint&&(this.animationInProgress=!0,this.enforceCroppingConstraint._.rectangle=this._getClipperRectProperties(),this.clipper.width>this.clipper.height*this.croppingConstraint?(this.enforceCroppingConstraint._.previousHeight=this.enforceCroppingConstraint._.rectangle.height,this.enforceCroppingConstraint._.rectangle.height=this.clipper.width/this.croppingConstraint,this.enforceCroppingConstraint._.rectangle.top-=(this.enforceCroppingConstraint._.rectangle.height-this.enforceCroppingConstraint._.previousHeight)/2,this.arePointsInsideRectangle(this._getRectangleVertices(this.enforceCroppingConstraint._.rectangle),this.imageVerticeCoords)||(this.enforceCroppingConstraint._.rectangle.width=this.clipper.height*this.croppingConstraint,this.enforceCroppingConstraint._.rectangle.height=this.enforceCroppingConstraint._.rectangle.width/this.croppingConstraint)):(this.enforceCroppingConstraint._.previousWidth=this.enforceCroppingConstraint._.rectangle.width,this.enforceCroppingConstraint._.rectangle.width=this.clipper.height*this.croppingConstraint,this.enforceCroppingConstraint._.rectangle.left-=(this.enforceCroppingConstraint._.rectangle.width-this.enforceCroppingConstraint._.previousWidth)/2,this.arePointsInsideRectangle(this._getRectangleVertices(this.enforceCroppingConstraint._.rectangle),this.imageVerticeCoords)||(this.enforceCroppingConstraint._.rectangle.height=this.clipper.width/this.croppingConstraint,this.enforceCroppingConstraint._.rectangle.width=this.enforceCroppingConstraint._.rectangle.height*this.croppingConstraint)),this.enforceCroppingConstraint._.properties={height:this.enforceCroppingConstraint._.rectangle.height,width:this.enforceCroppingConstraint._.rectangle.width},this.clipper.animate(this.enforceCroppingConstraint._.properties,{onChange:function(){t._redrawCropperElements(),t.croppingCanvas.renderAll()},duration:this.settings.animationDuration,onComplete:function(){t._redrawCropperElements(),t.animationInProgress=!1,t.renderCropper(),t.storeCropperState()}}))},_handleCropperResize:function(t){void 0===this._handleCropperResize._&&(this._handleCropperResize._={}),this._handleCropperResize._.deltaX=t.pageX-this.previousMouseX,this._handleCropperResize._.deltaY=t.pageY-this.previousMouseY,"b"!==this.handlePicked&&"t"!==this.handlePicked||(this._handleCropperResize._.deltaX=0),"l"!==this.handlePicked&&"r"!==this.handlePicked||(this._handleCropperResize._.deltaY=0),0===this._handleCropperResize._.deltaX&&0===this._handleCropperResize._.deltaY||this._resizeCropperByHandleAndDeltas(this.handlePicked,{x:this._handleCropperResize._.deltaX,y:this._handleCropperResize._.deltaY})},_calculateNewCropperSizeByDeltas:function(t,e,n,i){if(void 0===this._calculateNewCropperSizeByDeltas._&&(this._calculateNewCropperSizeByDeltas._={}),this._calculateNewCropperSizeByDeltas._.topDelta=0,this._calculateNewCropperSizeByDeltas._.leftDelta=0,this._calculateNewCropperSizeByDeltas._.rectangle=t,this._calculateNewCropperSizeByDeltas._.deltaX=e,this._calculateNewCropperSizeByDeltas._.deltaY=n,this.croppingConstraint){switch(this._calculateNewCropperSizeByDeltas._.change=0,i){case"t":this._calculateNewCropperSizeByDeltas._.change=-this._calculateNewCropperSizeByDeltas._.deltaY;break;case"b":this._calculateNewCropperSizeByDeltas._.change=this._calculateNewCropperSizeByDeltas._.deltaY;break;case"r":this._calculateNewCropperSizeByDeltas._.change=this._calculateNewCropperSizeByDeltas._.deltaX;break;case"l":this._calculateNewCropperSizeByDeltas._.change=-this._calculateNewCropperSizeByDeltas._.deltaX;break;case"tr":this._calculateNewCropperSizeByDeltas._.change=Math.abs(this._calculateNewCropperSizeByDeltas._.deltaY)>Math.abs(this._calculateNewCropperSizeByDeltas._.deltaX)?-this._calculateNewCropperSizeByDeltas._.deltaY:this._calculateNewCropperSizeByDeltas._.deltaX;break;case"tl":this._calculateNewCropperSizeByDeltas._.change=Math.abs(this._calculateNewCropperSizeByDeltas._.deltaY)>Math.abs(this._calculateNewCropperSizeByDeltas._.deltaX)?-this._calculateNewCropperSizeByDeltas._.deltaY:-this._calculateNewCropperSizeByDeltas._.deltaX;break;case"br":this._calculateNewCropperSizeByDeltas._.change=Math.abs(this._calculateNewCropperSizeByDeltas._.deltaY)>Math.abs(this._calculateNewCropperSizeByDeltas._.deltaX)?this._calculateNewCropperSizeByDeltas._.deltaY:this._calculateNewCropperSizeByDeltas._.deltaX;break;case"bl":this._calculateNewCropperSizeByDeltas._.change=Math.abs(this._calculateNewCropperSizeByDeltas._.deltaY)>Math.abs(this._calculateNewCropperSizeByDeltas._.deltaX)?this._calculateNewCropperSizeByDeltas._.deltaY:-this._calculateNewCropperSizeByDeltas._.deltaX}switch(this.croppingConstraint>1?(this._calculateNewCropperSizeByDeltas._.deltaX=this._calculateNewCropperSizeByDeltas._.change,this._calculateNewCropperSizeByDeltas._.deltaY=this._calculateNewCropperSizeByDeltas._.deltaX/this.croppingConstraint):(this._calculateNewCropperSizeByDeltas._.deltaY=this._calculateNewCropperSizeByDeltas._.change,this._calculateNewCropperSizeByDeltas._.deltaX=this._calculateNewCropperSizeByDeltas._.deltaY*this.croppingConstraint),this._calculateNewCropperSizeByDeltas._.rectangle.height+=this._calculateNewCropperSizeByDeltas._.deltaY,this._calculateNewCropperSizeByDeltas._.rectangle.width+=this._calculateNewCropperSizeByDeltas._.deltaX,i){case"t":this._calculateNewCropperSizeByDeltas._.rectangle.top-=this._calculateNewCropperSizeByDeltas._.deltaY,this._calculateNewCropperSizeByDeltas._.rectangle.left-=this._calculateNewCropperSizeByDeltas._.deltaX/2;break;case"b":this._calculateNewCropperSizeByDeltas._.rectangle.left+=-this._calculateNewCropperSizeByDeltas._.deltaX/2;break;case"r":this._calculateNewCropperSizeByDeltas._.rectangle.top+=-this._calculateNewCropperSizeByDeltas._.deltaY/2;break;case"l":this._calculateNewCropperSizeByDeltas._.rectangle.top-=this._calculateNewCropperSizeByDeltas._.deltaY/2,this._calculateNewCropperSizeByDeltas._.rectangle.left-=this._calculateNewCropperSizeByDeltas._.deltaX;break;case"tr":this._calculateNewCropperSizeByDeltas._.rectangle.top-=this._calculateNewCropperSizeByDeltas._.deltaY;break;case"tl":this._calculateNewCropperSizeByDeltas._.rectangle.top-=this._calculateNewCropperSizeByDeltas._.deltaY,this._calculateNewCropperSizeByDeltas._.rectangle.left-=this._calculateNewCropperSizeByDeltas._.deltaX;break;case"bl":this._calculateNewCropperSizeByDeltas._.rectangle.left-=this._calculateNewCropperSizeByDeltas._.deltaX}}else!this.shiftKeyHeld||"tl"!==i&&"tr"!==i&&"bl"!==i&&"br"!==i||(this._calculateNewCropperSizeByDeltas._.ratio,Math.abs(e)>Math.abs(n)?(this._calculateNewCropperSizeByDeltas._.ratio=t.width/t.height,this._calculateNewCropperSizeByDeltas._.deltaY=this._calculateNewCropperSizeByDeltas._.deltaX/this._calculateNewCropperSizeByDeltas._.ratio,this._calculateNewCropperSizeByDeltas._.deltaY*="tr"===i||"bl"===i?-1:1):(this._calculateNewCropperSizeByDeltas._.ratio=t.width/t.height,this._calculateNewCropperSizeByDeltas._.deltaX=this._calculateNewCropperSizeByDeltas._.deltaY*this._calculateNewCropperSizeByDeltas._.ratio,this._calculateNewCropperSizeByDeltas._.deltaX*="tr"===i||"bl"===i?-1:1)),i.match(/t/)&&(this._calculateNewCropperSizeByDeltas._.rectangle.top+=this._calculateNewCropperSizeByDeltas._.deltaY,this._calculateNewCropperSizeByDeltas._.rectangle.height-=this._calculateNewCropperSizeByDeltas._.deltaY),i.match(/b/)&&(this._calculateNewCropperSizeByDeltas._.rectangle.height+=this._calculateNewCropperSizeByDeltas._.deltaY),i.match(/r/)&&(this._calculateNewCropperSizeByDeltas._.rectangle.width+=this._calculateNewCropperSizeByDeltas._.deltaX),i.match(/l/)&&(this._calculateNewCropperSizeByDeltas._.rectangle.left+=this._calculateNewCropperSizeByDeltas._.deltaX,this._calculateNewCropperSizeByDeltas._.rectangle.width-=this._calculateNewCropperSizeByDeltas._.deltaX);return this._calculateNewCropperSizeByDeltas._.rectangle.top=this._calculateNewCropperSizeByDeltas._.rectangle.top,this._calculateNewCropperSizeByDeltas._.rectangle.left=this._calculateNewCropperSizeByDeltas._.rectangle.left,this._calculateNewCropperSizeByDeltas._.rectangle.width=this._calculateNewCropperSizeByDeltas._.rectangle.width,this._calculateNewCropperSizeByDeltas._.rectangle.height=this._calculateNewCropperSizeByDeltas._.rectangle.height,this._calculateNewCropperSizeByDeltas._.rectangle},_setMouseCursor:function(t){void 0===this._setMouseCursor._&&(this._setMouseCursor._={}),Garnish.isMobileBrowser(!0)||(this._setMouseCursor._.cursor="default",this._setMouseCursor._.handle=this.croppingCanvas&&this._cropperHandleHitTest(t),this.focalPoint&&this._isMouseOver(t,this.focalPoint)?this._setMouseCursor._.cursor="pointer":this._setMouseCursor._.handle?"t"===this._setMouseCursor._.handle||"b"===this._setMouseCursor._.handle?this._setMouseCursor._.cursor="ns-resize":"l"===this._setMouseCursor._.handle||"r"===this._setMouseCursor._.handle?this._setMouseCursor._.cursor="ew-resize":"tl"===this._setMouseCursor._.handle||"br"===this._setMouseCursor._.handle?this._setMouseCursor._.cursor="nwse-resize":"bl"!==this._setMouseCursor._.handle&&"tr"!==this._setMouseCursor._.handle||(this._setMouseCursor._.cursor="nesw-resize"):this.croppingCanvas&&this._isMouseOver(t,this.clipper)?this._setMouseCursor._.cursor="move":this.focalPickedUp&&(this._setMouseCursor._.cursor="grabbing"),$(".body").css("cursor",this._setMouseCursor._.cursor))},_cropperHandleHitTest:function(t){if(void 0===this._cropperHandleHitTest._&&(this._cropperHandleHitTest._={}),this._cropperHandleHitTest._.parentOffset=this.$croppingCanvas.offset(),this._cropperHandleHitTest._.mouseX=t.pageX-this._cropperHandleHitTest._.parentOffset.left,this._cropperHandleHitTest._.mouseY=t.pageY-this._cropperHandleHitTest._.parentOffset.top,this._cropperHandleHitTest._.lb=this.clipper.left-this.clipper.width/2,this._cropperHandleHitTest._.rb=this._cropperHandleHitTest._.lb+this.clipper.width,this._cropperHandleHitTest._.tb=this.clipper.top-this.clipper.height/2,this._cropperHandleHitTest._.bb=this._cropperHandleHitTest._.tb+this.clipper.height,this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.lb+10&&this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.lb-3){if(this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.tb+10&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.tb-3)return"tl";if(this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.bb+3&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.bb-10)return"bl"}if(this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.rb-13&&this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.rb+3){if(this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.tb+10&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.tb-3)return"tr";if(this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.bb+2&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.bb-10)return"br"}return this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.lb+3&&this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.lb-3&&this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.bb-10&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.tb+10?"l":this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.rb+1&&this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.rb-5&&this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.bb-10&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.tb+10?"r":this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.tb+4&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.tb-2&&this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.lb+10&&this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.rb-10?"t":this._cropperHandleHitTest._.mouseY<this._cropperHandleHitTest._.bb+2&&this._cropperHandleHitTest._.mouseY>this._cropperHandleHitTest._.bb-4&&this._cropperHandleHitTest._.mouseX>this._cropperHandleHitTest._.lb+10&&this._cropperHandleHitTest._.mouseX<this._cropperHandleHitTest._.rb-10&&"b"},_isMouseOver:function(t,e){return void 0===this._isMouseOver._&&(this._isMouseOver._={}),this._isMouseOver._.parentOffset=this.$croppingCanvas.offset(),this._isMouseOver._.mouseX=t.pageX-this._isMouseOver._.parentOffset.left,this._isMouseOver._.mouseY=t.pageY-this._isMouseOver._.parentOffset.top,this._isMouseOver._.lb=e.left-e.width/2,this._isMouseOver._.rb=this._isMouseOver._.lb+e.width,this._isMouseOver._.tb=e.top-e.height/2,this._isMouseOver._.bb=this._isMouseOver._.tb+e.height,this._isMouseOver._.mouseX>=this._isMouseOver._.lb&&this._isMouseOver._.mouseX<=this._isMouseOver._.rb&&this._isMouseOver._.mouseY>=this._isMouseOver._.tb&&this._isMouseOver._.mouseY<=this._isMouseOver._.bb},_getRectangleVertices:function(t,e,n){return void 0===this._getRectangleVertices._&&(this._getRectangleVertices._={}),void 0===e&&(e=0),void 0===n&&(n=0),this._getRectangleVertices._.topLeft={x:t.left+e,y:t.top+n},this._getRectangleVertices._.topRight={x:this._getRectangleVertices._.topLeft.x+t.width,y:this._getRectangleVertices._.topLeft.y},this._getRectangleVertices._.bottomRight={x:this._getRectangleVertices._.topRight.x,y:this._getRectangleVertices._.topRight.y+t.height},this._getRectangleVertices._.bottomLeft={x:this._getRectangleVertices._.topLeft.x,y:this._getRectangleVertices._.bottomRight.y},[this._getRectangleVertices._.topLeft,this._getRectangleVertices._.topRight,this._getRectangleVertices._.bottomRight,this._getRectangleVertices._.bottomLeft]},_setFittedImageVerticeCoordinates:function(){this.imageVerticeCoords=this.getImageVerticeCoords("fit")},getImageVerticeCoords:function(t){var e,n=-1*((this.hasOrientationChanged()?90:0)+this.imageStraightenAngle)*(Math.PI/180),i=this.getScaledImageDimensions();e="number"==typeof t?t:"cover"===t?this.getZoomToCoverRatio(i):this.getZoomToFitRatio(i);var r=i.height*e,a=i.width*e,s=Math.cos(n)*r,o=Math.sin(n)*a,l=Math.cos(n)*a,c=Math.sin(n)*r,u=(this.editorHeight-(s+o))/2,h=(this.editorWidth-(c+l))/2;return{a:{x:h+l,y:u},b:{x:this.editorWidth-h,y:u+s},c:{x:h+c,y:this.editorHeight-u},d:{x:h,y:u+o}}},_debug:function(t){this.canvas.remove(this.debugger),this.debugger=t,this.canvas.add(this.debugger)},arePointsInsideRectangle:function(t,e){for(void 0===this.arePointsInsideRectangle._&&(this.arePointsInsideRectangle._={}),this.arePointsInsideRectangle._.ab=this._getVector(e.a,e.b),this.arePointsInsideRectangle._.bc=this._getVector(e.b,e.c),this.arePointsInsideRectangle._.scalarAbAb=this._getScalarProduct(this.arePointsInsideRectangle._.ab,this.arePointsInsideRectangle._.ab),this.arePointsInsideRectangle._.scalarBcBc=this._getScalarProduct(this.arePointsInsideRectangle._.bc,this.arePointsInsideRectangle._.bc),this.arePointsInsideRectangle._.i=0;this.arePointsInsideRectangle._.i<t.length;this.arePointsInsideRectangle._.i++)if(this.arePointsInsideRectangle._.point=t[this.arePointsInsideRectangle._.i],this.arePointsInsideRectangle._.ap=this._getVector(e.a,this.arePointsInsideRectangle._.point),this.arePointsInsideRectangle._.bp=this._getVector(e.b,this.arePointsInsideRectangle._.point),this.arePointsInsideRectangle._.scalarAbAp=this._getScalarProduct(this.arePointsInsideRectangle._.ab,this.arePointsInsideRectangle._.ap),this.arePointsInsideRectangle._.scalarBcBp=this._getScalarProduct(this.arePointsInsideRectangle._.bc,this.arePointsInsideRectangle._.bp),this.arePointsInsideRectangle._.projectsOnAB=0<=this.arePointsInsideRectangle._.scalarAbAp&&this.arePointsInsideRectangle._.scalarAbAp<=this.arePointsInsideRectangle._.scalarAbAb,this.arePointsInsideRectangle._.projectsOnBC=0<=this.arePointsInsideRectangle._.scalarBcBp&&this.arePointsInsideRectangle._.scalarBcBp<=this.arePointsInsideRectangle._.scalarBcBc,!this.arePointsInsideRectangle._.projectsOnAB||!this.arePointsInsideRectangle._.projectsOnBC)return!1;return!0},_getVector:function(t,e){return{x:e.x-t.x,y:e.y-t.y}},_getScalarProduct:function(t,e){return t.x*e.x+t.y*e.y},_getVectorMagnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},_getAngleBetweenVectors:function(t,e){return Math.round(180*Math.acos(Math.min(1,this._getScalarProduct(t,e)/(this._getVectorMagnitude(t)*this._getVectorMagnitude(e))))/Math.PI*100)/100},_getEdgeCrossed:function(t,e){for(var n=[[t.a,t.b],[t.b,t.c],[t.c,t.d],[t.d,t.a]],i={x:this.editorWidth/2,y:this.editorHeight/2},r=180,a=null,s=0;s<n.length;s++){var o=n[s],l=this._getVector(o[0],i),c=this._getVector(o[0],o[1]),u=this._getVector(o[0],e),h=Math.abs(this._getAngleBetweenVectors(l,u)-(this._getAngleBetweenVectors(l,c)+this._getAngleBetweenVectors(c,u)));h<r&&(r=h,a=o)}return a},_getImageBoundingBox:function(t){var e={},n=Math.abs(this.imageStraightenAngle)*(Math.PI/180),i=t.height/t.width;if(e.height=t.width*(Math.sin(n)+Math.cos(n)*i),e.width=t.width*(Math.cos(n)+Math.sin(n)*i),this.hasOrientationChanged()){var r=e.width;e.width=e.height,e.height=r}return e}},{defaults:{animationDuration:100,allowSavingAsNew:!0,onSave:$.noop,allowDegreeFractions:null,colors:{white:"rgb(255, 255, 255)",black:"rgb(0, 0, 0)",transparentBlack:"rgba(0, 0, 0, 0.8)",transparent:"rgba(0,0,0,0)"}}})},308:function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.CpModal=Garnish.Modal.extend({action:null,namespace:null,showingLoadSpinner:!1,$loadSpinner:null,$container:null,$body:null,$content:null,$sidebar:null,$footer:null,$cancelBtn:null,$saveBtn:null,showingSidebar:!1,cancelToken:null,ignoreFailedRequest:!1,fieldsWithErrors:null,init:function(t,e){var n=this;this.action=t,this.setSettings(e,Craft.CpModal.defaults),this.fieldsWithErrors=[],this.$body=$("<div/>",{class:"cpmodal-body"}),this.$content=$("<div/>",{class:"cpmodal-content"}).appendTo(this.$body),this.$footer=$("<div/>",{class:"cpmodal-footer hidden"}),$("<div/>",{class:"flex-grow"}).appendTo(this.$footer);var i=$("<div/>",{class:"flex flex-nowrap"}).appendTo(this.$footer);this.$loadSpinner=$("<div/>",{class:"spinner",title:Craft.t("app","Loading"),"aria-label":Craft.t("app","Loading")}).prependTo(i),this.$cancelBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(i),this.settings.showSubmitButton&&(this.$saveBtn=Craft.ui.createSubmitButton({label:Craft.t("app","Save"),spinner:!0}).appendTo(i)),this.$container=$("<".concat(this.settings.containerElement,"/>"),this.settings.containerAttributes);var r=this.$body.add(this.$footer);this.$container.append(r),this.base(this.$container,{autoShow:!1}),this.$container.data("cpModal",this),Garnish.uiLayerManager.registerShortcut({keyCode:Garnish.S_KEY,ctrl:!0},(function(t){n.handleSubmit(t)})),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){n.closeMeMaybe()})),this.addListener(this.$cancelBtn,"click",(function(){n.closeMeMaybe()})),this.addListener(this.$shade,"click",(function(){n.closeMeMaybe()})),this.addListener(this.$container,"click",(function(t){var e=$(event.target);!n.showingSidebar||e.closest(n.$sidebarBtn).length||e.closest(n.$sidebar).length||n.hideSidebar()})),this.addListener(this.$container,"submit","handleSubmit"),this.load()},load:function(t,e){var n=this;return new Promise((function(t,i){n.trigger("beforeLoad"),n.showLoadSpinner(),n.cancelToken&&(n.ignoreFailedRequest=!0,n.cancelToken.cancel()),n.cancelToken=axios.CancelToken.source(),Craft.sendActionRequest("GET",n.action,$.extend({params:Object.assign({},n.getParams(),n.settings.params),cancelToken:n.cancelToken.token,headers:{"X-Craft-Container-Id":n.$container.attr("id")}},n.settings.requestOptions)).then((function(r){n.update(r.data).then((function(){!1!==e&&(n.$container.data("delta-names",r.data.deltaNames),n.$container.data("initial-delta-values",r.data.initialDeltaValues),n.$container.data("initialSerializedValue",n.$container.serialize())),t()})).catch((function(t){i(t)}))})).catch((function(t){n.ignoreFailedRequest||(Craft.cp.displayError(),i(t)),n.ignoreFailedRequest=!1})).finally((function(){n.hideLoadSpinner(),n.show(),n.cancelToken=null}))}))},getParams:function(){return{}},showLoadSpinner:function(){this.$loadSpinner.removeClass("hidden"),this.showingLoadSpinner=!0},hideLoadSpinner:function(){this.$loadSpinner.addClass("hidden"),this.showingLoadSpinner=!1},update:function(t){var e=this;return new Promise((function(n){e.namespace=t.namespace,t.bodyClass&&e.$body.addClass(t.bodyClass),e.$content.html(t.content),t.submitButtonLabel&&e.$saveBtn.text(t.submitButtonLabel),t.formAttributes&&Craft.setElementAttributes(e.$container,t.formAttributes),e.$footer.removeClass("hidden"),Garnish.requestAnimationFrame((function(){Craft.appendHeadHtml(t.headHtml),Craft.appendBodyHtml(t.bodyHtml),Craft.initUiElements(e.$content),Craft.cp.elementThumbLoader.load($(e.$content)),Garnish.isMobileBrowser()||Craft.setFocusWithin(e.$content),n(),e.trigger("load")}))}))},showSubmitSpinner:function(){this.$saveBtn.addClass("loading")},hideSubmitSpinner:function(){this.$saveBtn.removeClass("loading")},handleSubmit:function(t){t.preventDefault(),this.submit()},submit:function(){var t=this;this.showSubmitSpinner();var e=Craft.findDeltaData(this.$container.data("initialSerializedValue"),this.$container.serialize(),null,this.$container.data("initial-delta-values"));Craft.sendActionRequest("POST",null,{data:e,headers:{"X-Craft-Namespace":this.namespace}}).then((function(e){t.handleSubmitResponse(e)})).catch((function(e){t.handleSubmitError(e)})).finally((function(){t.hideSubmitSpinner()}))},handleSubmitResponse:function(t){this.clearErrors();var e=t.data||{};e.message&&Craft.cp.displaySuccess(e.message,e.notificationSettings),e.modelClass&&e.modelId&&Craft.refreshComponentInstances(e.modelClass,e.modelId),this.trigger("submit",{response:t,data:e.modelName&&e[e.modelName]||{}}),this.settings.closeOnSubmit&&this.close()},handleSubmitError:function(t){if(!t.isAxiosError||!t.response||400===!t.response.status)throw Craft.cp.displayError(),t;var e=t.response.data||{};Craft.cp.displayError(e.message),e.errors&&this.showErrors(e.errors)},showErrors:function(e){var n=this;this.clearErrors(),Object.entries(e).forEach((function(e){var i=function(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=i[0],a=i[1],s=n.$container.find('[data-attribute="'.concat(r,'"]'));s&&(Craft.ui.addErrorsToField(s,a),n.fieldsWithErrors.push(s))})),this.updateSizeAndPosition()},clearErrors:function(){this.fieldsWithErrors.forEach((function(t){Craft.ui.clearErrorsFromField(t)}))},isDirty:function(){var t=this,e=this.$container.data("initialSerializedValue");return void 0!==e&&e!==(this.$container.data("serializer")||function(){return t.$container.serialize()})()},closeMeMaybe:function(){this.visible&&(this.isDirty()&&!confirm(Craft.t("app","Are you sure you want to close this screen? Any changes will be lost."))||this.close())},close:function(){this.cancelToken&&(this.ignoreFailedRequest=!0,this.cancelToken.cancel()),this.hide(),this.trigger("close"),this.destroy()}},{defaults:{params:{},containerElement:"form",containerAttributes:{id:"cp-modal-".concat(Math.floor(1e8*Math.random())),action:"",method:"post",novalidate:"",class:"cpmodal modal fitted"},requestOptions:{},closeOnSubmit:!0,showSubmitButton:!0}})},337:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}var r;Craft.AuthManager=Garnish.Base.extend({checkRemainingSessionTimer:null,decrementLogoutWarningInterval:null,showingLogoutWarningModal:!1,showingLoginModal:!1,renewingSession:!1,logoutWarningModal:null,loginModal:null,$logoutWarningPara:null,$passwordInput:null,$loginBtn:null,loginBtn:null,get remainingSessionTime(){return Craft.remainingSessionTime},init:function(){Craft.username&&this.updateRemainingSessionTime(Craft.remainingSessionTime,!1)},setCheckRemainingSessionTimer:function(t){var e=this;this.checkRemainingSessionTimer&&clearTimeout(this.checkRemainingSessionTimer),this.checkRemainingSessionTimer=setTimeout((function(){e.checkRemainingSessionTime()}),1e3*t)},checkRemainingSessionTime:function(t){var n=this;return i(e().mark((function i(){var r,a,s;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Craft.getActionUrl("users/session-info",t?null:"dontExtendSession=1"),e.prev=1,e.next=4,Craft.sendActionRequest("GET",r);case 4:a=e.sent,s=a.data,void 0!==Craft.csrfTokenValue&&(Craft.csrfTokenValue=s.csrfTokenValue),n.updateRemainingSessionTime(s.timeout,s.isGuest),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.updateRemainingSessionTime(-1,!1);case 13:case"end":return e.stop()}}),i,null,[[1,10]])})))()},updateRemainingSessionTime:function(t,e){this.checkRemainingSessionTimer&&clearTimeout(this.checkRemainingSessionTimer);var n=!Craft.remainingSessionTime&&t;if(Craft.remainingSessionTime=parseInt(t),-1!==Craft.remainingSessionTime&&Craft.remainingSessionTime<Craft.AuthManager.minSafeSessionTime)if(!e||Craft.remainingSessionTime){this.showingLogoutWarningModal||this.showLogoutWarningModal();var i=Math.min(Craft.AuthManager.checkInterval,Craft.remainingSessionTime);this.setCheckRemainingSessionTimer(Math.max(1,i))}else this.showingLoginModal||this.renewingSession||(this.hideLogoutWarningModal(),this.showLoginModal()),this.setCheckRemainingSessionTimer(Craft.AuthManager.checkInterval);else this.hideLogoutWarningModal(),this.hideLoginModal(),-1!==Craft.remainingSessionTime&&Craft.remainingSessionTime<Craft.AuthManager.minSafeSessionTime+Craft.AuthManager.checkInterval?this.setCheckRemainingSessionTimer(Craft.remainingSessionTime-Craft.AuthManager.minSafeSessionTime+1):this.setCheckRemainingSessionTimer(Craft.AuthManager.checkInterval);n&&(window.am=this,this.trigger("login"))},showLogoutWarningModal:function(){var t,e=this;if(this.showingLoginModal?(this.hideLoginModal(!0),t=!0):t=!1,this.showingLogoutWarningModal=!0,!this.logoutWarningModal){var n=$('<form id="logoutwarningmodal" class="modal alert fitted"/>'),i=$('<div class="body"/>').appendTo(n),r=$('<div class="buttons right"/>').appendTo(i),a=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Sign out now")}).appendTo(r),s=$("<button/>",{type:"submit",class:"btn submit",text:Craft.t("app","Keep me signed in")}).appendTo(r);this.$logoutWarningPara=$("<p/>").prependTo(i),this.logoutWarningModal=new Garnish.Modal(n,{autoShow:!1,closeOtherModals:!1,hideOnEsc:!1,hideOnShadeClick:!1,shadeClass:"modal-shade dark logoutwarningmodalshade",onFadeIn:function(){Garnish.isMobileBrowser(!0)||setTimeout((function(){s.focus()}),100)}}),this.addListener(a,"activate","logout"),this.addListener(n,"submit",(function(t){t.preventDefault(),e.renewSession()}))}t?this.logoutWarningModal.quickShow():this.logoutWarningModal.show(),this.updateLogoutWarningMessage(),this.decrementLogoutWarningInterval=setInterval(this.decrementLogoutWarning.bind(this),1e3)},updateLogoutWarningMessage:function(){this.$logoutWarningPara.text(Craft.t("app","Your session will expire in {time}.",{time:Craft.secondsToHumanTimeDuration(Craft.remainingSessionTime)})),this.logoutWarningModal.updateSizeAndPosition()},decrementLogoutWarning:function(){Craft.remainingSessionTime>0&&(Craft.remainingSessionTime--,this.updateLogoutWarningMessage()),0===Craft.remainingSessionTime&&clearInterval(this.decrementLogoutWarningInterval)},hideLogoutWarningModal:function(t){this.showingLogoutWarningModal=!1,this.logoutWarningModal&&(t?this.logoutWarningModal.quickHide():this.logoutWarningModal.hide(),this.decrementLogoutWarningInterval&&clearInterval(this.decrementLogoutWarningInterval))},showLoginModal:function(){var t=this;return i(e().mark((function n(){var r,a,s,o,l;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.showingLoginModal){n.next=2;break}return n.abrupt("return");case 2:return t.showingLoginModal=!0,t.loginModal&&t.loginModal.destroy(),n.next=6,Craft.sendActionRequest("POST","users/login-modal",{data:{email:Craft.userEmail}});case 6:r=n.sent,a=r.data,s=$(a.html),o=document.documentElement.lang,(l=s.attr("lang"))===o&&l&&s.removeAttr("lang"),t.loginModal=new Garnish.Modal(s,{closeOtherModals:!1,hideOnEsc:!1,hideOnShadeClick:!1,shadeClass:"modal-shade dark blurred login-modal-shade",onFadeIn:function(){var n=i(e().mark((function n(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Craft.initUiElements(s),new Craft.LoginForm(s.find(".login-container"),{showPasskeyBtn:Craft.userHasPasskeys,onLogin:function(){t.loginModal.hide(),t.checkRemainingSessionTime()}}),e.next=4,Craft.appendHeadHtml(a.headHtml);case 4:return e.next=6,Craft.appendBodyHtml(a.bodyHtml);case 6:case"end":return e.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),onFadeOut:function(){var e;null===(e=t.loginModal)||void 0===e||e.destroy(),t.loginModal=null},onHide:function(){t.showingLoginModal=!1}});case 13:case"end":return n.stop()}}),n)})))()},hideLoginModal:function(t){this.loginModal&&(t?this.loginModal.quickHide():this.loginModal.hide(),this.loginModal.destroy(),this.loginModal=null)},logout:function(){$.get({url:Craft.getActionUrl("users/logout"),dataType:"json",success:function(){Craft.redirectTo("")}})},renewSession:(r=i(e().mark((function t(){var n=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.hideLogoutWarningModal(),this.renewingSession=!0,this.checkRemainingSessionTime(!0,(function(){n.renewingSession=!1}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)}),closeModal:function(){this.loginBtn.successEvent(),this.hideLoginModal(),this.checkRemainingSessionTime()}},{checkInterval:60,minSafeSessionTime:120})},341:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}Craft.IconPicker=Craft.BaseInputGenerator.extend({$container:null,$preview:null,$chooseBtn:null,$removeBtn:null,$input:null,modal:null,cancelToken:null,$searchInput:null,$iconListContainer:null,$iconList:null,defaultListHtml:null,get listLength(){return this.$iconList.find("li").length},init:function(t,e){var n=this;this.$container=$(t),this.setSettings(e,Craft.IconPicker.defaults),this.$container.data("iconpicker")&&(console.warn("Double-instantiating an icon picker on an element"),this.$container.data("iconpicker").destroy()),this.$container.data("iconpicker",this),this.$preview=this.$container.children(".icon-picker--icon"),this.$chooseBtn=this.$container.children(".icon-picker--choose-btn"),this.$removeBtn=this.$container.children(".icon-picker--remove-btn"),this.$input=this.$container.children("input"),this.addListener(this.$chooseBtn,"activate",(function(){n.showModal()})),this.addListener(this.$removeBtn,"activate",(function(){n.removeIcon()}))},showModal:function(){this.modal?this.modal.show():this.createModal()},createModal:function(){var t=this,n=$('<div class="modal icon-picker-modal"/>'),r=$('<div class="body"/>').appendTo(n),a=$('<div class="texticon"/>').appendTo(r);$('<span class="texticon-icon search icon" aria-hidden="true"/>').appendTo(a),this.$searchInput=Craft.ui.createTextInput({name:"search",class:"clearable",placeholder:Craft.t("app","Search")}).attr("aria-label",Craft.t("app","Search")).appendTo(a);var s=$("<button/>",{class:"clear-btn hidden",title:Craft.t("app","Clear search"),"aria-label":Craft.t("app","Clear search")}).appendTo(a);this.$iconListContainer=$('<div class="icon-picker-modal--list"/>').appendTo(r),this.$iconList=$('<ul tabindex="-1"/>').appendTo(this.$iconListContainer),this.updateLangAttribute(this.$iconList),$('<div class="spinner spinner-absolute"/>').appendTo(this.$iconListContainer),Craft.cp.announce(Craft.t("app","Loading"));var o=new Craft.FormObserver(a,(function(){t.updateIcons()}));this.addListener(this.$searchInput,"input,change",(function(){t.$searchInput.val()?s.removeClass("hidden"):s.addClass("hidden")})),this.addListener(s,"activate",(function(){t.$searchInput.val("").trigger("change"),o.checkForm()})),this.addListener(this.$iconList,"click",function(){var n=i(e().mark((function n(i){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("BUTTON"!==i.target.nodeName){e.next=4;break}r=$(i.target),e.next=7;break;case 4:if((r=$(i.target).closest("button")).length){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,t.selectIcon(r);case 9:t.$chooseBtn.focus();case 10:case"end":return e.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()),this.modal=new Garnish.Modal(n,{triggerElement:this.$chooseBtn}),this.updateIcons()},updateIcons:function(){var t=this;return i(e().mark((function n(){var i,r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadIcons();case 2:i=e.sent,t.$iconList.html(i),r="".concat(Craft.t("app","Loading complete")," - ").concat(Craft.t("app","{num, number} {num, plural, =1{result} other{results}}",{num:t.listLength})),Craft.cp.announce(r);case 6:case"end":return e.stop()}}),n)})))()},loadIcons:function(){var t=this;return i(e().mark((function n(){var i,r,a;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.cancelToken&&t.cancelToken.cancel(),""!==(i=t.$searchInput.val())||null===t.defaultListHtml){e.next=4;break}return e.abrupt("return",t.defaultListHtml);case 4:return t.$iconListContainer.addClass("loading"),Craft.cp.announce(Craft.t("app","Loading")),t.cancelToken=axios.CancelToken.source(),e.prev=7,e.next=10,Craft.sendActionRequest("POST","app/icon-picker-options",{data:{search:i,freeOnly:t.settings.freeOnly},cancelToken:t.cancelToken.token});case 10:return r=e.sent,a=r.data.listHtml,""===i&&(t.defaultListHtml=a),e.abrupt("return",a);case 14:return e.prev=14,t.$iconListContainer.removeClass("loading"),t.cancelToken=null,e.finish(14);case 18:case"end":return e.stop()}}),n,null,[[7,,14,18]])})))()},updateLangAttribute:function(t){document.documentElement.lang.startsWith("en")||t.attr("lang","en")},selectIcon:function(t){var n=this;return i(e().mark((function i(){var r,a,s;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=n.modal)||void 0===r||r.hide(),"string"!=typeof t){e.next=8;break}return a=t,e.next=5,Craft.ui.icon(t);case 5:s=e.sent.outerHTML,e.next=10;break;case 8:a=t.attr("title"),s=$(t).html();case 10:n.$preview.html(s).attr("title",a).attr("aria-label",a).attr("role","img"),n.updateLangAttribute(n.$preview),n.$input.val(a),n.$chooseBtn.children(".label").text(Craft.t("app","Change")),n.$removeBtn.removeClass("hidden"),n.$container.hasClass("small")&&n.$chooseBtn.addClass("hidden"),n.trigger("change",{iconName:a,iconHtml:s});case 17:case"end":return e.stop()}}),i)})))()},removeIcon:function(){this.$preview.html("").removeAttr("title").removeAttr("aria-label"),this.$input.val(""),this.$chooseBtn.children(".label").text(Craft.t("app","Choose")),this.$removeBtn.addClass("hidden"),this.$container.hasClass("small")?(this.$chooseBtn.removeClass("hidden"),this.$chooseBtn.focus()):this.$chooseBtn.focus(),this.trigger("change",{iconName:null,iconHtml:null})}},{defaults:{freeOnly:!1}})},555:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(i())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,e);var s=new(t.bind.apply(t,a));return n&&r(s,n.prototype),s}(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,t)},n(t)}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i=function(){return!!t})()}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function s(t,e,n){return(e=o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var l=function(n){function o(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return s(e=function(e,n,r){return n=a(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,i()?Reflect.construct(n,r||[],a(e).constructor):n.apply(e,r))}(this,o,[].concat(r)),"handleOpen",(function(){e.trigger.setAttribute("aria-expanded","true"),e.expanded=!0,e.target.dataset.state="expanded",e.dispatchEvent(new CustomEvent("open")),e.storeState("expanded")})),s(e,"handleClose",(function(){e.trigger.setAttribute("aria-expanded","false"),e.expanded=!1,e.target.dataset.state="collapsed",e.dispatchEvent(new CustomEvent("close")),e.storeState("collapsed")})),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}(o,n),function(t,n){return n&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o,[{key:"trigger",get:function(){return this.querySelector('button[type="button"]')}},{key:"target",get:function(){return document.getElementById(this.trigger.getAttribute("aria-controls"))}},{key:"connectedCallback",value:function(){this.trigger?this.target?(this.storageKey=this.getAttribute("storage-key")||"disclosure:".concat(this.trigger.getAttribute("aria-controls")),this.storageMode=this.getAttribute("storage-mode")||"localStorage",this.persist=this.hasAttribute("persist"),this.state=this.getInitialState(),this.trigger.getAttribute("aria-expanded")||this.trigger.setAttribute("aria-expanded","false"),this.trigger.addEventListener("click",this.toggle.bind(this)),"expanded"===this.state?this.open():this.close()):console.error("No target with id ".concat(this.trigger.getAttribute("aria-controls")," found for disclosure. "),this.trigger):console.error("craft-disclosure elements must include a button",this)}},{key:"disconnectedCallback",value:function(){this.open(),this.trigger.removeEventListener("click",this.toggle.bind(this))}},{key:"attributeChangedCallback",value:function(t,e,n){"state"===t&&("expanded"===n?this.handleOpen():this.handleClose())}},{key:"toggle",value:function(t){t.preventDefault(),this.expanded?this.close():this.open()}},{key:"getInitialState",value:function(){if(this.persist){if("localStorage"===this.storageMode)return localStorage.getItem(this.storageKey)||"expanded";if("cookies"===this.storageMode)return Craft.getCookie(this.storageKey)||"expanded"}return this.getAttribute("state")?this.getAttribute("state"):"expanded"}},{key:"storeState",value:function(t){"localStorage"===this.storageMode?localStorage.setItem(this.storageKey,t):"cookies"===this.storageMode&&Craft.setCookie(this.storageKey,t)}},{key:"open",value:function(){this.setAttribute("state","expanded")}},{key:"close",value:function(){this.setAttribute("state","collapsed")}}])}(n(HTMLElement));s(l,"observedAttributes",["state"]),customElements.define("craft-disclosure",l)},714:function(){function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==_typeof(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function asyncGeneratorStep(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){asyncGeneratorStep(a,i,r,s,o,"next",t)}function o(t){asyncGeneratorStep(a,i,r,s,o,"throw",t)}s(void 0)}))}}var _createElement;Craft.NestedElementManager=Garnish.Base.extend({$container:null,$btnContainer:null,elementType:null,$createBtn:null,$pasteBtn:null,$elements:null,elementSort:null,elementSelect:null,elementIndex:null,elementEditor:null,creatingElement:!1,init:function(t,e,n){var i=this;if(this.$container=$(t),this.elementType=e,this.setSettings(n,Craft.NestedElementManager.defaults),this.$container.data("nestedElementManager")&&(console.warn("Double-instantiating a nested element manager on an element"),this.$container.data("nestedElementManager").destroy()),this.$container.data("nestedElementManager",this),"cards"===this.settings.mode?this.$container.is(":has(.elements)")&&this.initCards():this.initElementIndex(),this.settings.canCreate){var r=Craft.ui.createButton({icon:"plus",label:this.settings.createButtonLabel,spinner:!0}).addClass("icon disabled");if("cards"===this.settings.mode&&r.addClass("dashed wrap"),this.addButton(r),Array.isArray(this.settings.createAttributes)){var a="menu-".concat(Math.floor(1e6*Math.random()));$("<div/>",{id:a,class:"menu menu--disclosure","data-with-search-input":this.settings.createAttributes.length>5?"true":null}).insertAfter(r),r.attr("aria-controls",a).attr("data-disclosure-trigger","true").addClass("menubtn").disclosureMenu();var s=r.data("disclosureMenu"),o={},l=[];this.settings.createAttributes.forEach((function(t){var e=t.group||Craft.t("app","General");o[e]||(o[e]=[],l.push(e)),o[e].push(t)}));var c=l.length>1;if(l.forEach((function(t){c&&(s.addHr(),s.addGroup(t,!1)),o[t].forEach((function(t){var e;s.addItem({icon:t.icon?$(t.icon)[0]:null,label:t.label,iconColor:t.color,onActivate:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.addClass("loading"),e.next=3,i.createElement(t.attributes);case 3:r.removeClass("loading");case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})}))})),c&&"cards"===this.settings.mode){var u,h=$('<div class="expandable-button--collapsed"/>').insertAfter(r);h.append(r);var d=$('<div class="expandable-button--expanded btngroup hidden"/>').insertAfter(h),f="btngroup-desc-".concat(Math.floor(1e5*Math.random())),p=$("<span>",{id:f,hidden:!0,html:Craft.t("app","Create {type}",{type:null!==(u=Craft.elementTypeNames[this.elementType][2])&&void 0!==u?u:Craft.t("app","element")})});d.append(p),l.forEach((function(t,e){var n=Craft.ui.createButton({icon:0===e?"plus":null,label:t,ariaDescribedBy:f,spinner:!0}).addClass("icon disabled dashed").appendTo(d),a="menu-".concat(Math.floor(1e6*Math.random()));$("<div/>",{id:a,class:"menu menu--disclosure"}).appendTo(d),n.attr("aria-controls",a).attr("data-disclosure-trigger","true").addClass("menubtn").disclosureMenu();var s=n.data("disclosureMenu");o[t].forEach((function(t){var e;s.addItem({icon:t.icon?$(t.icon)[0]:null,label:t.label,iconColor:t.color,onActivate:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.addClass("loading"),e.next=3,i.createElement(t.attributes);case 3:n.removeClass("loading");case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})})),r=r.add(n)})),h.expandableButton()}}else this.addListener(r,"activate",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r.addClass("loading"),t.next=4,i.createElement(i.settings.createAttributes);case 4:r.removeClass("loading");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());this.$createBtn=r,"cards"===this.settings.mode&&this.updateCreateBtn()}setTimeout((function(){i.elementEditor=i.$container.closest("form").data("elementEditor"),i.elementEditor&&i.elementEditor.on("update",(function(){i.settings.ownerId=i.elementEditor.getDraftElementId(i.settings.ownerId),i.elementIndex&&(i.elementIndex.settings.criteria[i.settings.ownerIdParam]=i.settings.ownerId)})),i.trigger("afterInit")}),100),Craft.cp.onCopyElements((function(t,e){i.updatePasteButton(t),i.$pasteBtn&&e&&i.$pasteBtn.find(".label").text(e)}))},addButton:function(t){"cards"===this.settings.mode?(this.$btnContainer||(this.$btnContainer=$btnContainer=$("<div/>",{class:"flex flex-inline"}).appendTo(this.$container)),t.appendTo(this.$btnContainer),this.updateCreateBtn()):t.appendTo(this.elementIndex.$toolbar)},initCards:function(){var t=this;this.$elements=this.$container.children(".elements"),this.$elements.length||(this.$elements=$("<ul/>",{class:"elements ".concat(this.settings.showInGrid?"card-grid":"cards")}).prependTo(this.$container),this.$container.children(".zilch").addClass("hidden")),this.settings.selectable&&(this.elementSelect=new Garnish.Select(this.$elements,this.$elements.children().children(".element"),{multi:!0,vertical:!this.settings.showInGrid,filter:function(t){return!$(t).closest("a[href],.toggle,.btn,[role=button],.move,craft-copy-attribute").length},checkboxMode:!0,waitForDoubleClicks:!0})),this.settings.sortable&&Craft.hasMousePointerEvents()&&(this.elementSort=new Garnish.DragSort({container:this.$elements,filter:this.settings.selectable?function(){return t.elementSort.$targetItem.children(".element").hasClass("sel")?t.elementSelect.getSelectedItems().parent("li"):t.elementSort.$targetItem}:null,handle:"> .element > .card-titlebar > .card-actions-container > .card-actions > .move-btn",ignoreHandleSelector:null,collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,onSortChange:function(){t.onSortChange(t.elementSort.$draggee)}}));var e,n=_createForOfIteratorHelper(this.$elements.children().toArray());try{for(n.s();!(e=n.n()).done;){var i=e.value;this.initElement($(i).children(".element"))}}catch(t){n.e(t)}finally{n.f()}},deinitCards:function(){var t;this.$elements&&(this.$elements.remove(),this.$elements=null,null===(t=this.elementSort)||void 0===t||t.destroy(),this.elementSort=null,this.$container.children(".zilch").removeClass("hidden"))},initElementIndex:function(){var t,e,n,i,r,a,s,o,l,c=this;this.elementIndex=Craft.createElementIndex(this.elementType,this.$container,Object.assign({context:"embedded-index",sortable:this.settings.sortable,prevalidate:this.settings.prevalidate},this.settings.indexSettings,{canDuplicateElements:function(t){return c.canCreate(t.length)},canDeleteElements:function(t){return c.canDelete(t.length)},onBeforeMoveElementsToPage:(l=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)}),onMoveElementsToPage:(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)}),onBeforeReorderElements:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}),onReorderElements:(a=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),onBeforeDuplicateElements:(r=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),onDuplicateElements:(i=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)}),onBeforeDeleteElements:(n=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)}),onDeleteElements:(e=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var e;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.markAsDirty();case 2:if(t.sent){t.next=4;break}null===(e=c.elementEditor)||void 0===e||e.checkForm(!0);case 4:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)}),onBeforeUpdateElements:function(){c.$createBtn&&c.$createBtn.addClass("disabled")},onCountResults:function(){c.updateCreateBtn()},onSortChange:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.onSortChange(e);case 2:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}))},markAsDirty:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.elementEditor&&t.settings.baseInputName){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,t.elementEditor.setFormValue(t.settings.baseInputName,"*");case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))()},getBaseActionData:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.markAsDirty();case 2:return e.abrupt("return",{ownerElementType:t.settings.ownerElementType,ownerId:t.settings.ownerId,ownerSiteId:t.settings.ownerSiteId,attribute:t.settings.attribute});case 3:case"end":return e.stop()}}),e)})))()},onSortChange:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.find(".element").toArray().map((function(t){return parseInt($(t).data("id"))})),n.prev=1,n.next=4,e.updateSortOrder(i);case 4:r=n.sent,Craft.cp.displayNotice(r.data.message),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),Craft.cp.displayError(null===n.t0||void 0===n.t0||null===(a=n.t0.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.message);case 11:return n.next=13,e.markAsDirty();case 13:if(n.sent){n.next=15;break}Craft.Preview.refresh();case 15:case"end":return n.stop()}}),n,null,[[1,8]])})))()},updateSortOrder:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(t=Array.isArray(t)?t:[t]).map((function(t){return parseInt(t)})),i=e.getElementIds(),n.t0=Object,n.next=6,e.getBaseActionData();case 6:return n.t1=n.sent,n.t2={elementIds:t,offset:e.getBaseElementOffset()+i.indexOf(t[0])},r=n.t0.assign.call(n.t0,n.t1,n.t2),n.next=11,Craft.sendActionRequest("POST","nested-elements/reorder",{data:r});case 11:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))()},updateCreateBtn:function(){this.$createBtn&&(this.canCreate()?this.$createBtn.removeClass("disabled"):this.$createBtn.addClass("disabled"),this.updatePasteButton())},updatePasteButton:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=e||Craft.cp.getCopiedElements(),this.canPaste(e)?this.$pasteBtn?this.$pasteBtn.removeClass("hidden"):(this.$pasteBtn=Craft.ui.createPasteButton(),this.addButton(this.$pasteBtn),this.addListener(this.$pasteBtn,"activate","pasteElements")):null===(t=this.$pasteBtn)||void 0===t||t.addClass("hidden")},canCreate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.settings.canCreate||0===t)return!1;if(!this.settings.maxElements)return!0;var e=this.getTotalElements();return null!==e&&e+t<=this.settings.maxElements},canDelete:function(){return!this.settings.minElements||null!==this.getTotalElements()},canPaste:function canPaste(elementInfo){if(!this.settings.canPaste||!this.canCreate(elementInfo.length))return!1;var _iterator2=_createForOfIteratorHelper(elementInfo),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var e=_step2.value;if(e.type!==this.elementType)return!1}}catch(t){_iterator2.e(t)}finally{_iterator2.f()}return"function"==typeof this.settings.canPaste?this.settings.canPaste(elementInfo):"string"!=typeof this.settings.canPaste||eval(this.settings.canPaste)(elementInfo)},getElementIds:function(){return("cards"===this.settings.mode?this.$elements.find("> li > .element").toArray():this.elementIndex.view.getAllElements().toArray().map((function(t){return t.querySelector(".element")}))).map((function(t){return t.getAttribute("data-id")})).filter((function(t){return t})).map((function(t){return parseInt(t)}))},getTotalElements:function(){return"cards"===this.settings.mode?this.$elements?this.$elements.children().length:0:this.elementIndex.isIndexBusy?null:this.elementIndex.totalUnfilteredResults},getBaseElementOffset:function(){return"cards"===this.settings.mode?0:this.elementIndex.settings.batchSize*(this.elementIndex.page-1)},createElement:(_createElement=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){var n,i,r,a,s,o,l=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.creatingElement){t.next=2;break}return t.abrupt("return");case 2:return this.creatingElement=!0,Craft.cp.announce(Craft.t("app","Loading")),t.prev=4,t.next=7,this.markAsDirty();case 7:return e=Object.assign({elementType:this.elementType,ownerId:this.settings.ownerId,fieldId:this.settings.fieldId,siteId:this.settings.ownerSiteId},e),t.next=10,Craft.sendActionRequest("POST","elements/create",{data:e});case 10:n=t.sent,i=n.data,r=Craft.createElementEditor(this.elementType,{siteId:i.element.siteId,elementId:i.element.id,draftId:i.element.draftId,params:{fresh:1}}),a=!1,s=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=12;break}if(a=!0,"cards"!==l.settings.mode){t.next=8;break}return t.next=5,l.addElementCard(e);case 5:t.sent,t.next=10;break;case 8:l.elementIndex.clearSearch(),l.elementIndex.updateElements();case 10:return t.next=12,l.markAsDirty();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.on("load",(function(){r.elementEditor.once("afterSaveDraft",(function(t){s(i.element)}))})),r.on("submit",_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s(i.element);case 2:case"end":return t.stop()}}),t)})))),r.on("close",(function(){var t;l.$createBtn&&l.$createBtn.filter(":visible:first").focus(),null===(t=l.elementEditor)||void 0===t||t.checkForm(!0)})),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(4),Craft.cp.displayError(null===t.t0||void 0===t.t0||null===(o=t.t0.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message);case 23:return t.prev=23,this.creatingElement=!1,Craft.cp.announce(Craft.t("app","Loading complete")),t.finish(23);case 27:case"end":return t.stop()}}),t,this,[[4,20,23,27]])}))),function(t){return _createElement.apply(this,arguments)}),duplicateElement:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a,s,o,l,c;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=$(t),Craft.cp.announce(Craft.t("app","Loading")),n.next=4,e.markAsDirty();case 4:return n.prev=4,o=r.data("id"),n.next=8,Craft.sendActionRequest("POST","elements/duplicate",{data:{elementType:e.elementType,ownerId:e.settings.ownerId,siteId:e.settings.ownerSiteId,elementId:(null===(s=e.elementEditor)||void 0===s?void 0:s.getDraftElementId(o))||o}});case 8:l=n.sent,a=l.data,n.next=15;break;case 12:n.prev=12,n.t0=n.catch(4),Craft.cp.displayError(null===n.t0||void 0===n.t0||null===(c=n.t0.response)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.message);case 15:return n.next=17,e.addElementCard(a.element);case 17:return n.sent.parent().insertAfter(r.parent()),n.next=21,e.updateSortOrder(a.element.id);case 21:null===(i=e.elementEditor)||void 0===i||i.checkForm(!0);case 22:case"end":return n.stop()}}),n,null,[[4,12]])})))()},duplicateElements:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t instanceof jQuery&&(t=t.toArray()),i=_createForOfIteratorHelper(t),n.prev=2,i.s();case 4:if((r=i.n()).done){n.next=10;break}return a=r.value,n.next=8,e.duplicateElement(a);case 8:n.next=4;break;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),i.e(n.t0);case 15:return n.prev=15,i.f(),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[2,12,15,18]])})))()},pasteElements:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Craft.cp.announce(Craft.t("app","Loading")),t.$pasteBtn.addClass("loading"),e.prev=2,e.next=5,t.markAsDirty();case 5:return e.next=7,Craft.cp.pasteElements(Object.assign({primaryOwnerId:t.settings.ownerId,ownerId:t.settings.ownerId,fieldId:t.settings.fieldId,siteId:t.settings.ownerSiteId},t.settings.pasteAttributes||{}));case 7:if((i=e.sent).length){e.next=10;break}return e.abrupt("return");case 10:if("cards"!==t.settings.mode){e.next=19;break}return e.next=13,t.addElementCards(i,!1);case 13:return r=e.sent,e.next=16,t.updateSortOrder(i[0].id);case 16:Garnish.firstFocusableElement(r).focus(),e.next=22;break;case 19:return t.elementIndex.clearSearch(),e.next=22,t.elementIndex.updateElements();case 22:return e.prev=22,t.$pasteBtn.removeClass("loading"),e.finish(22);case 25:null===(n=t.elementEditor)||void 0===n||n.checkForm(!0);case 26:case"end":return e.stop()}}),e,null,[[2,,22,25]])})))()},initElement:function(t){var e=this;setTimeout((function(){if(e.settings.selectable&&e.elementSelect.addItems(t),Garnish.hasAttr(t,"data-editable")){var n=t.find(".edit-btn");n.length&&(n.off("activate"),e.addListener(n,"activate",(function(i){n.focus();var r=t.data("cpUrl");r&&Garnish.isCtrlKeyPressed(i.originalEvent)?window.open(r):e.createElementEditor(t)}))),e.addListener(t,"dblclick,taphold",(function(n){$(n.target).closest("a[href],button,[role=button]").length||e.createElementEditor(t)}))}var i,r,a,s,o,l=t.find(".action-btn").removeClass("hidden").disclosureMenu().data("disclosureMenu");if(l){var c,u,h,d=l.$container,f=l.getFirstDestructiveGroup(),p=t.parent(),g=function(){return p.prev("li")},m=function(){return p.next("li")};if(e.settings.sortable){var v;null===(v=e.elementSort)||void 0===v||v.addItems(p);var y=l.addGroup(null,!0,f);c=l.addItem({icon:(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon(e.settings.showInGrid?"ltr"===Craft.orientation?"arrow-left":"arrow-right":"arrow-up");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)}),label:e.settings.showInGrid?Craft.t("app","Move forward"):Craft.t("app","Move up"),onActivate:function(){var t=g();t.length&&(p.insertBefore(t),e.onSortChange(p))}},y),u=l.addItem({icon:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon(e.settings.showInGrid?"ltr"===Craft.orientation?"arrow-right":"arrow-left":"arrow-down");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}),label:e.settings.showInGrid?Craft.t("app","Move backward"):Craft.t("app","Move down"),onActivate:function(){var t=m();t.length&&(p.insertAfter(t),e.onSortChange(p))}},y)}var b=Garnish.hasAttr(t,"data-duplicatable"),w=Garnish.hasAttr(t,"data-copyable");if(b||w){var C=l.addGroup(null,!0,f);if(b&&(h=l.addItem({icon:(a=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("clone");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),label:Craft.t("app","Duplicate"),onActivate:function(){e.duplicateElement(t)}},C)),w){var _=d.find("[data-copy-action]");_.length&&l.removeItem(_[0]),l.addItem({icon:(r=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("clone-dashed");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),iconColor:"fuchsia",label:Craft.t("app","Copy"),onActivate:function(){Craft.cp.copyElements(t)}},C)}}if(Garnish.hasAttr(t,"data-deletable")){var S=l.addGroup();l.addItem({icon:(i=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("trash");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)}),label:e.settings.deleteLabel||Craft.t("app","Delete"),destructive:!0,onActivate:function(){confirm(e.settings.deleteConfirmationMessage)&&e.deleteElement(t)}},S)}l.on("show",(function(){c&&l.toggleItem(c,g().length),u&&l.toggleItem(u,m().length),h&&l.toggleItem(h,e.canCreate())}))}}),1)},createElementEditor:function(t){var e,n,i=this,r=Craft.createElementEditor(this.elementType,t,{ownerId:null===(e=this.elementEditor)||void 0===e?void 0:e.getDraftElementId(t.data("ownerId")),onLoad:function(){r.elementEditor.on("update",(function(){Craft.Preview.refresh()}))},onBeforeSubmit:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i.elementEditor||!Garnish.hasAttr(t,"data-owner-is-canonical")||Garnish.hasAttr(t,"data-is-unpublished-draft")||i.elementEditor.settings.isUnpublishedDraft){e.next=6;break}return e.next=3,r.elementEditor.checkForm(!0,!0);case 3:return e.next=5,i.markAsDirty();case 5:i.elementEditor.settings.draftId&&r.elementEditor.settings.draftId&&(r.elementEditor.settings.saveParams||(r.elementEditor.settings.saveParams={}),r.elementEditor.settings.saveParams.action="elements/save-nested-element-for-derivative",r.elementEditor.settings.saveParams.newOwnerId=i.settings.ownerId);case 6:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)}),onSubmit:function(e){e.data.id!=t.data("id")&&(t.attr("data-id",e.data.id).data("id",e.data.id).data("owner-id",e.data.ownerId),Craft.refreshElementInstances(e.data.id))}})},deleteElement:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a,s,o,l;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=$(t),n.t0=Object,n.next=4,e.getBaseActionData();case 4:return n.t1=n.sent,n.t2={elementId:i.data("id")},r=n.t0.assign.call(n.t0,n.t1,n.t2),n.prev=7,n.next=10,Craft.sendActionRequest("POST","nested-elements/delete",{data:r});case 10:a=n.sent,Craft.cp.displayNotice(a.data.message),n.next=18;break;case 14:throw n.prev=14,n.t3=n.catch(7),Craft.cp.displayError(null===n.t3||void 0===n.t3||null===(s=n.t3.response)||void 0===s||null===(s=s.data)||void 0===s?void 0:s.message),n.t3;case 18:return e.settings.sortable&&(null===(o=e.elementSort)||void 0===o||o.removeItems(i)),i.parent().remove(),0===e.$elements.children().length&&e.deinitCards(),e.$createBtn&&(e.updateCreateBtn(),e.canCreate()&&e.$createBtn.filter(":visible:first").focus()),n.next=24,e.markAsDirty();case 24:if(n.sent){n.next=26;break}null===(l=e.elementEditor)||void 0===l||l.checkForm(!0);case 26:case"end":return n.stop()}}),n,null,[[7,14]])})))()},deleteElements:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t instanceof jQuery&&(t=t.toArray()),i=_createForOfIteratorHelper(t),n.prev=2,i.s();case 4:if((r=i.n()).done){n.next=10;break}return a=r.value,n.next=8,e.deleteElement(a);case 8:n.next=4;break;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),i.e(n.t0);case 15:return n.prev=15,i.f(),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[2,12,15,18]])})))()},addElementCard:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.addElementCards([t]);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},addElementCards:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var i,r,a,s,o,l,c,u,h,d,f,p,g,m;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.creatingElement){n.next=2;break}return n.abrupt("return",null);case 2:return Craft.cp.announce(Craft.t("app","Loading")),n.prev=3,n.next=6,Craft.sendActionRequest("POST","app/render-elements",{data:{elements:t.map((function(t){return{type:e.elementType,id:t.id,siteId:t.siteId,instances:[{context:"field",ui:"card",sortable:e.settings.sortable,selectable:e.settings.selectable,showActionMenu:!0,hyperlink:!1}]}}))}});case 6:r=n.sent,i=r.data,n.next=14;break;case 10:throw n.prev=10,n.t0=n.catch(3),Craft.cp.displayError(null===n.t0||void 0===n.t0||null===(a=n.t0.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.message),null!==(s=null===n.t0||void 0===n.t0||null===(o=n.t0.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message)&&void 0!==s?s:n.t0;case 14:e.$elements||e.initCards(),l=$(),c=_createForOfIteratorHelper(t);try{for(c.s();!(u=c.n()).done;){h=u.value,d=_createForOfIteratorHelper(i.elements[h.id]||[]);try{for(d.s();!(f=d.n()).done;)p=f.value,g=$("<li/>").appendTo(e.$elements),m=$(p).appendTo(g),l=l.add(m),e.initElement(m),Craft.cp.elementThumbLoader.load(m)}catch(t){d.e(t)}finally{d.f()}}}catch(t){c.e(t)}finally{c.f()}return n.next=20,Craft.appendHeadHtml(i.headHtml);case 20:return n.next=22,Craft.appendBodyHtml(i.bodyHtml);case 22:return e.updateCreateBtn(),n.abrupt("return",l);case 24:case"end":return n.stop()}}),n,null,[[3,10]])})))()},destroy:function(){this.$container.removeData("nestedElementManager"),this.base()}},{ownerId:null,defaults:{mode:"cards",showInGrid:!1,ownerElementType:null,ownerId:null,ownerSiteId:null,attribute:null,selectable:!1,sortable:!1,indexSettings:{},canCreate:!1,canPaste:!1,minElements:null,maxElements:null,createButtonLabel:Craft.t("app","Create"),ownerIdParam:null,createAttributes:null,pasteAttributes:null,fieldId:null,fieldHandle:null,baseInputName:null,deleteLabel:null,deleteConfirmationMessage:null,prevalidate:!1}})},743:function(){Craft.HandleGenerator=Craft.BaseInputGenerator.extend({generateTargetValue:function(t){var e=t.replace(/<(.*?)>/g,"");e=(e=e.replace(/['"‘’“”ʻ\[\]\(\)\{\}:]/g,"")).toLowerCase(),e=Craft.asciiString(e),this.settings.allowNonAlphaStart||(e=e.replace(/^[^a-z]+/,""));var n=Craft.filterArray(e.split(/[^a-z0-9]+/));if(e="","snake"===Craft.handleCasing)return n.join("_");for(var i=0;i<n.length;i++)"pascal"!==Craft.handleCasing&&0===i?e+=n[i]:e+=n[i].charAt(0).toUpperCase()+n[i].substring(1);return e}})},838:function(){Craft.ThumbsElementIndexView=Craft.BaseElementIndexView.extend({getElementContainer:function(){return this.$container.children("ul")}})},876:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(i())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,e);var s=new(t.bind.apply(t,a));return n&&r(s,n.prototype),s}(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,t)},n(t)}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i=function(){return!!t})()}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function s(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var o=function(n){function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),function(e,n,r){return n=a(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,i()?Reflect.construct(n,r||[],a(e).constructor):n.apply(e,r))}(this,s,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}(s,n),function(t,n){return n&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(s,[{key:"hidden",get:function(){return this.getAttribute("hidden")}},{key:"hasOverflow",get:function(){var t,e;return(null===(t=this.content)||void 0===t?void 0:t.scrollWidth)>(null===(e=this.scroller)||void 0===e?void 0:e.clientWidth)}},{key:"connectedCallback",value:function(){this.ignoreScrollEvent=!1,this.animation=!1,this.scroller=document.querySelector(this.getAttribute("scroller")),this.content=document.querySelector(this.getAttribute("content")),this.scroller&&this.content&&(this.proxy=document.createElement("div"),this.proxy.style.height="1px",this.proxy.style.width=this.content.getBoundingClientRect().width+"px",this.appendChild(this.proxy),this.addEventListener("scroll",this.syncScroll(this.scroller,this)),this.scroller.addEventListener("scroll",this.syncScroll(this,this.scroller)),window.addEventListener("resize",this.handleResize.bind(this)),Object.assign(this.style,{display:this.hasOverflow?"block":"none",overflowX:"scroll"}))}},{key:"attributeChangedCallback",value:function(t,e,n){"hidden"===t&&(this.style.display=n?"none":"block")}},{key:"disconnectedCallback",value:function(){var t,e,n;null===(t=this.proxy)||void 0===t||t.remove(),null===(e=this.scroller)||void 0===e||e.removeEventListener("scroll",this.syncScroll(this.scroller,this)),null===(n=this.scroller)||void 0===n||n.removeEventListener("scroll",this.syncScroll(this,this.scroller)),window.removeEventListener("resize",this.handleResize.bind(this))}},{key:"handleResize",value:function(){this.proxy.style.width=this.content.getBoundingClientRect().width+"px",this.hasOverflow?this.removeAttribute("hidden"):this.setAttribute("hidden","true")}},{key:"syncScroll",value:function(t,e){var n=this;return function(){if(n.ignoreScrollEvent)return!1;n.animation&&cancelAnimationFrame(n.animation),n.animation=requestAnimationFrame((function(){n.ignoreScrollEvent=!0,t.scrollLeft=e.scrollLeft,n.ignoreScrollEvent=!1}))}}}])}(n(HTMLElement));!function(t,e,n){(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(o,"observedAttributes",["hidden"]),customElements.define("craft-proxy-scrollbar",o)},991:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}Craft.AdminTable=Garnish.Base.extend({settings:null,totalItems:null,sorter:null,$noItems:null,$table:null,$tbody:null,$deleteBtns:null,init:function(t){var e=this;this.setSettings(t,Craft.AdminTable.defaults),this.settings.allowDeleteAll||(this.settings.minItems=1),this.$noItems=$(this.settings.noItemsSelector),this.$table=$(this.settings.tableSelector),this.$tbody=this.$table.children("tbody"),this.totalItems=this.$tbody.children().length,this.settings.sortable&&Craft.hasMousePointerEvents()&&(this.sorter=new Craft.DataTableSorter(this.$table,{onSortChange:this.reorderItems.bind(this)})),this.$deleteBtns=this.$table.find(".delete:not(.disabled)"),this.addListener(this.$deleteBtns,"click","handleDeleteBtnClick"),this.addListener(this.$deleteBtns,"keydown",(function(t){t.keyCode!==Garnish.SPACE_KEY&&t.keyCode!==Garnish.RETURN_KEY||(t.preventDefault(),e.handleDeleteBtnClick(t))})),this.$tbody.children("tr").each((function(t,n){e.initRow(n)})),this.updateUI()},initRow:function(t){return new Craft.AdminTable.Row(this,t)},addRow:function(t){if(!(this.settings.maxItems&&this.totalItems>=this.settings.maxItems)){var e,n=$(t).appendTo(this.$tbody),i=n.find(".delete");this.settings.sortable&&Craft.hasMousePointerEvents()&&(null===(e=this.sorter)||void 0===e||e.addItems(n)),this.$deleteBtns=this.$deleteBtns.add(i),this.addListener(i,"click","handleDeleteBtnClick"),this.totalItems++,this.updateUI()}},reorderItems:function(){var t=this;if(this.settings.sortable){var e=this.getRowOrder(),n={ids:JSON.stringify(e)};Craft.sendActionRequest("POST",this.settings.reorderAction,{data:n}).then((function(n){t.onReorderItems(e),Craft.cp.displaySuccess(Craft.t("app",t.settings.reorderSuccessMessage))})).catch((function(e){e.response,Craft.cp.displayError(Craft.t("app",t.settings.reorderFailMessage))}))}},getRowOrder:function(){var t=this,e=[];return this.$tbody.children("tr").each((function(n,i){var r=$(i).attr(t.settings.idAttribute);e.push(r)})),e},handleDeleteBtnClick:function(t){if(!(this.settings.minItems&&this.totalItems<=this.settings.minItems)){var e=$(t.target).closest("tr");this.confirmDeleteItem(e)&&this.deleteItem(e)}},confirmDeleteItem:function(t){if(!this.settings.confirmDeleteMessage)return!0;var e=this.getItemName(t);return confirm(Craft.t("app",this.settings.confirmDeleteMessage,{name:e}))},deleteItem:function(t){var e=this,n={id:this.getItemId(t)};Craft.sendActionRequest("POST",this.settings.deleteAction,{data:n}).then((function(n){return e.handleDeleteItemSuccess(n.data,t)})).catch((function(n){var i=n.response;return e.handleDeleteItemFailure(i.data,t)}))},handleDeleteItemFailure:function(t,e){this.getItemId(e);var n=this.getItemName(e);Craft.cp.displayError(Craft.t("app",this.settings.deleteFailMessage,{name:n}))},handleDeleteItemSuccess:function(t,e){var n=this.getItemId(e),i=this.getItemName(e);this.sorter&&this.sorter.removeItems(e),e.remove(),this.totalItems--,this.updateUI(),this.onDeleteItem(n),this.settings.deleteSuccessMessage&&Craft.cp.displaySuccess(Craft.t("app",this.settings.deleteSuccessMessage,{name:i}))},onReorderItems:function(t){this.settings.onReorderItems(t)},onDeleteItem:function(t){this.settings.onDeleteItem(t)},getItemId:function(t){return t.attr(this.settings.idAttribute)},getItemName:function(t){return Craft.escapeHtml(t.attr(this.settings.nameAttribute))},updateUI:function(){if(0===this.totalItems?(this.$table.hide(),this.$noItems.removeClass("hidden")):(this.$table.show(),this.$noItems.addClass("hidden")),this.settings.sortable)if(Craft.hasMousePointerEvents()){var t=this.$table.find(".move");1===this.totalItems?t.addClass("disabled"):t.removeClass("disabled")}else this.$table.find(".move").hide();this.settings.minItems&&this.totalItems<=this.settings.minItems?this.$deleteBtns.addClass("disabled"):this.$deleteBtns.removeClass("disabled"),this.settings.newItemBtnSelector&&(this.settings.maxItems&&this.totalItems>=this.settings.maxItems?$(this.settings.newItemBtnSelector).addClass("hidden"):$(this.settings.newItemBtnSelector).removeClass("hidden"))}},{defaults:{tableSelector:null,noItemsSelector:null,newItemBtnSelector:null,idAttribute:"data-id",nameAttribute:"data-name",sortable:!1,allowDeleteAll:!0,minItems:0,maxItems:null,reorderAction:null,deleteAction:null,reorderSuccessMessage:Craft.t("app","New order saved."),reorderFailMessage:Craft.t("app","Couldn’t save new order."),confirmDeleteMessage:Craft.t("app","Are you sure you want to delete “{name}”?"),deleteSuccessMessage:Craft.t("app","“{name}” deleted."),deleteFailMessage:Craft.t("app","Couldn’t delete “{name}”."),onReorderItems:$.noop,onDeleteItem:$.noop}}),Craft.AdminTable.Row=Garnish.Base.extend({table:null,$row:null,$moveHandle:null,$actionMenuBtn:null,$actionMenu:null,actionDisclosure:null,moveUpBtn:null,moveDownBtn:null,init:function(t,e){this.table=t,this.$row=$(e),this.initSortActions()},initSortActions:function(){var t=this;if(this.table.settings.sortable){this.$row.find(".delete").parent("td");var n,r,a="menu-"+Math.floor(1e9*Math.random()),s=this.$row.find(".actions-container");s.length>0&&(this.$actionMenuBtn=$("<button/>",{class:"btn action-btn","aria-controls":a,"aria-label":Craft.t("app","Actions"),"data-disclosure-trigger":"","data-icon":"ellipsis"}).appendTo(s),this.$actionMenu=$("<div/>",{id:a,class:"menu menu--disclosure"}).appendTo(s),this.actionDisclosure=new Garnish.DisclosureMenu(this.$actionMenuBtn),this.moveUpBtn=this.actionDisclosure.addItem({icon:(r=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-up");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),label:Craft.t("app","Move up"),onActivate:function(){t.moveUp()}}),this.moveDownBtn=this.actionDisclosure.addItem({icon:(n=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-down");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)}),label:Craft.t("app","Move down"),onActivate:function(){t.moveDown()}}),this.actionDisclosure.on("show",(function(){t.getPrevItem()?t.actionDisclosure.showItem(t.moveUpBtn):t.actionDisclosure.hideItem(t.moveUpBtn),t.getNextItem()?t.actionDisclosure.showItem(t.moveDownBtn):t.actionDisclosure.hideItem(t.moveDownBtn)})))}},moveUp:function(){var t=this.getPrevItem();t&&(this.$row.insertBefore(t),this.$row.trigger("movedUp"),this.table.reorderItems())},moveDown:function(){var t=this.getNextItem();t&&(this.$row.insertAfter(t),this.$row.trigger("movedDown"),this.table.reorderItems())},getPrevItem:function(){var t=this.$row.prevAll("tr:has(.actions-container):first");return t.length?t:null},getNextItem:function(){var t=this.$row.nextAll("tr:has(.actions-container):first");return t.length?t:null}})},1255:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=n(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function n(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function r(){"use strict";r=function(){return n};var e,n={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==i&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,s=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function a(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){a(s,i,r,o,l,"next",t)}function l(t){a(s,i,r,o,l,"throw",t)}o(void 0)}))}}var o;Craft.AssetMover=Garnish.Base.extend({undoMovedAssets:null,undoMovedFolders:null,conflictCount:0,init:function(){this.undoMovedAssets={assetIds:[],targetFolderId:null},this.undoMovedFolders={folderIds:[],targetFolderId:null}},getMoveParams:(o=s(r().mark((function t(e,n){var i,a,s,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=!0,a=!1,t.prev=2,t.next=5,Craft.sendActionRequest("POST","assets/move-info",{data:{folderIds:e,assetIds:n}});case 5:s=t.sent,t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(2),Craft.cp.displayError(null===t.t0||void 0===t.t0||null===(o=t.t0.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.message),t.abrupt("return");case 12:return(s.data.count>Craft.AssetMover.countLimit||s.data.totalSize>Craft.AssetMover.sizeLimit)&&(i=confirm(Craft.t("app","Are you sure you want to move the selected items?")),a=!0),t.abrupt("return",{proceed:i,confirmed:a});case 14:case"end":return t.stop()}}),t,null,[[2,8]])}))),function(t,e){return o.apply(this,arguments)}),successNotice:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=null,o=null;i&&0===this.conflictCount&&(o=Craft.ui.createButton({label:Craft.t("app","Undo"),spinner:!0})),!t.confirmed&&i&&(a={details:o});var l,c=Craft.cp.displayNotice(e,a);i&&(null===(l=o)||void 0===l||l.on("activate",s(r().mark((function e(){var i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm(Craft.t("app","Are you sure you want to undo the move?"))){e.next=9;break}return e.next=3,n.moveFolders(n.undoMovedFolders.folderIds,n.undoMovedFolders.targetFolderId);case 3:return i=e.sent,e.next=6,n.moveAssets(n.undoMovedAssets.assetIds,n.undoMovedAssets.targetFolderId);case 6:a=e.sent,i+a&&(n.successNotice(t,Craft.t("app","Move reverted."),!1),Craft.elementIndex.updateElements(!0));case 9:c.$closeBtn.trigger("click");case 10:case"end":return e.stop()}}),e)})))))},moveAssets:function(t,e,n){var i=t.map((function(t){return{for:"asset",action:"assets/move-asset",params:{assetId:t,folderId:e,initialFolderId:n}}}));return this._batchMoveRequests(i,{conflictChoices:[{value:"keepBoth",title:Craft.t("app","Keep both")},{value:"replace",title:Craft.t("app","Replace it")}],handleConflictChoice:function(t){var e={folderId:t.request.params.folderId,assetId:t.assetId,initialFolderId:t.request.params.initialFolderId};switch(t.choice){case"replace":e.force=!0;break;case"keepBoth":e.filename=t.suggestedFilename}return{action:"assets/move-asset",params:e}}})},moveFolders:function(t,e,r){var a=this;return new Promise((function(s,o){var l=[],c=[],u=[],h=t.map((function(t){return{for:"folder",action:"assets/move-folder",params:{folderId:t,parentId:e,initialParentId:r},onSuccess:function(e){var r;e.transferList.length&&(e.transferList.forEach((function(e){return e.oldFolderId=t})),l.push.apply(l,function(t){if(Array.isArray(t))return i(t)}(r=e.transferList)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||n(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),c.push(t)}}}));a._batchMoveRequests(h,{conflictChoices:[{value:"replace",title:Craft.t("app","Replace the folder (all existing files will be deleted)")},{value:"merge",title:Craft.t("app","Merge the folder (any conflicting files will be replaced)")}],handleConflictChoice:function(t){var e={folderId:t.folderId,parentId:t.parentId,initialParentId:t.request.params.initialParentId};switch(t.choice){case"replace":e.force=!0;break;case"merge":e.merge=!0}return{action:"assets/move-folder",params:e}}}).then((function(t){a._processTransferList(l).then((function(e){e.forEach((function(t){var e;if(null!==(e=t.error)&&void 0!==e&&e.length){var n=t.request.params.oldFolderId;u.includes(n)||u.push(n),c.includes(n)&&(c=c.filter((function(t){return t!==n})))}})),t-=u.length,a._deleteFolders(c).then((function(){s(t)}))}))})).catch(o)}))},_processTransferList:function(t){return this._batchRequests(t.map((function(t){return{action:"assets/move-asset",params:t}})))},_deleteFolders:function(t){return this._batchRequests(t.map((function(t){return{action:"assets/delete-folder",params:{folderId:t}}})))},_batchMoveRequests:function(t,n){var i=this;return new Promise((function(r){var a=0;i._batchRequests(t).then((function(t){Craft.elementIndex.promptHandler.resetPrompts();var s,o=e(t);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.success&&(l.newFolderId?(i.undoMovedFolders.folderIds.push(l.newFolderId),null===i.undoMovedFolders.targetFolderId&&(i.undoMovedFolders.targetFolderId=l.request.params.initialParentId)):(i.undoMovedAssets.assetIds.push(l.request.params.assetId),null===i.undoMovedAssets.targetFolderId&&(i.undoMovedAssets.targetFolderId=l.request.params.initialFolderId)),a++),l.conflict&&(i.conflictCount++,Craft.elementIndex.promptHandler.addPrompt(Object.assign({},l,{prompt:{message:l.conflict,choices:n.conflictChoices}}))),l.error&&Craft.cp.displayError(l.error)}}catch(t){o.e(t)}finally{o.f()}Craft.elementIndex.promptHandler.getPromptCount()?Craft.elementIndex.promptHandler.showBatchPrompts((function(t){Craft.elementIndex.promptHandler.resetPrompts();var s,o=[],l=e(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;if("cancel"!==c.choice&&n.handleConflictChoice){var u=n.handleConflictChoice(c);c.request&&c.request.onSuccess&&(u.onSuccess=c.request.onSuccess),o.push(u)}}}catch(t){l.e(t)}finally{l.f()}i._batchMoveRequests(o,n).then((function(t){r(a+t)}))})):r(a)}))}))},_batchRequests:function(t){return new Promise((function(n){if(t.length){Craft.elementIndex.setIndexBusy(!1),Craft.elementIndex._positionProgressBar(),Craft.elementIndex.progressBar.resetProgressBar(),Craft.elementIndex.progressBar.setItemCount(t.length),Craft.elementIndex.progressBar.showProgressBar();var i,r=[],a=t.length,s=e(t);try{var o=function(){var t=i.value;Craft.sendActionRequest("POST",t.action,{data:t.params}).then((function(e){r.push(Object.assign({success:!0},e.data,{request:t})),t.onSuccess&&t.onSuccess(e.data)})).catch((function(e){e.response&&e.response.data&&r.push(Object.assign({success:!1},e.response.data,{request:t}))})).finally((function(){0==--a?(Craft.elementIndex.setIndexAvailable(),Craft.elementIndex.progressBar.hideProgressBar(),Craft.cp.runQueue(),n(r)):(Craft.elementIndex.progressBar.incrementProcessedItemCount(1),Craft.elementIndex.progressBar.updateProgressBar())}))};for(s.s();!(i=s.n()).done;)o()}catch(t){s.e(t)}finally{s.f()}}else n([])}))}},{countLimit:50,sizeLimit:5e7})},1448:function(){Craft.AssetSelectorModal=Craft.BaseElementSelectorModal.extend({$selectTransformBtn:null,_selectedTransform:null,init:function(t,e){e=$.extend({},Craft.AssetSelectorModal.defaults,e),this.base(t,e),e.transforms.length&&this.createSelectTransformButton(e.transforms)},createSelectTransformButton:function(t){if(t&&t.length){var e=$('<div class="btngroup"/>').appendTo(this.$primaryButtons);this.$selectBtn.appendTo(e),this.$selectTransformBtn=$("<button/>",{type:"button",class:"btn menubtn disabled",text:Craft.t("app","Select transform")}).appendTo(e);for(var n=$('<div class="menu" data-align="right"></div>').insertAfter(this.$selectTransformBtn),i=$("<ul></ul>").appendTo(n),r=0;r<t.length;r++)$('<li><a data-transform="'+t[r].handle+'">'+t[r].name+"</a></li>").appendTo(i);var a=new Garnish.MenuBtn(this.$selectTransformBtn,{onOptionSelect:this.onSelectTransform.bind(this)});a.disable(),this.$selectTransformBtn.data("menuButton",a)}},onSelectionChange:function(t){var e=!1;this.elementIndex.getSelectedElements().length&&this.settings.transforms.length&&(e=!0);var n=null;this.$selectTransformBtn&&(n=this.$selectTransformBtn.data("menuButton")),e?(n&&n.enable(),this.$selectTransformBtn.removeClass("disabled")):this.$selectTransformBtn&&(n&&n.disable(),this.$selectTransformBtn.addClass("disabled")),this.base()},onSelectTransform:function(t){var e=$(t).data("transform");this.selectImagesWithTransform(e)},selectImagesWithTransform:function(t){var e=this;void 0===Craft.AssetSelectorModal.transformUrls[t]&&(Craft.AssetSelectorModal.transformUrls[t]={});for(var n=this.elementIndex.getSelectedElements(),i=[],r=0;r<n.length;r++){var a=$(n[r]),s=Craft.getElementInfo(a).id;void 0===Craft.AssetSelectorModal.transformUrls[t][s]&&i.push(s)}i.length?(this.showFooterSpinner(),this.fetchMissingTransformUrls(i,t,(function(){e.hideFooterSpinner(),e.selectImagesWithTransform(t)}))):(this._selectedTransform=t,this.selectElements(),this._selectedTransform=null)},fetchMissingTransformUrls:function(t,e,n){var i=this,r=t.pop(),a={assetId:r,handle:e};Craft.sendActionRequest("POST","assets/generate-transform",{data:a}).then((function(t){Craft.AssetSelectorModal.transformUrls[e][r]=t.data.url||!1})).catch((function(){Craft.AssetSelectorModal.transformUrls[e][r]=!1})).finally((function(){t.length?i.fetchMissingTransformUrls(t,e,n):n()}))},getElementInfo:function(t){var e=this.base(t);if(this._selectedTransform)for(var n=0;n<e.length;n++){var i=e[n].id;void 0!==Craft.AssetSelectorModal.transformUrls[this._selectedTransform][i]&&!1!==Craft.AssetSelectorModal.transformUrls[this._selectedTransform][i]&&(e[n].url=Craft.AssetSelectorModal.transformUrls[this._selectedTransform][i])}return e},onSelect:function(t){this.settings.onSelect(t,this._selectedTransform)}},{defaults:{canSelectImageTransforms:!1,transforms:[]},transformUrls:{}}),Craft.registerElementSelectorModalClass("craft\\elements\\Asset",Craft.AssetSelectorModal)},1833:function(){Craft.BaseElementSelectorModal=Garnish.Modal.extend({elementType:null,elementIndex:null,supportSidebarToggleView:!1,$body:null,$content:null,$footer:null,$selectBtn:null,$sidebar:null,$sources:null,$sourceToggles:null,$sidebarToggleBtn:null,$sidebarCloseBtn:null,$mainHeading:null,$main:null,$search:null,$elements:null,$tbody:null,$primaryButtons:null,$secondaryButtons:null,$cancelBtn:null,init:function(t,e){this.elementType=t,this.setSettings(e,Craft.BaseElementSelectorModal.defaults);var n="elementSelectorModalHeading-"+Math.floor(1e6*Math.random()),i=$("<div/>",{class:"modal elementselectormodal","aria-labelledby":n}).appendTo(Garnish.$bod),r=$("<div/>",{class:this.settings.showTitle?"header":"visually-hidden"}).appendTo(i);$("<h1/>",{id:n,text:this.settings.modalTitle}).appendTo(r);var a=$("<div/>",{class:"body"}).append($("<div/>",{class:"spinner big"})).appendTo(i);this.$footer=$("<div/>",{class:"footer"}).appendTo(i),this.settings.fullscreen&&(i.addClass("fullscreen"),this.settings.minGutter=0),this.base(i,this.settings),this.$secondaryButtons=$('<div class="buttons left secondary-buttons"/>').appendTo(this.$footer),this.$primaryButtons=$('<div class="buttons right"/>').appendTo(this.$footer),this.$cancelBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(this.$primaryButtons),this.$selectBtn=Craft.ui.createSubmitButton({class:"disabled",label:this.settings.selectBtnLabel,spinner:!0}).attr("aria-disabled","true").appendTo(this.$primaryButtons),this.$body=a,this.addListener(this.$cancelBtn,"activate","cancel"),this.addListener(this.$selectBtn,"activate","selectElements")},updateModalBottomPadding:function(){var t=this.$footer.outerHeight();t!==parseInt(this.$container.css("padding-bottom"))&&this.$container.css("padding-bottom",t)},updateSidebarView:function(){this.supportSidebarToggleView&&(this.sidebarShouldBeHidden()?this.$sidebarToggleBtn||this.buildSidebarToggleView():this.$sidebarToggleBtn&&this.resetView())},sidebarShouldBeHidden:function(){return this.$container.outerWidth()<550},resetView:function(){this.$mainHeader&&this.$mainHeader.remove(),this.$sidebarHeader&&this.$sidebarHeader.remove(),this.$sidebarToggleBtn=null,this.$body.addClass("has-sidebar"),this.$content.addClass("has-sidebar"),this.$sidebar.removeClass("hidden")},buildSidebarToggleView:function(){var t=this;!this.$sidebarToggleBtn&&this.sidebarShouldBeHidden()&&(this.$sidebarHeader=$('<div class="sidebar-header"/>').prependTo(this.$sidebar),this.$sidebarCloseBtn=Craft.ui.createButton({class:"nav-close close-btn"}).attr("aria-label",Craft.t("app","Close")).removeClass("btn").appendTo(this.$sidebarHeader),this.$mainHeader=$('<div class="main-header"/>').prependTo(this.$main),this.$mainHeading=$('<h2 class="main-heading">'.concat(this.getActiveSourceName(),"</h2>")).appendTo(this.$mainHeader),this.$sidebarToggleBtn=Craft.ui.createButton({toggle:!0,controls:"modal-sidebar",class:"nav-toggle"}).removeClass("btn").attr("aria-label",Craft.t("app","Show sidebar")).appendTo(this.$mainHeader),this.$sidebar.attr("id","modal-sidebar"),this.closeSidebar(),this.addListener(this.$sidebarToggleBtn,"click",(function(){t.toggleSidebar()})),this.addListener(this.$sidebarCloseBtn,"click",(function(){t.toggleSidebar()})))},sidebarIsOpen:function(){return"true"===this.$sidebarToggleBtn.attr("aria-expanded")},toggleSidebar:function(){this.sidebarIsOpen()?this.closeSidebar():this.openSidebar()},openSidebar:function(){var t=this;this.$body.addClass("has-sidebar"),this.$content.addClass("has-sidebar"),this.$sidebar.removeClass("hidden"),this.$sidebarToggleBtn.attr("aria-expanded","true"),this.$sidebar.find(":focusable").first().focus(),Garnish.uiLayerManager.addLayer(this.$sidebar),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){t.closeSidebar()}))},closeSidebar:function(){if(this.$sidebarToggleBtn){this.sidebarIsOpen()&&Garnish.uiLayerManager.removeLayer(),this.$sidebar.addClass("hidden"),this.$sidebarToggleBtn.attr("aria-expanded","false");var t=Garnish.getFocusedElement();$.contains(this.$sidebar.get(0),t.get(0))&&this.$sidebarToggleBtn.focus(),this.$body.removeClass("has-sidebar"),this.$content.removeClass("has-sidebar")}},getActiveSourceName:function(){return this.$sidebar.find(".sel").text()},onFadeIn:function(){this.elementIndex?(this.updateModalBottomPadding(),Garnish.isMobileBrowser(!0)||this.elementIndex.$search.focus()):this._createElementIndex(),this.base()},onSelectionChange:function(){this.updateSelectBtnState()},onSelectSource:function(){this.updateHeading(),this.updateModalBottomPadding()},updateHeading:function(){this.$mainHeading&&this.$mainHeading.text(this.getActiveSourceName())},updateSelectBtnState:function(){this.$selectBtn&&(this.shouldEnableSelectBtn()?this.enableSelectBtn():this.disableSelectBtn())},shouldEnableSelectBtn:function(){return this.hasSelection()},hasSelection:function(){return this.elementIndex&&this.elementIndex.getSelectedElements().length},enableSelectBtn:function(){this.$selectBtn.removeClass("disabled").attr("aria-disabled","false")},disableSelectBtn:function(){this.$selectBtn.addClass("disabled").attr("aria-disabled","true")},enableCancelBtn:function(){this.$cancelBtn.removeClass("disabled")},disableCancelBtn:function(){this.$cancelBtn.addClass("disabled")},showFooterSpinner:function(){this.$selectBtn.addClass("loading")},hideFooterSpinner:function(){this.$selectBtn.removeClass("loading")},cancel:function(){this.$cancelBtn.hasClass("disabled")||this.hide()},selectElements:function(){if(this.hasSelection()){this.elementIndex.view&&this.elementIndex.view.elementSelect&&this.elementIndex.view.elementSelect.clearMouseUpTimeout();var t=this.elementIndex.getSelectedElements(),e=this.getElementInfo(t);this.onSelect(e),this.settings.disableElementsOnSelect&&this.elementIndex.disableElements(this.elementIndex.getSelectedElements()),this.settings.hideOnSelect&&this.hide()}},getElementInfo:function(t){for(var e=[],n=0;n<t.length;n++){var i=$(t[n]),r=Craft.getElementInfo(i);e.push(r)}return e},onShow:function(){var t;this.updateSelectBtnState(),this.addListener(Garnish.$win,"resize",this.updateSidebarView),this.addListener(Garnish.$win,"resize",this.updateModalBottomPadding),this.updateModalBottomPadding(),this.updateSidebarView(),null!==(t=this.elementIndex)&&void 0!==t&&t.searching&&this.elementIndex.clearSearch(!0),this.base()},onHide:function(){this.closeSidebar(),this.base()},onSelect:function(t){this.settings.onSelect(t)},disable:function(){this.elementIndex&&this.elementIndex.disable(),this.base()},enable:function(){this.elementIndex&&this.elementIndex.enable(),this.base()},getElementIndexParams:function(){var t={context:"modal",elementType:this.elementType,sources:this.settings.sources,condition:this.settings.condition};return null!==this.settings.showSiteMenu&&"auto"!==this.settings.showSiteMenu&&(t.showSiteMenu=this.settings.showSiteMenu?"1":"0"),t},_createElementIndex:function(){var t=this;Craft.sendActionRequest("POST",this.settings.bodyAction,{data:this.getElementIndexParams()}).then((function(e){t.$body.html(e.data.html),t.$body.has(".sidebar:not(.hidden)").length&&(t.$body.addClass("has-sidebar"),t.supportSidebarToggleView=!0),t.elementIndex=Craft.createElementIndex(t.elementType,t.$body,t.getIndexSettings()),t.$main=t.elementIndex.$main,t.$sidebar=t.elementIndex.$sidebar,t.$content=t.$body.find(".content"),t.updateSidebarView(),t.updateModalBottomPadding(),t.addListener(t.elementIndex.$elements,"doubletap",(function(t,e){e.firstTap.target===e.secondTap.target&&this.selectElements()})),t.on("updateSizeAndPosition",(function(){t.elementIndex.handleResize()})),t.updateSelectBtnState()}))},getIndexSettings:function(){var t=this;return Object.assign({context:"modal",modal:this,storageKey:this.settings.storageKey,condition:this.settings.condition,referenceElementId:this.settings.referenceElementId,referenceElementOwnerId:this.settings.referenceElementOwnerId,referenceElementSiteId:this.settings.referenceElementSiteId,criteria:Object.assign({},this.settings.criteria),disabledElementIds:this.settings.disabledElementIds,selectable:!0,multiSelect:this.settings.multiSelect,waitForDoubleClicks:!0,buttonContainer:this.$secondaryButtons,onSelectionChange:function(){t.elementIndex&&t.onSelectionChange()},onSourcePathChange:function(){t.elementIndex&&t.onSelectionChange()},onSelectSource:this.onSelectSource.bind(this),hideSidebar:this.settings.hideSidebar,defaultSiteId:this.settings.defaultSiteId,defaultSource:this.settings.defaultSource,defaultSourcePath:this.settings.defaultSourcePath,preferStoredSource:this.settings.preferStoredSource,showSourcePath:this.settings.showSourcePath},this.settings.indexSettings)}},{defaults:{fullscreen:!1,resizable:!0,storageKey:null,sources:null,condition:null,referenceElementId:null,referenceElementOwnerId:null,referenceElementSiteId:null,criteria:null,multiSelect:!1,showSiteMenu:null,disabledElementIds:[],disableElementsOnSelect:!1,hideOnSelect:!0,modalTitle:Craft.t("app","Select element"),showTitle:!1,selectBtnLabel:Craft.t("app","Select"),onCancel:$.noop,onSelect:$.noop,hideSidebar:!1,defaultSiteId:null,defaultSource:null,defaultSourcePath:null,preferStoredSource:!1,showSourcePath:!0,bodyAction:"element-selector-modals/body",indexSettings:{}}})},1973:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function i(){"use strict";i=function(){return n};var e,n={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,s=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function r(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)}))}}var s;Craft.TableElementIndexView=Craft.BaseElementIndexView.extend({$table:null,$tableCaption:null,$selectedSortHeader:null,$statusMessage:null,$editBtn:null,$saveBtn:null,$cancelBtn:null,tableSort:null,_totalVisiblePostStructureTableDraggee:null,_morePendingPostStructureTableDraggee:!1,_broadcastListener:null,initialSerializedValue:null,stickyScrollbar:null,stickyScrollbarObserver:null,getElementContainer:function(){return this.$table=this.$container.find("table:first"),this.$table.children("tbody:first")},afterInit:function(){var t=this;this.$tableCaption=this.$table.find("caption"),this.initTableHeaders(),this.createScrollbar(),(this.settings.sortable||this.elementIndex.isAdministrative&&"structure"===this.elementIndex.viewMode&&Garnish.hasAttr(this.$table,"data-structure-id"))&&!this.elementIndex.inlineEditing&&(this.tableSort=new Craft.ElementTableSorter(this,this.getAllElements(),{structureId:this.$table.data("structure-id"),maxLevels:this.$table.attr("data-max-levels"),onSortChange:function(){t.settings.onSortChange(t.tableSort.$draggee)}})),"structure"!==this.elementIndex.viewMode||this.elementIndex.inlineEditing||this.addListener(this.$elementContainer,"click",(function(t){var e=$(t.target);e.hasClass("toggle")&&!1===this._collapseElement(e)&&this._expandElement(e)})),this.elementIndex.isAdministrative&&!this.elementIndex.settings.static&&!1!==this.elementIndex.settings.inlineEditable&&this.$elementContainer.has("> tr[data-id] > th .element[data-editable]")&&this.initForInlineEditing(),Craft.messageReceiver&&(this._broadcastListener=function(e){if("saveElement"===e.data.event||"replaceFile"===e.data.event){var n=t.$table.find('> tbody > tr[data-id="'.concat(e.data.id,'"]'));if(n.length){var i=Object.assign(t.elementIndex.getViewParams(),{id:e.data.id});Craft.sendActionRequest("POST","element-indexes/element-table-html",{data:i}).then((function(t){for(var e=t.data,i=0;i<n.length;i++){var r=n.eq(i);for(var a in e.attributeHtml)e.attributeHtml.hasOwnProperty(a)&&r.find('> td[data-attr="'.concat(a,'"]')).html(e.attributeHtml[a])}Craft.cp.elementThumbLoader.load(n)}))}}},Craft.messageReceiver.addEventListener("message",this._broadcastListener))},initForInlineEditing:function(){var t=this;this.elementIndex.inlineEditing?(Craft.initUiElements(this.$elementContainer),this.initialSerializedValue=this.serializeInputs(),this.$saveBtn=Craft.ui.createSubmitButton({label:Craft.t("app","Save"),spinner:!0}).insertBefore(this.elementIndex.$exportBtn),this.$cancelBtn=Craft.ui.createButton({label:Craft.t("app","Cancel"),spinner:!0}).insertBefore(this.elementIndex.$exportBtn),this.addListener(this.$saveBtn,"activate",(function(){t.$saveBtn.addClass("loading"),t.closeDateTimeFields(),t.saveChanges().then((function(e){if(e.errors){for(var n in e.errors)if(e.errors.hasOwnProperty(n)){var i=t.$elementContainer.children('[data-id="'.concat(n,'"]'));for(var r in e.errors[n])i.find('[name*="'.concat(r,'"]')).closest("td").addClass("errors")}return t.elementIndex.setIndexAvailable(),void Craft.cp.displayError(Craft.t("app","Could not save due to validation errors."))}Craft.cp.displaySuccess(Craft.t("app","Changes saved.")),t.elementIndex.inlineEditing=!1,t.elementIndex.updateElements(!0,!1).then((function(){t.elementIndex.$elements.removeClass("inline-editing")}))})).catch((function(){t.elementIndex.setIndexAvailable(),Craft.cp.displayError()})).finally((function(){t.$saveBtn.removeClass("loading")}))})),this.addListener(this.$cancelBtn,"activate",(function(){t.getDeltaInputChanges()&&!confirm(Craft.t("app","Are you sure you want to discard your changes?"))||(t.$cancelBtn.addClass("loading"),t.elementIndex.inlineEditing=!1,t.closeDateTimeFields(),t.elementIndex.updateElements(!0,!1).then((function(){t.elementIndex.$elements.removeClass("inline-editing")})))})),this.addListener(this.$elementContainer,"keydown",(function(e){e.keyCode===Garnish.RETURN_KEY?t.$saveBtn.trigger("click"):e.keyCode===Garnish.S_KEY&&Garnish.isCtrlKeyPressed(e)&&(e.stopPropagation(),e.preventDefault(),t.$saveBtn.trigger("click"))}))):(this.$editBtn=Craft.ui.createButton({label:Craft.t("app","Edit"),spinner:!0}).insertBefore(this.elementIndex.$exportBtn),this.addListener(this.$editBtn,"activate",(function(){t.$editBtn.addClass("loading"),t.elementIndex.inlineEditing=!0,t.elementIndex.updateElements(!0,!1).then((function(){t.elementIndex.$elements.addClass("inline-editing")}))})))},closeDateTimeFields:function(){this.elementIndex.$elements.find(".datewrapper input").datepicker("destroy"),$().timepicker&&this.elementIndex.$elements.find(".timewrapper input").timepicker("remove")},serializeInputs:function(){var t=Garnish.getPostData(this.$elementContainer),e=[];for(var n in t)e.push(encodeURIComponent("".concat(n,"=").concat(t[n])));return e.join("&")},getDeltaInputChanges:function(){var t=this,e=this.$elementContainer.children().toArray().map((function(e){return"".concat(t.elementIndex.nestedInputNamespace,"[element-").concat($(e).data("id"),"]")}));return Craft.findDeltaData(this.initialSerializedValue,this.serializeInputs(),e)},haveInputsChanged:function(){return this.serializeInputs()!==this.initialSerializedValue},saveChanges:(s=a(i().mark((function t(){var e,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.getDeltaInputChanges()){t.next=3;break}return t.abrupt("return",{});case 3:return e+="&"+$.param({elementType:this.elementIndex.elementType,siteId:this.elementIndex.siteId,namespace:this.elementIndex.nestedInputNamespace}),t.next=6,Craft.sendActionRequest("POST","element-indexes/save-elements",{data:e});case 6:return n=t.sent,t.abrupt("return",n.data);case 8:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)}),initTableHeaders:function(){if(!this.elementIndex.inlineEditing){var t,n;if("structure"===this.elementIndex.viewMode)t="structure",n="asc";else{var i=e(this.elementIndex.getSortAttributeAndDirection(),2);t=i[0],n=i[1]}for(var r=this.$table.children("thead").children().children("[data-attribute]"),a=0;a<r.length;a++){var s=r.eq(a),o=s.attr("data-attribute"),l="none";o===t?(this.$selectedSortHeader=s,l="asc"===n?"ascending":"descending",s.addClass("ordered "+n),this.makeColumnSortable(s,!0)):this.elementIndex.getSortOption(o)&&this.makeColumnSortable(s),s.attr("aria-sort",l)}}},makeColumnSortable:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.addClass("orderable");var n=t.html(),i=this.$tableCaption.find("[data-sort-instructions]"),r=$("<button/>",{id:"".concat(this.elementIndex.idPrefix,"-").concat(t.attr("data-attribute")),type:"button","aria-pressed":"false"}).html(n);i.length&&r.attr("aria-describedby",i.attr("id")),e?(r.attr("aria-pressed","true"),r.on("click",this._handleSelectedSortHeaderClick.bind(this))):r.on("click",this._handleUnselectedSortHeaderClick.bind(this)),t.empty().append(r)},isVerticalList:function(){return!0},getTotalVisible:function(){return this._isStructureTableDraggingLastElements()?this._totalVisiblePostStructureTableDraggee:this._totalVisible},setTotalVisible:function(t){this._isStructureTableDraggingLastElements()?this._totalVisiblePostStructureTableDraggee=t:this._totalVisible=t},getMorePending:function(){return this._isStructureTableDraggingLastElements()?this._morePendingPostStructureTableDraggee:this._morePending},setMorePending:function(t){this._isStructureTableDraggingLastElements()?this._morePendingPostStructureTableDraggee=t:this._morePending=this._morePendingPostStructureTableDraggee=t},getLoadMoreParams:function(){var t=this.base();return this._isStructureTableDraggingLastElements()&&(t.criteria.positionedAfter=this.tableSort.$targetItem.data("id")),t},appendElements:function(t){this.base(t),this.tableSort&&this.tableSort.addItems(t),Craft.cp.updateResponsiveTables()},_collapseElement:function(t,e){if(!e&&!t.hasClass("expanded"))return!1;t.removeClass("expanded"),t.attr("aria-expanded","false");for(var n=t.closest("tr"),i=n.data("id"),r=n.data("level"),a=n.next();a.length;){if(!Garnish.hasAttr(a,"data-spinnerrow")){if(a.data("level")<=r)break;this.elementSelect&&this.elementSelect.removeItems(a),this.tableSort&&this.tableSort.removeItems(a),this._totalVisible--}var s=a.next();a.remove(),a=s}this.elementIndex.instanceState.collapsedElementIds||(this.elementIndex.instanceState.collapsedElementIds=[]),this.elementIndex.instanceState.collapsedElementIds.push(i),this.elementIndex.setInstanceState("collapsedElementIds",this.elementIndex.instanceState.collapsedElementIds),this.maybeLoadMore()},_expandElement:function(t,e){var n=this;if(!e&&t.hasClass("expanded"))return!1;if(t.addClass("expanded"),t.attr("aria-expanded","true"),this.elementIndex.instanceState.collapsedElementIds){var r=t.closest("tr"),s=r.data("id"),o=$.inArray(s,this.elementIndex.instanceState.collapsedElementIds);if(-1!==o){this.elementIndex.instanceState.collapsedElementIds.splice(o,1),this.elementIndex.setInstanceState("collapsedElementIds",this.elementIndex.instanceState.collapsedElementIds);var l=this._createSpinnerRowAfter(r),c=$.extend(!0,{},this.settings.params);c.criteria.descendantOf=s,Craft.sendActionRequest("POST",this.settings.loadMoreElementsAction,{data:c}).then(function(){var t=a(i().mark((function t(e){var r,a,s,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.parent().length){t.next=2;break}return t.abrupt("return");case 2:return r=$(e.data.html),a=n._totalVisible+r.length,(s=n.settings.batchSize&&r.length===n.settings.batchSize)?(o=l.nextAll(),n.elementSelect&&n.elementSelect.removeItems(o),n.tableSort&&n.tableSort.removeItems(o),o.remove(),a-=o.length):s=n._morePending,l.replaceWith(r),n.thumbLoader.load(r),(n.elementIndex.actions||n.settings.selectable)&&(n.elementSelect.addItems(r.filter(":not(.disabled)")),n.elementIndex.updateActionTriggers()),n.tableSort&&n.tableSort.addItems(r),t.next=12,Craft.appendHeadHtml(e.data.headHtml);case 12:return t.next=14,Craft.appendBodyHtml(e.data.bodyHtml);case 14:Craft.cp.updateResponsiveTables(),n.setTotalVisible(a),n.setMorePending(s),n.maybeLoadMore();case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){Craft.cp.displayError(),l.parent().length}))}}},_createSpinnerRowAfter:function(t){return $('<tr data-spinnerrow><td class="centeralign" colspan="'+t.children().length+'"><div class="spinner"/></td></tr>').insertAfter(t)},_isStructureTableDraggingLastElements:function(){return this.tableSort&&this.tableSort.dragging&&this.tableSort.draggingLastElements},_handleSelectedSortHeaderClick:function(t){var e=$(t.currentTarget).closest("th");if(!e.hasClass("loading")){var n="asc"===this.elementIndex.getSelectedSortDirection()?"desc":"asc";this.elementIndex.selectViewMode("table"),this.elementIndex.setSelectedSortDirection(n),this._handleSortHeaderClick(t,e)}},_handleUnselectedSortHeaderClick:function(t){var e=$(t.currentTarget).closest("th");if(!e.hasClass("loading")){var n=e.attr("data-attribute");this.elementIndex.selectViewMode("table"),this.elementIndex.setSelectedSortAttribute(n),this._handleSortHeaderClick(t,e)}},_handleSortHeaderClick:function(t,e){this.$selectedSortHeader&&this.$selectedSortHeader.removeClass("ordered asc desc"),e.addClass("ordered loading"),this.elementIndex.updateElements(),this.elementIndex.hideIndexLoadingStyles()},_updateTableAttributes:function(t,e){var n=t.closest("tr");for(var i in e)e.hasOwnProperty(i)&&n.children('[data-attr="'+i+'"]:first').html(e[i])},destroy:function(){this.$editBtn?this.$editBtn.remove():this.$cancelBtn&&(this.$saveBtn.remove(),this.$cancelBtn.remove()),this.stickyScrollbar&&this.stickyScrollbar.remove(),this.stickyScrollbarObserver&&this.stickyScrollbarObserver.disconnect(),this._broadcastListener&&(Craft.messageReceiver.removeEventListener("message",this._broadcastListener),delete this._broadcastListener),this.base()},createScrollbar:function(){var t=this;if("index"===this.elementIndex.settings.context){var n=document.querySelector("#content > #footer");if(n){this.stickyScrollbar=document.createElement("craft-proxy-scrollbar"),this.stickyScrollbar.setAttribute("scroller",".tablepane"),this.stickyScrollbar.setAttribute("content",".tablepane > table"),this.stickyScrollbar.style.bottom="".concat(n.getBoundingClientRect().height+2,"px");var i=$(this.stickyScrollbar);this.stickyScrollbarObserver=new IntersectionObserver((function(n){e(n,1)[0].intersectionRatio<1?i.insertAfter(t.$container):i.remove()}),{rootMargin:"0px 0px -1px 0px",threshold:[1]}),this.stickyScrollbarObserver.observe(n)}}}})},1980:function(){Craft.IntervalManager=Garnish.Base.extend({_intervalId:null,init:function(t){this.setSettings(t,Craft.IntervalManager.defaults)},start:function(){var t=this;this._intervalId=setInterval((function(){t.settings.onInterval()}),this.settings.interval)},stop:function(){clearInterval(this._intervalId),this._intervalId=null}},{defaults:{interval:5e3,onInterval:$.noop}})},2059:function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.ColorInput=Garnish.Base.extend({$container:null,$input:null,$colorContainer:null,$colorPreview:null,$colorInput:null,init:function(t,e){this.setSettings(e,Craft.ColorInput.defaults),this.$container=$(t),this.$input=this.$container.find(".color-input"),this.$colorContainer=this.$container.children(".color"),this.$colorPreview=this.$colorContainer.children(".color-preview"),this.createColorInput(),this.handleTextChange(),this.addListener(this.$input,"input","handleTextChange")},createColorInput:function(){var e,n=document.createElement("input");if(n.setAttribute("type","color"),"color"===n.type){var i=!1;if(this.$container.parents(".input").hasClass("disabled")&&(i=!0),this.$colorContainer.removeClass("static"),this.$colorInput=$(n).addClass("color-preview-input").attr({"aria-controls":this.$input.attr("id"),"aria-label":Craft.t("app","Color picker"),"aria-labelledby":this.$input.attr("aria-labelledby")}).appendTo(this.$colorPreview),i&&this.$colorInput.attr("disabled",""),null!==(e=this.settings.presets)&&void 0!==e&&e.length){var r="listbox-".concat(Math.floor(1e6*Math.random()));this.$colorInput.attr("list",r);var a,s=$("<datalist/>",{id:r}).insertAfter(this.$colorInput),o=function(e,n){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}(this.settings.presets);try{for(o.s();!(a=o.n()).done;){var l=a.value;$("<option/>").text(l).appendTo(s)}}catch(t){o.e(t)}finally{o.f()}}this.addListener(this.$colorInput,"click",(function(t){t.stopPropagation()})),this.addListener(this.$colorContainer,"click",(function(){this.$colorInput.trigger("click")})),this.addListener(this.$colorInput,"input","updateColor")}},updateColor:function(){this.$input.val(this.$colorInput.val()),this.handleTextChange()},handleTextChange:function(){var t=this.$input.val();t!==(t=t.trim())&&this.$input.val(t),t.length&&"#"===t[0]&&(t=t.substring(1),this.$input.val(t)),t.length?(3===t.length&&(t=t[0].repeat(2)+t[1].repeat(2)+t[2].repeat(2)),t.match(/^[0-9a-f]{6}$/i)?(this.$colorPreview.css("background-color","#".concat(t)),this.$colorInput&&this.$colorInput.val("#".concat(t))):this.$colorPreview.css("background-color","")):this.$colorPreview.css("background-color","")}},{defaults:{presets:[]},_browserSupportsColorInputs:null,doesBrowserSupportColorInputs:function(){return Craft.ColorInput._browserSupportsColorInputs,Craft.ColorInput._browserSupportsColorInputs}})},2107:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}Craft.SortableCheckboxSelect=Garnish.Base.extend({$container:null,dragSort:null,init:function(t){var e=this;this.$container=$(t),this.$container.data("sortableCheckboxSelect",this);var n=this.$container.children(".checkbox-select-item:not(.all)");this.initDrag(n),n.length&&n.each((function(t,n){e.initItem(n)}))},initDrag:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===e.length&&(e=this.$container.children(".checkbox-select-item:not(.all)")),Craft.hasMousePointerEvents()&&e.length&&(this.dragSort=new Garnish.DragSort(e,{axis:Garnish.Y_AXIS,handle:".draggable-handle"}),this.dragSort.on("sortChange",(function(){t.trigger("sortChange")})))},initItem:function(t){return new Craft.SortableCheckboxSelect.Item(this,t)}}),Craft.SortableCheckboxSelect.Item=Garnish.Base.extend({select:null,$item:null,$moveHandle:null,$checkbox:null,$checkboxLabel:null,$actionMenuBtn:null,$actionMenu:null,actionDisclosure:null,moveUpBtn:null,moveDownBtn:null,init:function(t,e){var n=this;this.select=t,this.$item=$(e),this.$moveHandle=this.$item.children(".move"),Craft.hasMousePointerEvents()||this.$moveHandle.hide(),this.$checkbox=this.$item.children("input[type=checkbox]"),this.$checkboxLabel=this.$item.children("label"),this.addListener(this.$checkbox,"change",(function(){n.handleCheckboxChange()})),this.handleCheckboxChange()},handleCheckboxChange:function(){this.$checkbox.prop("checked")?this.onCheck():this.onUncheck()},onCheck:function(){var t,n=this;this.$actionMenuBtn&&this.onUncheck(),null===(t=this.$moveHandle)||void 0===t||t.removeClass("disabled");var r,a,s="menu-"+Math.floor(1e9*Math.random()),o=this.$checkboxLabel.attr("id");o||(o="label-".concat(Math.floor(1e9*Math.random())),this.$checkboxLabel.attr("id",o)),this.$actionMenuBtn=$("<button/>",{class:"btn action-btn","aria-controls":s,"aria-label":Craft.t("app","Actions"),"aria-describedby":o,"data-disclosure-trigger":"","data-icon":"ellipsis"}).appendTo(this.$item),this.$actionMenu=$("<div/>",{id:s,class:"menu menu--disclosure"}).appendTo(this.$item),this.actionDisclosure=new Garnish.DisclosureMenu(this.$actionMenuBtn),this.moveUpBtn=this.actionDisclosure.addItem({icon:(r=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-up");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),label:Craft.t("app","Move up"),onActivate:function(){n.moveUp()}}),this.moveDownBtn=this.actionDisclosure.addItem({icon:(a=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-down");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),label:Craft.t("app","Move down"),onActivate:function(){n.moveDown()}}),this.actionDisclosure.on("show",(function(){n.getPrevCheckedItem()?n.actionDisclosure.showItem(n.moveUpBtn):n.actionDisclosure.hideItem(n.moveUpBtn),n.getNextCheckedItem()?n.actionDisclosure.showItem(n.moveDownBtn):n.actionDisclosure.hideItem(n.moveDownBtn)}));var l=this.getAllCheckedSiblings();0==l.length?this.$actionMenuBtn.hide():1==l.length&&$(l[0]).find(".btn.action-btn").show(),this.$item.trigger("checked")},onUncheck:function(){var t,e,n,i,r=this.getAllCheckedSiblings();1==r.length&&$(r[0]).find(".btn.action-btn").hide(),null===(t=this.$moveHandle)||void 0===t||t.addClass("disabled"),null===(e=this.$actionMenuBtn)||void 0===e||e.remove(),null===(n=this.$actionMenu)||void 0===n||n.remove(),null===(i=this.actionDisclosure)||void 0===i||i.destroy(),this.$actionMenuBtn=this.actionDisclosure=null,this.$item.trigger("unchecked")},getPrevCheckedItem:function(){var t=this.$item.prevAll(".checkbox-select-item:not(.all):has(input[type=checkbox]:checked):first");return t.length?t:null},getNextCheckedItem:function(){var t=this.$item.nextAll(".checkbox-select-item:not(.all):has(input[type=checkbox]:checked):first");return t.length?t:null},getAllCheckedSiblings:function(){return this.$item.siblings(".checkbox-select-item:not(.all):has(input[type=checkbox]:checked)")},moveUp:function(){var t=this.getPrevCheckedItem();t&&(this.$item.insertBefore(t),this.$item.trigger("movedUp"),this.select.trigger("sortChange"))},moveDown:function(){var t=this.getNextCheckedItem();t&&(this.$item.insertAfter(t),this.$item.trigger("movedDown"),this.select.trigger("sortChange"))}})},2200:function(){Craft.LinkField=Garnish.Base.extend({$container:null,$typeSelect:null,$labelInput:null,$filenameInput:null,init:function(t,e){var n=this;this.$container=$(t),this.$container.data("linkField",this),this.$typeSelect=this.$container.find("select:first"),this.$labelInput=this.$container.children("[data-label-field]:first").find(".text:first"),this.$filenameInput=this.$container.find("[data-filename-field]:first .text:first"),this.$typeSelect.length&&this.$typeSelect.fieldtoggle().data("fieldtoggle").on("toggleChange",(function(){n.updateLabel(),n.updateFilename()}))},getActiveLinkTypeContainer:function(){return this.$container.find("[data-link-type]:not(.hidden):first")},updateLabel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getActiveLinkTypeContainer();null===t?t=e.data("linkLabel")||"":e.data("linkLabel",t),this.$labelInput.prop("placeholder",t)},updateFilename:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getActiveLinkTypeContainer();null===t?t=e.data("filename")||"":e.data("filename",t),this.$filenameInput.prop("placeholder",t)}})},2211:function(){Craft.ElementFieldSettings=Garnish.Base.extend({allowMultipleSources:null,$maintainHierarchyField:null,$maintainHierarchyButton:null,$sourcesField:null,$sourceSelect:null,$branchLimitField:null,$maxRelationsField:null,$minRelationsField:null,$defaultPlacementField:null,$viewModeField:null,init:function(t,e,n,i,r,a,s,o){this.allowMultipleSources=t,this.$maintainHierarchyField=$("#".concat(e)),this.$maintainHierarchyButton=this.$maintainHierarchyField.find("button"),this.$sourcesField=$("#".concat(n)),this.allowMultipleSources||(this.$sourceSelect=this.$sourcesField.find("select")),this.$branchLimitField=$("#".concat(i)),this.$minRelationsField=$("#".concat(r)),this.$maxRelationsField=$("#".concat(a)),this.$defaultPlacementField=$("#".concat(s)),this.$viewModeField=$("#".concat(o)),this.updateLimitFields(),this.addListener(this.$maintainHierarchyButton,"change","updateLimitFields"),this.allowMultipleSources?this.$sourcesField.find("[type=checkbox]").each(function(t,e){this.addListener($(e),"change","updateMaintainHierarchyField")}.bind(this)):this.addListener(this.$sourceSelect,"change","updateMaintainHierarchyField"),this.updateMaintainHierarchyField()},updateLimitFields:function(){!this.$maintainHierarchyField.hasClass("hidden")&&this.$maintainHierarchyButton.hasClass("on")?(this.$minRelationsField.addClass("hidden"),this.$maxRelationsField.addClass("hidden"),this.$branchLimitField.removeClass("hidden"),this.$defaultPlacementField.addClass("hidden"),this.$viewModeField.find("select").val("list").trigger("change"),this.$viewModeField.addClass("hidden")):(this.$branchLimitField.addClass("hidden"),this.$minRelationsField.removeClass("hidden"),this.$maxRelationsField.removeClass("hidden"),this.$defaultPlacementField.removeClass("hidden"),this.$viewModeField.removeClass("hidden"))},updateMaintainHierarchyField:function(){var t;if(this.allowMultipleSources){var e=this.$sourcesField.find('[type="checkbox"]:checked');t=1===e.length&&e.data("structure-id")}else t=this.$sourceSelect.children("option:selected").data("structure-id");t?this.$maintainHierarchyField.removeClass("hidden"):this.$maintainHierarchyField.addClass("hidden"),this.updateLimitFields()}})},2290:function(){Craft.BaseInputGenerator=Garnish.Base.extend({$source:null,$target:null,$form:null,settings:null,listening:null,sourceVal:null,init:function(t,e,n){this.$source=$(t),this.$target=$(e),this.$form=this.$source.closest("form"),this.setSettings(n,Craft.BaseInputGenerator.defaults),this.setSettings(n),this.startListening()},setNewSource:function(t){var e=this.listening;this.stopListening(),this.$source=$(t),e&&this.startListening()},startListening:function(){this.listening||(this.listening=!0,this.sourceVal=this.$source.val(),this.addListener(this.$source,"input","onSourceTextChange"),this.addListener(this.$target,"input","onTargetTextChange"),this.addListener(this.$form,"submit","updateTarget"))},stopListening:function(){this.listening&&(this.listening=!1,this.removeAllListeners(this.$source),this.removeAllListeners(this.$target),this.removeAllListeners(this.$form))},onSourceTextChange:function(){var t=this.$source.val();this.sourceVal!==(this.sourceVal=t)&&this.updateTarget()},onTargetTextChange:function(){this.$target.get(0)===document.activeElement&&this.stopListening()},updateTarget:function(){if(this.$target.is(":visible")||0!=this.settings.updateWhenHidden){var t=this.$source.val();if(void 0!==t){var e=this.generateTargetValue(t);e&&(e="".concat(this.settings.prefix).concat(e).concat(this.settings.suffix)),this.$target.val(e);for(var n=0;n<this.$target.length;n++)this.$target[n].dispatchEvent(new InputEvent("input",{inputType:"insertText"})),this.$target[n].dispatchEvent(new Event("input"));this.$target.is(":focus")&&Craft.selectFullValue(this.$target)}}},generateTargetValue:function(t){return t}},{defaults:{updateWhenHidden:!1,prefix:"",suffix:""}})},2353:function(){Craft.DeleteUserModal=Garnish.Modal.extend({id:null,userId:null,$deleteActionRadios:null,$deleteSubmitBtn:null,userSelect:null,_deleting:!1,init:function(t,e){var n=this;this.id=Math.floor(1e9*Math.random()),this.userId=t,e=$.extend(Craft.DeleteUserModal.defaults,e);var i,r=$('<form class="modal fitted deleteusermodal" method="post" accept-charset="UTF-8">'+Craft.getCsrfInput()+'<input type="hidden" name="action" value="users/delete-user"/>'+(Array.isArray(this.userId)?"":'<input type="hidden" name="userId" value="'+this.userId+'"/>')+(e.redirect?'<input type="hidden" name="redirect" value="'+e.redirect+'"/>':"")+"</form>").appendTo(Garnish.$bod),a=$('<div class="body"><div class="content-summary"><p>'+Craft.t("app","What do you want to do with their content?")+'</p><ul class="bullets"></ul></div><div class="options"><label><input type="radio" name="contentAction" value="transfer"/> '+Craft.t("app","Transfer it to:")+'</label><div id="transferselect'+this.id+'" class="elementselect"><ul class="elements"></ul><button type="button" class="btn add icon dashed">'+Craft.t("app","Choose a user")+'</button></div></div><div><label class="error"><input type="radio" name="contentAction" value="delete"/> '+Craft.t("app","Delete their content")+"</label></div></div>").appendTo(r),s=$('<div class="buttons right"/>').appendTo(a),o=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(s),l=a.find(".content-summary");if(e.contentSummary.length)for(var c=0;c<e.contentSummary.length;c++)l.find("ul").append($("<li/>",{text:e.contentSummary[c]}));else l.find("ul").remove();if(this.$deleteActionRadios=a.find("input[type=radio]"),this.$deleteSubmitBtn=Craft.ui.createSubmitButton({class:"disabled",label:this._submitBtnLabel(!1),spinner:!0}).appendTo(s),Array.isArray(this.userId)){i=["and"];for(var u=0;u<this.userId.length;u++)i.push("not "+this.userId[u])}else i="not "+this.userId;this.userSelect=new Craft.BaseElementSelectInput({id:"transferselect"+this.id,name:"transferContentTo",elementType:"craft\\elements\\User",criteria:{id:i},limit:1,modalSettings:{closeOtherModals:!1},onSelectElements:function(){n.updateSizeAndPosition(),n.$deleteActionRadios.first().prop("checked")?n.validateDeleteInputs():n.$deleteActionRadios.first().trigger("click")},onRemoveElements:this.validateDeleteInputs.bind(this),selectable:!1,editable:!1}),this.addListener(o,"click","hide"),this.addListener(this.$deleteActionRadios,"change","validateDeleteInputs"),this.addListener(r,"submit","handleSubmit"),this.base(r,e)},_submitBtnLabel:function(t){var e=t?"Delete {num, plural, =1{user} other{users}} and content":"Delete {num, plural, =1{user} other{users}}";return Craft.t("app",e,{num:Array.isArray(this.userId)?this.userId.length:1})},validateDeleteInputs:function(){var t=!1;return this.$deleteActionRadios.eq(1).prop("checked")?(t=!0,this.$deleteSubmitBtn.find(".label").text(this._submitBtnLabel(!0))):(this.$deleteSubmitBtn.find(".label").text(this._submitBtnLabel(!1)),this.$deleteActionRadios.eq(0).prop("checked")&&(t=!!this.userSelect.totalSelected)),this.updateSizeAndPosition(),t?this.$deleteSubmitBtn.removeClass("disabled"):this.$deleteSubmitBtn.addClass("disabled"),t},handleSubmit:function(t){if(!this._deleting&&this.validateDeleteInputs()){this.$deleteSubmitBtn.addClass("loading"),this.disable(),this.userSelect.disable(),this._deleting=!0;try{!1===this.settings.onSubmit()&&t.preventDefault()}catch(e){throw t.preventDefault(),this.$deleteSubmitBtn.removeClass("loading"),e}}else t.preventDefault()},onFadeIn:function(){Garnish.isMobileBrowser(!0)||this.$deleteActionRadios.first().focus(),this.base()}},{defaults:{contentSummary:[],onSubmit:$.noop,redirect:null}})},2364:function(){function t(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.ElevatedSessionForm=Garnish.Base.extend({$form:null,inputSelectors:null,$inputs:null,inputs:null,init:function(t,e){var n=this;this.$form=$(t),this.inputSelectors=[],this.$inputs=$(),this.inputs=[],void 0!==e&&$.makeArray(e).forEach((function(t){"string"==typeof t&&n.inputSelectors.push(t),$(t,n.$form).each((function(t,e){n.$inputs=n.$inputs.add(e);var i=$(e);n.inputs.push({$input:i,val:Garnish.getInputPostVal(i)})}))})),this.$form.data("slideout"),this.addListener(this.$form,"submit","handleFormSubmit")},handleFormSubmit:function(t){if(Craft.elevatedSessionManager.fetchingTimeout)return t.preventDefault(),t.stopImmediatePropagation(),void(t.cancel=!0);this.inputsChanged()&&(t.preventDefault(),t.stopImmediatePropagation(),t.cancel=!0,Craft.elevatedSessionManager.requireElevatedSession(this.submitForm.bind(this)))},inputsChanged:function(){if(!this.inputSelectors.length&&!this.inputs.length)return!0;var e,n=t(this.inputSelectors);try{for(n.s();!(e=n.n()).done;)for(var i=e.value,r=$(i,this.$form),a=0;a<r.length;a++){var s=r[a];if(!this.$inputs.is(s))return!0}}catch(t){n.e(t)}finally{n.f()}var o,l=t(this.inputs);try{for(l.s();!(o=l.n()).done;){var c=o.value,u=c.$input,h=c.val;if(u.data("passwordInput")&&(u=u.data("passwordInput").$currentInput),Garnish.getInputPostVal(u)!==h)return!0}}catch(t){l.e(t)}finally{l.f()}return!1},submitForm:function(){this.disable(),this.$form.trigger("submit"),this.enable()}})},2394:function(){function t(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.EntryIndex=Craft.BaseElementIndex.extend({publishableSections:null,$newEntryBtnGroup:null,$newEntryBtn:null,init:function(t,e,n){this.publishableSections=[],this.on("selectSource",this.updateButton.bind(this)),this.on("selectSite",this.updateButton.bind(this)),this.base(t,e,n)},afterInit:function(){var t=this.$sources.toArray().map((function(t){return $(t).data("handle")})).filter((function(t){return!!t}));this.publishableSections=Craft.publishableSections.filter((function(e){return t.includes(e.handle)})),this.base()},getDefaultSourceKey:function(){if("index"===this.settings.context&&"undefined"!=typeof defaultSectionHandle){if("singles"===defaultSectionHandle)return"singles";for(var t=0;t<this.$sources.length;t++){var e=$(this.$sources[t]);if(e.data("handle")===defaultSectionHandle)return e.data("key")}}return this.base()},updateButton:function(){var e=this;if(this.$source){var n,i;if("singles"===this.$source.data("key")?n="singles":(n=this.$source.data("handle"),i=this.$source.data("entry-type")),this.publishableSections.length){this.$newEntryBtnGroup&&this.$newEntryBtnGroup.remove();var r,a=this.publishableSections.find((function(t){return t.handle===n}));this.$newEntryBtnGroup=$('<div class="btngroup submit" data-wrapper/>');var s="new-entry-menu-"+Craft.randomString(10),o=this.publishableSections.filter((function(t){return t.sites.includes(e.siteId)}));if(a){var l="index"===this.settings.context?Craft.uppercaseFirst(Craft.t("app","New {type}",{type:Craft.elementTypeNames["craft\\elements\\Entry"][2]})):Craft.t("app","New {section} entry",{section:a.name}),c="index"===this.settings.context?Craft.t("app","New entry in the {section} section",{section:a.name}):l,u="index"===this.settings.context?"link":null;this.$newEntryBtn=Craft.ui.createButton({label:l,ariaLabel:c,spinner:!0,role:u}).addClass("submit add icon").appendTo(this.$newEntryBtnGroup),this.addListener(this.$newEntryBtn,"click mousedown",(function(t){if("index"===e.settings.context&&("click"===t.type&&Garnish.isCtrlKeyPressed(t)||"mousedown"===t.type&&1===t.originalEvent.button)){var n={};i&&(n.type=i),window.open(Craft.getUrl("entries/".concat(a.handle,"/new"),n))}else"click"===t.type&&e._createEntry(a.id,i)})),o.length>1&&(r=$("<button/>",{type:"button",class:"btn submit menubtn btngroup-btn-last","aria-controls":s,"data-disclosure-trigger":"","aria-label":Craft.t("app","New entry, choose a section")}).appendTo(this.$newEntryBtnGroup))}else o.length>0&&(this.$newEntryBtn=r=Craft.ui.createButton({label:Craft.uppercaseFirst(Craft.t("app","New {type}",{type:Craft.elementTypeNames["craft\\elements\\Entry"][2]})),ariaLabel:Craft.t("app","New entry, choose a section"),spinner:!0}).addClass("submit add icon menubtn btngroup-btn-last").attr("aria-controls",s).attr("data-disclosure-trigger","").appendTo(this.$newEntryBtnGroup));if(this.addButton(this.$newEntryBtnGroup),r){var h,d=$("<div/>",{id:s,class:"menu menu--disclosure"}).appendTo(this.$newEntryBtnGroup),f=$("<ul/>").appendTo(d),p=t(this.publishableSections);try{var g=function(){var t=h.value,n="index"===e.settings.context?"link":"button";if("index"===e.settings.context&&t.sites.includes(e.siteId)||"index"!==e.settings.context&&t!==a&&t.sites.includes(e.siteId)){var i=$("<li/>").appendTo(f),s=$("<a/>",{role:"button"===n?"button":null,href:Craft.getUrl("entries/".concat(t.handle,"/new")),type:"button"===n?"button":null,text:Craft.t("app","New {section} entry",{section:t.name})}).appendTo(i);e.addListener(s,"activate",(function(n){n.originalEvent.preventDefault(),r.data("trigger").hide(),e._createEntry(t.id)})),"button"===n&&e.addListener(s,"keydown",(function(n){n.keyCode===Garnish.SPACE_KEY&&(n.preventDefault(),r.data("trigger").hide(),e._createEntry(t.id))}))}};for(p.s();!(h=p.n()).done;)g()}catch(t){p.e(t)}finally{p.f()}new Garnish.DisclosureMenu(r)}}if("index"===this.settings.context){var m,v="content/".concat(null!==(m=this.settings.page)&&void 0!==m?m:"entries");n&&(v+="/"+n),Craft.setPath(v)}}else this.$newEntryBtnGroup&&this.$newEntryBtnGroup.remove()},_createEntry:function(t,e){var n=this;if(this.$newEntryBtn.hasClass("loading"))console.warn("New entry creation already in progress.");else{var i=this.publishableSections.find((function(e){return e.id===t}));if(!i)throw"Invalid section ID: ".concat(t);this.$newEntryBtn.addClass("loading"),Craft.sendActionRequest("POST","entries/create",{data:{siteId:this.siteId,section:i.handle,type:e}}).then((function(t){var e=t.data;"index"===n.settings.context?document.location.href=Craft.getUrl(e.cpEditUrl,{fresh:1}):Craft.createElementEditor(n.elementType,{siteId:n.siteId,elementId:e.entry.id,draftId:e.entry.draftId,params:{fresh:1,updateSearchIndexImmediately:1}}).on("submit",(function(t){n.clearSearch(!1),n.startSearching(),n.$search.val(t.data.title),n.searchText=t.data.title,n.selectElementAfterUpdate(e.entry.id),n.updateElements()}))})).finally((function(){n.$newEntryBtn.removeClass("loading")}))}},canPaste:function(e){if(!this.$source.data("sectionId"))return!1;var n,i=this.$source.data("entryTypeIds")||[],r=t(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!i.includes(a.data.entryTypeId))return!1}}catch(t){r.e(t)}finally{r.f()}return!0},pasteAttributes:function(){return{sectionId:this.$source.data("sectionId"),placeInStructure:!0}}}),Craft.registerElementIndexClass("craft\\elements\\Entry",Craft.EntryIndex)},2410:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function n(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function i(){"use strict";i=function(){return n};var e,n={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,s=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function r(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)}))}}Craft.CpScreenSlideout=Craft.Slideout.extend({action:null,namespace:null,showingLoadSpinner:!1,hasTabs:!1,hasCpLink:!1,hasSidebar:!1,$header:null,$toolbar:null,$tabContainer:null,$extraToolbarItems:null,$loadSpinner:null,$actionBtn:null,$editLink:null,$sidebarBtn:null,$body:null,$content:null,$sidebar:null,$footer:null,$noticeContainer:null,$cancelBtn:null,$saveBtn:null,tabManager:null,showingSidebar:!1,cancelToken:null,ignoreFailedRequest:!1,fieldsWithErrors:null,get showExpandedView(){return this.$container.width()>700},get sidebarIsOverlapping(){return this.showingSidebar&&"absolute"===this.$sidebar.css("position")},init:function(t,e){var n=this;this.action=t,e=Object.assign({},Craft.CpScreenSlideout.defaults,e),Object.assign(e.containerAttributes,{id:"cp-screen-".concat(Math.floor(1e8*Math.random())),class:"cp-screen"});var i="form"===e.containerElement;i&&Object.assign(e.containerAttributes,{action:"",method:"post",novalidate:""}),this.fieldsWithErrors=[],this.$header=$("<header/>",{class:"pane-header"}),this.$toolbar=$("<div/>",{class:"so-toolbar"}).appendTo(this.$header),this.$tabContainer=$("<div/>",{class:"pane-tabs"}).appendTo(this.$toolbar),this.$loadSpinner=$("<div/>",{class:"spinner",title:Craft.t("app","Loading"),"aria-label":Craft.t("app","Loading")}).appendTo(this.$toolbar),this.$editLink=$("<a/>",{target:"_blank",class:"btn header-btn hidden",title:Craft.t("app","Open in a new tab"),"aria-label":Craft.t("app","Open in a new tab"),"data-icon":"external"}).appendTo(this.$toolbar),this.$sidebarBtn=$("<button/>",{type:"button",class:"btn header-btn hidden sidebar-btn",title:Craft.t("app","Show sidebar"),"aria-label":Craft.t("app","Show sidebar"),"data-icon":"sidebar-".concat(Garnish.ltr?"right":"left"),"aria-expanded":"false"}).appendTo(this.$toolbar),this.addListener(this.$sidebarBtn,"click",(function(t){t.preventDefault(),n.showingSidebar?(n.hideSidebar(),n.showExpandedView&&Craft.setCookie("sidebar-slideout","collapsed")):(n.showSidebar(),n.showExpandedView&&Craft.setCookie("sidebar-slideout","expanded"))})),this.$body=$("<div/>",{class:"so-body"}),this.$content=$("<div/>",{class:"so-content"}).appendTo(this.$body),this.$sidebar=$("<div/>",{class:"so-sidebar details hidden"}).appendTo(this.$body),this.$footer=$("<div/>",{class:"so-footer hidden"}),this.$noticeContainer=$("<div/>",{class:"so-notice"}).appendTo(this.$footer),$("<div/>",{class:"flex-grow"}).appendTo(this.$footer);var r=$("<div/>",{class:"flex flex-nowrap"}).appendTo(this.$footer);this.$cancelBtn=$("<button/>",{type:"button",class:"btn",text:i?Craft.t("app","Cancel"):Craft.t("app","Close")}).appendTo(r),i&&(this.$saveBtn=Craft.ui.createSubmitButton({label:Craft.t("app","Save"),spinner:!0}).appendTo(r));var a=this.$header.add(this.$body).add(this.$footer);this.base(a,e),this.$container.data("cpScreen",this),this.on("beforeClose",(function(){n.hideSidebarIfOverlapping()})),Garnish.uiLayerManager.registerShortcut({keyCode:Garnish.S_KEY,ctrl:!0},(function(t){n.handleSubmit(t)})),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){n.closeMeMaybe()})),this.addListener(this.$cancelBtn,"click",(function(){n.closeMeMaybe()})),this.addListener(this.$shade,"click",(function(){n.closeMeMaybe()})),this.addListener(this.$container,"click",(function(t){var e=$(event.target);!n.showingSidebar||e.closest(n.$sidebarBtn).length||e.closest(n.$sidebar).length||n.hideSidebarIfOverlapping()})),this.addListener(this.$container,"submit","handleSubmit"),this.load()},load:function(t,e){var n=this;return new Promise((function(t,i){n.trigger("beforeLoad"),n.showLoadSpinner(),n.cancelToken&&(n.ignoreFailedRequest=!0,n.cancelToken.cancel()),n.cancelToken=axios.CancelToken.source(),Craft.sendActionRequest("GET",n.action,$.extend({params:Object.assign({},n.getParams(),n.settings.params),cancelToken:n.cancelToken.token,headers:{"X-Craft-Container-Id":n.$container.attr("id")}},n.settings.requestOptions)).then((function(r){n.update(r.data).then((function(){!1!==e&&(n.$container.data("delta-names",r.data.deltaNames),n.$container.data("initial-delta-values",r.data.initialDeltaValues),n.$container.data("initialSerializedValue",n.$container.serialize())),t()})).catch((function(t){i(t)}))})).catch((function(t){n.ignoreFailedRequest||(Craft.cp.displayError(),i(t)),n.ignoreFailedRequest=!1})).finally((function(){n.hideLoadSpinner(),n.cancelToken=null}))}))},getParams:function(){return{}},updateHeaderVisibility:function(){var t=this.settings.showHeader||this.hasTabs||this.hasCpLink||this.showingLoadSpinner;t||this.hasSidebar?this.$header.removeClass("hidden"):this.$header.addClass("hidden"),t?this.$header.addClass("so-visible"):this.$header.removeClass("so-visible")},showLoadSpinner:function(){this.$loadSpinner.removeClass("hidden"),this.showingLoadSpinner=!0,this.updateHeaderVisibility()},hideLoadSpinner:function(){this.$loadSpinner.addClass("hidden"),this.showingLoadSpinner=!1,this.updateHeaderVisibility()},update:function(t){var e=this;return new Promise((function(n){if(e.namespace=t.namespace,t.bodyClass&&e.$body.addClass(t.bodyClass),e.$content.html(t.content),t.submitButtonLabel&&e.$saveBtn.find(".label").text(t.submitButtonLabel),e.updateTabs(t.tabs),e.updateExtraToolbarItems(t.extraToolbarItems),t.formAttributes&&Craft.setElementAttributes(e.$container,t.formAttributes),t.editUrl?(e.$editLink.removeClass("hidden").attr("href",t.editUrl),e.hasCpLink=!0):(e.$editLink.addClass("hidden"),e.hasCpLink=!1),t.actionMenu){var r=Craft.namespaceId("action-menu-label",e.namespace),s=Craft.namespaceId("action-menu",e.namespace);$("<label/>",{id:r,class:"visually-hidden",text:Craft.t("app","Actions")}).insertBefore(e.$editLink),e.$actionBtn=$("<button/>",{class:"btn action-btn header-btn",type:"button",title:Craft.t("app","Actions"),"aria-controls":s,"aria-describedby":r,"data-disclosure-trigger":"true"}).insertBefore(e.$editLink),$(t.actionMenu).insertBefore(e.$editLink),e.$actionBtn.disclosureMenu()}else e.$actionBtn=null;t.sidebar?(e.$sidebarBtn.removeClass("hidden"),e.$sidebar.html(t.sidebar),e.$sidebar.find("a").each((function(){this.hostname.length&&void 0===$(this).attr("target")&&$(this).attr("target","_blank")})),e.hasSidebar=!0,e.showExpandedView&&"expanded"===(Craft.getCookie("sidebar-slideout")||"expanded")?e.showSidebar(!1):e.hideSidebar()):(e.hideSidebar(),e.$sidebarBtn.addClass("hidden"),e.$sidebar.addClass("hidden").html(""),e.hasSidebar=!1),t.notice?e.$noticeContainer.html(t.notice):e.$noticeContainer.empty(),e.updateHeaderVisibility(),e.$footer.removeClass("hidden"),Garnish.requestAnimationFrame(a(i().mark((function r(){return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Craft.appendHeadHtml(t.headHtml);case 2:return i.next=4,Craft.appendBodyHtml(t.bodyHtml);case 4:Craft.initUiElements(e.$content),Craft.cp.elementThumbLoader.load($(e.$content)),t.sidebar&&(Craft.initUiElements(e.$sidebar),Craft.cp.elementThumbLoader.load(e.$sidebar)),Garnish.isMobileBrowser()||e.isOpening||e.setFocusWithin(),n(),e.trigger("load"),e.settings.onLoad();case 11:case"end":return i.stop()}}),r)}))))}))},setFocusWithin:function(){Craft.setFocusWithin(this.$content)},updateTabs:function(t){var e=this;if(this.tabManager&&(this.tabManager.destroy(),this.tabManager=null,this.$tabContainer.html("")),this.hasTabs=!!t,this.hasTabs){var n=$(t);this.$tabContainer.replaceWith(n),this.$tabContainer=n,this.tabManager=new Craft.Tabs(this.$tabContainer),this.tabManager.on("deselectTab",(function(t){$(t.$tab.attr("href")).addClass("hidden")})),this.tabManager.on("selectTab",(function(t){$(t.$tab.attr("href")).removeClass("hidden"),Garnish.$win.trigger("resize"),e.$body.trigger("scroll")}))}},updateExtraToolbarItems:function(t){this.$extraToolbarItems&&(this.$extraToolbarItems.remove(),this.$extraToolbarItems=null),t&&(this.$extraToolbarItems=$(t).insertAfter(this.$tabContainer))},showSidebar:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.showingSidebar||(this.$container.addClass("showing-sidebar"),this.$body.scrollTop(0).addClass("no-scroll"),this.$sidebar.off("transitionend.so").css(this._closedSidebarStyles()).removeClass("hidden"),this.$sidebar[0].offsetWidth,this.$sidebar.css(this._openedSidebarStyles()),e&&!Garnish.isMobileBrowser()&&this.$sidebar.one("transitionend.so",(function(){Craft.setFocusWithin(t.$sidebar)})),this.showExpandedView||Craft.trapFocusWithin(this.$sidebar),this.$sidebarBtn.addClass("active").attr({"aria-expanded":"true"}),Garnish.$win.trigger("resize"),this.$sidebar.trigger("scroll"),Garnish.uiLayerManager.addLayer({bubble:!0}),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(e){t.hideSidebarIfOverlapping()||e.bubbleShortcut()})),this.showingSidebar=!0)},hideSidebar:function(){var t=this;this.showingSidebar&&(this.$container.removeClass("showing-sidebar"),this.$body.removeClass("no-scroll"),this.sidebarIsOverlapping||(this.$sidebar.addClass("hidden"),this.$sidebarBtn.focus()),this.$sidebar.off("transitionend.so").css(this._closedSidebarStyles()).one("transitionend.so",(function(){t.$sidebar.addClass("hidden"),t.$sidebarBtn.focus()})),Craft.releaseFocusWithin(this.$sidebar),this.$sidebarBtn.removeClass("active").attr({"aria-expanded":"false"}),Garnish.uiLayerManager.removeLayer(),this.showingSidebar=!1)},hideSidebarIfOverlapping:function(){return!!this.sidebarIsOverlapping&&(this.hideSidebar(),!0)},_openedSidebarStyles:function(){return n({},Garnish.ltr?"right":"left","0")},_closedSidebarStyles:function(){return n({},Garnish.ltr?"right":"left","-350px")},showSubmitSpinner:function(){this.$saveBtn.addClass("loading")},hideSubmitSpinner:function(){this.$saveBtn.removeClass("loading")},handleSubmit:function(t){var e=this;t.preventDefault(),setTimeout((function(){t.cancel||e.submit()}),1)},submit:function(){var t=this;this.showSubmitSpinner();var e=Craft.findDeltaData(this.$container.data("initialSerializedValue"),this.$container.serialize(),this.$container.data("delta-names"),null,this.$container.data("initial-delta-values"));Craft.sendActionRequest("POST",null,{data:e,headers:{"X-Craft-Namespace":this.namespace}}).then((function(e){t.handleSubmitResponse(e)})).catch((function(e){t.handleSubmitError(e)})).finally((function(){t.hideSubmitSpinner()}))},handleSubmitResponse:function(t){this.clearErrors();var e=t.data||{};e.message&&Craft.cp.displaySuccess(e.message,e.notificationSettings),e.modelClass&&e.modelId&&Craft.refreshComponentInstances(e.modelClass,e.modelId);var n={response:t,data:e.modelName&&e[e.modelName]||{}};this.trigger("submit",n),this.settings.onSubmit(n),this.settings.closeOnSubmit&&this.close()},handleSubmitError:function(t){if(!t.isAxiosError||!t.response||400===!t.response.status)throw Craft.cp.displayError(),t;var e=t.response.data||{};Craft.cp.displayError(e.message),e.errors&&this.showErrors(e.errors),e.errorSummary&&this.showErrorSummary(e.errorSummary,Object.keys(e.errors||{}).length)},showErrorSummary:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Craft.ui.clearErrorSummary(this.$body),null!==this.tabManager){var n=this.tabManager.$tabs,i=n.filter(".error"),r=this.$content;n.each((function(n,a){var s=$(a).data("id"),o=r.find("#"+s);if(o.length>0){var l=o.data("layout-tab"),c=$(t),u=c.find("ul.errors li").length,h="";c.find("ul.errors li").each((function(t,e){var n=$(e).find("a").data("layout-tab");void 0!==n&&n!==l&&($(e).remove(),u--)})),u>0?(h=Craft.t("app","Found {num, number} {num, plural, =1{error} other{errors}} in this tab.",{num:u}),i.length-1>0&&(h+='<span class="visually-hidden">'+Craft.t("app","{total, number} {total, plural, =1{error} other{errors}} found in {num, number} {num, plural, =1{tab} other{tabs}}.",{total:e,num:i.length})+"</span>")):h=Craft.t("app","Found errors in other tabs."),c.find("h2").html(h),c.prependTo(o),Craft.ui.setFocusOnErrorSummary(o)}}))}else $(t).prependTo(this.$content),Craft.ui.setFocusOnErrorSummary(this.$content)},showErrors:function(t){var n,i=this;this.clearErrors();var r=(null===(n=this.tabManager)||void 0===n?void 0:n.menu)||[],a='<span data-icon="alert"><span class="visually-hidden">'+Craft.t("app","This tab contains errors")+"</span>\n</span>";Object.entries(t).forEach((function(t){var n=function(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),s=n[0],o=n[1],l=i.$container.find('[data-error-key="'.concat(s,'"]'));if(l){Craft.ui.addErrorsToField(l,o),i.fieldsWithErrors.push(l);var c=Craft.ui.findTabAnchorForField(l,i.$container);if(c.length>0){0==i.tabManager.$menuBtn.hasClass("error")&&(i.tabManager.$menuBtn.addClass("error"),i.tabManager.$menuBtn.append('<span data-icon="alert"></span>'));for(var u=0;u<c.length;u++){var h=$(c[u]);if(0==h.hasClass("error")&&(h.addClass("error"),h.find(".tab-label").append(a),r.length)){var d=r.find("[data-id="+h.data("id")+"]");d.length>0&&0==d.hasClass("error")&&(d.addClass("error"),d.append(a))}}}}}))},clearErrors:function(){this.fieldsWithErrors.forEach((function(t){Craft.ui.clearErrorsFromField(t)}))},isDirty:function(){var t=this,e=this.$container.data("initialSerializedValue");return void 0!==e&&e!==(this.$container.data("serializer")||function(){return t.$container.serialize()})()},closeMeMaybe:function(){this.isOpen&&(this.isDirty()&&!confirm(Craft.t("app","Are you sure you want to close this screen? Any changes will be lost."))||this.close())},close:function(){this.showingSidebar&&this.hideSidebar(),this.base(),this.cancelToken&&(this.ignoreFailedRequest=!0,this.cancelToken.cancel())}},{defaults:{containerElement:"form",containerAttributes:{},params:{},requestOptions:{},showHeader:null,closeOnEsc:!1,closeOnShadeClick:!1,closeOnSubmit:!0,onLoad:function(){},onSubmit:function(){}}})},2756:function(){Craft.ImageUpload=Garnish.Base.extend({$container:null,progressBar:null,uploader:null,init:function(t){this.setSettings(t,Craft.ImageUpload.defaults),this.$container=$(this.settings.containerSelector),this.initImageUpload()},initImageUpload:function(){this.progressBar=new Craft.ProgressBar($('<div class="progress-shade"></div>').appendTo(this.$container));var t={url:Craft.getActionUrl(this.settings.uploadAction),formData:this.settings.postParameters,fileInput:this.$container.find(this.settings.fileInputSelector),paramName:this.settings.uploadParamName};void 0!==Craft.csrfTokenName&&void 0!==Craft.csrfTokenValue&&(t.formData[Craft.csrfTokenName]=Craft.csrfTokenValue),t.events={},t.events.fileuploadstart=this._onUploadStart.bind(this),t.events.fileuploadprogressall=this._onUploadProgress.bind(this),t.events.fileuploaddone=this._onUploadComplete.bind(this),t.events.fileuploadfail=this._onUploadFailure.bind(this),this.uploader=Craft.createUploader(null,this.$container,t),this.initButtons()},initButtons:function(){var t=this;this.$container.find(this.settings.uploadButtonSelector).on("click",(function(e){t.$container.find(t.settings.fileInputSelector).trigger("click")})),this.$container.find(this.settings.deleteButtonSelector).on("click",(function(e){confirm(Craft.t("app","Are you sure you want to delete this image?"))&&($(e.currentTarget).parent().append('<div class="blocking-modal"></div>'),Craft.sendActionRequest("POST",t.settings.deleteAction,{data:t.settings.postParameters}).then((function(e){var n=e.data;t.refreshImage(n)})))}))},refreshImage:function(t){this.$container.replaceWith(this.$container=$(t.html)),this.settings.onAfterRefreshImage(t),Craft.cp.elementThumbLoader.load(this.$container),this.initImageUpload()},_onUploadStart:function(t){this.progressBar.$progressBar.css({top:Math.round(this.$container.outerHeight()/2)-6}),this.$container.addClass("uploading"),this.progressBar.resetProgressBar(),this.progressBar.showProgressBar()},_onUploadProgress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=parseInt(e.loaded/e.total*100,10);this.progressBar.setProgressPercentage(n)},_onUploadComplete:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.refreshImage(e.result),this.uploader.isLastUpload()&&(this.progressBar.hideProgressBar(),this.$container.removeClass("uploading"))},_onUploadFailure:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=i.response(),a=(null==r||null===(e=r.jqXHR)||void 0===e?void 0:e.responseJSON)||{},s=a.message,o=a.filename,l=a.errors,c=void 0===l?{}:l;o=o||(null==i||null===(n=i.files)||void 0===n?void 0:n[0].name);var u=c?Object.values(c).flat():[];s||(s=u.length?u.join("\n"):o?Craft.t("app","Upload failed for “{filename}”.",{filename:o}):Craft.t("app","Upload failed.")),Craft.cp.displayError(s),this.progressBar.hideProgressBar(),this.$container.removeClass("uploading")}},{defaults:{postParameters:{},uploadAction:"",deleteAction:"",fileInputSelector:"",onAfterRefreshImage:$.noop,containerSelector:null,uploadButtonSelector:null,deleteButtonSelector:null,uploadParamName:"files"}})},2760:function(){Craft.VolumeFolderSelectorModal=Craft.BaseElementSelectorModal.extend({init:function(t){(t=Object.assign({},Craft.VolumeFolderSelectorModal.defaults,t,{showSiteMenu:!1})).indexSettings.disabledFolderIds=t.disabledFolderIds,this.base("craft\\elements\\Asset",t)},getElementIndexParams:function(){return Object.assign({},this.base(),{foldersOnly:!0})},shouldEnableSelectBtn:function(){var t;return!!this.base()||(null===(t=this.elementIndex)||void 0===t?void 0:t.sourcePath.length)&&void 0!==this.elementIndex.sourcePath[this.elementIndex.sourcePath.length-1].folderId&&!this.settings.disabledFolderIds.includes(this.elementIndex.sourcePath[this.elementIndex.sourcePath.length-1].folderId)},selectElements:function(t){if(this.hasSelection())this.base();else if(this.$selectBtn&&(null==t?void 0:t.currentTarget)===this.$selectBtn[0]&&this.shouldEnableSelectBtn()){var e=this.elementIndex.sourcePath[this.elementIndex.sourcePath.length-1].folderId;this.onSelect([{folderId:e}]),this.settings.hideOnSelect&&this.hide()}},getElementInfo:function(t){for(var e=[],n=0;n<t.length;n++){var i=t.eq(n).find(".element:first"),r=parseInt(i.data("folder-id"));e.push({folderId:r})}return e},getIndexSettings:function(){return Object.assign(this.base(),{foldersOnly:!0,viewSettings:function(){return{canSelectElement:function(t){return t=t.find(".element:first"),Garnish.hasAttr(t,"data-folder-id")}}}})}},{defaults:{disabledFolderIds:[],indexSettings:{}}})},2776:function(){Craft.DynamicGenerator=Craft.BaseInputGenerator.extend({callback:$.noop,init:function(t,e,n){this.callback=n,this.base(t,e)},generateTargetValue:function(t){return this.callback(t)}})},2807:function(){Craft.Queue=Garnish.Base.extend({running:!1,paused:!1,pausedForVisibility:!1,jobs:null,get length(){return this.jobs.length},get isPaused(){return this.paused||this.pausedForVisibility},init:function(){var t=this;this.jobs=[],Garnish.$doc.on("visibilitychange",(function(){t.pausedForVisibility&&Craft.isVisible()&&(t.pausedForVisibility=!1,t._resume())}))},push:function(t){return this._add(t,"push")},unshift:function(t){return this._add(t,"unshift")},pause:function(){this.paused||(this.paused=!0,this.pausedForVisibility||this.trigger("pause"))},resume:function(){this.paused&&(this.paused=!1,this._resume())},_add:function(t,e){var n=this;return new Promise((function(i,r){n.jobs[e]((function(){return new Promise((function(e,n){t().then((function(t){i(t),e()})).catch((function(t){r(t),n()}))}))})),n.running||(n.trigger("beforeRun"),n.running=!0,n._exec())}))},clear:function(){this.jobs.length=0},_exec:function(){var t=this;if(!this.jobs.length)return this.running=!1,void this.trigger("afterRun");this.pausedForVisibility||Craft.isVisible()||(this.pausedForVisibility=!0,this.paused||this.trigger("pause")),this.paused||this.pausedForVisibility||(this.trigger("beforeExec"),this.jobs.shift()().finally((function(){t.trigger("afterExec"),t._exec()})))},_resume:function(){this.isPaused||(this.trigger("resume"),this._exec())}}),Craft.queue=new Craft.Queue},3019:function(){Craft.SlideRuleInput=Garnish.Base.extend({$container:null,$options:null,$selectedOption:null,$input:null,value:null,dragging:!1,sensitivity:3,rotateIntent:!1,startPositionX:null,init:function(t,e){var n=this;this.setSettings(e,Craft.SlideRuleInput.defaultSettings),this.value=0,this.graduationsMin=-70,this.graduationsMax=70,this.slideMin=-45,this.slideMax=45,this.$container=$("#"+t),this.$overlay=$('<div class="overlay"></div>').appendTo(this.$container),this.$cursor=$('<div class="cursor"></div>').appendTo(this.$container),this.$graduations=$('<div class="graduations"></div>').appendTo(this.$container),this.$graduationsUl=$("<ul></ul>").attr({"aria-hidden":"true"}).appendTo(this.$graduations),this.$container.attr({role:"slider",tabindex:"0","aria-valuemin":this.slideMin,"aria-valuemax":this.slideMax,"aria-valuenow":"0","aria-valuetext":Craft.t("app","{num, number} {num, plural, =1{degree} other{degrees}}",{num:0})});for(var i=this.graduationsMin;i<=this.graduationsMax;i++){var r=$('<li class="graduation" data-graduation="'+i+'"><div class="label">'+i+"</div></li>").appendTo(this.$graduationsUl);i%5==0&&r.addClass("main-graduation"),0===i&&r.addClass("selected")}this.$options=this.$container.find(".graduation"),this.addListener(this.$container,"resize",this._handleResize.bind(this)),this.addListener(this.$container,"tapstart",this._handleTapStart.bind(this)),this.addListener(Garnish.$bod,"tapmove",this._handleTapMove.bind(this)),this.addListener(Garnish.$bod,"tapend",this._handleTapEnd.bind(this)),this.addListener(this.$container,"keydown",this._handleKeypress.bind(this)),setTimeout((function(){n.graduationsCalculatedWidth=10*(n.$options.length-1),n.$graduationsUl.css("left",-n.graduationsCalculatedWidth/2+n.$container.width()/2)}),50)},_handleResize:function(){var t=this.valueToPosition(this.value);this.$graduationsUl.css("left",t)},_handleKeypress:function(t){var e=parseInt(this.$container.attr("aria-valuenow"),10);switch(t.keyCode){case Garnish.UP_KEY:case Garnish.RIGHT_KEY:this.setValue(e+1);break;case Garnish.DOWN_KEY:case Garnish.LEFT_KEY:this.setValue(e-1);break;case Garnish.PAGE_UP_KEY:this.setValue(e+10);break;case Garnish.PAGE_DOWN_KEY:this.setValue(e-10);break;case Garnish.HOME_KEY:this.setValue(this.slideMin);break;case Garnish.END_KEY:this.setValue(this.slideMax)}this.onChange()},_handleTapStart:function(t,e){t.preventDefault(),this.rotateIntent=$(t.target).is(".graduations *"),this.rotateIntent&&(this.startPositionX=e.position.x,this.startLeft=this.$graduationsUl.position().left,this.onStart())},_handleTapMove:function(t,e){this.rotateIntent&&Math.abs(e.position.x-this.startPositionX)>this.sensitivity&&(this.dragging=!0,this.$container.addClass("dragging"),t.preventDefault(),this._setValueFromTouch(e),this.onChange())},_setValueFromTouch:function(t){var e,n=this.dragging?this.startPositionX:this.$cursor.offset().left+this.$cursor.outerWidth()/2;e=this.dragging?n-t.position.x:t.position.x-n;var i=this.startLeft-e,r=this.positionToValue(i);this.setValue(r)},setValue:function(t){var e=this.valueToPosition(t);t<this.slideMin?(t=this.slideMin,e=this.valueToPosition(t)):t>this.slideMax&&(t=this.slideMax,e=this.valueToPosition(t)),this.$graduationsUl.css("left",e),t>=this.slideMin&&t<=this.slideMax&&(this.$options.removeClass("selected"),$.each(this.$options,(function(e,n){$(n).data("graduation")>0&&$(n).data("graduation")<=t&&$(n).addClass("selected"),$(n).data("graduation")<0&&$(n).data("graduation")>=t&&$(n).addClass("selected"),0==$(n).data("graduation")&&$(n).addClass("selected")}))),this.$container.attr({"aria-valuenow":t,"aria-valuetext":Craft.t("app","{num, number} {num, plural, =1{degree} other{degrees}}",{num:parseInt(t,10)})}),this.value=t},_handleTapEnd:function(t,e){this.rotateIntent&&(this.dragging?(t.preventDefault(),this.dragging=!1,this.$container.removeClass("dragging")):(this._setValueFromTouch(e),this.onChange()),this.onEnd(),this.startPositionX=null,this.rotateIntent=!1)},positionToValue:function(t){var e=-1*this.graduationsMin,n=-1*(this.graduationsMin-this.graduationsMax);return(this.$graduations.width()/2+-1*t)/this.graduationsCalculatedWidth*n-e},valueToPosition:function(t){var e=-1*this.graduationsMin,n=-1*(this.graduationsMin-this.graduationsMax);return-((t+e)*this.graduationsCalculatedWidth/n-this.$graduations.width()/2)},onStart:function(){"function"==typeof this.settings.onChange&&this.settings.onStart(this)},onChange:function(){"function"==typeof this.settings.onChange&&this.settings.onChange(this)},onEnd:function(){"function"==typeof this.settings.onChange&&this.settings.onEnd(this)},defaultSettings:{onStart:$.noop,onChange:$.noop,onEnd:$.noop}})},3254:function(){},3517:function(){Craft.BaseUploader=Garnish.Base.extend({allowedKinds:null,$element:null,$fileInput:null,settings:null,fsType:null,formData:{},events:{},_rejectedFiles:{},_extensionList:null,_inProgressCounter:0,init:function(t,e){this._rejectedFiles={size:[],type:[],limit:[]},this.$element=t,this.settings=$.extend({},Craft.BaseUploader.defaults,e),this.formData=this.settings.formData,this.$fileInput=this.settings.fileInput||t,this.events=this.settings.events,this.settings.url||(this.settings.url=this.settings.replace?Craft.getActionUrl(this.settings.replaceAction):Craft.getActionUrl(this.settings.createAction)),this.settings.allowedKinds&&this.settings.allowedKinds.length&&("string"==typeof this.settings.allowedKinds&&(this.settings.allowedKinds=[this.settings.allowedKinds]),this.allowedKinds=this.settings.allowedKinds,delete this.settings.allowedKinds)},setParams:function(t){void 0!==Craft.csrfTokenName&&void 0!==Craft.csrfTokenValue&&(t[Craft.csrfTokenName]=Craft.csrfTokenValue),this.formData=t},getInProgress:function(){return this._inProgressCounter},isLastUpload:function(){return this.getInProgress()<2},processErrorMessages:function(){var t;this._rejectedFiles.type.length&&(t=1===this._rejectedFiles.type.length?"The file {files} could not be uploaded. The allowed file kinds are: {kinds}.":"The files {files} could not be uploaded. The allowed file kinds are: {kinds}.",t=Craft.t("app",t,{files:this._rejectedFiles.type.join(", "),kinds:this.allowedKinds.join(", ")}),this._rejectedFiles.type=[],Craft.cp.displayError(t)),this._rejectedFiles.size.length&&(t=1===this._rejectedFiles.size.length?"The file {files} could not be uploaded, because it exceeds the maximum upload size of {size}.":"The files {files} could not be uploaded, because they exceeded the maximum upload size of {size}.",t=Craft.t("app",t,{files:this._rejectedFiles.size.join(", "),size:this.humanFileSize(this.settings.maxFileSize)}),this._rejectedFiles.size=[],Craft.cp.displayError(t)),this._rejectedFiles.limit.length&&(t=1===this._rejectedFiles.limit.length?"The file {files} could not be uploaded, because the field limit has been reached.":"The files {files} could not be uploaded, because the field limit has been reached.",t=Craft.t("app",t,{files:this._rejectedFiles.limit.join(", ")}),this._rejectedFiles.limit=[],Craft.cp.displayError(t))},humanFileSize:function(t){var e=1024;if(t<e)return t+" B";var n=-1;do{t/=e,++n}while(t>=e);return t.toFixed(1)+" "+["kB","MB","GB","TB","PB","EB","ZB","YB"][n]},_createExtensionList:function(){this._extensionList=[];for(var t=0;t<this.allowedKinds.length;t++){var e=this.allowedKinds[t];if(void 0!==Craft.fileKinds[e])for(var n=0;n<Craft.fileKinds[e].extensions.length;n++){var i=Craft.fileKinds[e].extensions[n];this._extensionList.push(i)}}},destroy:$.noop},{defaults:{dropZone:null,pasteZone:null,fileInput:null,maxFileSize:Craft.maxUploadSize,allowedKinds:null,events:{},formData:{},canAddMoreFiles:null,headers:{Accept:"application/json;q=0.9,*/*;q=0.8"},paramName:"assets-upload",url:null,createAction:null,replaceAction:null,deleteAction:null,replace:!1}})},3589:function(t){var e="(".charCodeAt(0),n=")".charCodeAt(0),i="'".charCodeAt(0),r='"'.charCodeAt(0),a="\\".charCodeAt(0),s="/".charCodeAt(0),o=",".charCodeAt(0),l=":".charCodeAt(0),c="*".charCodeAt(0),u="u".charCodeAt(0),h="U".charCodeAt(0),d="+".charCodeAt(0),f=/^[a-f0-9?-]+$/i;t.exports=function(t){for(var p,g,m,v,y,b,w,C,$,_=[],S=t,x=0,I=S.charCodeAt(x),E=S.length,T=[{nodes:_}],D=0,L="",k="",A="";x<E;)if(I<=32){p=x;do{p+=1,I=S.charCodeAt(p)}while(I<=32);v=S.slice(x,p),m=_[_.length-1],I===n&&D?A=v:m&&"div"===m.type?(m.after=v,m.sourceEndIndex+=v.length):I===o||I===l||I===s&&S.charCodeAt(p+1)!==c&&(!$||($&&$.type,0))?k=v:_.push({type:"space",sourceIndex:x,sourceEndIndex:p,value:v}),x=p}else if(I===i||I===r){p=x,v={type:"string",sourceIndex:x,quote:g=I===i?"'":'"'};do{if(y=!1,~(p=S.indexOf(g,p+1)))for(b=p;S.charCodeAt(b-1)===a;)b-=1,y=!y;else p=(S+=g).length-1,v.unclosed=!0}while(y);v.value=S.slice(x+1,p),v.sourceEndIndex=v.unclosed?p:p+1,_.push(v),x=p+1,I=S.charCodeAt(x)}else if(I===s&&S.charCodeAt(x+1)===c)v={type:"comment",sourceIndex:x,sourceEndIndex:(p=S.indexOf("*/",x))+2},-1===p&&(v.unclosed=!0,p=S.length,v.sourceEndIndex=p),v.value=S.slice(x+2,p),_.push(v),x=p+2,I=S.charCodeAt(x);else if(I!==s&&I!==c||!$||"function"!==$.type)if(I===s||I===o||I===l)v=S[x],_.push({type:"div",sourceIndex:x-k.length,sourceEndIndex:x+v.length,value:v,before:k,after:""}),k="",x+=1,I=S.charCodeAt(x);else if(e===I){p=x;do{p+=1,I=S.charCodeAt(p)}while(I<=32);if(C=x,v={type:"function",sourceIndex:x-L.length,value:L,before:S.slice(C+1,p)},x=p,"url"===L&&I!==i&&I!==r){p-=1;do{if(y=!1,~(p=S.indexOf(")",p+1)))for(b=p;S.charCodeAt(b-1)===a;)b-=1,y=!y;else p=(S+=")").length-1,v.unclosed=!0}while(y);w=p;do{w-=1,I=S.charCodeAt(w)}while(I<=32);C<w?(v.nodes=x!==w+1?[{type:"word",sourceIndex:x,sourceEndIndex:w+1,value:S.slice(x,w+1)}]:[],v.unclosed&&w+1!==p?(v.after="",v.nodes.push({type:"space",sourceIndex:w+1,sourceEndIndex:p,value:S.slice(w+1,p)})):(v.after=S.slice(w+1,p),v.sourceEndIndex=p)):(v.after="",v.nodes=[]),x=p+1,v.sourceEndIndex=v.unclosed?p:x,I=S.charCodeAt(x),_.push(v)}else D+=1,v.after="",v.sourceEndIndex=x+1,_.push(v),T.push(v),_=v.nodes=[],$=v;L=""}else if(n===I&&D)x+=1,I=S.charCodeAt(x),$.after=A,$.sourceEndIndex+=A.length,A="",D-=1,T[T.length-1].sourceEndIndex=x,T.pop(),_=($=T[D]).nodes;else{p=x;do{I===a&&(p+=1),p+=1,I=S.charCodeAt(p)}while(p<E&&!(I<=32||I===i||I===r||I===o||I===l||I===s||I===e||I===c&&$&&"function"===$.type||I===s&&"function"===$.type||I===n&&D));v=S.slice(x,p),e===I?L=v:u!==v.charCodeAt(0)&&h!==v.charCodeAt(0)||d!==v.charCodeAt(1)||!f.test(v.slice(2))?_.push({type:"word",sourceIndex:x,sourceEndIndex:p,value:v}):_.push({type:"unicode-range",sourceIndex:x,sourceEndIndex:p,value:v}),x=p}else v=S[x],_.push({type:"word",sourceIndex:x-k.length,sourceEndIndex:x+v.length,value:v}),x+=1,I=S.charCodeAt(x);for(x=T.length-1;x;x-=1)T[x].unclosed=!0,T[x].sourceEndIndex=S.length;return T[0].nodes}},3730:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}Craft.AssetSelectInput=Craft.BaseElementSelectInput.extend({$uploadBtn:null,uploader:null,progressBar:null,openPreviewTimeout:null,init:function(){this.base.apply(this,arguments),this.settings.canUpload&&this._attachUploader(),this.updateAddElementsBtn(),this.addListener(this.$elementsContainer,"keydown",this._onKeyDown.bind(this))},elementSelectSettings:function(){return Object.assign(this.base(),{makeFocusable:!0})},_onKeyDown:function(t){if(t.keyCode===Garnish.SPACE_KEY&&t.shiftKey)return this.openPreview(),t.stopPropagation(),!1},clearOpenPreviewTimeout:function(){this.openPreviewTimeout&&(clearTimeout(this.openPreviewTimeout),this.openPreviewTimeout=null)},openPreview:function(t){Craft.PreviewFileModal.openInstance?Craft.PreviewFileModal.openInstance.hide():(t||(t=this.$elements.filter(":focus").add(this.$elements.has(":focus"))),t.length&&Craft.PreviewFileModal.showForAsset(t,this.elementSelect))},_attachUploader:function(){var t=this;this.progressBar=new Craft.ProgressBar($('<div class="progress-shade"></div>').appendTo(this.$container)),this.$addElementBtn&&(this.$uploadBtn=$("<button/>",{type:"button",class:"btn dashed","data-icon":"upload","aria-label":1==this.settings.limit?Craft.t("app","Upload a file"):Craft.t("app","Upload files"),"aria-describedby":this.settings.describedBy,text:1==this.settings.limit?Craft.t("app","Upload a file"):Craft.t("app","Upload files")}).insertAfter(this.$addElementBtn),this.$fileInput=$("<input/>",{type:"file",class:"hidden",multiple:1!=this.settings.limit}).insertAfter(this.$uploadBtn),Garnish.$win.trigger("resize"));var e={dropZone:this.$container,fileInput:this.$fileInput};void 0!==this.settings.criteria.kind&&(e.allowedKinds=this.settings.criteria.kind),e.canAddMoreFiles=this.canAddMoreFiles.bind(this),e.events={},e.events.fileuploadstart=this._onUploadStart.bind(this),e.events.fileuploadprogressall=this._onUploadProgress.bind(this),e.events.fileuploaddone=this._onUploadComplete.bind(this),e.events.fileuploadfail=this._onUploadFailure.bind(this),this.uploader=Craft.createUploader(this.settings.fsType,this.$container,e);var n={fieldId:this.settings.fieldId};this.settings.sourceElementId&&(n.elementId=this.settings.sourceElementId),this.settings.criteria.siteId&&(n.siteId=this.settings.criteria.siteId),this.uploader.setParams(n),this.$uploadBtn&&this.$uploadBtn.on("click",(function(e){t.$uploadBtn.next("input[type=file]").trigger("click")}))},enableAddElementsBtn:function(){this.$uploadBtn&&this.$uploadBtn.removeClass("hidden"),this.base()},disableAddElementsBtn:function(){this.$uploadBtn&&this.$uploadBtn.addClass("hidden"),this.base()},selectUploadedFile:function(t){if(this.canAddMoreElements()){var e=t.$element;e.appendTo(this.$elementsContainer);var n=-(e.outerWidth()+10);this.$addElementBtn.css("margin-"+Craft.left,n+"px");var i={};i["margin-"+Craft.left]=0,this.$addElementBtn.velocity(i,"fast"),this.addElements(e),delete this.modal}},_onUploadStart:function(){this.progressBar.$progressBar.css({top:Math.round(this.$container.outerHeight()/2)-6}),this.$container.addClass("uploading"),this.progressBar.resetProgressBar(),this.progressBar.showProgressBar()},_onUploadProgress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=t instanceof CustomEvent?t.detail:e;var n=parseInt(100*Math.min(e.loaded/e.total,1),10);this.progressBar.setProgressPercentage(n)},_onUploadComplete:function(t){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=t instanceof CustomEvent?t.detail:r.result;Craft.sendActionRequest("POST","app/render-elements",{data:{elements:[{type:"craft\\elements\\Asset",id:a.assetId,siteId:this.settings.criteria.siteId,instances:[{context:"field",ui:["list","list-inline","large","thumbs"].includes(this.settings.viewMode)?"chip":"card",size:["large","thumbs"].includes(this.settings.viewMode)?"large":"small",showActionMenu:this.settings.showActionMenu}]}]}}).then(function(){var t,r=(t=e().mark((function t(n){var r,s;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.data,s=Craft.getElementInfo(r.elements[a.assetId][0]),i.selectElements([s]),t.next=5,Craft.appendHeadHtml(r.headHtml);case 5:return t.next=7,Craft.appendBodyHtml(r.bodyHtml);case 7:i.uploader.isLastUpload()&&(i.progressBar.hideProgressBar(),i.$container.removeClass("uploading"),i.$container.trigger("change"));case 8:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))});return function(t){return r.apply(this,arguments)}}()).catch((function(t){if(!t||!t.response)throw Craft.cp.displayError(),t;Craft.cp.displayError(response.data.message)})),Craft.cp.runQueue()},_onUploadFailure:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(t instanceof CustomEvent?t.detail:null==i||null===(e=i.jqXHR)||void 0===e?void 0:e.responseJSON)||{},a=r.message,s=r.filename,o=r.errors;s=s||(null==i||null===(n=i.files)||void 0===n?void 0:n[0].name);var l=o?Object.values(o).flat():[];a||(a=l.length?l.join("\n"):s?Craft.t("app","Upload failed for “{filename}”.",{filename:s}):Craft.t("app","Upload failed.")),Craft.cp.displayError(a),this.progressBar.hideProgressBar(),this.$container.removeClass("uploading")},canAddMoreFiles:function(t){return!this.settings.limit||this.$elements.length+t<this.settings.limit}})},3910:function(){Craft.PromptHandler=Garnish.Base.extend({modal:null,$modalContainerDiv:null,$prompt:null,$promptApplyToRemainingContainer:null,$promptApplyToRemainingCheckbox:null,$promptApplyToRemainingLabel:null,$pomptChoices:null,_prompts:[],_promptBatchCallback:$.noop,_promptBatchReturnData:[],_promptBatchNum:0,resetPrompts:function(){this._prompts=[],this._promptBatchCallback=$.noop,this._promptBatchReturnData=[],this._promptBatchNum=0},addPrompt:function(t){this._prompts.push(t)},getPromptCount:function(){return this._prompts.length},showBatchPrompts:function(t){this._promptBatchCallback=t,this._promptBatchReturnData=[],this._promptBatchNum=0,this._showNextPromptInBatch()},_showNextPromptInBatch:function(){var t=this._prompts[this._promptBatchNum].prompt,e=this._prompts.length-(this._promptBatchNum+1);this._showPrompt(t.message,t.choices,this._handleBatchPromptSelection.bind(this),e,t.modalSettings)},_handleBatchPromptSelection:function(t,e){var n=this._prompts[this._promptBatchNum],i=this._prompts.length-(this._promptBatchNum+1),r=$.extend(n,{choice:t});this._promptBatchReturnData.push(r),i?(this._promptBatchNum++,e?this._handleBatchPromptSelection(t,!0):this._showNextPromptInBatch()):"function"==typeof this._promptBatchCallback&&this._promptBatchCallback(this._promptBatchReturnData)},_showPrompt:function(t,e,n,i,r){this._promptCallback=n,null===this.modal&&(this.modal=new Garnish.Modal(Object.assign({closeOtherModals:!1},r))),null===this.$modalContainerDiv&&(this.$modalContainerDiv=$('<div class="modal fitted prompt-modal"></div>').addClass().appendTo(Garnish.$bod)),this.$prompt=$('<div class="body"></div>').appendTo(this.$modalContainerDiv.empty()),this.$promptMessage=$('<p class="prompt-msg"/>').appendTo(this.$prompt),this.$promptChoices=$('<div class="options"></div>').appendTo(this.$prompt),this.$promptApplyToRemainingContainer=$('<label class="assets-applytoremaining"/>').appendTo(this.$prompt).hide(),this.$promptApplyToRemainingCheckbox=$('<input type="checkbox"/>').appendTo(this.$promptApplyToRemainingContainer),this.$promptApplyToRemainingLabel=$("<span/>").appendTo(this.$promptApplyToRemainingContainer),this.$promptButtons=$('<div class="buttons right"/>').appendTo(this.$prompt),this.modal.setContainer(this.$modalContainerDiv),this.$promptMessage.html(t);for(var a=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(this.$promptButtons),s=$("<button/>",{type:"submit",class:"btn submit disabled",text:Craft.t("app","OK")}).appendTo(this.$promptButtons),o=0;o<e.length;o++){var l=$('<div><label><input type="radio" name="promptAction" value="'+e[o].value+'"/> '+e[o].title+"</label></div>").appendTo(this.$promptChoices).find("input");this.addListener(l,"click",(function(){s.removeClass("disabled")}))}this.addListener(s,"activate",(function(t){var e=$(t.currentTarget).parents(".modal").find("input[name=promptAction]:checked").val(),n=this.$promptApplyToRemainingCheckbox.prop("checked");this._selectPromptChoice(e,n)})),this.addListener(a,"activate",(function(){var t=this.$promptApplyToRemainingCheckbox.prop("checked");this._selectPromptChoice("cancel",t)})),i&&(this.$promptApplyToRemainingContainer.show(),this.$promptApplyToRemainingLabel.html(" "+Craft.t("app","Apply this to the {number} remaining conflicts?",{number:i}))),this.modal.show(),this.modal.removeListener(Garnish.Modal.$shade,"click"),this.addListener(Garnish.Modal.$shade,"click","_cancelPrompt")},_selectPromptChoice:function(t,e){var n=this;this.$prompt.fadeOut("fast",(function(){n.modal.hide(),n._promptCallback(t,e)}))},_cancelPrompt:function(){this._selectPromptChoice("cancel",!0)}})},3914:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function s(){"use strict";s=function(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,s=Object.create(r.prototype),o=new A(i||[]);return a(s,"_invoke",{value:T(t,n,o)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==i&&r.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(a,s,o,l){var c=f(e[a],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&r.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var s;a(this,"_invoke",{value:function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return s=s?s.then(r,r):r()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,s=function t(){for(;++a<n.length;)if(r.call(n,a))return t.value=n[a],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,a(x,"constructor",{value:C,configurable:!0}),a(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function o(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){o(a,i,r,s,l,"next",t)}function l(t){o(a,i,r,s,l,"throw",t)}s(void 0)}))}}var c;Craft.EntryTypeSelectInput=Craft.ComponentSelectInput.extend({init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.base(Object.assign({},Craft.EntryTypeSelectInput.defaults,t))},addComponentInternal:function(t){if(this.settings.allowOverrides){var e=this.getDisclosureMenu(t),n=e.$container.find("[data-edit-action]");n.length&&e.hideItem(n[0]),this.settings.addItemsToActionMenus&&Craft.addActionsToChip(t,[{icon:(i=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("gear");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)}),label:Craft.t("app","Settings"),onActivate:function(e){$(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").createSettings(t)}}],!0)}var i;this.base(t)},createSettings:(c=l(s().mark((function t(e){var n,i,r,a,o,l=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Craft.sendActionRequest("POST","entry-types/render-override-settings",{data:JSON.parse(e.find("input").val())});case 3:i=t.sent,n=i.data,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),Craft.cp.displayError(null===t.t0||void 0===t.t0||null===(r=t.t0.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message),t.t0;case 11:return a=n.namespace,t.next=14,this.createSlideout(n);case 14:(o=t.sent).$container.on("submit",(function(t){t.preventDefault(),l.applySettings(e,o,a)})),o.on("close",(function(){o.destroy()})),this.trigger("createSettings");case 18:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return c.apply(this,arguments)}),createSlideout:function(t){return l(s().mark((function e(){var n,i,r,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$("<div/>",{class:"entry-type-override-settings-body"}),$("<div/>",{class:"fields",html:t.settingsHtml}).appendTo(n),i=$("<div/>",{class:"entry-type-override-settings-footer"}),$("<div/>",{class:"flex-grow"}).appendTo(i),r=Craft.ui.createButton({label:Craft.t("app","Close"),spinner:!0}).appendTo(i),Craft.ui.createSubmitButton({class:"secondary",label:Craft.t("app","Apply"),spinner:!0}).appendTo(i),a=n.add(i),(o=new Craft.Slideout(a,{containerElement:"form",containerAttributes:{action:"",method:"post",novalidate:"",class:"entry-type-override-settings"}})).on("open",(function(){Garnish.requestAnimationFrame((function(){o.$container.find(".text:first").focus()}))})),r.on("click",(function(){o.close()})),!t.headHtml){e.next=13;break}return e.next=13,Craft.appendHeadHtml(t.headHtml);case 13:if(!t.bodyHtml){e.next=16;break}return e.next=16,Craft.appendBodyHtml(t.bodyHtml);case 16:return Craft.initUiElements(o.$container),e.abrupt("return",o);case 18:case"end":return e.stop()}}),e)})))()},applySettings:function(t,e,i){var a=this;return l(s().mark((function o(){var l,c,u,h,d,f,p,g,m,v;return s().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return l=e.$container.find("button[type=submit]").addClass("loading"),e.$container.find(".field.has-errors").each((function(t,e){var n=$(e);n.removeClass("has-errors"),n.children(".input").removeClass("errors prevalidate"),n.children("ul.errors").remove()})),s.prev=2,s.prev=3,s.next=6,Craft.sendActionRequest("POST","entry-types/apply-override-settings",{data:{id:t.data("id"),settingsNamespace:i,settings:e.$container.serialize()}});case 6:u=s.sent,c=u.data,s.next=16;break;case 10:throw s.prev=10,s.t0=s.catch(3),(f=null===s.t0||void 0===s.t0||null===(h=s.t0.response)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.errors)&&Object.entries(f).forEach((function(t){var n=r(t,2),i=n[0],a=n[1],s=e.$container.find('[data-error-key="'.concat(i,'"]'));s.length&&Craft.ui.addErrorsToField(s,a)})),Craft.cp.displayError(null===s.t0||void 0===s.t0||null===(d=s.t0.response)||void 0===d||null===(d=d.data)||void 0===d?void 0:d.message),s.t0;case 16:p=$(c.chipHtml),t.find(".chip-label").replaceWith(p.find(".chip-label")),g=t.find("input"),m=n({},c.config),(v=JSON.parse(g.val()).group)&&(m.group=v),g.val(JSON.stringify(m)),Craft.initUiElements(t),a.trigger("applySettings"),e.close(),e.destroy();case 27:return s.prev=27,l.removeClass("loading"),s.finish(27);case 30:case"end":return s.stop()}}),o,null,[[2,,27,30],[3,10]])})))()},renderSettings:function(t){return Object.assign(this.base(),{inputValue:this.settings.allowOverrides?JSON.stringify({id:t}):null})}},{defaults:{allowOverrides:!1}})},4004:function(){Craft.ProgressBar=Garnish.Base.extend({$progressBar:null,$innerProgressBar:null,$progressBarStatus:null,intervalManager:null,_itemCount:0,_progressPercentage:null,_processedItemCount:0,_displaySteps:!1,init:function(t,e,n){var i=this;this.setSettings(n,Craft.ProgressBar.defaults),e&&(this._displaySteps=!0),this.$progressBar=$('<div class="progressbar pending hidden"/>').appendTo(t),this.$innerProgressBar=$('<div class="progressbar-inner"/>').appendTo(this.$progressBar),this.$progressBarStatus=$('<div class="progressbar-status hidden" />').insertAfter(this.$progressBar),this.settings.announceProgress&&(this.intervalManager=new Craft.IntervalManager({onInterval:function(){Craft.cp.announce(i.getProgressMessage.bind(i))}})),this.resetProgressBar()},resetProgressBar:function(){this.setProgressPercentage(100),this.$progressBar.addClass("pending"),this.setItemCount(1),this.setProcessedItemCount(0),this.$progressBarStatus.html(""),this._displaySteps&&this.$progressBar.addClass("has-status")},hideProgressBar:function(){this.$progressBar.addClass("hidden"),this.$progressBarStatus.addClass("hidden"),this.settings.announceProgress&&this.intervalManager.stop()},showProgressBar:function(){this.$progressBar.removeClass("hidden"),this.$progressBarStatus.removeClass("hidden"),this.settings.announceProgress&&this.intervalManager.start()},getProgressMessage:function(){return 100!==this._progressPercentage?Craft.t("app","{num} percent complete",{num:this._progressPercentage}):Craft.t("app","Processing")},setItemCount:function(t){this._itemCount=t},incrementItemCount:function(t){this._itemCount+=t},setProcessedItemCount:function(t){this._processedItemCount=t},incrementProcessedItemCount:function(t){this._processedItemCount+=t},updateProgressBar:function(){this._itemCount=Math.max(this._itemCount,1);var t=Math.min(100,Math.round(100*this._processedItemCount/this._itemCount));this.setProgressPercentage(t),this._displaySteps&&this.$progressBarStatus.html(this._processedItemCount+" / "+this._itemCount)},setProgressPercentage:function(t,e){this._progressPercentage=t,0===t?this.$progressBar.addClass("pending"):(this.$progressBar.removeClass("pending"),e?this.$innerProgressBar.velocity("stop").velocity({width:t+"%"},"fast"):this.$innerProgressBar.velocity("stop").width(t+"%"))}},{defaults:{announceProgress:!0}})},4172:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.CategoryIndex=Craft.BaseElementIndex.extend({editableGroups:null,$newCategoryBtnGroup:null,$newCategoryBtn:null,init:function(t,e,n){this.editableGroups=[],this.on("selectSource",this.updateButton.bind(this)),this.on("selectSite",this.updateButton.bind(this)),this.base(t,e,n)},afterInit:function(){var t=this;this.editableGroups=Craft.editableCategoryGroups.filter((function(e){return!!t.getSourceByKey("group:".concat(e.uid))})),this.base()},getDefaultSourceKey:function(){if("index"===this.settings.context&&"undefined"!=typeof defaultGroupHandle)for(var t=0;t<this.$sources.length;t++){var e=$(this.$sources[t]);if(e.data("handle")===defaultGroupHandle)return e.data("key")}return this.base()},updateButton:function(){var t=this;if(this.$source){var e=this.$source.data("handle");if(this.editableGroups.length){this.$newCategoryBtnGroup&&this.$newCategoryBtnGroup.remove();var n,r=this.editableGroups.find((function(t){return t.handle===e}));this.$newCategoryBtnGroup=$('<div class="btngroup submit" data-wrapper/>');var a="new-category-menu-"+Craft.randomString(10);if(r){var s="index"===this.settings.context?Craft.uppercaseFirst(Craft.t("app","New {type}",{type:Craft.elementTypeNames["craft\\elements\\Category"][2]})):Craft.t("app","New {group} category",{group:r.name}),o="index"===this.settings.context?Craft.t("app","New category in the {group} category group",{group:r.name}):s,l="index"===this.settings.context?"link":null;this.$newCategoryBtn=Craft.ui.createButton({label:s,ariaLabel:o,spinner:!0,role:l}).addClass("submit add icon").appendTo(this.$newCategoryBtnGroup),this.addListener(this.$newCategoryBtn,"click mousedown",(function(e){"index"===t.settings.context&&("click"===e.type&&Garnish.isCtrlKeyPressed(e)||"mousedown"===e.type&&1===e.originalEvent.button)?window.open(Craft.getUrl("categories/".concat(r.handle,"/new"))):"click"===e.type&&t._createCategory(r.id)})),this.editableGroups.length>1&&(n=$("<button/>",{type:"button",class:"btn submit menubtn btngroup-btn-last","aria-controls":a,"data-disclosure-trigger":"","aria-label":Craft.t("app","New category, choose a category group")}).appendTo(this.$newCategoryBtnGroup))}else this.$newCategoryBtn=n=Craft.ui.createButton({label:Craft.uppercaseFirst(Craft.t("app","New {type}",{type:Craft.elementTypeNames["craft\\elements\\Category"][2]})),ariaLabel:Craft.t("app","New category, choose a category group"),spinner:!0}).addClass("submit add icon menubtn btngroup-btn-last").attr("aria-controls",a).attr("data-disclosure-trigger","").appendTo(this.$newCategoryBtnGroup);if(this.addButton(this.$newCategoryBtnGroup),n){var c,u=$("<div/>",{id:a,class:"menu menu--disclosure"}).appendTo(this.$newCategoryBtnGroup),h=$("<ul/>").appendTo(u),d=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}(this.editableGroups);try{var f=function(){var e=c.value,i="index"===t.settings.context?"link":"button";if("index"===t.settings.context||e!==r){var a=$("<li/>").appendTo(h),s=$("<a/>",{role:"button"===i?"button":null,href:"#",type:"button"===i?"button":null,text:Craft.t("app","New {group} category",{group:e.name})}).appendTo(a);t.addListener(s,"click",(function(){n.data("trigger").hide(),t._createCategory(e.id)})),"button"===i&&t.addListener(s,"keydown",(function(i){i.keyCode===Garnish.SPACE_KEY&&(i.preventDefault(),n.data("trigger").hide(),t._createCategory(e.id))}))}};for(d.s();!(c=d.n()).done;)f()}catch(t){d.e(t)}finally{d.f()}new Garnish.DisclosureMenu(n)}}if("index"===this.settings.context){var p="categories";e&&(p+="/"+e),Craft.setPath(p)}}},_createCategory:function(t){var i=this;if(this.$newCategoryBtn.hasClass("loading"))console.warn("New category creation already in progress.");else{var r=this.editableGroups.find((function(e){return e.id===t}));if(!r)throw"Invalid category group ID: ".concat(t);this.$newCategoryBtn.addClass("loading"),Craft.cp.announce(Craft.t("app","Loading")),Craft.sendActionRequest("POST","elements/create",{data:{elementType:this.elementType,siteId:this.siteId,groupId:t}}).then((function(t){var a=t.data;"index"===i.settings.context?document.location.href=Craft.getUrl(a.cpEditUrl,{fresh:1}):Craft.createElementEditor(i.elementType,{siteId:i.siteId,elementId:a.element.id,draftId:a.element.draftId,params:{fresh:1,updateSearchIndexImmediately:1}}).on("submit",function(){var t,s=(t=e().mark((function t(n){var s;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s="group:".concat(r.uid),i.sourceKey===s){t.next=4;break}return t.next=4,i.asyncSelectSourceByKey(s);case 4:i.clearSearch(!1),i.startSearching(),i.$search.val(n.data.title),i.searchText=n.data.title,i.selectElementAfterUpdate(a.element.id),i.updateElements();case 10:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))});return function(t){return s.apply(this,arguments)}}())})).finally((function(){i.$newCategoryBtn.removeClass("loading")}))}}}),Craft.registerElementIndexClass("craft\\elements\\Category",Craft.CategoryIndex)},4398:function(){Craft.Tabs=Garnish.Base.extend({$container:null,$tablist:null,$menuBtn:null,$tabs:null,$firstTab:null,$lastTab:null,$selectedTab:null,$focusableTab:null,menu:null,init:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$container=$(t),this.setSettings(n,Craft.Tabs.defaults),this.$tablist=this.$container.find('> [role="tablist"]:first'),this.$tabs=this.$tablist.find('> [role="tab"]'),this.$firstTab=this.$tabs.first(),this.$lastTab=this.$tabs.last(),this.$selectedTab=this.$tabs.filter(".sel:first"),this.$focusableTab=this.$tabs.filter("[tabindex=0]:first"),this.$menuBtn=this.$container.find("> .menubtn:first").disclosureMenu(),this.menu=this.$menuBtn.data("trigger").$container,this.$container.data("tabs")&&(console.warn("Double-instantiating a tab manager on an element"),this.$container.data("tabs").destroy()),this.$container.data("tabs",this);for(var i=function(){var t=e.$tabs.eq(r),n=t.attr("href");n&&"#"===n.charAt(0)&&(e.addListener(t,"keydown",(function(t){[Garnish.SPACE_KEY,Garnish.RETURN_KEY].includes(t.keyCode)&&(t.preventDefault(),e.selectTab(t.currentTarget,!0))})),e.addListener(t,"click",(function(n){var i=t.attr("href");e.settings.handleCtrlClicks&&"#"===(null==i?void 0:i.charAt(0))&&Garnish.isCtrlKeyPressed(n)||(n.preventDefault(),e.selectTab(n.currentTarget,!0))}))),e.addListener(t,"keydown",(function(t){var n;[Garnish.LEFT_KEY,Garnish.RIGHT_KEY].includes(t.keyCode)&&$.contains(e.$tablist[0],t.currentTarget)?n=t.keyCode===("ltr"===Craft.orientation?Garnish.LEFT_KEY:Garnish.RIGHT_KEY)?(n=$(t.currentTarget).prevAll('[role="tab"]:not(.hidden):first')).length?n:e.$lastTab:(n=$(t.currentTarget).nextAll('[role="tab"]:not(.hidden):first')).length?n:e.$firstTab:t.keyCode!==Garnish.HOME_KEY&&t.keyCode!==Garnish.END_KEY||(n=t.keyCode===Garnish.HOME_KEY?e.$firstTab:e.$lastTab),n&&(t.preventDefault(),e.makeTabFocusable(n),n.focus(),e.scrollToTab(n))}))},r=0;r<this.$tabs.length;r++)i();this.updateMenuBtn(),Garnish.$win.on("resize",(function(){e.updateMenuBtn()}));var a=this.getMenuOptions();this.addListener(a,"activate",(function(t){var n=$(t.currentTarget),i=n.attr("href");if(e.settings.handleCtrlClicks&&"#"===(null==i?void 0:i.charAt(0))){if(Garnish.isCtrlKeyPressed(t.originalEvent))return;t.preventDefault()}e.selectTab(n.data("id")),e.$menuBtn.data("trigger").hide()}))},getMenuOptions:function(){return this.menu.find("a")},getSelectedTabIndex:function(){return this.$tabs.index(this.$selectedTab)},selectTab:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._getTab(t);if(n[0]!==this.$selectedTab[0]){this.deselectTab(),this.$selectedTab=n.addClass("sel").attr("aria-selected","true"),this.makeTabFocusable(n),e&&n.focus(),this.scrollToTab(n),this.getMenuOptions().removeClass("sel").removeAttr("aria-current"),this.getMenuOptions().filter('[data-id="'.concat(n.data("id"),'"]')).addClass("sel").attr("aria-current","true"),this.trigger("selectTab",{$tab:n}),$("#content").trigger("scroll");var i=n.closest(".slideout-container");i.length&&i.find(".so-content").trigger("scroll")}},deselectTab:function(){var t=this.$selectedTab.removeClass("sel").attr("aria-selected","false");this.$selectedTab=null,this.trigger("deselectTab",{$tab:t})},makeTabFocusable:function(t){var e=this._getTab(t);e[0]!==this.$focusableTab[0]&&(this.$focusableTab.attr("tabindex","-1"),this.$focusableTab=e.attr("tabindex","0"))},scrollToTab:function(t){var e=this._getTab(t),n=this.$tablist.scrollLeft(),i=e.offset().left-this.$tablist.offset().left,r=!1;if(i<0)r=n+i-24;else{var a=e.outerWidth(),s=this.$tablist.prop("clientWidth");i+a>s&&(r=n+(i-(s-a))+24)}!1!==r&&this.$tablist.scrollLeft(r)},updateMenuBtn:function(){Math.floor(this.$tablist.prop("scrollWidth")-48)>this.$container.prop("clientWidth")?(this.$tablist.addClass("scrollable"),this.$menuBtn.removeClass("hidden")):(this.$tablist.removeClass("scrollable"),this.$menuBtn.addClass("hidden"))},_getTab:function(t){if("number"==typeof t&&(t=this.$tabs.eq(t)),t instanceof jQuery)return t;if(t instanceof HTMLElement)return $(t);if("string"!=typeof t)throw"Invalid tab ID";var e=this.$tabs.filter('[data-id="'.concat(t,'"]'));if(!e.length)throw"Invalid tab ID: ".concat(t);return e},destroy:function(){this.$container.removeData("tabs"),this.base()}},{defaults:{handleCtrlClicks:!1}})},4500:function(){function t(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function i(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e,n){return(e=function(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(){"use strict";s=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,s=Object.create(r.prototype),o=new A(i||[]);return a(s,"_invoke",{value:T(t,n,o)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==n&&i.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(a,s,o,l){var c=f(t[a],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==r(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var s;a(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return s=s?s.then(r,r):r()}})}function T(e,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(e,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,D(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function n(){for(;++a<e.length;)if(i.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(r(e)+" is not iterable")}return w.prototype=C,a(x,"constructor",{value:C,configurable:!0}),a(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:P(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function o(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){o(a,i,r,s,l,"next",t)}function l(t){o(a,i,r,s,l,"throw",t)}s(void 0)}))}}var c,u,h,d;Craft.Preview=Garnish.Base.extend({elementEditor:null,tabManager:null,hasTabs:!1,$shade:null,editorId:null,$editorContainer:null,$editorHeader:null,$editorToolbar:null,$tabContainer:null,$content:null,$spinner:null,$editorFooter:null,$saveBtn:null,$dragHandle:null,$previewWrapper:null,$previewContainer:null,$previewSkipLink:null,$bumperLink:null,$notifier:null,$iframeContainer:null,$previewHeader:null,$targetBtn:null,$targetMenu:null,$deviceTypeContainer:null,$orientationBtn:null,$refreshBtn:null,$deviceMask:null,$devicePreviewContainer:null,$iframe:null,iframeLoaded:!1,isActive:!1,isVisible:!1,activeTarget:0,animationDuration:"slow",currentDeviceType:"desktop",deviceOrientation:null,deviceWidth:"",deviceHeight:"",deviceMaskDimensions:{phone:{width:375,height:753},tablet:{width:768,height:1110}},draftId:null,url:null,iframeHeight:null,scrollTop:null,scrollLeft:null,dragger:null,dragStartEditorWidth:null,_editorWidth:null,_editorWidthInPx:null,init:function(t){this.setSettings(t,Craft.Preview.defaults),this.editorWidth=Craft.getLocalStorage("LivePreview.editorWidth",Craft.Preview.defaultEditorWidth),Craft.Preview.instances.push(this),this.settings.standaloneMode&&this.open(!1)},get editorWidth(){return this._editorWidth},get editorWidthInPx(){return this._editorWidthInPx},set editorWidth(t){var e;t>=1?(e=t,t/=Garnish.$win.width()):e=Math.round(t*Garnish.$win.width()),e<Craft.Preview.minEditorWidthInPx&&(t=(e=Craft.Preview.minEditorWidthInPx)/Garnish.$win.width()),this._editorWidth=t,this._editorWidthInPx=e},open:(d=l(s().mark((function t(){var e,n=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!(n.length>0&&void 0!==n[0])||n[0],!this.isActive){t.next=3;break}return t.abrupt("return");case 3:if(this.cancelToken&&(this.ignoreFailedRequest=!0,this.cancelToken.cancel()),this.isActive=!0,this.trigger("beforeOpen"),$(document.activeElement).trigger("blur"),this.$editorContainer||this._buildUi(),this.handleWindowResize(),this.addListener(Garnish.$win,"resize","handleWindowResize"),this.$editorContainer.css(Craft.left,-this.editorWidthInPx+"px"),this.$dragHandle.css(Craft.left,this.editorWidthInPx-2+"px"),this.$previewContainer.css(Craft.right,-this.getIframeWidth()),this.slideIn(e),this.elementEditor){t.next=17;break}return t.next=17,this._loadElementEditor();case 17:this.trigger("open");case 18:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)}),_buildUi:function(){var t=this;this.editorId="lp-editor-".concat(Math.floor(1e8*Math.random()));var e=Craft.t("app","Skip to top of preview");if(this.$shade=$("<div/>",{class:"modal-shade dark"}).appendTo(Garnish.$bod),this.$previewWrapper=$("<div/>",{role:"dialog","aria-modal":"true","aria-labelledby":"lp-preview-heading"}).appendTo(Garnish.$bod),this.$modalLabel=$("<h2/>",{id:"lp-preview-heading",class:"visually-hidden",html:Craft.t("app","Preview")}).appendTo(this.$previewWrapper),this.$editorContainer=$("<form/>",{id:this.editorId,class:"lp-editor-container"}).appendTo(this.$previewWrapper),this.$previewContainer=$("<div/>",{class:"lp-preview-container",id:"lp-preview-container"}).appendTo(this.$previewWrapper),this.$notifier=$("<span/>",{class:"visually-hidden",role:"status"}).appendTo(this.$previewContainer),this.$editorHeader=$("<header/>",{class:"lp-editor-header"}).appendTo(this.$editorContainer),!this.settings.standaloneMode){var n=$("<button/>",{type:"button",class:"btn lp-close-btn","data-icon":"xmark",title:Craft.t("app","Close Preview"),"aria-label":Craft.t("app","Close Preview")}).appendTo(this.$editorHeader);this.addListener(n,"click","close")}this.$editorToolbar=$("<div/>",{class:"lp-toolbar"}).appendTo(this.$editorHeader),this.$tabContainer=$("<div/>",{class:"pane-tabs"}).appendTo(this.$editorToolbar),this.$content=$("<div/>",{class:"lp-content loading"}).appendTo(this.$editorContainer).append($("<div/>",{class:"spinner"})),this.$editorFooter=$("<footer/>",{class:"flex flex-nowrap"}).appendTo(this.$editorContainer),this.$dragHandle=$("<div/>",{class:"lp-draghandle"}).appendTo(Garnish.$bod),$("<div/>",{class:"flex-grow"}).appendTo(this.$editorHeader),this.$spinner=$("<div/>",{class:"spinner hidden",title:Craft.t("app","Saving")}).appendTo(this.$editorHeader),this.$statusMessage=$("<span/>",{class:"visually-hidden","aria-live":"polite"}).appendTo(this.$editorHeader),this.$previewSkipLink=$("<a/>",{class:"skip-link btn hidden",href:"#lp-preview-container",html:e}).appendTo(this.$editorHeader),this.$previewHeader=$("<header/>",{class:"lp-preview-header"}).appendTo(this.$previewContainer),this._buildDeviceTypeFieldset(),$('<div class="flex-grow"/>').appendTo(this.$previewHeader);var i=$('<div class="buttons"/>').appendTo(this.$previewHeader);this.$orientationBtn=$("<button/>",{type:"button",class:"btn disabled","data-icon":"rotate","aria-disabled":"true",text:Craft.t("app","Rotate"),"aria-label":Craft.t("app","Rotate")}).appendTo(i),this.addListener(this.$orientationBtn,"click","switchOrientation"),this.$refreshBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Refresh"),"data-icon":"refresh"}).appendTo(i),this.addListener(this.$refreshBtn,"click",(function(){t.updateIframe(!1,!0)})),this.deviceOrientation=Craft.getLocalStorage("LivePreview.orientation"),this.$iframeContainer=$("<div/>",{class:"lp-iframe-container"}).appendTo(this.$previewContainer),this.$devicePreviewContainer=$("<div/>",{class:"lp-device-preview-container"}).appendTo(this.$iframeContainer),this.$deviceMask=$("<div/>",{class:"lp-device-mask"}).appendTo(this.$iframeContainer),this.$bumperLink=$("<a/>",{class:"skip-link btn lp-preview-container__bumper-link",html:e,href:"#lp-preview-container"}),this.$bumperLink.appendTo(this.$previewContainer),this.dragger=new Garnish.BaseDrag(this.$dragHandle,{axis:Garnish.X_AXIS,onDragStart:this._onDragStart.bind(this),onDrag:this._onDrag.bind(this),onDragStop:this._onDragStop.bind(this)})},_loadElementEditor:(h=l(s().mark((function t(){var e,n,i,r,o,c,u,h,d,f=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.settings.onBeforeLoad();case 2:return this.cancelToken=axios.CancelToken.source(),t.prev=3,t.next=6,Craft.sendActionRequest("GET","elements/edit",{params:{elementType:this.settings.elementType,elementId:this.settings.elementId,draftId:this.settings.draftId,revisionId:this.settings.revisionId,siteId:this.settings.siteId},cancelToken:this.cancelToken.token,headers:{"X-Craft-Container-Id":this.editorId,"X-Craft-Namespace":this.namespace}});case 6:e=t.sent,t.next=16;break;case 9:if(t.prev=9,t.t0=t.catch(3),this.ignoreFailedRequest){t.next=14;break}throw Craft.cp.displayError(),t.t0;case 14:return this.ignoreFailedRequest=!1,t.abrupt("return");case 16:return t.prev=16,this.$content.removeClass("loading"),this.cancelToken=null,t.finish(16);case 20:return n=e.data,this.namespace=n.namespace,this.settings.standaloneMode&&(n.actionMenu&&(i=Craft.namespaceId("action-menu-label",this.namespace),r=Craft.namespaceId("action-menu",this.namespace),$("<label/>",{id:i,class:"visually-hidden",text:Craft.t("app","Actions")}).appendTo(this.$editorHeader),o=$("<button/>",{class:"btn action-btn header-btn",type:"button",title:Craft.t("app","Actions"),"aria-controls":r,"aria-describedby":i,"data-disclosure-trigger":"true"}).appendTo(this.$editorHeader),$(n.actionMenu).appendTo(this.$editorHeader),o.disclosureMenu()),n.editUrl&&$("<a/>",{target:"_blank",class:"btn header-btn",title:Craft.t("app","Open in a new tab"),"aria-label":Craft.t("app","Open in a new tab"),"data-icon":"external",href:n.editUrl}).appendTo(this.$editorHeader)),this.$content.html(n.content),this.$saveBtn=Craft.ui.createSubmitButton({label:Craft.t("app","Save"),spinner:!0}).appendTo(this.$editorFooter),this.updateTabs(n.tabs),n.formAttributes&&Craft.setElementAttributes(this.$editorContainer,n.formAttributes),this.$editorContainer.data("delta-names",e.data.deltaNames),this.$editorContainer.data("initial-delta-values",e.data.initialDeltaValues),this.$editorContainer.data("initialSerializedValue",this.$editorContainer.serialize()),t.next=32,Craft.appendHeadHtml(n.headHtml);case 32:return t.next=34,Craft.appendBodyHtml(n.bodyHtml);case 34:if(Craft.initUiElements(this.$editorContainer),this.elementEditor=new Craft.ElementEditor(this.$editorContainer,Object.assign({namespace:this.namespace,$contentContainer:this.$content,$actionBtn:this.$saveBtn,$spinnerContainer:this.$editorHeader,updateTabs:function(t){return f.updateTabs(t)},getTabManager:function(){return f.tabManager},handleSubmitResponse:function(t){f.settings.redirectUrl?document.location.href=f.settings.redirectUrl:window.location.reload()},handleSubmitError:function(){var t=l(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f.$saveBtn.addClass("loading"),t.next=3,l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))();case 3:return t.next=5,f.elementEditor.refreshContent(a({},f.elementEditor.namespaceInputName("prevalidate"),1));case 5:f.$saveBtn.removeClass("loading");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),autosaveDrafts:!0,saveParams:{setEnabled:0}},this.$editorContainer.data("elementEditorSettings"))),this.elementEditor.on("afterSaveDraft",(function(t){var e=t.response;f.trigger("afterSaveDraft",{response:e})})),this.elementEditor.on("update",(function(){f.updateIframe()})),this.elementEditor.on("beforeSubmit",(function(){f.$saveBtn.addClass("loading")})),this.elementEditor.on("afterSubmit",(function(){f.$saveBtn.removeClass("loading")})),Craft.cp.elementThumbLoader.load(this.$content),Craft.setFocusWithin(this.$content),this.elementEditor.settings.previewTargets.length>1){for(c=$('<div class="flex-grow"/>').insertAfter(this.$deviceTypeContainer),this.$targetBtn=$("<button/>",{type:"button",class:"btn menubtn",text:this.elementEditor.settings.previewTargets[0].label}).insertAfter(c),this.$targetMenu=$("<div/>",{class:"menu lp-target-menu"}).insertAfter(this.$targetBtn),u=$("<ul/>",{class:"padded"}).appendTo(this.$targetMenu),d=0;d<this.elementEditor.settings.previewTargets.length;d++)h=$("<li/>").appendTo(u),$("<a/>",{data:{target:d},text:this.elementEditor.settings.previewTargets[d].label,class:0===d?"sel":null}).appendTo(h);new Garnish.MenuBtn(this.$targetBtn,{onOptionSelect:function(t){f.switchTarget($(t).data("target"))}})}this.updateIframe(),Craft.ElementThumbLoader.retryAll(),this.$previewSkipLink.removeClass("hidden");case 46:case"end":return t.stop()}}),t,this,[[3,9,16,20]])}))),function(){return h.apply(this,arguments)}),_getDeviceTypeTranslation:function(t){var e;switch(t){case"phone":e=Craft.t("app","Mobile");break;case"tablet":e=Craft.t("app","Tablet");break;default:e=Craft.t("app","Desktop")}return e},_getDeviceOrientationTranslation:function(t){return"portrait"===t?Craft.t("app","Portrait"):Craft.t("app","Landscape")},_buildDeviceTypeFieldset:function(){var t=this;this.$deviceTypeContainer=$("<section/>",{class:"btngroup lp-device-type","aria-label":Craft.t("app","Device type")}).appendTo(this.$previewHeader),$("<button/>",{type:"button",class:"btn lp-device-type-btn--desktop active",title:Craft.t("app","Desktop"),"aria-label":Craft.t("app","Desktop"),"aria-pressed":"true",data:{width:"",height:"",deviceType:"desktop"}}).appendTo(this.$deviceTypeContainer),$("<button/>",{type:"button",class:"btn lp-device-type-btn--tablet",title:Craft.t("app","Tablet"),"aria-label":Craft.t("app","Tablet"),"aria-pressed":"false",data:{width:768,height:1024,deviceType:"tablet"}}).appendTo(this.$deviceTypeContainer),$("<button/>",{type:"button",class:"btn lp-device-type-btn--phone",title:Craft.t("app","Mobile"),"aria-label":Craft.t("app","Mobile"),"aria-pressed":"false",data:{width:375,height:667,deviceType:"phone"}}).appendTo(this.$deviceTypeContainer),this.deviceBtnGroup=new Craft.Listbox(this.$deviceTypeContainer,{onChange:function(e){t.switchDeviceType(e)}})},_activeTarget:function(){return this.elementEditor.settings.previewTargets[this.activeTarget]},_autoRefresh:function(){var t=this._activeTarget();return void 0===r(t.refresh)||!!t.refresh},switchTarget:function(t){this.activeTarget=t,this.$targetBtn.text(this.elementEditor.settings.previewTargets[t].label),this.$targetMenu.find("a.sel").removeClass("sel"),this.$targetMenu.find("a").eq(t).addClass("sel"),this.updateIframe(!0),this.trigger("switchTarget",{previewTarget:this.elementEditor.settings.previewTargets[t]})},handleWindowResize:function(){this.editorWidth=this.editorWidth,this.updateWidths()},slideIn:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isActive&&!this.isVisible&&($("html").addClass("noscroll"),this.$shade.velocity("fadeIn"),this.$editorContainer.show().velocity("stop").animateLeft(0,Garnish.getUserPreferredAnimationDuration(this.animationDuration),(function(){t.trigger("slideIn"),Garnish.$win.trigger("resize")})),this.$previewContainer.show().velocity("stop").animateRight(0,Garnish.getUserPreferredAnimationDuration(this.animationDuration)),this.isVisible=!0,Garnish.uiLayerManager.addLayer(this.$previewWrapper),Garnish.hideModalBackgroundLayers(),Craft.setFocusWithin(this.$previewWrapper),Craft.trapFocusWithin(this.$previewWrapper),Garnish.uiLayerManager.registerShortcut({keyCode:Garnish.S_KEY,ctrl:!0},function(){var e=l(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.elementEditor.checkForm();case 2:t.elementEditor.handleSubmit(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){t.close()})),e||(this.$editorContainer.velocity("finish"),this.$previewContainer.velocity("finish")))},close:(u=l(s().mark((function t(){var e=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isActive&&this.isVisible){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.elementEditor.checkForm();case 4:this.trigger("beforeClose"),$("html").removeClass("noscroll"),this.removeListener(Garnish.$win,"resize"),Garnish.uiLayerManager.removeLayer(),Garnish.resetModalBackgroundLayerVisibility(),Garnish.prefersReducedMotion()?this.$shade.velocity("fadeOut"):this.$shade.delay(200).velocity("fadeOut"),this.$editorContainer.velocity("stop").animateLeft(-this.editorWidthInPx,Garnish.getUserPreferredAnimationDuration(this.animationDuration),(function(){e.$editorContainer.hide(),e.trigger("slideOut")})),this.$previewContainer.velocity("stop").animateRight(-this.getIframeWidth(),Garnish.getUserPreferredAnimationDuration(this.animationDuration),(function(){e.$iframeContainer.removeClass("lp-iframe-container--rotating"),e.$previewContainer.hide()})),Craft.ElementThumbLoader.retryAll(),this.isActive=!1,this.isVisible=!1,this.trigger("close");case 16:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)}),updateTabs:function(t){var e=this;if(this.tabManager&&(this.tabManager.destroy(),this.tabManager=null,this.$tabContainer.html("")),this.hasTabs=!!t,this.hasTabs){var n=$(t);this.$tabContainer.replaceWith(n),this.$tabContainer=n,this.tabManager=new Craft.Tabs(this.$tabContainer),this.tabManager.on("deselectTab",(function(t){$(t.$tab.attr("href")).addClass("hidden")})),this.tabManager.on("selectTab",(function(t){$(t.$tab.attr("href")).removeClass("hidden"),Garnish.$win.trigger("resize"),e.$content.trigger("scroll")}))}},getIframeWidth:function(){return Garnish.$win.width()-this.editorWidthInPx},updateWidths:function(){this.$editorContainer.css("width",this.editorWidthInPx+"px"),this.$dragHandle.css(Craft.left,this.editorWidthInPx-2+"px"),this.$previewContainer.width(this.getIframeWidth()),this._devicePreviewIsActive()&&this.updateDevicePreview()},_useIframeResizer:function(){return!1!==Craft.previewIframeResizerOptions},updateIframe:function(t,e){var n=this;if(!this.isActive)return!1;t=!0===t,this.draftId===(this.draftId=this.elementEditor.settings.draftId)&&this.$iframe||(e=!0);var i=this._activeTarget();void 0===e&&(e=t||this._autoRefresh()),this.trigger("beforeUpdateIframe",{previewTarget:i,resetScroll:t,refresh:e}),e?this.elementEditor.getTokenizedPreviewUrl(i.url,"x-craft-live-preview").then((function(e){var i;t?(n.scrollTop=null,n.scrollLeft=null):n.iframeLoaded&&n.$iframe&&(n._useIframeResizer()?(n.iframeHeight=n.$iframe.height(),n.scrollTop=n.$iframeContainer.scrollTop(),n.scrollLeft=n.$iframeContainer.scrollLeft()):(i=Craft.isSameHost(e))&&n.$iframe[0].contentWindow&&(n.scrollTop=$(n.$iframe[0].contentWindow.document).scrollTop(),n.scrollLeft=$(n.$iframe[0].contentWindow.document).scrollLeft())),n.iframeLoaded=!1;var r=$("<iframe/>",{class:"lp-preview",frameborder:0,src:e,title:Craft.t("app","Preview")});n.$iframe?n.$iframe.replaceWith(r):r.appendTo(n.$devicePreviewContainer),n._useIframeResizer()?(t||null===n.iframeHeight||(r.height(n.iframeHeight),n.$iframeContainer.scrollTop(n.scrollTop),n.$iframeContainer.scrollLeft(n.scrollLeft)),iFrameResize($.extend({checkOrigin:!1,scrolling:!0,onInit:function(t){n.iframeLoaded=!0,n.iframeHeight=null,n.scrollTop=null,n.scrollLeft=null,t.scrolling="no"}},Craft.previewIframeResizerOptions||{}),r[0])):r.on("load",(function(){n.iframeLoaded=!0,!t&&i&&r[0].contentWindow.scrollTo(n.scrollLeft||0,n.scrollTop||0)})),n.url=e,n.$iframe=r,n._devicePreviewIsActive()&&n.updateDevicePreview(),n.trigger("afterUpdateIframe",{previewTarget:n.elementEditor.settings.previewTargets[n.activeTarget],$iframe:n.$iframe}),n.slideIn()})):this.slideIn()},_devicePreviewIsActive:function(){return"desktop"!==this.currentDeviceType},_updateNotifier:function(){var t=this;this.$notifier.html="";var e="desktop"===this.currentDeviceType?"Previewing {type} device":"Previewing {type} device in {orientation}",n={type:this._getDeviceTypeTranslation(this.currentDeviceType)};"desktop"!==this.currentDeviceType&&(n=i(i({},n),{orientation:this._getDeviceOrientationTranslation(this.deviceOrientation)}));var r=Craft.t("app",e,n);setTimeout((function(){t.$notifier.text(r)}),200)},switchDeviceType:function(t){this.$iframeContainer.removeClass("lp-iframe-container--rotating");var e=t.data("deviceType");if(e===this.currentDeviceType)return!1;this.currentDeviceType=e,this.deviceWidth=t.data("width"),this.deviceHeight=t.data("height"),"desktop"===this.currentDeviceType?(this.$orientationBtn.addClass("disabled").attr("aria-disabled","true"),this.$iframeContainer.removeClass("lp-iframe-container--has-device-preview")):(this.$orientationBtn.removeClass("disabled").removeAttr("aria-disabled"),this.$iframeContainer.addClass("lp-iframe-container--has-device-preview")),"tablet"===this.currentDeviceType?this.$iframeContainer.addClass("lp-iframe-container--tablet"):this.$iframeContainer.removeClass("lp-iframe-container--tablet"),this._updateNotifier(),"desktop"!==this.currentDeviceType&&this.updateDevicePreview()},switchOrientation:function(){var t=this;if(!this._devicePreviewIsActive())return!1;this.deviceOrientation&&"portrait"!==this.deviceOrientation?this.deviceOrientation="portrait":this.deviceOrientation="landscape",Craft.setLocalStorage("LivePreview.orientation",this.deviceOrientation),this.$iframeContainer.addClass("lp-iframe-container--rotating"),this.updateDevicePreview(),this._updateNotifier(),setTimeout((function(){t.$iframeContainer.removeClass("lp-iframe-container--rotating")}),300)},updateDevicePreview:function(){var t=1,e=1,n=1,i=this.$previewContainer.height()-50-48,r=this.$previewContainer.width()-48,a=this.deviceMaskDimensions[this.currentDeviceType].height,s=this.deviceMaskDimensions[this.currentDeviceType].width;"landscape"===this.deviceOrientation?(r<a&&(t=r/a),i<s&&(e=i/s)):(i<a&&(t=i/a),r<s&&(e=r/s)),n=t,e<t&&(n=e);var o=-100/n/2,l="landscape"===this.deviceOrientation?"-90deg":"0deg";this.$deviceMask.css({width:this.deviceMaskDimensions[this.currentDeviceType].width+"px",height:this.deviceMaskDimensions[this.currentDeviceType].height+"px",transform:"scale("+n+") translate("+o+"%, "+o+"%) rotate("+l+")"}),"landscape"===this.deviceOrientation?this.$devicePreviewContainer.css({width:this.deviceHeight+"px",height:this.deviceWidth+"px",transform:"scale("+n+") translate("+o+"%, "+o+"%)",marginTop:0,marginLeft:"-"+12*n+"px"}):this.$devicePreviewContainer.css({width:this.deviceWidth+"px",height:this.deviceHeight+"px",transform:"scale("+n+") translate("+o+"%, "+o+"%)",marginTop:"-"+12*n+"px",marginLeft:0})},_onDragStart:function(){this.dragStartEditorWidth=this.editorWidthInPx,this.$previewContainer.addClass("dragging")},_onDrag:function(){"ltr"===Craft.orientation?this.editorWidth=this.dragStartEditorWidth+this.dragger.mouseDistX:this.editorWidth=this.dragStartEditorWidth-this.dragger.mouseDistX,this.tabManager&&this.tabManager.updateMenuBtn(),this.updateWidths(),this.trigger("drag")},_onDragStop:function(){this.$previewContainer.removeClass("dragging"),Craft.setLocalStorage("LivePreview.editorWidth",this.editorWidth)},destroy:function(){var t=this;Craft.Preview.instances=Craft.Preview.instances.filter((function(e){return e!==t})),this.elementEditor.destroy(),delete this.elementEditor,this.base()}},{defaultEditorWidth:.33,minEditorWidthInPx:320,instances:[],defaults:{elementType:null,elementId:null,draftId:null,revisionId:null,siteId:null,standaloneMode:!1,redirectUrl:null,onBeforeLoad:(c=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},refresh:function(){var e,n=t(Craft.Preview.instances);try{for(n.s();!(e=n.n()).done;)e.value.updateIframe()}catch(t){n.e(t)}finally{n.f()}var i,r=t(Craft.LivePreview.instances);try{for(r.s();!(i=r.n()).done;)i.value.forceUpdateIframe()}catch(t){r.e(t)}finally{r.f()}},getActive:function(){var e,n=t(Craft.Preview.instances);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.isActive)return i}}catch(t){n.e(t)}finally{n.f()}}})},4581:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function n(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=u(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function r(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function a(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(){"use strict";s=function(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,s=Object.create(r.prototype),o=new A(i||[]);return a(s,"_invoke",{value:T(t,n,o)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==i&&r.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(a,s,o,l){var c=f(e[a],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&r.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var s;a(this,"_invoke",{value:function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return s=s?s.then(r,r):r()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,s=function t(){for(;++a<n.length;)if(r.call(n,a))return t.value=n[a],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,a(x,"constructor",{value:C,configurable:!0}),a(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function o(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){o(a,i,r,s,l,"next",t)}function l(t){o(a,i,r,s,l,"throw",t)}s(void 0)}))}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var d,f,p,g;Craft.ElementEditor=Garnish.Base.extend({isFullPage:null,$container:null,$activityContainer:null,$contentContainer:null,$sidebar:null,$spinner:null,$expandSiteStatusesBtn:null,$statusIcon:null,$previewBtn:null,metaModal:null,$nameTextInput:null,$saveMetaBtn:null,$siteStatusPane:null,$globalLightswitch:null,$siteLightswitches:null,$additionalSiteField:null,siteIds:null,newSiteIds:null,enableAutosave:null,lastSerializedValue:null,formObserver:null,cancelToken:null,ignoreFailedRequest:!1,queue:null,savingDraft:!1,saveDraftCallbacks:null,submittingForm:!1,draftElementIds:null,draftElementUids:null,failed:!1,httpStatus:null,httpError:null,preview:null,activatedPreviewToken:!1,previewTokenQueue:null,previewLinks:null,hiddenTipsStorageKey:"Craft-"+Craft.systemUid+".TipField.hiddenTips",activityTooltips:null,get tipDismissBtn(){return this.$container.find(".tip-dismiss-btn")},get slideout(){return this.$container.data("slideout")},get tabManager(){var t,e=this;return(null!==(t=this.settings.getTabManager)&&void 0!==t?t:function(){return e.isFullPage?Craft.cp.tabManager:null})()},init:function(t,e){var n,i,r,a,s,o=this;if(this.$container=$(t),this.$container.data("elementEditor")&&(console.warn("Double-instantiating an element editor on an element."),this.$container.data("elementEditor").destroy()),this.$container.data("elementEditor",this),this.$container.attr("data-element-editor",""),this.setSettings(e,Craft.ElementEditor.defaults),this.isFullPage=[Craft.cp.$primaryForm[0],Craft.cp.$main[0]].includes(this.$container[0]),this.$contentContainer=null!==(n=this.settings.$contentContainer)&&void 0!==n?n:this.isFullPage?$("#content"):$(),this.$sidebar=null!==(i=this.settings.$sidebar)&&void 0!==i?i:this.isFullPage?$("#details .details"):$(),this.queue=this._createQueue(),this.previewTokenQueue=this._createQueue(),this.draftElementIds={},this.draftElementUids={},this.enableAutosave=null!==(r=this.settings.autosaveDrafts)&&void 0!==r?r:Craft.autosaveDrafts,this.previewLinks=[],null!==(a=this.settings.previewTargets)&&void 0!==a&&a.length){var l,u,h=null!==(l=this.settings.$actionBtn)&&void 0!==l?l:this.isFullPage?$("#action-btn"):$(),d=this.namespaceId("action-view"),f=null===(u=h.data("disclosureMenu"))||void 0===u?void 0:u.$container.find('a[id^="'.concat(d,'-"]'));if(null!=f&&f.length){var p=f.attr("href");f.data("targetUrl",p).attr("href",this.getTokenizedPreviewUrl(p,null,!1)),this.previewLinks.push(f)}}this.siteIds=Object.keys(this.settings.siteStatuses).map((function(t){return parseInt(t)})),this.$previewBtn=this.$container.find(".preview-btn");var g=null!==(s=this.settings.$spinnerContainer)&&void 0!==s?s:this.isFullPage?$("#revision-indicators"):$();if(this.$spinner=$("<div/>",{class:"revision-spinner spinner hidden",title:Craft.t("app","Saving")}).appendTo(g),this.$statusIcon=$("<div/>",{class:"revision-status ".concat(this.isFullPage?"invisible":"hidden")}).appendTo(g),this.$expandSiteStatusesBtn=this.$container.find(".expand-status-btn"),this.settings.canEditMultipleSites&&(this.addListener(this.$expandSiteStatusesBtn,"click","expandSiteStatuses"),Garnish.$bod.on("activate","[data-cross-site-copy]",(function(t){var e,n=$(t.currentTarget),i=null===(e=n.closest(".menu").data("disclosureMenu"))||void 0===e?void 0:e.$trigger.closest(".field");i.closest(o.$container).length&&(t.preventDefault(),o.showFieldCopyModal(n,i))}))),this.settings.previewTargets.length&&this.isFullPage){this.settings.enablePreview&&this.addListener(this.$previewBtn,"click","openPreview");var m=this.$container.find(".preview-btn-container");if(1===this.settings.previewTargets.length){var v=c(this.settings.previewTargets,1)[0];this.createPreviewLink(v).addClass("view-btn btn").attr("aria-label",Craft.t("app","View")).appendTo(m)}else this.createShareMenu(m)}if(this.settings.canSave){if("FORM"!==this.$container.prop("tagName"))throw"Element editors may only be used with forms.";Craft.edition!==Craft.Solo&&(this.$activityContainer=this.$container.find(".activity-container"),this._checkActivity()),this.$container.data("serializer",(function(){return o.serializeForm(!0)})),this.$container.data("initialSerializedValue",this.serializeForm(!0)),Garnish.requestAnimationFrame((function(){o.$container.data("initialSerializedValue",o.serializeForm(!0))})),this.slideout||this.addListener(this.$container,"submit","handleSubmit"),this.settings.isProvisionalDraft?this.initForProvisionalDraft():this.settings.draftId&&!this.settings.isUnpublishedDraft?this.initForDraft():this.settings.canSaveCanonical||this.addListener(this.$container,"submit.saveShortcut",(function(t){t.saveShortcut&&(t.preventDefault(),o.saveDraft(),o.removeListener(o.$container,"submit.saveShortcut"))})),this.listenForChanges(),this.addListener(this.$statusIcon,"click",(function(){o.showStatusHud(o.$statusIcon)})),this.handleDismissibleTips(),this.isFullPage&&Craft.messageReceiver&&Craft.broadcaster.addEventListener("message",(function(t){if("saveDraft"===t.data.event&&t.data.canonicalId===o.settings.canonicalId&&(t.data.draftId===o.settings.draftId||t.data.isProvisionalDraft&&!o.settings.draftId)||"saveElement"===t.data.event&&t.data.id===o.settings.canonicalId&&!o.settings.draftId)(o.settings.reloadOnBroadcastSave||t.data.draftId!==o.settings.draftId)&&(Craft.setUrl(Craft.getUrl(document.location.href,{scrollY:window.scrollY})),window.location.reload());else if("deleteDraft"===t.data.event&&t.data.canonicalId===o.settings.canonicalId&&t.data.draftId===o.settings.draftId){var e=new URL(window.location.href);e.searchParams.delete("draftId"),e.href!==document.location.href?window.location.href=e:(Craft.setUrl(Craft.getUrl(document.location.href,{scrollY:window.scrollY})),window.location.reload())}})),this.activityTooltips={},this.isFullPage&&Craft.ui.setFocusOnErrorSummary(this.$container)}},_createQueue:function(){var t=this,e=new Craft.Queue;return e.on("beforeRun",(function(){t.showSpinner()})),e.on("afterRun",(function(){t.hideSpinner()})),e},get namespace(){return this.settings.namespace},namespaceInputName:function(t){return Craft.namespaceInputName(t,this.namespace)},namespaceId:function(t){return Craft.namespaceId(t,this.namespace)},get listeningForChanges(){return!!this.formObserver},get pauseLevel(){var t,e;return null!==(t=null===(e=this.formObserver)||void 0===e?void 0:e._pauseLevel)&&void 0!==t?t:0},listenForChanges:function(){var t=this;this.formObserver||(this.formObserver=new Craft.FormObserver(this.$container,(function(){t.checkForm()})))},stopListeningForChanges:function(){this.formObserver&&(this.formObserver.destroy(),this.formObserver=null)},pause:function(){var t,e=this;return null===(t=this.formObserver)||void 0===t||t.pause(),new Promise((function(t){e.savingDraft?e.saveDraftCallbacks.push((function(){t()})):t()}))},resume:function(){var t;null===(t=this.formObserver)||void 0===t||t.resume()},initForProvisionalDraft:function(){var t,e=this,n=this.$container.find(".discard-changes-btn");if(!n.length){var i,r,a,s=null!==(i=this.settings.$noticeContainer)&&void 0!==i?i:this.isFullPage?Craft.cp.$noticeContainer:this.$container.find(".so-notice");this.isFullPage&&(r=$("#content").height(),a=Garnish.$win.scrollTop());var o=$("<div/>",{class:"draft-notice"}).append($("<div/>",{class:"draft-icon","aria-hidden":"true","data-icon":"edit"})).append($("<p/>",{text:Craft.t("app","Showing your unsaved changes.")})).appendTo(s);if(n=$("<button/>",{type:"button",class:"discard-changes-btn btn",text:Craft.t("app","Discard")}).appendTo(o),this.isFullPage){var l=$("#content").height()-r;if(Garnish.$win.scrollTop(a+l),Garnish.$win.scrollTop()===a){Craft.cp.$contentContainer.css("pointer-events","none"),$("#content-header").css("min-height","auto");var c=s.height();s.css({height:c-l,overflow:"hidden"}).velocity({height:c},"fast",(function(){$("#content-header").css("min-height",""),s.css({height:"",overflow:""}),setTimeout((function(){Craft.cp.$contentContainer.css("pointer-events","")}),300)}))}}}this.addListener(n,"keypress,keyup,change,focus,blur,click,mousedown,mouseup",(function(t){t.stopPropagation()})),this.addListener(n,"click",(function(){confirm(Craft.t("app","Are you sure you want to discard your changes?"))&&e.queue.unshift((function(){return new Promise((function(t,n){e.isFullPage?Craft.submitForm(e.$container,{action:"elements/delete-draft",redirect:e.settings.hashedCpEditUrl,params:{draftId:e.settings.draftId,fieldId:e.settings.fieldId,ownerId:e.settings.ownerId,provisional:1}}):Craft.sendActionRequest("POST","elements/delete-draft",{data:{elementId:e.settings.canonicalId,draftId:e.settings.draftId,fieldId:e.settings.fieldId,ownerId:e.settings.ownerId,siteId:e.settings.siteId,provisional:1}}).then((function(t){var n;Craft.cp.displaySuccess(t.data.message),Craft.broadcaster.postMessage({event:"saveElement",id:e.settings.canonicalId}),null===(n=e.slideout)||void 0===n||n.close()})).catch(n)}))}))})),this.isFullPage||null===(t=this.slideout)||void 0===t||t.$cancelBtn.text(Craft.t("app","Close"))},initForDraft:function(){var t=this;this.createEditMetaAction(),this.settings.canSaveCanonical&&Garnish.uiLayerManager.registerShortcut({keyCode:Garnish.S_KEY,ctrl:!0,alt:!0},(function(){Craft.submitForm(t.$container,{action:"elements/apply-draft",redirect:t.settings.hashedCpEditUrl})}),0)},expandSiteStatuses:function(){var t=this;this.removeListener(this.$expandSiteStatusesBtn,"click"),this.$expandSiteStatusesBtn.velocity({opacity:0},"fast",(function(){t.$expandSiteStatusesBtn.remove()}));var e=this.$container.find(".enabled-for-site-".concat(this.settings.siteId,"-field"));if(this.$siteStatusPane=e.parent(),this.settings.revisionId)this._getOtherSupportedSites().forEach((function(e){return t._createSiteStatusField(e)}));else{e.addClass("nested");var n=Craft.ui.createLightswitchField({label:Craft.t("app","Enabled for all sites"),name:this.namespaceInputName("enabled")}).insertBefore(e);n.find("label").css("font-weight","bold"),this.$globalLightswitch=n.find(".lightswitch"),this.settings.revisionId||this._showField(n);var i=Object.values(this.settings.siteStatuses),r=i.includes(!0),a=i.includes(!1),s=r&&a?"-":r?"1":"",o=encodeURIComponent(this.namespaceInputName("enabledForSite[".concat(this.settings.siteId,"]")))+"="+(this.settings.enabledForSite?"1":"");this.$siteLightswitches=e.find(".lightswitch").on("change",this._updateGlobalStatus.bind(this)),this._getOtherSupportedSites().forEach((function(e){return t._createSiteStatusField(e)}));for(var l=encodeURIComponent(this.namespaceInputName("enabled"))+"=".concat(s),c=0;c<this.$siteLightswitches.length;c++){var u=this.$siteLightswitches.eq(c).data("lightswitch").$input;l+="&"+encodeURIComponent(u.attr("name"))+"="+u.val()}this.$container.data("initialSerializedValue",this.$container.data("initialSerializedValue").replace(o,l)),this.lastSerializedValue&&(this.lastSerializedValue=this.lastSerializedValue.replace(o,l)),this.settings.additionalSites&&this.settings.additionalSites.length&&this._createAddlSiteField(),this.$globalLightswitch.focus(),this.$globalLightswitch.on("change",this._updateSiteStatuses.bind(this)),this._updateGlobalStatus()}},showFieldCopyModal:function(t,e){var n=this,i="cross-site-copy-heading-"+Math.floor(1e6*Math.random()),r=$("<div/>",{class:"modal fitted cross-site-copy-modal","aria-labelledby":i}),a=$("<div/>",{class:"body"}).appendTo(r);a.append('<div class="header"><h1 id="'.concat(i,'" class="h2">').concat(Craft.t("app","Copy “{name}” value",{name:t.data("label")}),"</h1></div>"));var o=Craft.createForm().appendTo(a);o.append(Craft.getCsrfInput());var c=$("<div/>",{class:"flex flex-end flex-nowrap"}).appendTo(o),u=Craft.ui.createSelectField({label:Craft.t("app","Copy from"),class:["fullwidth"],options:this._getOtherSupportedSites().map((function(t){return{label:t.name,value:t.id}}))}).addClass("flex-grow").appendTo(c);Craft.ui.createSubmitButton({label:Craft.t("app","Copy"),spinner:!0}).appendTo(c);var h=new Garnish.Modal(r),d=u.find("select").focus();this.addListener(o,"submit",function(){var i=l(s().mark((function i(r){var a,l,c,u,f,p,g,m;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r.preventDefault(),(a=o.find("[type=submit]")).addClass("loading"),Craft.cp.announce(Craft.t("app","Loading")),i.prev=4,i.next=7,Craft.sendActionRequest("POST","elements/copy-values-from-site",{data:{elementId:n.getDraftElementId(t.data("element-id")),siteId:n.settings.siteId,fromSiteId:parseInt(d.val()),layoutElementUid:t.data("layout-element"),namespace:t.data("namespace")}});case 7:return l=i.sent,c=l.data,u=c.fieldHtml,f=c.headHtml,p=c.bodyHtml,g=c.message,m=$(u),e.replaceWith(m),i.next=13,Craft.appendHeadHtml(f);case 13:return i.next=15,Craft.appendBodyHtml(p);case 15:Craft.initUiElements(m),h.$triggerElement=m.find("[data-disclosure-trigger]"),Craft.cp.displaySuccess(g);case 18:return i.prev=18,a.removeClass("loading"),Craft.cp.announce(Craft.t("app","Loading complete")),h.hide(),i.finish(18);case 23:case"end":return i.stop()}}),i,null,[[4,,18,23]])})));return function(t){return i.apply(this,arguments)}}())},_getOtherSupportedSites:function(){var t=this;return Craft.sites.filter((function(e){return e.id!=t.settings.siteId&&t.siteIds.includes(e.id)}))},_showField:function(t){var e=t.height();t.css({overflow:"hidden","min-height":"auto"}).height(0).velocity({height:e},"fast",(function(){t.css({overflow:"",height:"","min-height":""})}))},_removeField:function(t){t.css({overflow:"hidden","min-height":"auto"}).velocity({height:0},"fast",(function(){t.remove()}))},_updateGlobalStatus:function(){var t=!0,e=!0;this.$siteLightswitches.each((function(){if($(this).data("lightswitch").on?e=!1:t=!1,!t&&!e)return!1})),t?this.$globalLightswitch.data("lightswitch").turnOn(!0):e?this.$globalLightswitch.data("lightswitch").turnOff(!0):this.$globalLightswitch.data("lightswitch").turnIndeterminate(!0)},_updateSiteStatuses:function(){var t=this.$globalLightswitch.data("lightswitch").on;this.$siteLightswitches.each((function(){t?$(this).data("lightswitch").turnOn(!0):$(this).data("lightswitch").turnOff(!0)}))},_createSiteStatusField:function(t,e){var n=Craft.ui.createLightswitchField({fieldClass:"enabled-for-site-".concat(t.id,"-field"),label:t.name,name:this.namespaceInputName("enabledForSite[".concat(t.id,"]")),on:void 0!==e?e:!this.settings.siteStatuses.hasOwnProperty(t.id)||this.settings.siteStatuses[t.id],disabled:!!this.settings.revisionId});if(this.$additionalSiteField?n.insertBefore(this.$additionalSiteField):n.appendTo(this.$siteStatusPane),!this.settings.revisionId){n.addClass("nested");var i=n.find(".lightswitch").on("change",this._updateGlobalStatus.bind(this));this.$siteLightswitches=this.$siteLightswitches.add(i)}return this._showField(n),n},_createAddlSiteField:function(){var t=this,e=Craft.sites.filter((function(e){return!t.siteIds.includes(e.id)&&t.settings.additionalSites.some((function(t){return t.siteId==e.id}))}));if(e.length){var n="add-site-label",i=$("<span/>",{text:Craft.t("app","Add a site..."),class:"visually-hidden",id:n}),r=Craft.ui.createSelect({options:[{label:Craft.t("app","Add a site…")}].concat(a(e.map((function(t){return{label:t.name,value:t.id}})))),labelledBy:n}).addClass("fullwidth");this.$additionalSiteField=Craft.ui.createField(r,{}).addClass("nested add").appendTo(this.$siteStatusPane),i.prependTo(this.$additionalSiteField);var s=r.find("select");s.on("change",(function(){var e=parseInt(s.val()),n=Craft.sites.find((function(t){return t.id===e}));if(n){var i=t.settings.additionalSites.find((function(t){return t.siteId==n.id}));t._createSiteStatusField(n,i.enabledByDefault),t._updateGlobalStatus(),s.val("").find('option[value="'.concat(e,'"]')).remove(),null===t.newSiteIds&&(t.newSiteIds=[]),t.siteIds.push(e),t.newSiteIds.push(e),1===s.find("option").length&&t._removeField(t.$additionalSiteField)}})),this._showField(this.$additionalSiteField)}},showStatusHud:function(t){var e;this.failed?(e='<p class="error"><strong>'.concat(this._saveFailMessage(),"</strong></p>"),this.httpError&&(e+='<p class="http-error code">'.concat(Craft.escapeHtml(this.httpError),"</p>")),400===this.httpStatus&&(e+='<button class="btn refresh-btn">'.concat(Craft.t("app","Refresh"),"</button>"))):e="<p>".concat(this._saveSuccessMessage(),"</p>");var n=new Garnish.HUD(t,e,{hudClass:"hud revision-status-hud",onHide:function(){n.destroy()}});n.$mainContainer.find(".refresh-btn").on("click",(function(){window.location.reload()}))},_saveSuccessMessage:function(){return this.settings.isProvisionalDraft||this.settings.isUnpublishedDraft?Craft.t("app","Your changes have been stored."):Craft.t("app","The draft has been saved.")},_saveFailMessage:function(){return this.settings.isProvisionalDraft||this.settings.isUnpublishedDraft?Craft.t("app","Your changes could not be stored."):Craft.t("app","The draft could not be saved.")},spinners:function(){return this.$spinner},showSpinner:function(){this.spinners().removeClass("hidden")},hideSpinner:function(){this.spinners().addClass("hidden")},statusIcons:function(){return this.$statusIcon},createEditMetaAction:function(){if(this.isFullPage){var t,e=$("#action-menu").disclosureMenu().data("disclosureMenu"),n=e.getFirstDestructiveGroup(),i=e.addGroup(null,!0,n),r=e.addItem({type:"button",icon:(t=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("edit");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)}),label:Craft.t("app","Edit draft settings")},i);this.addListener(r,"click","showMetaModal")}},createPreviewLink:function(t,e){var n=this,i=$("<a/>",{href:this.getTokenizedPreviewUrl(t.url,null,!1),text:e||Craft.t("app","View"),target:"_blank",data:{targetUrl:t.url,targetLabel:t.label}});return this.addListener(i,"click",(function(){decodeURIComponent(i.attr("href")).match(/\bpreview\/create-token\b/)&&setTimeout((function(){n.activatePreviewToken()}),1)})),this.previewLinks.push(i),i},updatePreviewLinks:function(){var t=this;this.previewLinks.forEach((function(e){t.updatePreviewLinkHref(e),t.activatedPreviewToken&&t.removeListener(e,"click")}))},updatePreviewLinkHref:function(t){t.attr("href",this.getTokenizedPreviewUrl(t.data("targetUrl"),null,!1))},activatePreviewToken:function(){this.activatedPreviewToken=!0,this.updatePreviewLinks()},createShareMenu:function(t){var e=this,n=$("<button/>",{type:"button",class:"view-btn btn menubtn",text:Craft.t("app","View")}).appendTo(t),i=$("<div/>",{class:"menu"}).appendTo(t),r=$("<ul/>").appendTo(i);this.settings.previewTargets.forEach((function(t){$("<li/>").append(e.createPreviewLink(t,t.label)).appendTo(r)})),new Garnish.MenuBtn(n)},getPreviewTokenParams:function(){var t={elementType:this.settings.elementType,canonicalId:this.settings.canonicalId,siteId:this.settings.siteId,revisionId:this.settings.revisionId,previewToken:this.settings.previewToken};return this.settings.draftId&&!this.settings.isProvisionalDraft&&(t.draftId=this.settings.draftId),t},getPreviewToken:function(){var t=this;return this.previewTokenQueue.push((function(){return new Promise((function(e,n){t.activatedPreviewToken?e(t.settings.previewToken):Craft.sendActionRequest("POST","preview/create-token",{data:t.getPreviewTokenParams()}).then((function(){t.activatePreviewToken(),e(t.settings.previewToken)})).catch(n)}))}))},getTokenizedPreviewUrl:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r={},a=this.settings.previewParamValue&&(e||!this.settings.isLive);if(a&&(r[e||"x-craft-preview"]=this.settings.previewParamValue),this.settings.siteToken&&(r[Craft.siteToken]=this.settings.siteToken),!a){var s=Craft.getUrl(t,r);return i?new Promise((function(t){t(s)})):s}if(!this.settings.previewToken)throw"Missing preview token";r[Craft.tokenParam]=this.settings.previewToken;var o=Craft.getUrl(t,r);if(this.activatedPreviewToken)return i?new Promise((function(t){t(o)})):o;if(i)return new Promise((function(t,e){n.getPreviewToken().then((function(){t(o)})).catch(e)}));var l=this.getPreviewTokenParams();return l.redirect=o,Craft.getActionUrl("preview/create-token",l)},getPreview:function(){var t,e,n,i=this;return this.preview&&!this.preview.isVisible&&(null===(t=this.preview.elementEditor)||void 0===t?void 0:t.settings.updatedTimestamp)!==this.settings.updatedTimestamp&&(this.preview.destroy(),delete this.preview),this.preview||(this.preview=new Craft.Preview({elementType:this.settings.elementType,elementId:this.settings.isProvisionalDraft?this.settings.canonicalId:this.settings.elementId,draftId:this.settings.isProvisionalDraft?null:this.settings.draftId,revisionId:this.settings.revisionId,siteId:this.settings.siteId,onBeforeLoad:(n=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.checkForm(!1,!0);case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}),this.preview.on("open",(function(){e=i.settings.updatedTimestamp,i.pause()})),this.preview.on("close",l(s().mark((function t(){var n,r,a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.$previewBtn&&i.$previewBtn.focus(),i.settings.updatedTimestamp===e){t.next=4;break}return t.next=4,i.refreshContent();case 4:null!==(a=null!==(n=null===(r=i.preview.tabManager)||void 0===r?void 0:r.getSelectedTabIndex())&&void 0!==n?n:null)&&(null===(o=i.tabManager)||void 0===o||o.selectTab(a)),i.resume();case 7:case"end":return t.stop()}}),t)})))),this.preview.on("afterSaveDraft",(function(t){var e=t.response;i._handleSaveDraftResponse(e)}))),this.preview},openPreview:(g=l(s().mark((function t(){var e,n,i,r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Garnish.hasAttr(this.$previewBtn,"aria-disabled")){t.next=2;break}return t.abrupt("return");case 2:return this.$previewBtn.attr("aria-disabled",!0),t.prev=3,i=this.getPreview(),t.next=7,i.open();case 7:null!==(r=null!==(e=null===(n=this.tabManager)||void 0===n?void 0:n.getSelectedTabIndex())&&void 0!==e?e:null)&&(null===(a=i.tabManager)||void 0===a||a.selectTab(r));case 9:return t.prev=9,this.$previewBtn.removeAttr("aria-disabled"),t.finish(9);case 12:case"end":return t.stop()}}),t,this,[[3,,9,12]])}))),function(){return g.apply(this,arguments)}),ensureIsDraftOrRevision:function(t){var e=this;return new Promise((function(n,i){if(e.settings.draftId||e.settings.revisionId)n();else{if(t&&e.serializeForm(!0)===e.$container.data("initialSerializedValue"))return void n();e.saveDraft().then(n).catch(i)}}))},setFormValue:function(t,e){var n=this;return l(s().mark((function i(){return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n.settings.revisionId){i.next=2;break}throw"Unable to set form values on a revision.";case 2:return i.next=4,n.checkForm();case 4:if(!n.$container.serialize().split("&").includes("".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e)))){i.next=7;break}return i.abrupt("return",!1);case 7:if($("<input/>",{type:"hidden",name:t,value:e}).prependTo(n.$container),!n.settings.canCreateDrafts){i.next=11;break}return i.next=11,n.saveDraft();case 11:return i.abrupt("return",!0);case 12:case"end":return i.stop()}}),i)})))()},markDeltaNameAsModified:function(t){var e=this;return l(s().mark((function n(){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=e.$container.data("modified-delta-names")||[]).includes(t)){n.next=6;break}return i.push(t),e.$container.data("modified-delta-names",i),n.next=6,e.saveDraft();case 6:case"end":return n.stop()}}),n)})))()},serializeForm:function(t){var e=this.$container.serialize();if(t&&!this.settings.isUnpublishedDraft){var n=encodeURIComponent(this.namespaceInputName("action")),i=encodeURIComponent(this.namespaceInputName("redirect"));e=(e=e.replace(new RegExp("&".concat(Craft.escapeRegex(n),"=[^&]*")),"")).replace(new RegExp("&".concat(Craft.escapeRegex(i),"=[^&]*")),"")}var r={serialized:e=e.replace(/&elementindex-[^&]*/g,"")};return this.trigger("serializeForm",{data:r}),r.serialized},checkForm:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.queue.push((function(){return new Promise((function(i,r){if(e.settings.revisionId)i();else if(e.savingDraft&&e.saveDraftCallbacks.push(l(s().mark((function a(){return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.checkForm(t,n);case 3:a.next=9;break;case 5:return a.prev=5,a.t0=a.catch(0),r(a.t0),a.abrupt("return");case 9:i();case 10:case"end":return a.stop()}}),a,null,[[0,5]])})))),void 0!==e.$container.data("initialSerializedValue")){var a=e.serializeForm(!0);t||a!==(e.lastSerializedValue||e.$container.data("initialSerializedValue"))?(null!=n?n:e.enableAutosave)&&e.settings.canCreateDrafts?e._saveDraftInternal(a).then(i).catch((function(t){console.warn("Couldn’t save draft:",t),r(t)})):e.updateFieldLayout(a).then(i).catch((function(t){console.warn("Couldn’t update field layout:",t),r(t)})):i()}else setTimeout(l(s().mark((function a(){return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.checkForm(t,n);case 3:a.next=9;break;case 5:return a.prev=5,a.t0=a.catch(0),r(a.t0),a.abrupt("return");case 9:i();case 10:case"end":return a.stop()}}),a,null,[[0,5]])}))),500)}))}))},refreshContent:function(t){var e=this;return l(s().mark((function n(){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.settings.visibleLayoutElements={},e.settings.staticLayoutElements={},(i=[e.serializeForm(!0)]).push($.param(r({},e.namespaceInputName("applyParams"),0))),t&&!$.isEmptyObject(t)&&i.push($.param(t)),n.next=7,e.updateFieldLayout(i.join("&"));case 7:case"end":return n.stop()}}),n)})))()},isPreviewActive:function(){return this.preview&&this.preview.isActive},saveDraft:function(){var t=this;return this.queue.push((function(){return new Promise((function(e,n){t._saveDraftInternal(t.serializeForm(!0)).then(e).catch(n)}))}))},_saveDraftInternal:(p=l(s().mark((function t(e){var o,l,u,h,d,f,p,g,m,v,y,b,w,C,_,S,x,I,E,T,D,L,k,A,P,F,M,B,O,H,R,j,G,N,U,z,W,Y,V=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.submittingForm){t.next=2;break}throw"Form already being submitted.";case 2:if(!this.savingDraft){t.next=4;break}throw"Draft already being saved.";case 4:this.lastSerializedValue=e,this.savingDraft=!0,this.saveDraftCallbacks=[],this.failed=!1,this.httpStatus=null,this.httpError=null,this.cancelToken=axios.CancelToken.source(),this.statusIcons().velocity("stop").css("opacity","").removeClass("hidden invisible checkmark-icon alert-icon fade-out").addClass("hidden"),this.$saveMetaBtn&&this.$saveMetaBtn.addClass("active"),u=Craft.findModifiedDeltaNames(this.$container.data("initialSerializedValue"),e,this.$container.data("delta-names"),this.$container.data("initial-delta-values"),this.$container.data("modified-delta-names"),!0),h=c(u,1),d=h[0],f=this.prepareData(e,null,!0),p=$(),g=i(d);try{for(g.s();!(m=g.n()).done;)v=m.value,y=p=p.add(this.$container.find('.field[data-base-input-name="'.concat($.escapeSelector(v),'"]'))),p=p.add(y).add(y.parentsUntil(this.$container,".field"))}catch(t){g.e(t)}finally{g.f()}return f.push($.param(r({},this.namespaceInputName("visibleLayoutElements"),this.settings.visibleLayoutElements)),$.param(r({},this.namespaceInputName("staticLayoutElements"),this.settings.staticLayoutElements))),!this.settings.isProvisionalDraft&&this.settings.draftId||f.push("".concat(this.namespaceInputName("provisional"),"=1")),(b=this.$contentContainer.children("[data-layout-tab]:not(.hidden)").data("id"))&&f.push("".concat(this.namespaceInputName("selectedTab"),"=").concat(b)),t.prev=22,t.next=25,Craft.sendActionRequest("POST","elements/save-draft",{cancelToken:this.cancelToken.token,headers:this._saveHeaders,data:f.join("&")});case 25:w=t.sent,t.next=38;break;case 28:if(t.prev=28,t.t0=t.catch(22),this._afterSaveDraft(),C=this.ignoreFailedRequest,this.ignoreFailedRequest=!1,C){t.next=38;break}throw this.failed=!0,t.t0&&t.t0.response&&(this.httpStatus=t.t0.response.status,this.httpError=t.t0.response.data?t.t0.response.data.message:null),this._showFailStatus(),t.t0;case 38:t.prev=38,this.savingDraft=!1,_=a(this.saveDraftCallbacks),this.saveDraftCallbacks=[],S=i(_),t.prev=43,S.s();case 45:if((x=S.n()).done){t.next=51;break}return I=x.value,t.next=49,I();case 49:t.next=45;break;case 51:t.next=56;break;case 53:t.prev=53,t.t1=t.catch(43),S.e(t.t1);case 56:return t.prev=56,S.f(),t.finish(56);case 59:return t.finish(38);case 60:return this._afterSaveDraft(),this.settings.previewParamValue=w.data.previewParamValue,t.next=64,this._afterUpdateFieldLayout(e,b,w);case 64:if(E={},null!==(o=w.data.deltaNames)&&void 0!==o&&o.length){T=this.$container.data("delta-names"),T=Array.isArray(T)?a(T):[],D=[],L=i(w.data.deltaNames);try{for(L.s();!(k=L.n()).done;)A=k.value,-1===T.indexOf(A)&&(T.push(A),D.push(A))}catch(t){L.e(t)}finally{L.f()}if(D.length)for(this.$container.data("delta-names",T),P=Craft.groupParams(this.serializeForm(),D),F=0,M=Object.entries(P);F<M.length;F++){(B=c(M[F],2))[0],O=B[1],H=i(O);try{for(H.s();!(R=H.n()).done;)j=R.value,G=j.split("=",2),N=c(G,2),U=N[0],z=N[1],E[decodeURIComponent(U)]=decodeURIComponent(z)}catch(t){H.e(t)}finally{H.f()}}}for(this._handleSaveDraftResponse(w),$.isPlainObject(w.data.draftElementUids)&&(this.draftElementUids=n(n({},this.draftElementUids),w.data.draftElementUids)),W=w.data.modifiedAttributes.map((function(t){return t=V.namespaceInputName(t),['[name="'.concat(t,'"]'),'[name^="'.concat(t,'["]')]})).flat().join(","),p=p.add(this.$contentContainer.find(W).parentsUntil(this.$container,".flex-fields > .field")).add(null===(l=this.$sidebar)||void 0===l?void 0:l.find(W).closest(".field")).not(".no-status,:has(> .status-badge)"),Y=0;Y<p.length;Y++)p.eq(Y).prepend($("<div/>",{class:"status-badge modified","aria-hidden":"true",title:Craft.t("app","This field has been modified.")}).append($("<span/>",{class:"visually-hidden",html:Craft.t("app","This field has been modified.")})));this.afterUpdate(this.lastSerializedValue,E),this.trigger("afterSaveDraft",{response:w}),Craft.broadcaster&&Craft.broadcaster.postMessage({pageId:Craft.pageId,event:"saveDraft",canonicalId:this.settings.canonicalId,draftId:this.settings.draftId,isProvisionalDraft:this.settings.isProvisionalDraft});case 74:case"end":return t.stop()}}),t,this,[[22,28,38,60],[43,53,56,59]])}))),function(t){return p.apply(this,arguments)}),_handleSaveDraftResponse:function(t){var e=this,i=!this.settings.draftId;i&&(this.settings.isProvisionalDraft=!0),this.isFullPage&&(t.data.title&&this.$container.find(".screen-title").text(t.data.title),t.data.docTitle&&(document.title=t.data.docTitle)),this.newSiteIds&&(this.newSiteIds.forEach((function(t){var n=e.settings.additionalSites.find((function(e){return e.siteId==t})),i=!n||void 0===n.enabledByDefault||n.enabledByDefault;Craft.cp.showSiteCrumbMenuItem(t),Craft.cp.setSiteCrumbMenuItemStatus(t,i?"enabled":"disabled")})),this.newSiteIds=null),this.settings.isProvisionalDraft?i&&(this.$container.find("input.action-input").attr("value","elements/apply-draft"),this.settings.elementId=t.data.elementId,this.settings.draftId=t.data.draftId,this.settings.isLive=!1,this.previewToken=null,this.initForProvisionalDraft()):(this.settings.draftName=t.data.draftName,this.isFullPage&&Craft.cp.updateContext(t.data.draftName,t.data.creator?Craft.t("app","Saved {timestamp} by {creator}",{timestamp:t.data.timestamp,creator:t.data.creator}):Craft.t("app","Saved {timestamp}",{timestamp:t.data.timestamp}))),t.data.previewTargets&&JSON.stringify(t.data.previewTargets)!==JSON.stringify(this.settings.previewTargets)&&this.updatePreviewTargets(t.data.previewTargets),i&&(this.updatePreviewLinks(),this.trigger("createProvisionalDraft")),this.$nameTextInput&&this.checkMetaValues(),$.isPlainObject(t.data.draftElementIds)&&(this.draftElementIds=n(n({},this.draftElementIds),t.data.draftElementIds)),this.settings.updatedTimestamp=t.data.updatedTimestamp,this.settings.canonicalUpdatedTimestamp=t.data.canonicalUpdatedTimestamp},_afterSaveDraft:function(){this.$saveMetaBtn&&this.$saveMetaBtn.removeClass("active")},_showFailStatus:function(){this.statusIcons().velocity("stop").css("opacity","").removeClass("hidden checkmark-icon").addClass("alert-icon"),this.setStatusMessage(this._saveFailMessage())},updateFieldLayout:(f=l(s().mark((function t(e){var n,i,a,o,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.submittingForm){t.next=2;break}throw"Form already being submitted.";case 2:return this.lastSerializedValue=e,this.cancelToken=axios.CancelToken.source(),n=this.prepareData(e),i=r(r({},this.namespaceInputName("visibleLayoutElements"),this.settings.visibleLayoutElements),this.namespaceInputName("staticLayoutElements"),this.settings.staticLayoutElements),this.settings.isProvisionalDraft&&(i[this.namespaceInputName("provisional")]=1),(a=this.$contentContainer.children("[data-layout-tab]:not(.hidden)").data("id"))&&(i[this.namespaceInputName("selectedTab")]=a),n+="&".concat($.param(i)),t.prev=10,t.next=13,Craft.sendActionRequest("POST","elements/update-field-layout",{cancelToken:this.cancelToken.token,headers:this._saveHeaders,data:n});case 13:o=t.sent,t.next=22;break;case 16:t.prev=16,t.t0=t.catch(10),this._afterSaveDraft(),l=this.ignoreFailedRequest,this.ignoreFailedRequest=!1,l||(this.failed=!0,t.t0&&t.t0.response&&(this.httpStatus=t.t0.response.status,this.httpError=t.t0.response.data?t.t0.response.data.message:null),this._showFailStatus(),reject(t.t0));case 22:return t.next=24,this._afterUpdateFieldLayout(e,a,o);case 24:case"end":return t.stop()}}),t,this,[[10,16]])}))),function(t){return f.apply(this,arguments)}),prepareData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Craft.findDeltaData(this.$container.data("initialSerializedValue"),t,this.$container.data("delta-names"),e,this.$container.data("initial-delta-values"),this.$container.data("modified-delta-names"),!0);if(this.settings.draftId&&(i.push("".concat(this.namespaceInputName("draftId"),"=").concat(this.settings.draftId)),this.settings.isProvisionalDraft&&i.push("".concat(this.namespaceInputName("provisional"),"=1"))),null!==this.settings.draftName&&i.push("".concat(this.namespaceInputName("draftName"),"=").concat(encodeURIComponent(this.settings.draftName))),null!==this.settings.fieldId&&i.push("".concat(this.namespaceInputName("fieldId"),"=").concat(this.settings.fieldId)),null!==this.settings.ownerId&&i.push("".concat(this.namespaceInputName("ownerId"),"=").concat(this.settings.ownerId)),this.settings.saveParams)for(var r=0,a=Object.entries(this.settings.saveParams);r<a.length;r++){var s=c(a[r],2),o=s[0],l=s[1];i.push("".concat(this.namespaceInputName(o),"=").concat(l))}return n?i:i.join("&")},get _saveHeaders(){var t={"content-type":"application/x-www-form-urlencoded"};return this.namespace&&(t["X-Craft-Namespace"]=this.namespace),t},getDraftElementId:function(t){return t==this.settings.canonicalId?this.settings.elementId:this.draftElementIds[t]||t},getDraftElementUid:function(t){return this.draftElementUids[t]||t},updatePreviewTargets:function(t){var e=this;t.forEach((function(t){var n=e.settings.previewTargets.find((function(e){return e.label===t.label}));n&&(n.url=t.url);var i=e.previewLinks.find((function(e){return e.data("targetLabel")===t.label}));i&&(i.data("targetUrl",t.url),e.updatePreviewLinkHref(i))}))},_afterUpdateFieldLayout:function(t,e,n){var r=this;return l(s().mark((function a(){var o,l,c,u,h,d,f,p,g,m,v,y,b,w,C,_,S,x,I,E,T;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=r.serializeForm(!0)===t,c=r.$contentContainer.children("[data-layout-tab]:not(.hidden)").data("id"),u=$(),h={},d={},f=!1,p=i(n.data.missingElements);try{for(p.s();!(g=p.n()).done;){m=g.value,(v=r.$contentContainer.children('[data-layout-tab="'.concat(m.uid,'"]'))).length||(v=$("<div/>",{id:r.namespaceId(m.id),class:"flex-fields","data-id":m.id,"data-layout-tab":m.uid}),m.id!==e&&v.addClass("hidden"),v.appendTo(r.$contentContainer)),u=u.add(v),y=i(m.elements);try{for(y.s();!(b=y.n()).done;)!1!==(w=b.value).html?(h[m.uid]||(h[m.uid]=[]),h[m.uid].push(w.uid),w.static&&(d[m.uid]||(d[m.uid]=[]),d[m.uid].push(w.uid)),"string"==typeof w.html&&(C=v.children('[data-layout-element="'.concat(w.uid,'"]')),_=$(w.html),C.length?C.replaceWith(_):_.appendTo(v),Craft.cp.elementThumbLoader.load(_),f=!0)):(S=v.children('[data-layout-element="'.concat(w.uid,'"]'))).length&&Garnish.hasAttr(S,"data-layout-element-placeholder")||(x=$("<div/>",{class:"hidden","data-layout-element":w.uid,"data-layout-element-placeholder":""}),S.length?S.replaceWith(x):x.appendTo(v),f=!0)}catch(t){y.e(t)}finally{y.f()}}}catch(t){p.e(t)}finally{p.f()}return(I=r.$contentContainer.children("[data-layout-tab]").not(u).not('[data-layout-tab=""]')).length&&(I.remove(),f=!0),u.filter(":not(.hidden)").length||u.first().removeClass("hidden"),r.settings.visibleLayoutElements=h,r.settings.staticLayoutElements=d,(null!==(o=r.settings.updateTabs)&&void 0!==o?o:r.isFullPage?function(t){return Craft.cp.updateTabs(t)}:function(){})(n.data.tabs),e&&c&&e!==c&&(E=r.tabManager)&&((T=E.$tabs.filter('[data-id="'.concat(c,'"]'))).length?E.selectTab(T):E.selectTab(E.$tabs.first())),a.next=18,Craft.appendHeadHtml(n.data.headHtml);case 18:return a.next=20,Craft.appendBodyHtml(n.data.bodyHtml);case 20:Craft.initUiElements(r.$contentContainer),f&&(n.data.initialDeltaValues&&Object.assign(r.$container.data("initial-delta-values"),n.data.initialDeltaValues),l&&(r.lastSerializedValue=r.serializeForm(!0))),r.handleDismissibleTips();case 23:case"end":return a.stop()}}),a)})))()},afterUpdate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$container.data("initialSerializedValue",t),this.$container.data("initial-delta-values",e);var n=this.statusIcons().velocity("stop").css("opacity","").removeClass("hidden").addClass("checkmark-icon");this.setStatusMessage(this._saveSuccessMessage()),this.settings.autosaveDrafts||n.velocity("stop").velocity({opacity:0},{delay:2e3,complete:function(){n.addClass("hidden")}}),this.trigger("update"),(this.settings.isProvisionalDraft||this.settings.isUnpublishedDraft)&&Craft.broadcaster&&Craft.broadcaster.postMessage({event:"saveElement",id:this.settings.canonicalId})},setStatusMessage:function(t){this.statusIcons().attr("title",t),Craft.cp.announce(t)},showMetaModal:function(){var t=this;this.metaModal?this.metaModal.show():this.createMetaModal(),Garnish.isMobileBrowser(!0)||setTimeout((function(){t.$nameTextInput.focus()}),100)},createMetaModal:function(){var t=this,e=$("<form/>",{class:"modal fitted"}),n=$("<div/>",{class:"body"}).appendTo(e),i=$('<div class="field"><div class="heading"><label for="draft-name">'+Craft.t("app","Draft Name")+"</label></div></div>").appendTo(n),r=$('<div class="input"/>').appendTo(i);this.$nameTextInput=$('<input type="text" class="text fullwidth" id="draft-name"/>').appendTo(r).val(this.settings.draftName);var a=$('<div class="hud-footer flex flex-center"/>').appendTo(e);$('<div class="flex-grow"></div>').appendTo(a),this.$saveMetaBtn=$("<button/>",{type:"submit",class:"btn submit disabled","aria-disabled":"true",text:Craft.t("app","Save")}).appendTo(a),this.metaModal=new Garnish.Modal(e),this.addListener(this.$nameTextInput,"input","checkMetaValues"),this.addListener(e,"submit",(function(e){e.preventDefault(),t.saveMeta()})),this.metaModal.on("escape",(function(){t.$nameTextInput.val(t.settings.draftName)}))},checkMetaValues:function(){return this.$nameTextInput.val()&&this.$nameTextInput.val()!==this.settings.draftName?(this.$saveMetaBtn.removeClass("disabled"),this.$saveMetaBtn.removeAttr("aria-disabled"),!0):(this.$saveMetaBtn.addClass("disabled"),this.$saveMetaBtn.attr("aria-disabled","true"),!1)},shakeMetaModal:function(){Garnish.shake(this.metaModal.$container)},saveMeta:function(){var t=this;return new Promise((function(e,n){if(!t.checkMetaValues())return t.shakeMetaModal(),void n();t.settings.draftName=t.$nameTextInput.val(),t.metaModal.hide(),t.checkForm(!0).then(e).catch(n)}))},handleSubmit:(d=l(s().mark((function t(e){var n,i,r,a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!this.submittingForm){t.next=5;break}return t.abrupt("return");case 5:if(!this.settings.draftId||this.settings.isUnpublishedDraft||this.settings.isProvisionalDraft||void 0!==e.autosave&&!e.autosave||!(e.saveShortcut||e.customTrigger&&"elements/save-draft"===e.customTrigger.data("action"))||!this.enableAutosave){t.next=8;break}return this.checkForm(!0),t.abrupt("return");case 8:if(this.submittingForm=!0,Craft.cp.$confirmUnloadForms=Craft.cp.$confirmUnloadForms.not(this.$container),this.cancelToken&&(this.ignoreFailedRequest=!0,this.cancelToken.cancel()),this.trigger("beforeSubmit"),n=this.prepareData(this.serializeForm(!1)),!this.isFullPage){t.next=20;break}this.stopListeningForChanges(),(i=Craft.createForm(n)).appendTo(Garnish.$bod),i.submit(),t.next=37;break;case 20:return t.prev=20,t.next=23,Craft.sendActionRequest("POST",null,{headers:this._saveHeaders,data:n});case 23:r=t.sent,t.next=30;break;case 26:return t.prev=26,t.t0=t.catch(20),this.settings.handleSubmitError(t.t0),t.abrupt("return");case 30:return t.prev=30,this.submittingForm=!1,this.trigger("afterSubmit"),this.checkForm(!1,!1),t.finish(30);case 35:if(this.settings.isUnpublishedDraft)for(a=$('div.element[data-id="'.concat(this.settings.elementId,'"][data-settings]')),o=0;o<a.length;o++)a.eq(o).removeData("draft-id").removeAttr("data-draft-id");this.settings.handleSubmitResponse(r);case 37:case"end":return t.stop()}}),t,this,[[20,26,30,35]])}))),function(t){return d.apply(this,arguments)}),handleDismissibleTips:function(){var t=this;this.addListener(this.tipDismissBtn,"click",(function(e){t.hideTip(e)}))},getHiddenTipsUids:function(){return Craft.getLocalStorage("dismissedTips",[])},setHiddenTipsUids:function(t){Craft.setLocalStorage("dismissedTips",t)},hideTip:function(t){var e=t.target;if(e){var n=$(e).closest("[data-layout-element]");if(n.length){var i=n.data("layout-element");if(n.remove(),"undefined"!=typeof Storage){var r=this.getHiddenTipsUids();r.includes(i)||(r.push(i),this.setHiddenTipsUids(r))}}}},_checkActivity:function(){var t=this;Craft.remainingSessionTime?this.queue.push((function(){return new Promise((function(e,n){Craft.sendActionRequest("POST","elements/recent-activity",{params:{dontExtendSession:1},data:{elementType:t.settings.elementType,elementId:t.settings.canonicalId,draftId:t.settings.draftId,siteId:t.settings.siteId,provisional:t.settings.isProvisionalDraft}}).then((function(n){var i=n.data,r=null;if(t.activityTooltips&&(r=Object.values(t.activityTooltips).find((function(t){return t.$trigger[0]===document.activeElement}))),t.$activityContainer.html("").attr("role","region").attr("aria-label",Craft.t("app","Recent Activity")),i.activity.length){$("<h2/>",{class:"visually-hidden",text:Craft.t("app","Recent Activity")}).appendTo(t.$activityContainer);for(var a=$("<ul/>").appendTo(t.$activityContainer),s=0;s<i.activity.length;s++){var o=i.activity[s],l=$("<li/>").appendTo(a),c=$("<button/>",{type:"button",class:"activity-btn","aria-label":Craft.t("app","{name} active, more info",{name:o.userName}),"aria-expanded":"false"}).appendTo(l),u=$(o.userThumb).addClass("elementthumb").css("z-index",i.activity.length-s).appendTo(c);u.find("img,svg").attr("role","presentation"),Craft.cp.elementThumbLoader.load(l),u.find("title").remove(),void 0===t.activityTooltips[o.userId]?t.activityTooltips[o.userId]=new Craft.Tooltip(c,o.message):(t.activityTooltips[o.userId].$trigger=c,t.activityTooltips[o.userId].message=o.message,t.activityTooltips[o.userId]===r&&t.activityTooltips[o.userId].$trigger.focus())}}for(var h=function(){var e=f[d];i.activity.find((function(t){return t.userId==e}))||t.activityTooltips[e].hide()},d=0,f=Object.keys(t.activityTooltips);d<f.length;d++)h();if(t.isFullPage){var p=t.settings.updatedTimestamp&&t.settings.updatedTimestamp!==i.updatedTimestamp,g=t.settings.canonicalUpdatedTimestamp&&t.settings.canonicalUpdatedTimestamp!==i.canonicalUpdatedTimestamp;if(p||g){var m=Craft.ui.createButton({label:Craft.t("app","Reload"),spinner:!0});Craft.cp.displayNotice(Craft.uppercaseFirst(Craft.t("app","This {type} has been updated.",{type:p&&t.settings.draftId&&!t.settings.isProvisionalDraft?Craft.t("app","draft"):Craft.elementTypeNames[t.settings.elementType]?Craft.elementTypeNames[t.settings.elementType][2]:Craft.t("app","element")})),{details:m}),m.on("click",(function(){window.location.reload()}))}}t.settings.updatedTimestamp=i.updatedTimestamp,t.settings.canonicalUpdatedTimestamp=i.canonicalUpdatedTimestamp,t.trigger("checkActivity",i),setTimeout((function(){t._checkActivity()}),15e3),e()})).catch((function(i){var r;400===(null==i||null===(r=i.response)||void 0===r?void 0:r.status)?(Garnish.once(Craft.AuthManager,"login",(function(){t._checkActivity()})),e()):n(i)}))}))})):Garnish.once(Craft.AuthManager,"login",(function(){t._checkActivity()}))},destroy:function(){var t,e;this.queue.destroy(),delete this.queue,null===(t=this.formObserver)||void 0===t||t.destroy(),delete this.formObserver,null===(e=this.preview)||void 0===e||e.destroy(),delete this.preview,this.base()}},{defaults:{namespace:null,additionalSites:[],canCreateDrafts:!1,canEditMultipleSites:!1,canSave:!1,canSaveCanonical:!1,elementId:null,canonicalId:null,draftId:null,draftName:null,elementType:null,enablePreview:!1,enabled:!1,enabledForSite:!1,hashedCpEditUrl:null,isLive:!1,isProvisionalDraft:!1,isUnpublishedDraft:!1,previewTargets:[],previewToken:null,previewParamValue:null,revisionId:null,fieldId:null,ownerId:null,siteId:null,siteStatuses:[],saveParams:null,siteToken:null,visibleLayoutElements:{},staticLayoutElements:{},updatedTimestamp:null,canonicalUpdatedTimestamp:null,reloadOnBroadcastSave:!0,$contentContainer:null,$sidebar:null,$actionBtn:null,$spinnerContainer:null,updateTabs:null,getTabManager:null,handleSubmitResponse:function(){},handleSubmitError:function(){},autosaveDrafts:null}})},4642:function(){function t(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.FormObserver=Garnish.Base.extend({$container:null,_callback:null,_pauseLevel:0,_timeout:null,_recentKeypress:!1,_formData:null,_mutationObserver:null,_selectizeInputs:null,get isActive(){return 0===this._pauseLevel},init:function(e,n){var i=this;this.$container=$(e),this._callback=n,this._serialize(),this.addListener(this.$container,"change,input,keypress,keyup",(function(t){i.isActive&&(["keypress","keyup"].includes(t.type)&&(i._recentKeypress=!0),i._checkFormAfterDelay())})),this._mutationObserver=new MutationObserver((function(e){var n,r=t(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;i.isActive&&i._formChanged(a)&&i._checkFormAfterDelay();var s,o=t(a.addedNodes);try{for(o.s();!(s=o.n()).done;){var l=s.value;l instanceof Element&&i._initSelectizeInputs(l)}}catch(t){o.e(t)}finally{o.f()}"class"===a.attributeName&&a.target instanceof Element&&a.target.classList.contains("selectized")&&i._initSelectizeInput(a.target)}}catch(t){r.e(t)}finally{r.f()}})),this._mutationObserver.observe(this.$container[0],{childList:!0,subtree:!0,characterData:!0,attributeFilter:["name","value","disabled","class"]}),this._initSelectizeInputs(this.$container[0])},_formChanged:function(t){switch(t.type){case"childList":return"TEXTAREA"===t.target.nodeName&&t.target.hasAttribute("name")||this._hasNamedNodes(t.addedNodes)||this._hasNamedNodes(t.removedNodes);case"attributes":switch(t.attributeName){case"name":return!t.target.disabled;case"value":return t.target.hasAttribute("name")&&!t.target.disabled;case"disabled":return t.target.hasAttribute("name")}case"characterData":return t.target.parentNode instanceof Element&&t.target.parentNode.hasAttribute("name");default:return!1}},_initSelectizeInputs:function(e){if(e.classList.contains("selectized"))this._initSelectizeInput(e);else{var n,i=t(e.querySelectorAll(".selectized"));try{for(i.s();!(n=i.n()).done;){var r=n.value;this._initSelectizeInput(r)}}catch(t){i.e(t)}finally{i.f()}}},_initSelectizeInput:function(t){var e=this;this.removeAllListeners(t),this.addListener(t,"selectizedropdownopen",(function(){e.pause()})),this.addListener(t,"selectizedropdownclose",(function(){setTimeout((function(){e.resume()}),100)}))},_hasNamedNodes:function(e){var n,i=t(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r instanceof Element&&(r.hasAttribute("name")||r.querySelectorAll("[name]").length))return!0}}catch(t){i.e(t)}finally{i.f()}return!1},_checkFormAfterDelay:function(){var t=this;clearTimeout(this._timeout),this._timeout=setTimeout((function(){t.checkForm()}),this._recentKeypress?1e3:100)},checkForm:function(){clearTimeout(this._timeout),this._recentKeypress=!1,this._formData!==this._serialize()&&this._callback(this._formData)},_serialize:function(){return"FORM"===this.$container[0].nodeName?this._formData=this.$container.serialize():this._formData=$("<form/>").append(this.$container.clone()).serialize(),this._formData},pause:function(){this._pauseLevel++},resume:function(){if(0===this._pauseLevel)throw"Craft.FormObserver::resume() should only be called after pause().";this._pauseLevel--,this.isActive&&this.checkForm()},destroy:function(){clearTimeout(this._timeout),this._mutationObserver.disconnect(),delete this._mutationObserver,this.base()}})},4731:function(t,e,n){"use strict";n.r(e),n.d(e,{decode:function(){return v},encode:function(){return y},toASCII:function(){return w},toUnicode:function(){return b},ucs2decode:function(){return f},ucs2encode:function(){return p}});const i=2147483647,r=36,a=/^xn--/,s=/[^\0-\x7F]/,o=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=Math.floor,u=String.fromCharCode;function h(t){throw new RangeError(l[t])}function d(t,e){const n=t.split("@");let i="";n.length>1&&(i=n[0]+"@",t=n[1]);const r=function(t,e){const n=[];let i=t.length;for(;i--;)n[i]=e(t[i]);return n}((t=t.replace(o,".")).split("."),e).join(".");return i+r}function f(t){const e=[];let n=0;const i=t.length;for(;n<i;){const r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){const i=t.charCodeAt(n++);56320==(64512&i)?e.push(((1023&r)<<10)+(1023&i)+65536):(e.push(r),n--)}else e.push(r)}return e}const p=t=>String.fromCodePoint(...t),g=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},m=function(t,e,n){let i=0;for(t=n?c(t/700):t>>1,t+=c(t/e);t>455;i+=r)t=c(t/35);return c(i+36*t/(t+38))},v=function(t){const e=[],n=t.length;let a=0,s=128,o=72,l=t.lastIndexOf("-");l<0&&(l=0);for(let n=0;n<l;++n)t.charCodeAt(n)>=128&&h("not-basic"),e.push(t.charCodeAt(n));for(let d=l>0?l+1:0;d<n;){const l=a;for(let e=1,s=r;;s+=r){d>=n&&h("invalid-input");const l=(u=t.charCodeAt(d++))>=48&&u<58?u-48+26:u>=65&&u<91?u-65:u>=97&&u<123?u-97:r;l>=r&&h("invalid-input"),l>c((i-a)/e)&&h("overflow"),a+=l*e;const f=s<=o?1:s>=o+26?26:s-o;if(l<f)break;const p=r-f;e>c(i/p)&&h("overflow"),e*=p}const f=e.length+1;o=m(a-l,f,0==l),c(a/f)>i-s&&h("overflow"),s+=c(a/f),a%=f,e.splice(a++,0,s)}var u;return String.fromCodePoint(...e)},y=function(t){const e=[],n=(t=f(t)).length;let a=128,s=0,o=72;for(const n of t)n<128&&e.push(u(n));const l=e.length;let d=l;for(l&&e.push("-");d<n;){let n=i;for(const e of t)e>=a&&e<n&&(n=e);const f=d+1;n-a>c((i-s)/f)&&h("overflow"),s+=(n-a)*f,a=n;for(const n of t)if(n<a&&++s>i&&h("overflow"),n===a){let t=s;for(let n=r;;n+=r){const i=n<=o?1:n>=o+26?26:n-o;if(t<i)break;const a=t-i,s=r-i;e.push(u(g(i+a%s,0))),t=c(a/s)}e.push(u(g(t,0))),o=m(s,f,d===l),s=0,++d}++s,++a}return e.join("")},b=function(t){return d(t,(function(t){return a.test(t)?v(t.slice(4).toLowerCase()):t}))},w=function(t){return d(t,(function(t){return s.test(t)?"xn--"+y(t):t}))},C={version:"2.3.1",ucs2:{decode:f,encode:p},decode:v,encode:y,toASCII:w,toUnicode:b};e.default=C},4750:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}Craft.BaseElementIndexView=Garnish.Base.extend({$container:null,$loadingMoreSpinner:null,$elementContainer:null,$scroller:null,elementIndex:null,elementSelect:null,loadingMore:!1,_totalVisible:null,_morePending:null,_handleEnableElements:null,_handleDisableElements:null,get thumbLoader(){return console.warn("Craft.BaseElementIndexView::thumbLoader is deprecated. Craft.cp.elementThumbLoader should be used instead."),Craft.cp.elementThumbLoader},init:function(t,e,n){var i=this;this.elementIndex=t,this.$container=$(e),this.setSettings(n,Craft.BaseElementIndexView.defaults),this.$loadingMoreSpinner=$('<div class="centeralign hidden"><div class="spinner loadingmore"></div></div>').insertAfter(this.$container),this.$elementContainer=this.getElementContainer();var r=this.$elementContainer.children();this.setTotalVisible(r.length),this.setMorePending(this.elementIndex.settings.batchSize&&r.length==this.elementIndex.settings.batchSize),Craft.cp.elementThumbLoader.load(r),this.settings.selectable&&(this.elementSelect=new Garnish.Select(this.$elementContainer,this.filterSelectableElements(r),{multi:this.settings.multiSelect,vertical:this.isVerticalList(),filter:function(t){return!$(t).closest("a[href],.toggle,.btn,[role=button],.move,craft-copy-attribute").length},checkboxMode:this.settings.checkboxMode,waitForDoubleClicks:this.settings.waitForDoubleClicks,onSelectionChange:this.onSelectionChange.bind(this)}),this.updateInitialViewForSelectedElements(r),this._handleEnableElements=function(t){i.elementSelect.addItems(i.filterSelectableElements($(t.elements)));for(var e=0;e<$(t.elements).length;e++){var n=$(t.elements).eq(e);i.enableFocusableElements(n)}},this._handleDisableElements=function(t){i.elementSelect.removeItems(t.elements);for(var e=0;e<$(t.elements).length;e++){var n=$(t.elements).eq(e);i.disableFocusableElements(n)}},this.elementIndex.on("enableElements",this._handleEnableElements),this.elementIndex.on("disableElements",this._handleDisableElements)),this.elementIndex.isAdministrative&&(this._handleElementEditing=function(t){if(!i.elementIndex.inlineEditing&&!$(t.target).closest("a[href],button,[role=button],.move").length){var e=$(t.target),n=e.closest(".element");if((n.length||(n=e.closest("tr").find(".element:first")).length)&&Garnish.hasAttr(n,"data-editable")&&!n.closest(".elementselect").length)var r=Craft.createElementEditor(n.data("type"),n,{onLoad:"embedded-index"===i.elementIndex.settings.context?function(){r.elementEditor.on("update",(function(){Craft.Preview.refresh()}))}:null})}},this.elementIndex.trashed||this.addListener(this.$elementContainer,"dblclick,taphold",this._handleElementEditing)),this.afterInit(),this.elementIndex.paginated&&"embedded-index"!==this.elementIndex.settings.context||!this.elementIndex.settings.batchSize||("index"===this.settings.context?this.$scroller=Garnish.$scrollContainer:this.$scroller=this.elementIndex.$main,this.$scroller.scrollTop(0),this.elementIndex.paginated||(this.addListener(this.$scroller,"scroll","maybeLoadMore"),this.maybeLoadMore()))},updateInitialViewForSelectedElements:function(t){for(var e=0;e<t.length;e++){var n=t.eq(e);n.hasClass("disabled")?(this.getElementCheckbox(n).attr({"aria-checked":"true"}),this.disableFocusableElements(n)):this.canSelectElement(n)||n.find(".checkbox").remove()}},filterSelectableElements:function(t){for(var e=[],n=0;n<t.length;n++){var i=t.eq(n);this.canSelectElement(i)&&e.push(i[0])}return $(e)},disableFocusableElements:function(t){var e={tabindex:"-1","data-focusable":!0},n=Garnish.getKeyboardFocusableElements(t);n.length&&n.attr(e),this.getElementCheckbox(t).attr(e)},enableFocusableElements:function(t){var e=t.find("[data-focusable]");e.length&&(e.removeAttr("tabindex data-focusable"),this.getElementCheckbox(t).attr("tabindex","0"))},canSelectElement:function(t){return!t.hasClass("disabled")&&(this.settings.canSelectElement?this.settings.canSelectElement(t):!!t.data("id"))},getElementContainer:function(){return this.$container},afterInit:function(){},getAllElements:function(){return this.$elementContainer.children()},getEnabledElements:function(){return this.$elementContainer.children(":not(.disabled)")},getElementById:function(t){var e=this.$elementContainer.children('[data-id="'+t+'"]:first');return e.length?e:null},getSelectedElements:function(){if(!this.elementSelect)throw"This view is not selectable.";return this.elementSelect.$selectedItems},getSelectedElementIds:function(){var t;try{t=this.getSelectedElements()}catch(t){}var e=[];if(t)for(var n=0;n<t.length;n++){var i=t.eq(n).data("id");i&&e.push(i)}return e},selectElement:function(t){if(!this.elementSelect)throw"This view is not selectable.";return this.elementSelect.selectItem(t,!0),!0},selectElementById:function(t){if(!this.elementSelect)throw"This view is not selectable.";var e=this.getElementById(t);return!!e&&(this.elementSelect.selectItem(e,!0),!0)},selectAllElements:function(){this.elementSelect.selectAll()},deselectAllElements:function(){this.elementSelect.deselectAll()},getElementCheckbox:function(t){return $(t).find(".checkbox")},isVerticalList:function(){return!1},getTotalVisible:function(){return this._totalVisible},setTotalVisible:function(t){this._totalVisible=t},getMorePending:function(){return this._morePending},setMorePending:function(t){this._morePending=t},maybeLoadMore:function(){this.canLoadMore()&&this.loadMore()},canLoadMore:function(){return!(!this.getMorePending()||!this.elementIndex.settings.batchSize)&&(this.$scroller[0]===Garnish.$win[0]?Garnish.$win.innerHeight()+Garnish.$win.scrollTop()>=this.$container.offset().top+this.$container.height():this.$scroller.prop("scrollHeight")-this.$scroller.scrollTop()<=this.$scroller.outerHeight()+15)},loadMore:function(){var t=this;this.getMorePending()&&!this.loadingMore&&this.elementIndex.settings.batchSize&&(this.loadingMore=!0,this.$loadingMoreSpinner.removeClass("hidden"),this.removeListener(this.$scroller,"scroll"),Craft.sendActionRequest("POST",this.settings.loadMoreElementsAction,{data:this.getLoadMoreParams()}).then(function(){var i,r=(i=e().mark((function n(i){var r,a;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingMore=!1,t.$loadingMoreSpinner.addClass("hidden"),t.isAdministrative&&(Craft.currentElementIndex=t),r=$(i.data.html),t.elementIndex.selectable&&(a=t.elementIndex.multiSelect?"checkbox":"radio",r.find(".checkbox").attr("role",a)),t.appendElements(r),e.next=8,Craft.appendHeadHtml(i.data.headHtml);case 8:return e.next=10,Craft.appendBodyHtml(i.data.bodyHtml);case 10:t.elementSelect&&(t.elementSelect.addItems(t.filterSelectableElements(r)),t.elementIndex.updateActionTriggers()),t.setTotalVisible(t.getTotalVisible()+r.length),t.setMorePending(r.length==t.elementIndex.settings.batchSize),t.addListener(t.$scroller,"scroll","maybeLoadMore"),t.maybeLoadMore();case 15:case"end":return e.stop()}}),n)})),function(){var t=this,e=arguments;return new Promise((function(r,a){var s=i.apply(t,e);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))});return function(t){return r.apply(this,arguments)}}()).catch((function(e){t.loadingMore=!1,t.$loadingMoreSpinner.addClass("hidden")})))},getLoadMoreParams:function(){var t=$.extend(!0,{},this.settings.params);return t.criteria.offset=this.getTotalVisible(),t},appendElements:function(t){t.appendTo(this.$elementContainer),Craft.cp.elementThumbLoader.load(t),this.onAppendElements(t)},onAppendElements:function(t){this.settings.onAppendElements(t),this.trigger("appendElements",{newElements:t})},onSelectionChange:function(){this.settings.onSelectionChange(),this.trigger("selectionChange")},disable:function(){this.elementSelect&&this.elementSelect.disable()},enable:function(){this.elementSelect&&this.elementSelect.enable()},destroy:function(){this.$loadingMoreSpinner.remove(),this.elementSelect&&(this.elementIndex.off("enableElements",this._handleEnableElements),this.elementIndex.off("disableElements",this._handleDisableElements),this.elementSelect.destroy(),delete this.elementSelect),this.base()}},{defaults:{context:"index",batchSize:null,params:null,selectable:!1,multiSelect:!1,canSelectElement:null,checkboxMode:!1,waitForDoubleClicks:!1,sortable:!1,loadMoreElementsAction:"element-indexes/get-more-elements",onAppendElements:$.noop,onSelectionChange:$.noop,onSortChange:$.noop}})},4843:function(){function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==_typeof(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function asyncGeneratorStep(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){asyncGeneratorStep(a,i,r,s,o,"next",t)}function o(t){asyncGeneratorStep(a,i,r,s,o,"throw",t)}s(void 0)}))}}Craft.FieldLayoutDesigner=Garnish.Base.extend({$container:null,$innerContainer:null,$configInput:null,$tabContainer:null,$newTabBtn:null,$libraryContainer:null,$selectedLibrary:null,$fieldLibrary:null,$uiLibrary:null,$uiLibraryElements:null,$fieldSearch:null,$clearFieldSearchBtn:null,$fieldGroups:null,$fields:null,$createFieldBtn:null,libraryPicker:null,tabGrid:null,elementDrag:null,cvd:null,$cvd:null,_config:null,_$selectedFields:null,init:function(t,e){var n=this;this.$container=$(t),this.setSettings(e,Craft.FieldLayoutDesigner.defaults),this.$configInput=this.$container.children("input[data-config-input]"),this._config=JSON.parse(this.$configInput.val()),this._config.tabs||(this._config.tabs=[]),this._fieldHandles={},this.$innerContainer=this.$container.children(".fld-container");var i=this.$innerContainer.children(".fld-workspace");this.$tabContainer=i.children(".fld-tabs"),this.$newTabBtn=i.children(".fld-new-tab-btn"),this.$libraryContainer=this.$innerContainer.children(".fld-library"),this.$fieldLibrary=this.$selectedLibrary=this.$libraryContainer.children(".fld-field-library");var r=this.$fieldLibrary.children(".search");this.$fieldSearch=r.children("input"),this.$clearFieldSearchBtn=r.children(".clear-btn"),this.$fieldGroups=this.$libraryContainer.find(".fld-field-group"),this.$fields=this.$fieldGroups.children(".fld-element"),this.$uiLibrary=this.$libraryContainer.children(".fld-ui-library"),this.$uiLibraryElements=this.$uiLibrary.children(),this.settings.readOnly&&this.$fieldLibrary.attr("tabindex","-1"),this.tabGrid=new Craft.Grid(this.$tabContainer,{itemSelector:".fld-tab",minColWidth:312,fillMode:"grid",snapToGrid:24});for(var a=this.$tabContainer.children(),s=0;s<a.length;s++)this.initTab($(a[s]));if(this.elementDrag=new Craft.FieldLayoutDesigner.ElementDrag(this),this.settings.readOnly||this.initLibraryElements(this.$libraryContainer.find(".fld-element")),this.settings.customizableTabs&&(this.tabDrag=new Craft.FieldLayoutDesigner.TabDrag(this),this.addListener(this.$newTabBtn,"activate","addTab")),this.settings.customizableUi){var o=this.$libraryContainer.children(".btngroup");this.libraryPicker=new Craft.Listbox(o,{onChange:function(t){switch(t.data("library")){case"field":n.$fieldLibrary.removeClass("hidden"),n.$uiLibrary.addClass("hidden"),n.$createFieldBtn.removeClass("hidden");break;case"ui":n.$fieldLibrary.addClass("hidden"),n.$uiLibrary.removeClass("hidden"),n.$createFieldBtn.addClass("hidden")}}})}this.addListener(this.$fieldSearch,"input",(function(){n.updateFieldSearchResults()})),this.addListener(this.$fieldSearch,"keydown",(function(t){switch(t.keyCode){case Garnish.ESC_KEY:n.$fieldSearch.val("").trigger("input");break;case Garnish.RETURN_KEY:t.preventDefault()}})),this.addListener(this.$clearFieldSearchBtn,"click",(function(){n.clearSearch()})),this.refreshSelectedFields(),this.$createFieldBtn=Craft.ui.createButton({label:Craft.t("app","New field"),class:"mt-m fullwidth add icon dashed",disabled:this.settings.readOnly}).appendTo(this.$libraryContainer),this.addListener(this.$createFieldBtn,"activate",_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.createField();case 1:case"end":return t.stop()}}),t)})))),this.settings.withCardViewDesigner&&(this.$cvd=this.$container.parents(".fld-cvd").find(".card-view-designer"),this.initCvd())},updateFieldSearchResults:function(){var t=this.$fieldSearch.val().toLowerCase().replace(/['"]/g,"");if(!t)return this.$fieldLibrary.find(".filtered").removeClass("filtered"),void this.$clearFieldSearchBtn.addClass("hidden");this.$clearFieldSearchBtn.removeClass("hidden");var e=this.$fields.filter('[data-keywords*="'.concat(t,'"]')).add(this.$fieldGroups.filter('[data-name*="'.concat(t,'"]')).children(".fld-element")).removeClass("filtered");this.$fields.not(e).addClass("filtered");for(var n=0;n<this.$fieldGroups.length;n++){var i=this.$fieldGroups.eq(n);i.find(".fld-element:not(.hidden):not(.filtered)").length?i.removeClass("filtered"):i.addClass("filtered")}},clearSearch:function(){this.$fieldSearch.val("").trigger("input")},initCvd:function(){this.cvd=new Craft.FieldLayoutDesigner.CardViewDesigner(this,this.$cvd);var t=this.cvd.$container.attr("id");if(t){var e=$("<a/>",{class:"skip-link btn",text:Craft.t("app","Skip to card view designer"),href:"#".concat(t)});this.cvd.$container.attr("tabindex","-1"),this.$innerContainer.prepend(e)}},initTab:function(t){return new Craft.FieldLayoutDesigner.Tab(this,t)},removeFieldByHandle:function(t){this.$fields.filter('[data-attribute="'.concat(t,'"]:first')).removeClass("hidden").closest(".fld-field-group").removeClass("hidden")},addTab:function(){if(this.settings.customizableTabs){var t="";0===this.tabGrid.$items.length&&(t=Craft.t("app","Content"));var e=Craft.escapeHtml(prompt(Craft.t("app","Give your tab a name."),t));if(e){var n=$('\n<div class="fld-tab">\n  <div class="tabs">\n    <div class="tab sel draggable">\n      <h3 class="fld-tab__name">'.concat(e,'</h3>\n    </div>\n  </div>\n  <div class="fld-tabcontent">\n    <button class="btn add icon dashed fullwidth fld-add-btn" type="button">\n      ').concat(Craft.t("app","Add"),"\n    </button>\n  </div>\n</div>\n")),i=this.$tabContainer.children(".fld-tab:last");i.length?n.insertAfter(i):n.prependTo(this.$tabContainer),this.tabGrid.addItems(n),this.tabDrag.addItems(n),this.initTab(n).updatePositionInConfig()}}},get config(){return this._config},set config(t){this._config=t,this.$configInput.val(JSON.stringify(t))},updateConfig:function(t){var e=t(this.config);!1!==e&&(this.config=e)},refreshSelectedFields:function(){this._$selectedFields=this.$tabContainer.find(".fld-field")},refreshLibraryFields:function(){this.$fields=this.$fieldGroups.children(".fld-element");for(var t=0;t<this.$fieldGroups.length;t++){var e=this.$fieldGroups.eq(t);e.children(".fld-element").sort((function(t,e){return $(t).data("ui-label")>$(e).data("ui-label")?1:-1})).appendTo(e)}this.updateFieldSearchResults()},hasHandle:function(t){for(var e=0;e<this._$selectedFields.length;e++){var n=this._$selectedFields.eq(e).data("fld-element");if(t===(n.config.handle||n.attribute))return!0}return!1},createField:function(){var t=this;new Craft.CpScreenSlideout("fields/edit-field").on("submit",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.response,r=$(i.data.selectorHtml),t.$fieldGroups.last().append(r).removeClass("hidden"),t.refreshLibraryFields(),t.initLibraryElements(r),t.addLibraryElementToActiveTab(r),Garnish.requestAnimationFrame((function(){var e;null===(e=t.getActiveHud())||void 0===e||e.hide()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},initLibraryElements:function(t){var e=this;this.elementDrag.addItems(t),this.addListener(t,"activate",(function(t){t.stopPropagation(),t.originalEvent.preventDefault(),e.addLibraryElementToActiveTab(t.currentTarget)}))},cloneLibraryElementForSelection:function(t){var e=$(t),n=e.clone().removeClass("unused").removeAttr("tabindex");return Garnish.hasAttr(e,"data-is-multi-instance")||(e.css({visibility:"inherit",display:"field"}).addClass("hidden"),0===e.siblings(".fld-field:not(.hidden)").length&&e.closest(".fld-field-group").addClass("hidden")),this.elementDrag.addItems(n),n},getActiveHud:function(){return this.$libraryContainer.closest(".fld-library-hud").data("hud")},addLibraryElementToActiveTab:function(t){var e=this.getActiveHud();if(e){var n=this.cloneLibraryElementForSelection(t),i=e.$trigger.closest(".fld-tab").data("fld-tab");n.insertBefore(e.$trigger);var r=i.initElement(n);r.onSelect(),r.updatePositionInConfig(),this.tabGrid.refreshCols(!0)}}},{defaults:{elementType:null,customizableTabs:!0,customizableUi:!0,withCardViewDesigner:!1,alwaysShowThumbAlignmentBtns:!1,readOnly:!1},createSlideout:function createSlideout(data,js){var _arguments=arguments;return _asyncToGenerator(_regeneratorRuntime().mark((function _callee3(){var settings,$body,$footer,$cancelBtn,$contents,slideout;return _regeneratorRuntime().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(settings=_arguments.length>2&&void 0!==_arguments[2]?_arguments[2]:{},$body=$("<div/>",{class:"fld-element-settings-body"}),$("<div/>",{class:"fields",html:data.settingsHtml}).appendTo($body),$footer=$("<div/>",{class:"fld-element-settings-footer"}),$("<div/>",{class:"flex-grow"}).appendTo($footer),$cancelBtn=Craft.ui.createButton({label:Craft.t("app","Close"),spinner:!0}).appendTo($footer),Craft.ui.createSubmitButton({class:"secondary",label:Craft.t("app","Apply"),spinner:!0}).appendTo($footer),$contents=$body.add($footer),slideout=new Craft.Slideout($contents,Object.assign({containerElement:"form",containerAttributes:{action:"",method:"post",novalidate:"",class:"fld-element-settings"}},settings)),slideout.on("open",(function(){Garnish.requestAnimationFrame((function(){slideout.$container.find(".text:first").focus()}))})),$cancelBtn.on("click",(function(){slideout.close()})),!data.headHtml){_context3.next=14;break}return _context3.next=14,Craft.appendHeadHtml(data.headHtml);case 14:if(!data.bodyHtml){_context3.next=17;break}return _context3.next=17,Craft.appendBodyHtml(data.bodyHtml);case 17:return js&&eval(js),Craft.initUiElements(slideout.$container),_context3.abrupt("return",slideout);case 20:case"end":return _context3.stop()}}),_callee3)})))()}}),Craft.FieldLayoutDesigner.Tab=Garnish.Base.extend({designer:null,uid:null,$container:null,$addBtn:null,slideout:null,destroyed:!1,init:function(t,e){var n=this;this.designer=t,this.$container=e,this.$container.data("fld-tab",this),this.uid=this.$container.data("uid"),this.uid||(this.uid=Craft.uuid(),this.config={uid:this.uid,name:this.$container.find(".tabs .tab .fld-tab__name").text(),elements:[]}),this.designer.settings.customizableTabs&&this.createMenu();var i=this.$container.children(".fld-tabcontent");this.$addBtn=i.children(".fld-add-btn");var r=new Garnish.HUD(this.$addBtn,{hudClass:"hud fld-library-hud",listenToMainResize:!1,showOnInit:!1,orientations:["right","bottom","left"]});r.on("show",(function(){var t;n.designer.$libraryContainer.appendTo(r.$main),null===(t=n.designer.libraryPicker)||void 0===t||t.select(0),n.designer.$fieldSearch.focus(),n.designer.clearSearch(),n.designer.$fieldLibrary.scrollTop(0)})),r.on("hide",(function(){n.$addBtn.focus()})),this.$addBtn.on("activate",(function(){r.show()}));for(var a=i.children().not(this.$addBtn),s=0;s<a.length;s++)this.initElement($(a[s]))},createMenu:function(){var t,e=this,n=this.$container.find(".tabs .tab"),i="actionmenu".concat(Math.floor(1e6*Math.random())),r=$("<button/>",{type:"button",class:"btn action-btn","data-disclosure-trigger":"true","aria-controls":i,"aria-haspopup":"true","aria-label":Craft.t("app","Actions"),title:Craft.t("app","Actions"),disabled:this.designer.settings.readOnly}).appendTo(n),a=($("<div/>",{id:i,class:"menu menu--disclosure","data-disclosure-menu":"true"}).appendTo(n),r.disclosureMenu().data("disclosureMenu"));a.addItem({label:Craft.t("app","Settings"),icon:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("gear");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)}),onActivate:function(){e.createSettings()}},a.addGroup());var s,o,l,c=a.addGroup(),u=a.addItem({label:"ltr"===Craft.orientation?Craft.t("app","Move to the left"):Craft.t("app","Move to the right"),icon:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-left":"arrow-right");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}),onActivate:function(){e.moveLeft()}},c),h=a.addItem({label:"ltr"===Craft.orientation?Craft.t("app","Move to the right"):Craft.t("app","Move to the left"),icon:(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-right":"arrow-left");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)}),onActivate:function(){e.moveRight()}},c);a.addItem({label:Craft.t("app","Remove"),icon:(l=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("xmark");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)}),destructive:!0,onActivate:function(){e.destroy()}},a.addGroup()),a.on("show",(function(){a.toggleItem(u,e.$container.prev(".fld-tab").length),a.toggleItem(h,e.$container.next(".fld-tab").length)}))},createSettings:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Craft.sendActionRequest("POST","fields/render-layout-component-settings",{data:{uid:t.uid,layoutConfig:t.designer.config,elementType:t.designer.settings.elementType}});case 3:i=e.sent,n=i.data,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),Craft.cp.displayError(null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message),e.t0;case 11:return t.settingsNamespace=n.namespace,e.next=14,Craft.FieldLayoutDesigner.createSlideout(n,null,{triggerElement:t.$actionBtn});case 14:t.slideout=e.sent,t.slideout.$container.on("submit",(function(e){e.preventDefault(),t.applySettings()})),t.slideout.on("close",(function(){t.slideout.destroy(),t.slideout=null}));case 17:case"end":return e.stop()}}),e,null,[[0,7]])})))()},applySettings:function(){var t=this;if(this.slideout.$container.find('[name$="[name]"]').val()){var e=this.slideout.$container.find("button[type=submit]").addClass("loading"),n=$.extend({},this.config);delete n.elements,Craft.sendActionRequest("POST","fields/apply-layout-tab-settings",{data:{uid:this.uid,layoutConfig:this.designer.config,elementType:this.designer.settings.elementType,config:n,settingsNamespace:this.settingsNamespace,settings:this.slideout.$container.serialize()}}).then((function(e){t.updateConfig((function(t){return $.extend(e.data.config,{elements:t.elements})}));var n=t.$container.find(".tabs .tab"),i=n.children("button").detach();n.html(e.data.labelHtml).append(i),t.slideout.close()})).catch((function(t){Craft.cp.displayError(),console.error(t)})).finally((function(){e.removeClass("loading"),t.slideout.close()}))}else Craft.cp.displayError(Craft.t("app","You must specify a tab name."))},moveLeft:function(){var t=this.$container.prev(".fld-tab");t.length&&(this.$container.insertBefore(t),this.updatePositionInConfig())},moveRight:function(){var t=this.$container.next(".fld-tab");t.length&&(this.$container.insertAfter(t),this.updatePositionInConfig())},initElement:function(t){return new Craft.FieldLayoutDesigner.Element(this,t)},get index(){var t=this;return this.designer.config.tabs.findIndex((function(e){return e.uid===t.uid}))},get config(){var t=this;if(!this.uid)throw"Tab is missing its UID";var e=this.designer.config.tabs.find((function(e){return e.uid===t.uid}));return e||(e={uid:this.uid,elements:[]},this.config=e),e},set config(t){if(!this.destroyed){t.name&&t.name!==this.config.name&&this.$container.find(".tabs .tab .fld-tab__name").text(t.name);var e=this.designer.config,n=this.index;if(-1!==n)e.tabs[n]=t;else{var i=$.inArray(this.$container[0],this.$container.parent().children(".fld-tab"));e.tabs.splice(i,0,t)}this.designer.config=e}},updateConfig:function(t){if(!this.destroyed){var e=t(this.config);!1!==e&&(this.config=e)}},updatePositionInConfig:function(){var t=this;this.destroyed||this.designer.updateConfig((function(e){var n=t.config,i=t.index,r=$.inArray(t.$container[0],t.$container.parent().children(".fld-tab"));return-1!==i&&e.tabs.splice(i,1),e.tabs.splice(r,0,n),e}))},destroy:function(){var t=this;if(!this.destroyed){this.destroyed=!0,this.designer.updateConfig((function(e){var n=t.index;return-1!==n&&(e.tabs.splice(n,1),e)}));for(var e=this.$container.find(".fld-element"),n=0;n<e.length;n++)e.eq(n).data("fld-element").destroy();var i=this.$container.siblings().find(":focusable:first");i.length?i.focus():this.designer.$newTabBtn.focus(),this.designer.tabGrid.removeItems(this.$container),this.designer.tabDrag.removeItems(this.$container),this.$container.remove(),this.designer.refreshSelectedFields(),this.base()}}}),Craft.FieldLayoutDesigner.Element=Garnish.Base.extend({tab:null,$container:null,$actionBtn:null,uid:null,isMandatory:!1,isMultiInstance:null,isField:!1,attribute:null,requirable:!1,thumbable:!1,hasCustomWidth:!1,hasSettings:!1,settingsNamespace:null,slideout:null,defaultHandle:null,fieldId:null,fieldsWithErrors:null,init:function(t,e){this.tab=t,this.$container=e,this.uid=e.data("uid"),this.fieldId=e.data("id"),this.fieldsWithErrors=[];var n=!this.uid;if(n&&(this.uid=Craft.uuid(),this.config=$.extend(e.data("config"),{uid:this.uid})),this.initUi(),n&&this.isField){for(var i=this.defaultHandle,r=1;this.tab.designer.hasHandle(i);)r++,i=this.defaultHandle+r;i!==this.defaultHandle&&(this.config=$.extend({},this.config,{handle:i}),e.find(".fld-attribute-label").text(i)),this.tab.designer.refreshSelectedFields()}e.attr("data-keywords",null)},initUi:function(){var t=this;this.$container.data("fld-element",this),this.isMandatory=Garnish.hasAttr(this.$container,"data-mandatory"),this.isField=this.$container.hasClass("fld-field"),this.isMultiInstance=Garnish.hasAttr(this.$container,"data-is-multi-instance"),this.isField&&(this.requirable=Garnish.hasAttr(this.$container,"data-requirable"),this.thumbable=Garnish.hasAttr(this.$container,"data-thumbable"),this.attribute=this.$container.data("attribute"),this.defaultHandle=this.$container.data("default-handle")),this.hasCustomWidth=this.tab.designer.settings.customizableUi&&Garnish.hasAttr(this.$container,"data-has-custom-width"),this.hasCustomWidth&&new Craft.SlidePicker(this.config.width||100,{min:25,max:100,step:25,valueLabel:function(t){return Craft.t("app","{pct} width",{pct:"".concat(t,"%")})},onChange:function(e){t.updateConfig((function(t){return t.width=e,t}))},readOnly:this.tab.designer.settings.readOnly}).$container.appendTo(this.$container);var e="actionmenu".concat(Math.floor(1e6*Math.random()));this.$actionBtn=$("<button/>",{type:"button",class:"btn action-btn","data-disclosure-trigger":"true","aria-controls":e,"aria-haspopup":"true","aria-label":Craft.t("app","Actions"),title:Craft.t("app","Actions"),disabled:this.tab.designer.settings.readOnly}).appendTo(this.$container),$("<div/>",{id:e,class:"menu menu--disclosure","data-disclosure-menu":"true"}).appendTo(this.$container);var n,i,r,a,s,o=this.$actionBtn.disclosureMenu().data("disclosureMenu");if(this.hasSettings=Garnish.hasAttr(this.$container,"data-has-settings"),this.hasSettings&&!this.tab.designer.settings.readOnly&&(o.addItem({label:Craft.t("app","Settings"),icon:(r=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("gear");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),onActivate:function(){t.createSettings()}}),this.addListener(this.$container,"dblclick",(function(){t.createSettings()}))),this.requirable||!this.tab.designer.settings.withCardViewDesigner&&this.thumbable){var l=o.addGroup();this.requirable&&(n=o.addItem({label:Craft.t("app","Make required"),icon:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("asterisk");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}),iconColor:"rose",onActivate:function(){t.makeRequired()}},l),i=o.addItem({label:Craft.t("app","Make optional"),icon:(a=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("asterisk-slash");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),iconColor:"gray",onActivate:function(){t.dropRequired()}},l))}var c,u,h,d=o.addGroup(),f=o.addItem({label:Craft.t("app","Move up"),icon:(c=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-up");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)}),onActivate:function(){t.moveUp()}},d),p=o.addItem({label:Craft.t("app","Move down"),icon:(u=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-down");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)}),onActivate:function(){t.moveDown()}},d);this.isMandatory||o.addItem({label:Craft.t("app","Remove"),icon:(h=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("xmark");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)}),destructive:!0,onActivate:function(){t.destroy()}},o.addGroup()),o.on("show",(function(){t.requirable&&(o.toggleItem(n,!t.config.required),o.toggleItem(i,t.config.required)),o.toggleItem(f,t.$container.prev(".fld-element").length),o.toggleItem(p,t.$container.next(".fld-element").length)}))},onSelect:function(){var t=this;this.$container.attr("data-uid",this.uid);var e=this.$container.data("preview-options");if(e){var n=this.tab.designer.cvd;n&&(e.forEach((function(e){n.addCheckbox({value:e.value.replace(/\{uid}/g,t.uid),label:e.label})})),n.updateThumbnailsDropdown(this,"add"))}},getLabel:function(){var t=this.$container.find(".fld-element-label").text();return""!==t?t:this.$container.data("attribute")},createSettings:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,i,r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Craft.sendActionRequest("POST","fields/render-layout-component-settings",{data:{uid:t.uid,layoutConfig:t.tab.designer.config,elementType:t.tab.designer.settings.elementType}});case 3:i=e.sent,n=i.data,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),Craft.cp.displayError(null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message),e.t0;case 11:return t.settingsNamespace=n.namespace,e.next=14,Craft.FieldLayoutDesigner.createSlideout(n,null,{triggerElement:t.$actionBtn});case 14:t.slideout=e.sent,t.slideout.$container.on("submit",(function(e){e.preventDefault(),t.applySettings()})),t.slideout.on("close",(function(){t.slideout.destroy(),t.slideout=null})),a=t.slideout.$container.find(".fields:first"),t.isField&&a.find('input[name$="[handle]"]').val(t.config.handle||""),t.trigger("createSettings");case 20:case"end":return e.stop()}}),e,null,[[0,7]])})))()},applySettings:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slideout.$container.find("button[type=submit]").addClass("loading"),e.prev=1,e.next=4,t.applyConfig((function(){return t.config}),!0);case 4:return e.prev=4,n.removeClass("loading"),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))()},showFieldEditor:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new Craft.CpScreenSlideout("fields/edit-field",{params:{fieldId:t.fieldId,multiInstanceTypesOnly:t.isMultiInstance?1:0}}).on("submit",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var i,r,a,s,o,l,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=n.response,r=t.tab.designer,a=r.$fieldLibrary.find(".fld-field[data-id=".concat(t.fieldId,"]")),s=$(i.data.selectorHtml),a.replaceWith(s),r.refreshLibraryFields(),r.elementDrag.removeItems(a),r.elementDrag.addItems(s),o=r.$tabContainer.find(".fld-field[data-id=".concat(t.fieldId,"]")),l=0;l<o.length;l++)null===(c=o.eq(l).data("fld-element"))||void 0===c||c.refresh();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},makeRequired:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.applyConfig((function(t){return t.required=!0,t}));case 2:case"end":return e.stop()}}),e)})))()},dropRequired:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.applyConfig((function(t){return t.required=!1,t}));case 2:case"end":return e.stop()}}),e)})))()},moveUp:function(){var t=this.$container.prev(".fld-element");t.length&&(this.$container.insertBefore(t),this.updatePositionInConfig())},moveDown:function(){var t=this.$container.next(".fld-element");t.length&&(this.$container.insertAfter(t),this.updatePositionInConfig())},applyConfig:function(t){var e=arguments,n=this;return _asyncToGenerator(_regeneratorRuntime().mark((function i(){var r,a,s,o,l,c,u,h,d,f,p,g,m,v,y,b;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=e.length>1&&void 0!==e[1]&&e[1],!1!==(a=t(n.config))){i.next=4;break}return i.abrupt("return");case 4:return n.fieldsWithErrors.forEach((function(t){Craft.ui.clearErrorsFromField(t)})),i.prev=5,i.next=8,Craft.sendActionRequest("POST","fields/apply-layout-element-settings",{data:{uid:n.uid,layoutConfig:n.tab.designer.config,elementType:n.tab.designer.settings.elementType,config:a,settingsNamespace:n.settingsNamespace,settings:r?n.slideout.$container.serialize():null}});case 8:o=i.sent,s=o.data,i.next=17;break;case 12:throw i.prev=12,i.t0=i.catch(5),r&&(u=null===i.t0||void 0===i.t0||null===(c=i.t0.response)||void 0===c||null===(c=c.data)||void 0===c?void 0:c.errors)&&Object.entries(u).forEach((function(t){var e=_slicedToArray(t,2),i=e[0],r=e[1],a=n.slideout.$container.find('[data-error-key="'.concat(i,'"]'));a.length&&(Craft.ui.addErrorsToField(a,r),n.fieldsWithErrors.push(a))})),Craft.cp.displayError(null===i.t0||void 0===i.t0||null===(l=i.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message),i.t0;case 17:if(n.config=s.config,h=n.$container,d=$(s.selectorHtml),n.$container.replaceWith(d),n.$container=d,n.initUi(),n.tab.designer.settings.withCardViewDesigner&&(f=n.tab.designer.cvd)&&((p=d.data("preview-options"))&&p.forEach((function(t){f.updateCheckboxLabel(t.value.replace(/\{uid}/g,n.uid),t.label)})),f.updateThumbnailsDropdownOptionLabel(n.$container)),(g=n.tab.designer).refreshSelectedFields(),g.elementDrag.removeItems(h),g.elementDrag.addItems(d),g.tabGrid.refreshCols(!0),n.slideout&&(n.slideout.close(),n.slideout.destroy(),n.slideout=null),n.config.providesThumbs)for(m=n.tab.designer.$tabContainer.find(".fld-field"),v=0;v<m.length;v++)y=m.eq(v),(b=y.data("fld-element"))&&b!==n&&b.config.providesThumbs&&b.applyConfig((function(t){return t.providesThumbs=!1,t}));case 31:case"end":return i.stop()}}),i,null,[[5,12]])})))()},refresh:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.applyConfig((function(t){return t}));case 2:case"end":return e.stop()}}),e)})))()},get index(){var t=this,e=this.tab.config;return void 0===e?-1:e.elements.findIndex((function(e){return e.uid===t.uid}))},get config(){var t=this;if(!this.uid)throw"Tab is missing its UID";var e=this.tab.config.elements.find((function(e){return e.uid===t.uid}));return e||(e={uid:this.uid},this.config=e),e},set config(t){var e=this.tab.config,n=this.index;if(-1!==n)e.elements[n]=t;else{var i=$.inArray(this.$container[0],this.$container.parent().children(".fld-element"));e.elements.splice(i,0,t)}this.tab.config=e},updateConfig:function(t){var e=t(this.config);!1!==e&&(this.config=e)},updatePositionInConfig:function(){var t=this;this.tab.updateConfig((function(e){var n=t.config,i=t.index,r=$.inArray(t.$container[0],t.$container.parent().children(".fld-element"));return-1!==i&&e.elements.splice(i,1),e.elements.splice(r,0,n),e}))},destroy:function(){var t=this;if(this.tab.designer.settings.withCardViewDesigner){var e=this.tab.designer.cvd;if(e){var n=this.$container.data("preview-options");this.config.providesThumbs&&e.updateThumbnailsDropdown(this,"remove"),null!=n&&n.length&&n.forEach((function(n){e.removeCheckbox(n.value.replace(/\{uid}/g,t.uid))})),e.updatePreview()}}this.tab.updateConfig((function(e){var n=t.index;return-1!==n&&(e.elements.splice(n,1),e)}));var i=this.$container.siblings().find(":focusable:first");if(i.length?i.focus():this.tab.$addBtn.focus(),this.tab.designer.elementDrag.removeItems(this.$container),this.$container.remove(),this.isField)this.tab.designer.refreshSelectedFields(),this.isMultiInstance||this.tab.designer.removeFieldByHandle(this.defaultHandle||this.attribute);else if(!this.isMultiInstance){var r=this.tab.designer.$uiLibraryElements.filter('[data-type="'.concat(this.$container.data("type"),'"]:first'));r.length&&$(r[0]).removeClass("hidden")}this.base()}}),Craft.FieldLayoutDesigner.BaseDrag=Garnish.Drag.extend({designer:null,$insertion:null,showingInsertion:!1,$caboose:null,init:function(t,e){this.designer=t,this.base(this.findItems(),e)},onDragStart:function(){this.base(),this.$insertion=this.createInsertion(),this.$caboose=this.createCaboose(),this.$items=$().add(this.$items.add(this.$caboose)),Garnish.$bod.addClass("dragging")},removeCaboose:function(){this.$items=this.$items.not(this.$caboose),this.$caboose.remove()},swapDraggeeWithInsertion:function(){this.$insertion.insertBefore(this.$draggee),this.$draggee.detach(),this.$items=$().add(this.$items.not(this.$draggee).add(this.$insertion)),this.showingInsertion=!0},swapInsertionWithDraggee:function(){this.$insertion.replaceWith(this.$draggee),this.$items=$().add(this.$items.not(this.$insertion).add(this.$draggee)),this.showingInsertion=!1},setMidpoints:function(){for(var t=0;t<this.$items.length;t++){var e=$(this.$items[t]),n=e.offset();e.hasClass("unused")||e.data("midpoint",{left:n.left+e.outerWidth()/2,top:n.top+e.outerHeight()/2})}},getClosestItem:function(){for(this.getClosestItem._closestItem=null,this.getClosestItem._closestItemMouseDiff=null,this.getClosestItem._i=0;this.getClosestItem._i<this.$items.length;this.getClosestItem._i++)this.getClosestItem._$item=$(this.$items[this.getClosestItem._i]),this.getClosestItem._midpoint=this.getClosestItem._$item.data("midpoint"),this.getClosestItem._midpoint&&(this.getClosestItem._mouseDiff=Garnish.getDist(this.getClosestItem._midpoint.left,this.getClosestItem._midpoint.top,this.mouseX,this.mouseY),(null===this.getClosestItem._closestItem||this.getClosestItem._mouseDiff<this.getClosestItem._closestItemMouseDiff)&&(this.getClosestItem._closestItem=this.getClosestItem._$item[0],this.getClosestItem._closestItemMouseDiff=this.getClosestItem._mouseDiff));return this.getClosestItem._closestItem},checkForNewClosestItem:function(){this.checkForNewClosestItem._closestItem=this.getClosestItem(),this.checkForNewClosestItem._closestItem!==this.$insertion[0]&&(this.showingInsertion&&$.inArray(this.$insertion[0],this.$items)<$.inArray(this.checkForNewClosestItem._closestItem,this.$items)&&-1===$.inArray(this.checkForNewClosestItem._closestItem,this.$caboose)?this.$insertion.insertAfter(this.checkForNewClosestItem._closestItem):this.$insertion.insertBefore(this.checkForNewClosestItem._closestItem),this.designer.tabGrid.$items.length>0&&(this.$items=$().add(this.$items.add(this.$insertion)),this.showingInsertion=!0,this.designer.tabGrid.refreshCols(!0),this.setMidpoints()))},onDragStop:function(){var t=this;this.showingInsertion&&this.swapInsertionWithDraggee(),this.removeCaboose(),this.designer.tabGrid.refreshCols(!0);var e=this.$draggee.offset();!e||0===e.top&&0===e.left?(this.$draggee.css({display:this.draggeeDisplay,visibility:"visible",opacity:0}).velocity({opacity:1},Garnish.FX_DURATION),this.helpers[0].velocity({opacity:0},Garnish.FX_DURATION,(function(){t._showDraggee()}))):this.returnHelpersToDraggees(),this.base(),Garnish.$bod.removeClass("dragging")}}),Craft.FieldLayoutDesigner.TabDrag=Craft.FieldLayoutDesigner.BaseDrag.extend({init:function(t){this.base(t,{handle:".tab"})},findItems:function(){return this.designer.$tabContainer.find("> div.fld-tab")},onDragStart:function(){this.base(),this.swapDraggeeWithInsertion(),this.setMidpoints()},swapDraggeeWithInsertion:function(){this.base(),this.designer.tabGrid.removeItems(this.$draggee),this.designer.tabGrid.addItems(this.$insertion)},swapInsertionWithDraggee:function(){this.base(),this.designer.tabGrid.removeItems(this.$insertion),this.designer.tabGrid.addItems(this.$draggee)},onDrag:function(){this.checkForNewClosestItem(),this.base()},onDragStop:function(){this.base(),this.$draggee.css({display:this.draggeeDisplay,visibility:"hidden"}),this.$draggee.data("fld-tab").updatePositionInConfig()},createCaboose:function(){var t=$('<div class="fld-tab fld-tab-caboose"/>').appendTo(this.designer.$tabContainer);return this.designer.tabGrid.addItems(t),t},removeCaboose:function(){this.base(),this.designer.tabGrid.removeItems(this.$caboose)},createInsertion:function(){var t=this.$draggee.find(".tab");return $('\n<div class="fld-tab fld-insertion" style="height: '.concat(this.$draggee.height(),'px;">\n  <div class="tabs"><div class="tab sel draggable" style="width: ').concat(t.outerWidth(),"px; height: ").concat(t.outerHeight()+2,'px;"></div></div>\n  <div class="fld-tabcontent" style="height: ').concat(this.$draggee.find(".fld-tabcontent").height()-2,'px;"></div>\n</div>\n'))}}),Craft.FieldLayoutDesigner.ElementDrag=Craft.FieldLayoutDesigner.BaseDrag.extend({draggingLibraryElement:!1,draggingField:!1,draggingMultiInstanceElement:!1,originalTab:null,onDragStart:function(){this.base(),this.draggingLibraryElement=this.$draggee.hasClass("unused"),this.draggingField=this.$draggee.hasClass("fld-field"),this.draggingMultiInstanceElement=Garnish.hasAttr(this.$draggee,"data-is-multi-instance"),this.draggingLibraryElement&&this.draggingMultiInstanceElement&&this.$draggee.css({display:this.draggeeDisplay,visibility:"visible"}),this.draggingLibraryElement?this.originalTab=null:(this.originalTab=this.$draggee.closest(".fld-tab").data("fld-tab"),this.swapDraggeeWithInsertion()),this.setMidpoints()},onDrag:function(){this.isDraggeeMandatory()||this.isHoveringOverTab()?this.checkForNewClosestItem():this.showingInsertion&&(this.$insertion.remove(),this.$items=$().add(this.$items.not(this.$insertion)),this.showingInsertion=!1,this.designer.tabGrid.refreshCols(!0),this.setMidpoints()),this.base()},isDraggeeMandatory:function(){return Garnish.hasAttr(this.$draggee,"data-mandatory")},isHoveringOverTab:function(){for(var t=0;t<this.designer.tabGrid.$items.length;t++)if(Garnish.hitTest(this.mouseX,this.mouseY,this.designer.tabGrid.$items.eq(t)))return!0;return!1},findItems:function(){return this.designer.$tabContainer.find(".fld-element")},createCaboose:function(){for(var t=$(),e=this.designer.$tabContainer.find("> .fld-tab > .fld-tabcontent"),n=0;n<e.length;n++)t=t.add($("<div/>").insertBefore(e.eq(n).children(".fld-add-btn")));return t},createInsertion:function(){return $('<div class="fld-element fld-insertion" style="height: '.concat(this.$draggee.outerHeight(),'px;"/>'))},onDragStop:function(){var t=this.showingInsertion;if(t)this.draggingLibraryElement&&(this.$draggee=this.designer.cloneLibraryElementForSelection(this.$draggee));else if(!this.draggingLibraryElement){var e=this.draggingField?this.designer.$fields.filter('[data-attribute="'.concat(this.$draggee.data("attribute"),'"]:first')):this.designer.$uiLibraryElements.filter('[data-type="'.concat(this.$draggee.data("type"),'"]:first'));this.draggingField&&(e.removeClass("hidden"),e.closest(".fld-field-group").removeClass("hidden")),this.$draggee.data("fld-element").destroy(),this.$draggee=e}if(this.base(),this.$draggee.css({display:this.draggeeDisplay,visibility:this.draggingField||t?"hidden":"visible"}),t){var n,i=this.$draggee.closest(".fld-tab").data("fld-tab");if(this.draggingLibraryElement)(n=i.initElement(this.$draggee)).onSelect();else if(n=this.$draggee.data("fld-element"),i!==this.originalTab){var r=n.config;this.originalTab.updateConfig((function(t){var e=n.index;return-1!==e&&(t.elements.splice(e,1),t)})),this.$draggee.data("fld-element").tab=i,n.config=r}n.updatePositionInConfig()}}}),Craft.FieldLayoutDesigner.CardViewDesigner=Garnish.Base.extend({designer:null,$container:null,$previewContainer:null,$libraryContainer:null,sortableCheckboxSelect:null,$thumbManagementContainer:null,alwaysShowThumbAlignmentBtns:!1,init:function(t,e){var n=this;this.designer=t,this.$container=$(e),this.$container.data("cvd",this),this.$previewContainer=this.$container.find(".cvd-preview"),this.$libraryContainer=this.$container.find(".cvd-library .checkbox-select"),this.sortableCheckboxSelect=this.$libraryContainer.data("sortableCheckboxSelect"),this.$thumbManagementContainer=this.$container.find(".thumb-management"),this.alwaysShowThumbAlignmentBtns=t.settings.alwaysShowThumbAlignmentBtns;var i=this.$thumbManagementContainer.find('select[id$="thumb-source"]');this.addListener(i,"change",(function(t){n.manageThumbnails(t.target)})),this.alwaysShowThumbAlignmentBtns&&this.showThumbAlignment();var r=this.$thumbManagementContainer.find('div.btngroup[id$="thumb-alignment"] .btn');this.addListener(r,"activate",(function(t){n.manageThumbnailAlignment(t.target)})),this.listenToCheckboxEvents(),this.disablePreviewLinks()},initDrag:function(t){var e,n=this;this.sortableCheckboxSelect.initDrag(),this.sortableCheckboxSelect.initItem(t),null===(e=this.sortableCheckboxSelect.dragSort)||void 0===e||e.on("dragStop",(function(){n.updatePreview()})),this.listenToCheckboxEvents()},listenToCheckboxEvents:function(){var t=this;this.$libraryContainer.on("checked unchecked",(function(){t.updateCardViewConfig(),t.updatePreview()})),this.sortableCheckboxSelect.on("sortChange",(function(){t.updateCardViewConfig(),t.updatePreview()}))},updateCardViewConfig:function(){var t=this;this.designer.updateConfig((function(e){return e.cardView=t.$libraryContainer.find("input[type=checkbox]").toArray().filter((function(t){return t.checked})).map((function(t){return t.value})),e}))},updatePreview:function(){var t=this;this.$previewContainer.addClass("loading"),Craft.cp.announce(Craft.t("app","Loading")),Craft.sendActionRequest("POST","fields/render-card-preview",{data:{fieldLayoutConfig:this.designer.config}}).then((function(e){var n=e.data;t.$previewContainer.html(n.previewHtml),t.disablePreviewLinks()})).catch((function(t){var e;throw Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message),t})).finally((function(){t.$previewContainer.removeClass("loading"),Craft.cp.announce(Craft.t("app","Loading complete"))}))},disablePreviewLinks:function(){this.$previewContainer.find("a").each((function(t,e){$(e).attr("aria-disabled",!0)})),this.$previewContainer.find("a").on("click",(function(t){t.preventDefault()}))},addCheckbox:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.$libraryContainer.length){var e=$('<div class="checkbox-select-item"/>');Craft.hasMousePointerEvents()&&$('<a class="move icon draggable-handle disabled"/>').appendTo(e),Craft.ui.createCheckbox(Object.assign({checked:!1},t)).appendTo(e),e.appendTo(this.$libraryContainer),this.initDrag(e)}},updateCheckboxLabel:function(t,e){var n=this.findCheckboxByValue(t);null!=n&&n.length&&n.find("label").text(e)},removeCheckbox:function(t){var e=this.findCheckboxByValue(t);null!=e&&e.length&&(e.find('input[type="checkbox"]').prop("checked",!1),e.remove(),this.updatePreview())},findCheckboxByValue:function(t){return this.$libraryContainer.length?this.$libraryContainer.find('input[value="'.concat(t,'"]')).parents(".checkbox-select-item"):null},manageThumbnailAlignment:function(t){var e=$(t).data("value");e!==this.designer.config.thumbAlignment&&(this.designer.updateConfig((function(t){return t.cardThumbAlignment=e,t})),this.updatePreview())},manageThumbnails:function(t){var e=$(t),n=null;"__none__"===e.val()||"__default__"===e.val()?"__none__"!==e.val()||this.designer.settings.alwaysShowThumbAlignmentBtns||this.hideThumbAlignment():(n=e.val(),this.showThumbAlignment()),n!==this.designer.config.thumbFieldKey&&(this.designer.updateConfig((function(t){return t.thumbFieldKey=n,t})),this.updatePreview())},updateThumbnailsDropdown:function(t,e){var n=this.$thumbManagementContainer.find('select[id$="thumb-source"]');if("add"==e){var i,r;if(!Garnish.hasAttr(t.$container,"data-thumbable"))return null;var a=null!==(i=null===(r=t.$container.data("preview-options")[0])||void 0===r?void 0:r.label)&&void 0!==i?i:t.attribute;$('<option value="layoutElement:'+t.uid+'">'+a+"</option>").appendTo(n)}else if("remove"==e){if(!Garnish.hasAttr(t.$container,"data-thumbable"))return null;var s=null==n?void 0:n.find('option[value="'+t.uid+'"]');s&&(s.attr("selected")&&(null==n||n.find('option[value="__none__"').attr("selected"),this.designer.settings.alwaysShowThumbAlignmentBtns||this.hideThumbAlignment()),s.remove())}},updateThumbnailsDropdownOptionLabel:function(t){var e,n=t.data("uid"),i=this.$thumbManagementContainer.find('select[id$="thumb-source"]').find('option[value="'+n+'"]');if(null===i)return null;var r=null!==(e=t.find(".fld-element-label").text())&&void 0!==e?e:this.attribute;i.text(r)},showThumbAlignment:function(){this.$thumbManagementContainer.find('[data-attribute="thumb-alignment"]').removeClass("hidden")},hideThumbAlignment:function(){this.$thumbManagementContainer.find('[data-attribute="thumb-alignment"]').addClass("hidden")}})},4885:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function r(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function a(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}!function(t){Craft.ContentBlockEditor=Garnish.Base.extend({$container:null,formObserver:null,cancelToken:null,ignoreFailedRequest:!1,init:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$container=t,this.setSettings(n,Craft.ContentBlockEditor.defaults),this.formObserver=new Craft.FormObserver(this.$container,(function(t){e.updateFieldLayout(t)}))},updateFieldLayout:function(i){var s,o=this;return(s=e().mark((function a(){var s,l,c,u,h,d,f,p,g,m,v,y,b,w,C,$,_,S,x;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(c=o.$container.closest("form").data("elementEditor"))||!c.submittingForm){e.next=3;break}throw"Form already being submitted.";case 3:return o.cancelToken&&(o.ignoreFailedRequest=!0,o.cancelToken.cancel()),h=r(r(r(r(r(r(r({},(u=function(t){return Craft.namespaceInputName(t,o.settings.baseInputName)})("visibleLayoutElements"),o.settings.visibleLayoutElements),u("staticLayoutElements"),o.settings.staticLayoutElements),u("elementType"),"craft\\elements\\ContentBlock"),u("ownerId"),null!==(s=null==c?void 0:c.getDraftElementId(o.settings.ownerId))&&void 0!==s?s:o.settings.ownerId),u("fieldId"),o.settings.fieldId),u("siteId"),o.settings.siteId),u("elementId"),null!==(l=null==c?void 0:c.getDraftElementId(o.settings.elementId))&&void 0!==l?l:o.settings.elementId),i+="&".concat(t.param(h)),o.cancelToken=axios.CancelToken.source(),e.prev=8,e.next=11,Craft.sendActionRequest("POST","elements/update-field-layout",{cancelToken:o.cancelToken.token,headers:{"content-type":"application/x-www-form-urlencoded","X-Craft-Namespace":o.settings.baseInputName},data:i});case 11:d=e.sent,e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(8),o.ignoreFailedRequest){e.next=18;break}throw e.t0;case 18:return o.ignoreFailedRequest=!1,e.abrupt("return");case 20:return e.prev=20,o.cancelToken=null,e.finish(20);case 23:f={},p={},g=o.$container.find(".flex-fields:first"),m=n(d.data.missingElements);try{for(m.s();!(v=m.n()).done;){y=v.value,b=n(y.elements);try{for(b.s();!(w=b.n()).done;)!1!==(C=w.value).html?(f[y.uid]||(f[y.uid]=[]),f[y.uid].push(C.uid),C.static&&(p[y.uid]||(p[y.uid]=[]),p[y.uid].push(C.uid)),"string"==typeof C.html&&($=g.children('[data-layout-element="'.concat(C.uid,'"]')),_=t(C.html),$.length?$.replaceWith(_):_.appendTo(g),Craft.initUiElements(_))):(S=g.children('[data-layout-element="'.concat(C.uid,'"]'))).length&&Garnish.hasAttr(S,"data-layout-element-placeholder")||(x=t("<div/>",{class:"hidden","data-layout-element":C.uid,"data-layout-element-placeholder":""}),S.length?S.replaceWith(x):x.appendTo(g))}catch(t){b.e(t)}finally{b.f()}}}catch(t){m.e(t)}finally{m.f()}return o.settings.visibleLayoutElements=f,o.settings.staticLayoutElements=p,e.next=33,Craft.appendHeadHtml(d.data.headHtml);case 33:return e.next=35,Craft.appendBodyHtml(d.data.bodyHtml);case 35:null==c||c.handleDismissibleTips();case 36:case"end":return e.stop()}}),a,null,[[8,14,20,23]])})),function(){var t=this,e=arguments;return new Promise((function(n,i){var r=s.apply(t,e);function o(t){a(r,n,i,o,l,"next",t)}function l(t){a(r,n,i,o,l,"throw",t)}o(void 0)}))})()}},{defaults:{baseInputName:null,ownerElementType:null,ownerId:null,fieldId:null,siteId:null,elementId:null,visibleLayoutElements:{},staticLayoutElements:{}}})}(jQuery)},5026:function(){Craft.GeneratedFieldsTable=Craft.EditableTable.extend({get cvd(){return this.$table.closest(".field").next(".card-view-designer").data("cvd")},createRow:function(t,e,n,i){var r=this.base(t,e,n,i);return $('<input type="hidden" name="'.concat(n,"[").concat(t,'][uid]" value="').concat(Craft.uuid(),'">')).appendTo(r),r},createRowObj:function(t){return new Craft.GeneratedFieldsTable.Row(this,t)}}),Craft.GeneratedFieldsTable.Row=Craft.EditableTable.Row.extend({uid:null,init:function(t,e){var n=this;this.base(t,e),this.uid=this.$tr.find('> input[name$="[uid]"]').val();var i=this.$tr.find("> td:first-child > textarea"),r=this.$tr.find("> td:nth-child(2) > textarea");i.val()||new Craft.HandleGenerator(i,r),this.addListener(i,"input",(function(){var t=Craft.trim(i.val()),e=n.table.cvd;if(""!==t){var r=e.findCheckboxByUid(n.uid);null!=r&&r.length?e.updateCheckboxLabel(n.uid,t):e.addCheckbox({value:"generatedField:".concat(n.uid),labelHtml:t,data:{"field-id":n.fieldId,"field-label":t}})}else e.removeCheckbox(n.uid)}))},destroy:function(){this.table.cvd.removeCheckbox(this.uid),this.base()}})},5141:function(){Craft.EnvVarGenerator=Craft.BaseInputGenerator.extend({generateTargetValue:function(t){var e=t.replace(/<(.*?)>/g,"");return e=(e=e.replace(/['"‘’“”ʻ\[\]\(\)\{\}:]/g,"")).toLowerCase(),e=(e=Craft.asciiString(e)).replace(/^[^a-z]+/,""),Craft.filterArray(e.split(/[^a-z0-9]+/)).join("_").toUpperCase()}})},5176:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}var r,a;Craft.ElementActionTrigger=Garnish.Base.extend({elementIndex:null,maxLevels:null,newChildUrl:null,$trigger:null,$selectedItems:null,triggerEnabled:!0,init:function(t){if(this.elementIndex=Craft.currentElementIndex,this.elementIndex.triggers.push(this),$.isPlainObject(t)||(t={}),void 0!==t.batch&&(t.bulk=t.batch,delete t.batch),Object.defineProperty(t,"batch",{get:function(){return this.bulk},set:function(t){this.bulk=t}}),this.setSettings(t,Craft.ElementActionTrigger.defaults),this.$trigger=$("#".concat(this.elementIndex.namespaceId(t.type),"-actiontrigger")).data("trigger",this),this.settings.activate){this.$trigger.data("custom-handler",!0);var e=this.$trigger.find("button,.btn");e.length||(e=this.$trigger),this.addListener(e,"activate","handleTriggerActivation")}this.updateTrigger(),this.elementIndex.on("selectionChange",this.updateTrigger.bind(this))},updateTrigger:function(){0!==this.elementIndex.getSelectedElements().length&&(this.validateSelection()?this.enableTrigger():this.disableTrigger())},validateSelection:function(){var t=this;if(this.$selectedItems=this.elementIndex.getSelectedElements(),!this.settings.bulk&&this.$selectedItems.length>1)return!1;if(this.settings.requireId)for(var e=0;e<this.$selectedItems.length;e++){var n=this.$selectedItems.eq(e);if(!Garnish.hasAttr(n,"data-id")||n.is('[data-id=""]'))return!1}return"function"!=typeof this.settings.validateSelection||this._call((function(){return t.settings.validateSelection(t.$selectedItems,t.elementIndex)}))},enableTrigger:function(){this.triggerEnabled||((this.$trigger.has("button,.btn").length?this.$trigger.find("button,.btn"):this.$trigger).removeClass("disabled").removeAttr("aria-disabled"),this.triggerEnabled=!0)},disableTrigger:function(){this.triggerEnabled&&((this.$trigger.has("button,.btn").length?this.$trigger.find("button,.btn"):this.$trigger).addClass("disabled").attr("aria-disabled","true"),this.triggerEnabled=!1)},handleTriggerActivation:function(){var t=this;this.triggerEnabled&&this._call((function(){return t.settings.activate(t.$selectedItems,t.elementIndex)}))},_call:function(t){var e=Craft.elementIndex;Craft.elementIndex=this.elementIndex;var n=t();return Craft.elementIndex=e,n}},{defaults:{type:null,bulk:!0,requireId:!0,validateSelection:null,beforeActivate:(a=i(e().mark((function t(n,i){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)}),activate:null,afterActivate:(r=i(e().mark((function t(n,i){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})}})},5184:function(){Craft.SlugGenerator=Craft.BaseInputGenerator.extend({generateTargetValue:function(t){t=(t=t.replace(/<(.*?)>/g,"")).replace(/['"‘’“”ʻ\[\]\(\)\{\}:]/g,""),Craft.limitAutoSlugsToAscii&&(t=Craft.asciiString(t,this.settings.charMap)),Craft.allowUppercaseInSlug||(t=t.toLowerCase());var e=Craft.filterArray(XRegExp.matchChain(t,[XRegExp("[\\p{L}\\p{N}\\p{M}]+")]));return e.length?e.join(Craft.slugWordSeparator):""}})},5315:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function a(){"use strict";a=function(){return n};var e,n={},i=Object.prototype,r=i.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==i&&r.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(a,s,o,l){var c=f(e[a],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&r.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var a;s(this,"_invoke",{value:function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return a=a?a.then(r,r):r()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,s=function t(){for(;++a<n.length;)if(r.call(n,a))return t.value=n[a],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function s(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function o(t){s(a,i,r,o,l,"next",t)}function l(t){s(a,i,r,o,l,"throw",t)}o(void 0)}))}}var l,c,u,h,d,f,p,g,m;Craft.BaseElementSelectInput=Garnish.Base.extend({elementSelect:null,elementSort:null,modal:null,elementEditor:null,modalFirstOpen:!0,$container:null,$form:null,$elementsContainer:null,$elements:null,$addElementBtn:null,$spinner:null,searchTimeout:null,searchMenu:null,$searchContainer:null,$searchInput:null,$searchSpinner:null,_ignoreSearchBlur:!1,_initialized:!1,_$replaceElement:null,get thumbLoader(){return console.warn("Craft.BaseElementSelectInput::thumbLoader is deprecated. Craft.cp.elementThumbLoader should be used instead."),Craft.cp.elementThumbLoader},init:function(t){var e=this;if(!$.isPlainObject(t)){for(var n={},i=["id","name","elementType","sources","criteria","sourceElementId","limit","modalStorageKey","fieldId"],r=0;r<i.length&&void 0!==arguments[r];r++)n[i[r]]=arguments[r];t=n}this.setSettings(t,Craft.BaseElementSelectInput.defaults),this.settings.modalStorageKey&&(this.modalStorageKey="BaseElementSelectInput."+this.settings.modalStorageKey),(1==this.settings.limit||this.settings.maintainHierarchy)&&(this.settings.sortable=!1),this.$container=this.getContainer(),this.$form=this.$container.closest("form"),this.$container.data("elementSelect",this),this.$elementsContainer=this.getElementsContainer(),this.$addElementBtn=this.getAddElementsBtn(),this.$spinner=this.getSpinner(),this.$searchContainer=this.getSearchContainer(),this.$searchInput=this.getSearchInput(),this.$searchSpinner=this.getSearchSpinner(),this.initElementSelect(),this.initElementSort(),this.initSearch(),this.resetElements(),this.$addElementBtn.length&&this.addListener(this.$addElementBtn,"activate","showModal"),Garnish.requestAnimationFrame((function(){e._initialized=!0})),this.elementSelect&&this.addListener(Garnish.$win,"mousedown",(function(t){e.$container.is(t.target)||e.$container.find(t.target).length||$(t.target).closest(".menu").length||e.elementSelect.deselectAll()})),setTimeout((function(){e.elementEditor=e.$container.closest("form").data("elementEditor")}),100)},get totalSelected(){return this.$elements.length},getContainer:function(){return $("#"+this.settings.id)},getElementsContainer:function(){return this.$container.children(".elements")},getElements:function(){return this.$elementsContainer.hasClass("structure")?this.$elementsContainer.find("> li .row .element"):this.$elementsContainer.find("> li > .element")},getSearchContainer:function(){return this.$container.find(".elementselect__search-input-wrapper")},getSearchInput:function(){return this.$searchContainer.find("input")},getSearchSpinner:function(){return this.$searchContainer.find(".spinner")},getAddElementsBtn:function(){return this.$container.find(".btn.add:first")},getSpinner:function(){return this.$container.find(".spinner")},initElementSelect:function(){this.settings.selectable&&(this.elementSelect=new Garnish.Select(this.elementSelectSettings()))},elementSelectSettings:function(){return{multi:this.settings.sortable,filter:function(t){return!$(t).closest("a[href],button,[role=button]").length},makeFocusable:!1}},initElementSort:function(){var t=this;Craft.hasMousePointerEvents()||$(".element > .chip-content > .chip-actions > .move-btn, .element > .card-titlebar > .card-actions-container > .card-actions > .move-btn").hide(),this.settings.sortable&&Craft.hasMousePointerEvents()&&(this.elementSort=new Garnish.DragSort({container:this.$elementsContainer,filter:this.settings.selectable?function(){return t.elementSort.$targetItem.children(".element").hasClass("sel")?t.elementSelect.getSelectedItems().parent("li"):t.elementSort.$targetItem}:null,ignoreHandleSelector:".delete",handle:function(){switch(t.settings.viewMode){case"list":case"list-inline":case"thumbs":case"large":return"> .element > .chip-content > .chip-actions > .move-btn";case"cards":return"> .element > .card-titlebar > .card-actions-container > .card-actions > .move-btn";default:return null}}(),axis:this.getElementSortAxis(),collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,onBeforeDragStart:function(){var e;null===(e=t.elementEditor)||void 0===e||e.pause(),t.$elementsContainer.find("craft-element-label").attr("disabled",!0)},onDragStop:function(){var e;null===(e=t.elementEditor)||void 0===e||e.resume(),t.$elementsContainer.find("craft-element-label").removeAttr("disabled")},onSortChange:function(){t.onSortChange()}}))},getElementSortAxis:function(){return"list"!==this.settings.viewMode||this.getElementsContainer().hasClass("inline-chips")?null:"y"},canAddMoreElements:function(){return this.settings.allowAdd&&(!this.settings.limit||this.$elements.length<this.settings.limit)},updateAddElementsBtn:function(){this.canAddMoreElements()?this.enableAddElementsBtn():this.disableAddElementsBtn()},enableAddElementsBtn:function(){this.settings.allowAdd&&this.$addElementBtn.length&&(this.$addElementBtn.removeClass("hidden"),this.$searchContainer.removeClass("hidden")),this.updateButtonContainer()},disableAddElementsBtn:function(){this.$addElementBtn.length&&(this.$addElementBtn.addClass("hidden"),this.$searchContainer.addClass("hidden")),this.updateButtonContainer()},showSpinner:function(){this.$spinner&&this.$spinner.removeClass("hidden"),this.updateButtonContainer()},hideSpinner:function(){this.$spinner&&this.$spinner.addClass("hidden"),this.updateButtonContainer()},updateButtonContainer:function(){var t=this.$addElementBtn.length&&this.$addElementBtn.parent(".flex");null!=t&&t.length&&(t.children(":not(.hidden)").length?t.removeClass("hidden"):t.addClass("hidden"))},getNextLogicalFocusElement:function(){return this.canAddMoreElements()?this.$searchContainer.length&&!this.$searchContainer.hasClass("hidden")?this.$searchInput:this.$addElementBtn.length&&!this.$addElementBtn.hasClass("hidden")?this.$addElementBtn:this.$container.attr("tabindex","-1"):this.getLastActionBtn()},focusNextLogicalElement:function(){var t=this.getNextLogicalFocusElement();null!=t&&t.length?t.focus():console.warn("No logical element to focus on.")},focusLastRemoveBtn:function(){this.focusLastActionBtn()},getLastActionBtn:function(){return this.$container.find(".action-btn").last()},focusLastActionBtn:function(){this.getLastActionBtn().focus()},resetElements:function(){null!==this.$elements?this.removeElements(this.$elements):this.$elements=$(),this.addElements(this.getElements())},addElements:function(t){for(var e,n=this,i=function(){var e=t.eq(r),i=n.defineElementActions(e);if(i.length){Craft.addActionsToChip(e,i);var a=e.find("> .chip-content > .chip-actions .action-btn, > .card-titlebar > .card-actions-container > .card-actions .action-btn").data("disclosureMenu"),s=a.$container.find("[data-move-forward]")[0],o=a.$container.find("[data-move-backward]")[0];a.on("show",(function(){var t=e.parent(),n=t.prev(),i=t.next();s&&a.toggleItem(s,n.length),o&&a.toggleItem(o,i.length)}))}n.settings.sortable&&Craft.hasMousePointerEvents()&&Craft.ui.createButton({class:"chromeless small move-btn",icon:"move"}).attr({title:Craft.t("app","Reorder"),"aria-label":Craft.t("app","Reorder"),"aria-describedby":e.find(".label").attr("id")}).appendTo(e.find("> .chip-content > .chip-actions, > .card-titlebar > .card-actions-container > .card-actions"))},r=0;r<t.length;r++)i();Craft.cp.elementThumbLoader.load(t),this.settings.selectable&&this.elementSelect.addItems(t),this.settings.sortable&&(null===(e=this.elementSort)||void 0===e||e.addItems(t.parent("li"))),this.settings.editable&&(this._handleShowElementEditor=function(t){if("taphold"!==t.type||"BUTTON"!==t.target.nodeName){var e=$(t.currentTarget);!Garnish.hasAttr(e,"data-editable")||e.hasClass("disabled")||e.hasClass("loading")||n.createElementEditor(e)}},this.addListener(t,"dblclick",this._handleShowElementEditor),$.isTouchCapable()&&this.addListener(t,"taphold",this._handleShowElementEditor)),t.on("keydown",(function(t){if([Garnish.BACKSPACE_KEY,Garnish.DELETE_KEY].includes(t.keyCode)){t.stopPropagation(),t.preventDefault();for(var e=n.elementSelect.getSelectedItems(),i=0;i<e.length;i++)n.removeElement(e.eq(i))}})),this.$elements=this.$elements.add(t),this.updateAddElementsBtn(),this.onAddElements(),this.onSortChange()},defineElementActions:function(t){var e,n,i,r,s=this,l=[];if(this.settings.sortable){var c=this.getElementSortAxis();l.push({icon:(n=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("y"===c?"arrow-up":"ltr"===Craft.orientation?"arrow-left":"arrow-right");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)}),label:"y"===c?Craft.t("app","Move up"):Craft.t("app","Move forward"),callback:function(){s.moveElementForward(t)},attributes:{"data-move-forward":!0}}),l.push({icon:(e=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("y"===c?"arrow-down":"ltr"===Craft.orientation?"arrow-right":"arrow-left");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)}),label:"y"===c?Craft.t("app","Move down"):Craft.t("app","Move backward"),callback:function(){s.moveElementBackward(t)},attributes:{"data-move-backward":!0}})}return this.settings.allowRemove&&(this.settings.elementType&&l.push({icon:(r=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrows-rotate");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),label:Craft.t("app","Replace"),callback:function(){s._$replaceElement=t,s.showModal()}}),l.push({icon:(i=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("remove");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)}),label:Craft.t("app","Remove"),callback:function(){var e;null!==(e=s.elementSelect)&&void 0!==e&&e.isSelected(t)?s.removeElement(s.elementSelect.getSelectedItems()):s.removeElement(t)}})),l},createElementEditor:function(t,e){return e=Object.assign({elementSelectInput:this,prevalidate:this.settings.prevalidate},e),Craft.createElementEditor(this.settings.elementType,t,e)},replaceElement:function(t,e){var n=this;return new Promise((function(i,r){var s=n.$elements.filter('[data-id="'.concat(t,'"]'));s.length?(n.showSpinner(),Craft.sendActionRequest("POST","app/render-elements",{data:{elements:[{type:n.settings.elementType,id:e,siteId:n.settings.criteria.siteId,instances:[{context:"field",ui:["list","list-inline","thumbs","large"].includes(n.settings.viewMode)?"chip":"card",size:["thumbs","large"].includes(n.settings.viewMode)?"large":"small",showActionMenu:n.settings.showActionMenu}]}]}}).then(function(){var t=o(a().mark((function t(r){var o,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.data,n.removeElement(s),l=Craft.getElementInfo(o.elements[e][0]),n.selectElements([l]).then(i),t.next=6,Craft.appendHeadHtml(o.headHtml);case 6:return t.next=8,Craft.appendBodyHtml(o.bodyHtml);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var e,n;Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message),r(null==t||null===(n=t.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)})).finally((function(){n.hideSpinner()}))):r("No element selected with an ID of ".concat(t,"."))}))},onSortChange:function(){var t;null===(t=this.elementSelect)||void 0===t||t.resetItemOrder(),this.$elements=$().add(this.$elements)},moveElementForward:function(t){var e=t.closest("li"),n=e.prev();n.length&&(e.insertBefore(n),this.onSortChange())},moveElementBackward:function(t){var e=t.closest("li"),n=e.next();n.length&&(e.insertAfter(n),this.onSortChange())},removeElements:function(t){var e,n,i,r,a,s,o=this;if(this.settings.selectable&&this.elementSelect.removeItems(t),this.modal){for(var l=[],c=0;c<t.length;c++){var u=t.eq(c).data("id");u&&l.push(u)}l.length&&this.modal.elementIndex.enableElementsById(l)}if(t.children("input").prop("disabled",!0),this.settings.selectable){var h=this.$elements.index(t.last());i=this.$elements.eq(h+1),r=h-1>=0?this.$elements.eq(h-1):null}null!==(e=i)&&void 0!==e&&e.length||null!==(n=r)&&void 0!==n&&n.length?null===(s=null!==(a=i)&&void 0!==a&&a.length?this.getElementFocusTarget(i):this.getElementFocusTarget(r))||void 0===s||s.focus():setTimeout((function(){o.focusNextLogicalElement()}),200),this.$elements=this.$elements.not(t),this.updateAddElementsBtn(),this.onSortChange(),this.onRemoveElements()},getElementFocusTarget:function(t){return t.is(":focusable")?t:Garnish.firstFocusableElement(t).length?Garnish.firstFocusableElement(t):null},removeElement:function(t){if(this.settings.maintainHierarchy){for(var e=$(),n=0;n<t.length;n++)e=e.add(t.eq(n).parent().siblings("ul").find(".element"));t=t.add(e)}if($("[name]",t).removeAttr("name"),this.removeElements(t),this.settings.maintainHierarchy)for(var i=0;i<t.length;i++)this._animateStructureElementAway(t,i);else for(var r=0;r<t.length;r++){var a=t.eq(r),s=a.parent("li");this.animateElementAway(a),s.remove()}},animateElementAway:(m=o(a().mark((function t(e,n){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.offset(),r=e.width(),e.appendTo(Garnish.$bod).css({"z-index":0,position:"absolute",top:i.top,left:i.left,maxWidth:r+"px"}),t.next=5,Craft.animate(e,{opacity:-1,left:i.left+100*("ltr"===Craft.orientation?-1:1)});case 5:e.remove(),n&&n();case 7:case"end":return t.stop()}}),t)}))),function(t,e){return m.apply(this,arguments)}),showModal:function(){(this._$replaceElement||this.canAddMoreElements())&&(this.modal?this.modal.show():(this.modal=this.createModal(),this.modalFirstOpen=!1))},createModal:function(){return Craft.createElementSelectorModal(this.settings.elementType,this.getModalSettings())},getModalSettings:function(){var t,e,n=this,i=$.extend({closeOtherModals:!1,storageKey:this.modalStorageKey,sources:this.settings.sources,condition:this.settings.condition,referenceElementId:this.settings.referenceElementId?(null===(t=this.elementEditor)||void 0===t?void 0:t.getDraftElementId(this.settings.referenceElementId))||this.settings.referenceElementId:null,referenceElementOwnerId:this.settings.referenceElementOwnerId?(null===(e=this.elementEditor)||void 0===e?void 0:e.getDraftElementId(this.settings.referenceElementOwnerId))||this.settings.referenceElementOwnerId:null,referenceElementSiteId:this.settings.referenceElementSiteId,criteria:Object.assign({},this.settings.criteria),multiSelect:1!=this.settings.limit,hideOnSelect:!1,showSiteMenu:this.settings.showSiteMenu,disabledElementIds:this.getDisabledElementIds(),onSelect:this.onModalSelect.bind(this),onHide:this.onModalHide.bind(this),triggerElement:function(){return n.getNextLogicalFocusElement()},modalTitle:Craft.t("app","Choose")},this.settings.modalSettings);return this.modalFirstOpen||(i.preferStoredSource=!0),i},getSelectedElementIds:function(){for(var t=[],e=0;e<this.$elements.length;e++)t.push(this.$elements.eq(e).data("id"));return t},getDisabledElementIds:function(){var t,e=this.getSelectedElementIds();return!this.settings.allowSelfRelations&&this.settings.sourceElementId&&e.push(this.settings.sourceElementId),this.settings.disabledElementIds&&e.push.apply(e,function(t){if(Array.isArray(t))return r(t)}(t=this.settings.disabledElementIds)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e},onModalSelect:(g=o(a().mark((function t(e){var i,r,s,o,l,c,u,h,d,f,p,g,m,v,y,b,w,C,_,S=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(i=this.modal)||void 0===i||i.disable(),null===(r=this.modal)||void 0===r||r.disableCancelBtn(),null===(s=this.modal)||void 0===s||s.disableSelectBtn(),null===(o=this.modal)||void 0===o||o.showFooterSpinner(),null===(l=this.elementEditor)||void 0===l||l.pause(),this._$replaceElement&&(this.removeElement(this._$replaceElement),this._$replaceElement=null),g=function(){switch(S.settings.viewMode){case"thumbs":case"large":return["chip","large"];case"cards":return["card",null];default:return["chip","small"]}}(),m=n(g,2),v=m[0],y=m[1],t.next=9,Craft.sendActionRequest("POST","app/render-elements",{data:{elements:[{type:this.settings.elementType,id:e.map((function(t){return t.id})),siteId:e[0].siteId,instances:[{context:"field",ui:v,size:y,showActionMenu:this.settings.showActionMenu}]}]}});case 9:for(b=t.sent,w=b.data,C=0;C<e.length;C++)void 0!==w.elements[e[C].id]&&(e[C].$modalElement=e[C].$element,e[C].$element=$(w.elements[e[C].id][0]));if(!this.settings.maintainHierarchy){t.next=17;break}return t.next=15,this.selectStructuredElements(e);case 15:t.next=21;break;case 17:return this.settings.limit&&(_=this.settings.limit-this.$elements.length,e.length>_&&(e=e.slice(0,_))),t.next=20,this.selectElements(e);case 20:this.updateDisabledElementsInModal();case 21:return null===(c=this.modal)||void 0===c||c.enable(),null===(u=this.modal)||void 0===u||u.enableCancelBtn(),null===(h=this.modal)||void 0===h||h.enableSelectBtn(),null===(d=this.modal)||void 0===d||d.hideFooterSpinner(),null===(f=this.modal)||void 0===f||f.hide(),t.next=28,Craft.appendHeadHtml(w.headHtml);case 28:return t.next=30,Craft.appendBodyHtml(w.bodyHtml);case 30:null===(p=this.elementEditor)||void 0===p||p.resume();case 31:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)}),onModalHide:function(){this.modal&&this.settings.condition&&this.settings.referenceElementId&&(this.modal.destroy(),this.modal=null),this._$replaceElement=null},selectElements:(p=o(a().mark((function t(e){var n,i,r,s,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=[],i=0;i<e.length;i++)r=e[i],s=this.createNewElement(r),this.appendElement(s),this.addElements(s),r.$element=s,(o=r.$modalElement||r.$element)&&o.parent().length&&n.push({$modalElement:o,$inputElement:s});this.animateElementsIntoPlace(n),this.onSelectElements(e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)}),selectStructuredElements:(f=o(a().mark((function t(e){var n,i,r,s,o,l,c,u,h,d,f;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=this.getSelectedElementIds(),i=0;i<e.length;i++)n.push(e[i].id);return r={elementIds:n,siteId:e[0].siteId,containerId:this.settings.id,name:this.settings.name,branchLimit:this.settings.branchLimit,selectionLabel:this.settings.selectionLabel,elementType:this.settings.elementType},t.next=5,Craft.sendActionRequest("POST","relational-fields/structured-input-html",{data:r});case 5:return s=t.sent,o=$(s.data.html),l=o.children(".elements"),this.$elementsContainer.replaceWith(l),this.$elementsContainer=l,t.next=11,Craft.appendHeadHtml(s.data.headHtml);case 11:return t.next=13,Craft.appendBodyHtml(s.data.bodyHtml);case 13:for(this.resetElements(),c=[],u=[],h=0;h<e.length;h++)d=e[h],(f=this.getElementById(d.id))&&(c.push(d),u.push({$modalElement:d.$element,$inputElement:f}));this.animateElementsIntoPlace(u),this.updateDisabledElementsInModal(),this.onSelectElements(c);case 20:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)}),createNewElement:function(t){var e=t.$element.clone();return Craft.t("app","Remove {label}",{label:Craft.escapeHtml(t.label)}),Craft.setElementSize(e,["thumbs","large"].includes(this.settings.viewMode)?"large":"small"),e.addClass("removable").append($("<input/>",{type:"hidden",name:this.settings.name+(this.settings.single?"":"[]"),value:t.id})),e},appendElement:function(t){var e=$("<li/>").append(t);"beginning"===this.settings.defaultPlacement?e.prependTo(this.$elementsContainer):e.appendTo(this.$elementsContainer)},animateElementIntoPlace:(d=o(a().mark((function t(e,n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.animateElementsIntoPlace([{$modalElement:e,$inputElement:n}]);case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)}),animateElementsIntoPlace:(h=o(a().mark((function t(i){var r,s,o,l,c,u,h,d,f,p,g,m,v;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],s=e(i);try{for(s.s();!(o=s.n()).done;)l=o.value,c=l.$modalElement,u=l.$inputElement,h=c.offset(),d=u.offset(),f=u.clone().appendTo(Garnish.$bod).width(u.width()),u.css("visibility","hidden"),f.css({position:"absolute",zIndex:1e4,top:h.top,left:h.left}),r.push([f,{top:d.top,left:d.left}])}catch(t){s.e(t)}finally{s.f()}return t.next=5,Craft.animateAll(r);case 5:for(p=0,g=r;p<g.length;p++)n(g[p],1)[0].remove();m=e(i);try{for(m.s();!(v=m.n()).done;)v.value.$inputElement.css("visibility","")}catch(t){m.e(t)}finally{m.f()}case 8:case"end":return t.stop()}}),t)}))),function(t){return h.apply(this,arguments)}),updateDisabledElementsInModal:function(){var t;null!==(t=this.modal)&&void 0!==t&&t.elementIndex&&this.modal.elementIndex.disableElementsById(this.getDisabledElementIds())},getElementById:function(t){for(var e=0;e<this.$elements.length;e++){var n=this.$elements.eq(e);if(n.data("id")==t)return n}},onSelectElements:function(t){this.trigger("selectElements",{elements:t}),this.settings.onSelectElements(t),this.$container.trigger("change")},onAddElements:function(){this.trigger("addElements"),this.settings.onAddElements(),this.$container.trigger("change")},onRemoveElements:function(){this.trigger("removeElements"),this.settings.onRemoveElements(),this.$container.trigger("change")},_animateStructureElementAway:function(t,e){var n,i=this;if(e===t.length-1){var r=t.first().parent().parent(),a=r.parent();n=function(){a[0]===i.$elementsContainer[0]||r.siblings().length?r.remove():a.remove()}}var s=function(){i.animateElementAway(t.eq(e),n)};0===e?s():setTimeout(s,100*e)},canCreateElements:function(){return!1},createElement:(u=o(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)}),initSearch:function(){var t=this;this.$searchInput.length&&(this.addListener(this.$searchInput,"input",(function(){t.searchTimeout&&clearTimeout(t.searchTimeout),t.searchTimeout=setTimeout((function(){t.searchForTags()}),500)})),this.addListener(this.$searchInput,"keydown",(function(t){switch(t.keyCode===Garnish.RETURN_KEY&&t.preventDefault(),t.keyCode){case Garnish.RETURN_KEY:return t.preventDefault(),void(this.searchMenu&&this.selectSearchResult(this.searchMenu.$options.filter(".hover")));case Garnish.DOWN_KEY:if(t.preventDefault(),this.searchMenu){var e=this.searchMenu.$options.filter(".hover");if(e.length){var n=e.parent().nextAll().find(".menu-item:not(.disabled)").first();n.length&&this.focusOption(n)}else this.focusOption(this.searchMenu.$options.eq(0))}return;case Garnish.UP_KEY:if(t.preventDefault(),this.searchMenu){var i=this.searchMenu.$options.filter(".hover");if(i.length){var r=i.parent().prevAll().find(".menu-item:not(.disabled)").last();r.length&&this.focusOption(r)}else this.focusOption(this.searchMenu.$options.eq(this.searchMenu.$options.length-1))}return}})),this.addListener(this.$searchInput,"focus",(function(){this.searchMenu&&this.searchMenu.show()})),this.addListener(this.$searchInput,"blur",(function(){var t=this;this._ignoreSearchBlur?this._ignoreSearchBlur=!1:setTimeout((function(){t.searchMenu&&t.searchMenu.hide()}),1)})))},searchForTags:(c=o(a().mark((function t(){var n,i,r,s,o,l,c,u,h,d,f,p,g,m,v,y,b,w,C,_=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.searchMenu&&this.killSearchMenu(),!(n=this.$searchInput.val())){t.next=31;break}for(this.$searchSpinner.removeClass("hidden"),Craft.cp.announce(Craft.t("app","Loading")),i=[],r=0;r<this.$elements.length;r++)(s=$(this.$elements[r]).data("id"))&&i.push(s);return this.settings.sourceElementId&&!this.settings.allowSelfRelations&&i.push(this.settings.sourceElementId),t.prev=8,t.next=11,Craft.sendActionRequest("POST","element-search/search",{data:{elementType:this.settings.elementType,siteId:this.settings.criteria.siteId,search:n,criteria:this.settings.searchCriteria,condition:this.settings.condition,referenceElementId:this.settings.referenceElementId?(null===(l=this.elementEditor)||void 0===l?void 0:l.getDraftElementId(this.settings.referenceElementId))||this.settings.referenceElementId:null,referenceElementOwnerId:this.settings.referenceElementOwnerId?(null===(c=this.elementEditor)||void 0===c?void 0:c.getDraftElementId(this.settings.referenceElementOwnerId))||this.settings.referenceElementOwnerId:null,referenceElementSiteId:this.settings.referenceElementSiteId,excludeIds:i}});case 11:o=t.sent;case 12:return t.prev=12,this.searchMenu&&this.killSearchMenu(),this.$searchSpinner.addClass("hidden"),Craft.cp.announce(Craft.t("app","Loading complete")),t.finish(12);case 17:u=$('<div class="menu tagmenu"/>').appendTo(Garnish.$bod),h=$("<ul/>").appendTo(u),d=e(o.data.elements);try{for(d.s();!(f=d.n()).done;)g=f.value,m=$("<li/>").appendTo(h),v="".concat(Craft.t("app","Existing {type}",{type:null!==(p=Craft.elementTypeNames[this.settings.elementType][2])&&void 0!==p?p:Craft.t("app","element")}),": ").concat(g.title),m.attr("aria-label",v),y=$('<div class="menu-item"/>').appendTo(m).html(g.html).data("id",g.id),g.exclude&&y.addClass("disabled")}catch(t){d.e(t)}finally{d.f()}!o.data.exactMatch&&this.canCreateElements()&&(w=$("<li/>").appendTo(h),C="".concat(Craft.t("app","Create {type}",{type:null!==(b=Craft.elementTypeNames[this.settings.elementType][2])&&void 0!==b?b:Craft.t("app","element")}),": ").concat(n),w.attr("aria-label",C),$('<div class="menu-item" data-icon="plus"/>').appendTo(w).text(n)),h.find(".menu-item:not(.disabled):first").addClass("hover"),this.searchMenu=new Garnish.CustomSelect(u,{anchor:this.$searchInput,onOptionSelect:function(t){_.selectSearchResult(t)}}),this.$searchInput.attr("aria-controls",this.searchMenu.menuId),this.searchMenu.on("show",(function(){_.$searchInput.attr("aria-expanded","true"),_.focusSelectedOption(),Craft.cp.elementThumbLoader.load(u)})),this.searchMenu.on("hide",(function(){_.$searchInput.attr("aria-expanded","false"),_.$searchInput.removeAttr("aria-activedescendant")})),this.addListener(u,"mousedown",(function(){_._ignoreSearchBlur=!0})),this.searchMenu.show(),t.next=32;break;case 31:this.$searchSpinner.addClass("hidden");case 32:case"end":return t.stop()}}),t,this,[[8,,12,17]])}))),function(){return c.apply(this,arguments)}),focusOption:function(t){this.searchMenu.$options.removeClass("hover"),this.searchMenu.$ariaOptions.attr("aria-selected","false"),t.addClass("hover"),this.$searchInput.attr("aria-activedescendant",t.parent("li").attr("id"))},focusSelectedOption:function(){var t=this.searchMenu.$options.filter(".hover:first");t.length?this.focusOption(t):this.focusFirstOption()},focusFirstOption:function(){var t=this.searchMenu.$options.first();this.focusOption(t)},selectSearchResult:(l=o(a().mark((function t(e){var n,i,r=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=$(e)).hasClass("disabled")){t.next=3;break}return t.abrupt("return");case 3:if((i=n.data("id"))||!this.canCreateElements()){t.next=8;break}return t.next=7,this.createElement(n.text());case 7:i=t.sent;case 8:if(!i){t.next=11;break}return t.next=11,this.onModalSelect([{id:i,siteId:this.settings.criteria.siteId}]);case 11:this.killSearchMenu(),this.$searchInput.val(""),setTimeout((function(){r.focusNextLogicalElement()}),200);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)}),killSearchMenu:function(){this.searchMenu.hide(),this.searchMenu.destroy(),this.searchMenu=null}},{ADD_FX_DURATION:200,REMOVE_FX_DURATION:200,defaults:{id:null,name:null,fieldId:null,elementType:null,sources:null,condition:null,referenceElementId:null,referenceElementOwnerId:null,referenceElementSiteId:null,criteria:{},searchCriteria:null,allowAdd:!0,allowRemove:!0,allowSelfRelations:!1,sourceElementId:null,disabledElementIds:null,viewMode:"list",single:!1,maintainHierarchy:!1,branchLimit:null,limit:null,defaultPlacement:"end",showSiteMenu:!1,modalStorageKey:null,modalSettings:{},onAddElements:$.noop,onSelectElements:$.noop,onRemoveElements:$.noop,sortable:!0,selectable:!0,showActionMenu:!0,editable:!0,prevalidate:!1,editorSettings:{}}})},5335:function(){Craft.StructureDrag=Garnish.Drag.extend({structure:null,maxLevels:null,draggeeLevel:null,$helperLi:null,$targets:null,draggeeHeight:null,init:function(t,e){this.structure=t,this.maxLevels=e,this.$insertion=$('<li class="draginsertion"/>');var n=this.structure.$container.find("li");this.base(n,{handle:".element:first, .move:first",helper:this.getHelper.bind(this)})},getHelper:function(t){this.$helperLi=t;var e=$('<ul class="structure draghelper"/>').append(t);return t.css("padding-"+Craft.left,this.$draggee.css("padding-"+Craft.left)),t.find(".move").removeAttr("title"),e},onDragStart:function(){var t=this;this.$targets=$(),this.findTargets(this.structure.$container),this.draggeeLevel=0;var e=this.$draggee;do{this.draggeeLevel++,e=e.find("> ul > li")}while(e.length);this.draggeeHeight=this.$draggee.height(),this.$draggee.velocity({height:0},"fast",(function(){t.$draggee.addClass("hidden")})),this.base(),this.addListener(Garnish.$doc,"keydown",(function(t){t.keyCode===Garnish.ESC_KEY&&this.cancelDrag()}))},findTargets:function(t){for(var e=t.children().not(this.$draggee),n=0;n<e.length;n++){var i=$(e[n]);this.$targets=this.$targets.add(i.children(".row")),i.hasClass("collapsed")||this.findTargets(i.children("ul"))}},onDrag:function(){for(this._.$closestTarget&&(this._.$closestTarget.removeClass("draghover"),this.$insertion.remove()),this._.$closestTarget=null,this._.closestTargetPos=null,this._.closestTargetYDiff=null,this._.closestTargetOffset=null,this._.closestTargetHeight=null,this._.i=0;this._.i<this.$targets.length&&(this._.$target=$(this.$targets[this._.i]),this._.targetOffset=this._.$target.offset(),this._.targetHeight=this._.$target.outerHeight(),this._.targetYMidpoint=this._.targetOffset.top+this._.targetHeight/2,this._.targetYDiff=Math.abs(this.mouseY-this._.targetYMidpoint),0===this._.i||this.mouseY>=this._.targetOffset.top+5&&this._.targetYDiff<this._.closestTargetYDiff);this._.i++)this._.$closestTarget=this._.$target,this._.closestTargetPos=this._.i,this._.closestTargetYDiff=this._.targetYDiff,this._.closestTargetOffset=this._.targetOffset,this._.closestTargetHeight=this._.targetHeight;if(this._.$closestTarget)if(0===this._.closestTargetPos&&this.mouseY<this._.closestTargetOffset.top+5)this.$insertion.prependTo(this.structure.$container);else if(this._.$closestTargetLi=this._.$closestTarget.parent(),this._.closestTargetLevel=this._.$closestTargetLi.data("level"),this._.closestTargetPos<this.$targets.length-1?(this._.$nextTargetLi=$(this.$targets[this._.closestTargetPos+1]).parent(),this._.nextTargetLevel=this._.$nextTargetLi.data("level")):(this._.$nextTargetLi=null,this._.nextTargetLevel=null),this._.hoveringBetweenRows=this.mouseY>=this._.closestTargetOffset.top+this._.closestTargetHeight-5,this._.$nextTargetLi&&this._.nextTargetLevel==this._.closestTargetLevel)this._.hoveringBetweenRows?(!this.maxLevels||this.maxLevels>=this._.closestTargetLevel+this.draggeeLevel-1)&&this.$insertion.insertAfter(this._.$closestTargetLi):(!this.maxLevels||this.maxLevels>=this._.closestTargetLevel+this.draggeeLevel)&&this._.$closestTarget.addClass("draghover");else if(this._.$nextTargetLi&&this._.nextTargetLevel>this._.closestTargetLevel)(!this.maxLevels||this.maxLevels>=this._.nextTargetLevel+this.draggeeLevel-1)&&(this._.hoveringBetweenRows?this.$insertion.insertBefore(this._.$nextTargetLi):(this._.$closestTarget.addClass("draghover"),this.$insertion.appendTo(this._.$closestTargetLi.children("ul"))));else if(this._.hoveringBetweenRows){for(this._.draggeeX=this.mouseX-this.targetItemMouseDiffX,"rtl"===Craft.orientation&&(this._.draggeeX+=this.$helperLi.width()),this._.$parentLis=this._.$closestTarget.parentsUntil(this.structure.$container,"li"),this._.$closestParentLi=null,this._.closestParentLiXDiff=null,this._.closestParentLevel=null,this._.i=0;this._.i<this._.$parentLis.length;this._.i++)this._.$parentLi=$(this._.$parentLis[this._.i]),this._.parentLiX=this._.$parentLi.offset().left,"rtl"===Craft.orientation&&(this._.parentLiX+=this._.$parentLi.width()),this._.parentLiXDiff=Math.abs(this._.parentLiX-this._.draggeeX),this._.parentLevel=this._.$parentLi.data("level"),(!this.maxLevels||this.maxLevels>=this._.parentLevel+this.draggeeLevel-1)&&(!this._.$closestParentLi||this._.parentLiXDiff<this._.closestParentLiXDiff&&(!this._.$nextTargetLi||this._.parentLevel>=this._.nextTargetLevel))&&(this._.$closestParentLi=this._.$parentLi,this._.closestParentLiXDiff=this._.parentLiXDiff,this._.closestParentLevel=this._.parentLevel);this._.$closestParentLi&&this.$insertion.insertAfter(this._.$closestParentLi)}else(!this.maxLevels||this.maxLevels>=this._.closestTargetLevel+this.draggeeLevel)&&this._.$closestTarget.addClass("draghover")},cancelDrag:function(){this.$insertion.remove(),this._.$closestTarget&&this._.$closestTarget.removeClass("draghover"),this.onMouseUp()},onDragStop:function(){var t=this;if(this._.$closestTarget&&(this.$insertion.parent().length||this._.$closestTarget.hasClass("draghover"))){var e,n;if(this.$draggee.siblings().length||(e=this.$draggee.parent()),this.$insertion.parent().length){var i=this.$insertion.next().add(this.$insertion.prev());-1===$.inArray(this.$draggee[0],i)?(this.$insertion.replaceWith(this.$draggee),n=!0):(this.$insertion.remove(),n=!1)}else{var r=this._.$closestTargetLi.children("ul");if(e&&r.length&&r[0]===e[0])n=!1;else{if(r.length)this._.$closestTargetLi.hasClass("collapsed")&&this._.$closestTarget.children(".toggle").trigger("click");else{var a=$('<div class="toggle" title="'+Craft.t("app","Show/hide children")+'"/>').prependTo(this._.$closestTarget);this.structure.initToggle(a),r=$("<ul>").appendTo(this._.$closestTargetLi)}this.$draggee.appendTo(r),n=!0}}if(this._.$closestTarget.removeClass("draghover"),n){e&&this.structure._removeUl(e);var s,o=this.$draggee.parentsUntil(this.structure.$container,"li").length+1;o!=this.$draggee.data("level")&&(1==this.$draggee.data("level")?((s={})["padding-"+Craft.left]=38,this.$helperLi.velocity(s,"fast")):1==o&&((s={})["padding-"+Craft.left]=Craft.Structure.baseIndent,this.$helperLi.velocity(s,"fast")),this.setLevel(this.$draggee,o));var l=this.$draggee.children(".row").children(".element"),c={structureId:this.structure.id,elementId:l.data("id"),siteId:l.data("site-id"),prevId:this.$draggee.prev().children(".row").children(".element").data("id"),parentId:this.$draggee.parent("ul").parent("li").children(".row").children(".element").data("id")};Craft.sendActionRequest("POST","structures/move-element",{data:c}).then((function(t){Craft.cp.displaySuccess(Craft.t("app","New order saved."))}))}}this.$draggee.velocity("stop").removeClass("hidden").velocity({height:this.draggeeHeight},"fast",(function(){t.$draggee.css("height","auto")})),this.returnHelpersToDraggees(),this.base()},setLevel:function(t,e){t.data("level",e);var n=this.structure.getIndent(e),i={};i["margin-"+Craft.left]="-"+n+"px",i["padding-"+Craft.left]=n+"px",this.$draggee.children(".row").css(i);for(var r=t.children("ul").children(),a=0;a<r.length;a++)this.setLevel($(r[a]),e+1)}})},5343:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(r())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(t.bind.apply(t,i));return n&&a(s,n.prototype),s}(t,arguments,s(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}var o=function(n){function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,n,i){return n=s(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,r()?Reflect.construct(n,i||[],s(e).constructor):n.apply(e,i))}(this,i,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,n),function(t,n){return n&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(i,[{key:"copyValue",value:function(t){this.input.select(),document.execCommand("copy"),Craft.cp.displayNotice(Craft.t("app","Copied to clipboard.")),$(this.btn).trigger("copy"),this.input.setSelectionRange(0,0),this.btn.focus()}},{key:"handleTrigger",value:function(t){t instanceof KeyboardEvent&&(" "===t.key||"Enter"===t.key)&&(t.preventDefault(),this.copyValue()),t instanceof PointerEvent&&this.copyValue()}},{key:"renderInput",value:function(){var t=document.createElement("input");t.value=this.value,t.classList.add("visually-hidden"),t.readOnly=!0,t.size=Math.max(this.value.length,1),t.tabIndex=-1,t.ariaHidden="true",this.input=t,this.prepend(this.input)}},{key:"renderIcon",value:function(){var t=document.createElement("span");t.classList.add("visually-hidden"),t.innerText=Craft.t("app","Copy to clipboard"),this.btn.appendChild(t);var e=document.createElement("span");e.ariaHidden=!0,e.setAttribute("data-icon","clipboard"),this.btn.appendChild(e)}},{key:"renderButton",value:function(){var t=document.createElement("button");t.type="button",t.addEventListener("click",this.handleTrigger.bind(this)),t.addEventListener("keydown",this.handleTrigger.bind(this)),t.innerText=this.value,this.btn=t,this.appendChild(this.btn)}},{key:"connectedCallback",value:function(){this.value=(this.getAttribute("value")||this.innerText).trim()||this.innerText.trim(),this.innerHTML="",this.renderButton(),this.renderInput(),this.renderIcon()}},{key:"disconnectedCallback",value:function(){this.setAttribute("value",this.value)}}])}(i(HTMLElement));customElements.define("craft-copy-attribute",o)},5516:function(t){function e(t,e){var i,r,a=t.type,s=t.value;return e&&void 0!==(r=e(t))?r:"word"===a||"space"===a?s:"string"===a?(i=t.quote||"")+s+(t.unclosed?"":i):"comment"===a?"/*"+s+(t.unclosed?"":"*/"):"div"===a?(t.before||"")+s+(t.after||""):Array.isArray(t.nodes)?(i=n(t.nodes,e),"function"!==a?i:s+"("+(t.before||"")+i+(t.after||"")+(t.unclosed?"":")")):s}function n(t,n){var i,r;if(Array.isArray(t)){for(i="",r=t.length-1;~r;r-=1)i=e(t[r],n)+i;return i}return e(t,n)}t.exports=n},5540:function(t,e,n){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(){"use strict";r=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==n&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(r,s,o,l){var c=f(t[r],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}})}function T(e,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(e,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,D(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:P(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function a(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){a(s,i,r,o,l,"next",t)}function l(t){a(s,i,r,o,l,"throw",t)}o(void 0)}))}}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var c=n(4731);Craft.LinkInput=Garnish.Base.extend({field:null,$container:null,$field:null,$chip:null,$textInput:null,$hiddenInput:null,menu:null,init:function(t,e){var n=this;this.$container=$(t),this.setSettings(e,Craft.LinkInput.defaults),this.$container.data("linkInput",this),this.field=this.$container.closest("[data-link-field]").parent().data("linkField"),this.$chip=this.$container.children(".chip"),this.$textInput=this.$container.children(".text"),this.$hiddenInput=this.$container.children("input[type=hidden]"),this.$chip.length?(this.menu=this.$chip.find(".action-btn").disclosureMenu().data("disclosureMenu"),this.initChip()):this.initTextInput(),this.addListener(this.$container,"click",(function(t){var e;null!==(e=n.$chip)&&void 0!==e&&e.length&&!["A","BUTTON"].includes(t.target.nodeName)&&(n.switchToTextInput(),n.$textInput.focus())}))},hasPrefix:function(t){t=t.toLowerCase();var e,n=o(this.settings.prefixes);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(Craft.startsWith(t,i,!0))return!0}}catch(t){n.e(t)}finally{n.f()}return!1},ensurePrefix:function(t){return this.settings.prefixes.length&&!this.hasPrefix(t)?this.settings.prefixes[0]+t:t},removePrefix:function(t){var e,n=o(this.settings.prefixes);try{for(n.s();!(e=n.n()).done;){var i=e.value;t=Craft.removeLeft(t,i,!0)}}catch(t){n.e(t)}finally{n.f()}return t},removeFirstPrefix:function(t){return this.settings.prefixes.length?Craft.removeLeft(t,this.settings.prefixes[0],!0):t},createChip:function(t){var e=this.removePrefix(t);e.match(/^[^\/]+\/$/)&&(e=Craft.removeRight(e,"/"));var n="menu-".concat(Math.floor(1e6*Math.random()));this.reset(),this.$chip=$('\n<div class="chip chromeless">\n  <div class="chip-content">\n    <a href="'.concat(Craft.escapeHtml(t.replace(/ /g,"+")),'" rel="noopener" target="_blank" class="truncate">\n      ').concat(Craft.escapeHtml(e),'\n    </a>\n    <div class="chip-actions">\n      <button class="btn action-btn" type="button" aria-controls="').concat(n,'"\n          aria-label="').concat(Craft.t("app","Actions"),'"\n          data-disclosure-trigger data-icon="ellipsis"></button>\n      <div id="').concat(n,'" class="menu menu--disclosure"></div>\n    </div>\n  </div>\n</div>\n')).prependTo(this.$container),this.menu=this.$chip.find(".action-btn").disclosureMenu().data("disclosureMenu"),this.initChip()},createTextInput:function(t){this.reset(),this.$textInput=Craft.ui.createTextInput(this.settings.inputAttributes).attr("name",this.settings.inputName).val(t).prependTo(this.$container),this.initTextInput(),this.$textInput.trigger("input")},switchToTextInput:function(){var t=this.removeFirstPrefix(this.$hiddenInput.val());this.createTextInput(t)},initTextInput:function(){var t=this;this.addListener(this.$textInput,"input",(function(){var e=t.normalize(t.$textInput.val());t.$hiddenInput.val(e),t.field.updateLabel(t.removePrefix(e))})),this.addListener(this.$textInput,"blur",(function(){t.maybeSwitchToChip()})),this.addListener(this.$textInput,"keydown",(function(e){e.keyCode===Garnish.ESC_KEY&&t.maybeSwitchToChip()&&(e.stopPropagation(),t.$chip.find("a").focus())}))},normalize:function(t){if(!(t=Craft.trim(t)))return"";var e=this.ensurePrefix(t);return this.validate(e)?e:t},validate:function(t){return!!(t=c.toASCII(t)).match(new RegExp(this.settings.pattern,"i"))},maybeSwitchToChip:function(){var t;if(null!==(t=this.$textInput)&&void 0!==t&&t.length){var e=this.normalize(this.$textInput.val());return!(!e||!this.validate(e)||(this.createChip(e),0))}},initChip:function(){var t,e,n,i=this,a=this.menu.addItem({label:Craft.t("app","View in a new tab"),icon:(t=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("share");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),o=this.menu.addItem({label:Craft.t("app","Edit"),icon:(e=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("pencil");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}),l=this.menu.addItem({label:Craft.t("app","Copy URL"),icon:(n=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("link");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})});this.menu.addHr(),this.menu.addGroup();var c,u=this.menu.addItem({label:"Remove",icon:(c=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("xmark");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)}),destructive:!0});this.addListener(l,"activate",(function(){Craft.ui.createCopyTextPrompt({label:"Full URL",value:i.$hiddenInput.val().replace(/ /g,"+")})})),this.addListener(a,"activate",(function(){window.open(i.$chip.find("a").attr("href"))})),this.addListener(o,"activate",(function(){i.switchToTextInput(),i.$textInput.focus()})),this.addListener(u,"activate",(function(){i.createTextInput(""),i.$textInput.focus()}))},reset:function(){var t,e,n;null===(t=this.$textInput)||void 0===t||t.remove(),null===(e=this.$chip)||void 0===e||e.remove(),null===(n=this.menu)||void 0===n||n.destroy(),this.$textInput=this.$chip=this.menu=null}},{defaults:{prefixes:null,pattern:null,textInputAttributes:{}}})},5571:function(){Craft.PasswordInput=Garnish.Base.extend({$passwordWrapper:null,$passwordInput:null,$textInput:null,$currentInput:null,$showPasswordToggle:null,showingPassword:null,init:function(t,e){this.$passwordInput=$(t),this.$passwordWrapper=this.$passwordInput.parent(".passwordwrapper"),this.settings=$.extend({},Craft.PasswordInput.defaults,e),this.$passwordInput.data("passwordInput")&&(console.warn("Double-instantiating a password input on an element"),this.$passwordInput.data("passwordInput").destroy()),this.$passwordInput.data("passwordInput",this),this.$showPasswordToggle=$('<button type="button" class="invisible" />'),this.$showPasswordToggle.addClass("password-toggle"),this.$showPasswordToggle.insertAfter(this.$passwordInput),this.initInputFocusEvents(this.$passwordInput),this.addListener(this.$showPasswordToggle,"click","onClick"),this.hidePassword(),this.addListener(this.$passwordWrapper.closest("form"),"submit","hidePassword")},setCurrentInput:function(t){this.$currentInput&&(t.insertAfter(this.$currentInput),this.$currentInput.detach(),t.focus(),t.val(this.$currentInput.val())),this.$currentInput=t,this.addListener(this.$currentInput,"keypress,keyup,change,blur","onInputChange")},updateToggleLabel:function(t){this.$showPasswordToggle.text(t)},initInputFocusEvents:function(t){this.addListener(t,"focus",(function(){this.$passwordWrapper.addClass("focus")})),this.addListener(t,"blur",(function(){this.$passwordWrapper.removeClass("focus")}))},showPassword:function(){this.showingPassword||(this.$textInput||(this.$textInput=this.$passwordInput.clone(!0),this.$textInput.attr({type:"text",autocapitalize:"off"}),this.initInputFocusEvents(this.$textInput)),this.setCurrentInput(this.$textInput),this.updateToggleLabel(Craft.t("app","Hide")),this.showingPassword=!0)},hidePassword:function(){!1!==this.showingPassword&&(this.setCurrentInput(this.$passwordInput),this.updateToggleLabel(Craft.t("app","Show")),this.showingPassword=!1)},togglePassword:function(){this.showingPassword?this.hidePassword():this.showPassword(),this.settings.onToggleInput(this.$currentInput)},onInputChange:function(){this.$currentInput.val()?this.$showPasswordToggle.removeClass("invisible"):this.$showPasswordToggle.addClass("invisible")},onClick:function(t){if(this.$currentInput[0].setSelectionRange){var e=this.$currentInput[0].selectionStart,n=this.$currentInput[0].selectionEnd;this.togglePassword(),this.$currentInput[0].setSelectionRange(e,n)}else this.togglePassword()},destroy:function(){this.$passwordInput.removeData("passwordInput"),this.base()}},{defaults:{onToggleInput:$.noop}})},5616:function(){function t(){"use strict";t=function(){return n};var e,n={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(r,s,o,l){var c=f(t[r],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(a.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(i(t)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function e(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function n(t){return function(){var n=this,i=arguments;return new Promise((function(r,a){var s=t.apply(n,i);function o(t){e(s,r,a,o,l,"next",t)}function l(t){e(s,r,a,o,l,"throw",t)}o(void 0)}))}}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return(e=function(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c;Craft.ui={createButton:function(t){var e,n=$("<button/>",{type:t.type||"button",class:"btn"});if(t.id&&n.attr("id",t.id),t.class&&n.addClass(t.class),t.ariaLabel&&n.attr("aria-label",t.ariaLabel),t.ariaDescribedBy&&n.attr("aria-describedby",t.ariaDescribedBy),t.role&&n.attr("role",t.role),t.icon||t.label||t.html){var i=$('<div class="inline-flex gap-xs"/>').appendTo(n);if(t.icon&&(e=$('<div class="cp-icon"/>').prependTo(i)),t.label||t.html){var r=$('<div class="label"/>').appendTo(i);t.label?r.text(t.label):r.html(t.html)}}else n.addClass("btn-empty");return t.toggle&&n.attr("aria-expanded","false"),t.controls&&n.attr("aria-controls",t.controls),t.data&&Object.entries(t.data).forEach((function(t){n.attr("data-"+t[0],t[1])})),t.spinner&&n.append($('<div class="spinner spinner-absolute"/>')),t.disabled&&n.attr("disabled","disabled"),t.icon&&this.icon(t.icon).then((function(t){e.append(t)})),n},createSubmitButton:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.createButton(Object.assign({},t,{type:"submit",label:t.label||Craft.t("app","Submit")})).addClass("submit")},createPasteButton:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.createButton(Object.assign({},t,{icon:"duplicate",label:t.label||Craft.uppercaseFirst(Craft.t("app","Paste {type}",{type:Craft.t("app","elements")})),spinner:!0})).addClass("paste-btn")},createTextInput:function(t){t=$.extend({autocomplete:!1},t);var e=$("<input/>",{attr:{class:"text",type:t.type||"text",inputmode:t.inputmode,id:t.id,size:t.size,name:t.name,value:t.value,maxlength:t.maxlength,autofocus:this.getAutofocusValue(t.autofocus),autocomplete:"boolean"==typeof t.autocomplete?t.autocomplete?"on":"off":t.autocomplete,disabled:this.getDisabledValue(t.disabled),"aria-describedby":this.getDescribedByValue(t),readonly:t.readonly,title:t.title,placeholder:t.placeholder,step:t.step,min:t.min,max:t.max}});return t.class&&e.addClass(t.class),t.placeholder&&e.addClass("nicetext"),"password"===t.type&&e.addClass("password"),t.disabled&&e.addClass("disabled"),t.size||e.addClass("fullwidth"),t.describedBy&&e.attr("aria-describedby",t.describedBy),t.inputAttributes&&this.addAttributes(e,t.inputAttributes),t.showCharsLeft&&t.maxlength&&e.attr("data-show-chars-left").css("padding-"+("ltr"===Craft.orientation?"right":"left"),7.2*t.maxlength.toString().length+14+"px"),(t.placeholder||t.showCharsLeft)&&new Garnish.NiceText(e),"password"===t.type?$('<div class="passwordwrapper"/>').append(e):e},createTextField:function(t){return t.id||(t.id="text"+Math.floor(1e9*Math.random())),this.createField(this.createTextInput(t),t)},createPasswordInput:function(t){return this.createTextInput(Object.assign({},t,{type:"password"}))},createPasswordField:function(t){return this.createTextField(Object.assign({},t,{type:"password"}))},createCopyTextInput:function(t){var e=t.id||"copytext"+Math.floor(1e9*Math.random()),n=t.buttonId||"".concat(e,"-btn"),i=$("<div/>",{class:"copytext"}),r=$.extend({},t,{readonly:!0});t.textarea;var a=t.textarea?this.createTextarea(r):this.createTextInput(r);return a.appendTo(i),$("<button/>",{type:"button",id:n,class:"btn","data-icon":"clipboard",title:Craft.t("app","Copy to clipboard"),"aria-label":Craft.t("app","Copy to clipboard")}).appendTo(i).on("click",(function(){a[0].select(),document.execCommand("copy"),Craft.cp.displayNotice(Craft.t("app","Copied to clipboard.")),i.trigger("copy"),a[0].setSelectionRange(0,0)})),i},createCopyTextBtn:function(t){var e=t.id||"copytext"+Math.floor(1e9*Math.random()),n=t.value,i=$("<craft-copy-attribute/>"),r=$("<div/>",{id:e,class:"copytextbtn",role:"button",title:Craft.t("app","Copy to clipboard"),tabindex:"0"}).appendTo(i);return t.class&&r.addClass(t.class),r.text(n),i},createCopyTextField:function(t){return t.id||(t.id="copytext"+Math.floor(1e9*Math.random())),this.createField(this.createCopyTextInput(t),t)},createCopyTextPrompt:function(t){var e=$("<div/>",{class:"modal fitted"}),n=$("<div/>",{class:"body"}).appendTo(e);this.createCopyTextField($.extend({size:Math.max(Math.min(t.value.length,50),25)},t)).appendTo(n);var i=n.find("label");i.length>0&&i.attr("id")&&e.attr("aria-labelledby",i.attr("id"));var r=new Garnish.Modal(e,{closeOtherModals:!1});return e.on("copy",(function(){r.hide()})),e},createTextarea:function(t){var e=$("<textarea/>",{class:"text",rows:t.rows||2,cols:t.cols||50,id:t.id,name:t.name,maxlength:t.maxlength,autofocus:t.autofocus&&!Garnish.isMobileBrowser(!0),disabled:!!t.disabled,placeholder:t.placeholder,html:t.value});return t.showCharsLeft&&e.attr("data-show-chars-left",""),t.class&&e.addClass(t.class),t.size||e.addClass("fullwidth"),e},createTextareaField:function(t){return t.id||(t.id="textarea"+Math.floor(1e9*Math.random())),this.createField(this.createTextarea(t),t)},createSelect:function(t){var e=$("<div/>",{class:"select"});t.class&&e.addClass(t.class);var n=$("<select/>",{id:t.id,name:t.name,autofocus:t.autofocus&&Garnish.isMobileBrowser(!0),disabled:t.disabled,"data-target-prefix":t.targetPrefix,"aria-labelledby":t.labelledBy}).appendTo(e);if($.isPlainObject(t.options)){var i=[];for(var r in t.options)if(t.options.hasOwnProperty(r)){var a=t.options[r];$.isPlainObject(a)?void 0!==a.optgroup?i.push(a):i.push({label:a.label,value:void 0!==a.value?a.value:r,disabled:void 0!==a.disabled&&a.disabled}):i.push({label:a,value:r})}t.options=i}for(var s=null,o=0;o<t.options.length;o++){var l=t.options[o];if(void 0!==l.optgroup)s=$("<optgroup/>",{label:l.optgroup}).appendTo(n);else{var c=$("<option/>",{value:l.value,selected:l.value==t.value,disabled:void 0!==l.disabled&&l.disabled}).appendTo(s||n);l.labelHtml?c.html(l.labelHtml):l.label&&c.text(l.label)}}return t.toggle&&(n.addClass("fieldtoggle"),new Craft.FieldToggle(n)),e},createSelectField:function(t){return t.id||(t.id="select"+Math.floor(1e9*Math.random())),this.createField(this.createSelect(t),t)},createCheckbox:function(t){var e=t.id||"checkbox"+Math.floor(1e9*Math.random()),n=$("<input/>",{type:"checkbox",value:void 0!==t.value?t.value:"1",id:e,class:"checkbox",name:t.name,checked:t.checked?"checked":null,autofocus:this.getAutofocusValue(t.autofocus),disabled:this.getDisabledValue(t.disabled),"data-target":t.toggle,"data-reverse-target":t.reverseToggle});t.class&&n.addClass(t.class),t.data&&Object.entries(t.data).forEach((function(t){n.attr("data-"+t[0],t[1])})),t.aria&&Object.entries(t.aria).forEach((function(t){n.attr("aria-"+t[0],t[1])})),(t.toggle||t.reverseToggle)&&(n.addClass("fieldtoggle"),new Craft.FieldToggle(n));var i=$("<label/>",{for:e});return t.labelHtml?i.html(t.labelHtml):t.label&&i.text(t.label),t.name&&(t.name.length<3||"[]"!==t.name.slice(-2))?$([$("<input/>",{type:"hidden",name:t.name,value:""})[0],n[0],i[0]]):$([n[0],i[0]])},createCheckboxField:function(t){t.id||(t.id="checkbox"+Math.floor(1e9*Math.random()));var e=["field","checkboxfield"];t.fieldClass.length>0&&(e=e.concat(t.fieldClass));var n=$('<div class="'+e.join(" ")+'"/>',{id:"".concat(t.id,"-field")});return t.first&&n.addClass("first"),t.instructions&&n.addClass("has-instructions"),this.createCheckbox(t).appendTo(n),t.instructions&&$('<div class="instructions"/>').text(t.instructions).appendTo(n),n},createCheckboxSelect:function(t){var e=$('<div class="checkbox-select"/>');t.class&&e.addClass(t.class);var n=t.values||[],i=!1;if(t.showAllOption){var r=t.allValue||"*";n===r&&(n=t.options.map((function(t){return t.value})),i=!0),$("<div/>").appendTo(e).append(this.createCheckbox({id:t.id,class:"all",labelHtml:"<b>"+(t.allLabel||Craft.t("app","All"))+"</b>",name:t.name,value:r,checked:i,autofocus:t.autofocus,disabled:t.disabled})),t.options=t.options.filter((function(t){return t.value!==r}))}else i=!1;Array.isArray(n)||(n=[]),t.sortable&&t.options.sort((function(t,e){var i=n.indexOf(t.value),r=n.indexOf(e.value);return-1===i&&(i=n.length),-1===r&&(r=n.length),i-r}));for(var a=0;a<t.options.length;a++){var s=t.options[a],o=$("<div/>",{class:"checkbox-select-item"}).appendTo(e);t.sortable&&$("<div/>",{class:"icon move draggable-handle"}).appendTo(o),this.createCheckbox({label:Craft.escapeHtml(s.label),name:t.name?Craft.ensureEndsWith(t.name,"[]"):null,value:s.value,checked:i||n.includes(s.value),disabled:i||t.disabled}).appendTo(o)}if(t.includeSortActions)new Craft.SortableCheckboxSelect(e);else if(new Garnish.CheckboxSelect(e),t.sortable){var l=new Garnish.DragSort(e.children(":not(.all)"),{handle:".move",axis:"y"});e.data("dragSort",l)}return e},createCheckboxSelectField:function(t){return t.fieldset=!0,t.id||(t.id="checkboxselect"+Math.floor(1e9*Math.random())),this.createField(this.createCheckboxSelect(t),t)},createSortableCheckboxSelect:function(t){return this.createCheckboxSelect(s(s({},t),{},{sortable:!0,includeSortActions:!0}))},createSortableCheckboxSelectField:function(t){return this.createCheckboxSelectField(s(s({},t),{},{sortable:!0,includeSortActions:!0}))},createLightswitch:function(t){var e=t.value||"1",n=t.indeterminateValue||"-",i=$("<button/>",{type:"button",class:"lightswitch","data-value":e,"data-indeterminate-value":n,id:t.id,role:"switch","aria-checked":t.on?"true":t.indeterminate?"mixed":"false","aria-labelledby":t.labelId,"data-target":t.toggle,"data-reverse-target":t.reverseToggle});return t.on?i.addClass("on"):t.indeterminate&&i.addClass("indeterminate"),t.small&&i.addClass("small"),t.disabled&&i.addClass("disabled"),$('<div class="lightswitch-container"><div class="handle"></div></div>').appendTo(i),t.name&&$("<input/>",{type:"hidden",name:t.name,value:t.on?e:t.indeterminate?n:"",disabled:t.disabled}).appendTo(i),(t.toggle||t.reverseToggle)&&(i.addClass("fieldtoggle"),new Craft.FieldToggle(i)),new Craft.LightSwitch(i,{onChange:t.onChange||$.noop}),i},createLightswitchField:function(t){return t.id||(t.id="lightswitch"+Math.floor(1e9*Math.random())),t.labelId||(t.labelId="".concat(t.id,"-label")),this.createField(this.createLightswitch(t),t).addClass("lightswitch-field")},createIconPicker:function(t){var e=$("<div/>",{id:t.id,class:"icon-picker"}),n=$("<div/>",{class:"icon-picker--icon",lang:Craft.language}).appendTo(e);if(t.small&&(e.addClass("small"),n.addClass("small")),!t.static){var i=this.createButton({class:"icon-picker--choose-btn",label:Craft.t("app","Choose")}).appendTo(e),r=this.createButton({class:"icon-picker--remove-btn hidden",label:Craft.t("app","Remove")}).appendTo(e);t.small&&(i.addClass("small"),r.addClass("small")),t.name&&$("<input/>",{type:"hidden",name:t.name}).appendTo(e)}var a=new Craft.IconPicker(e,{freeOnly:t.freeOnly});return t.value&&a.selectIcon(t.value),e},createIconPickerField:function(t){return t.id||(t.id="iconpicker"+Math.floor(1e9*Math.random())),t.labelId||(t.labelId="".concat(t.id,"-label")),this.createField(this.createIconPicker(t),t).addClass("iconpicker-field")},createColorInput:function(t){var e=t.id||"color"+Math.floor(1e9*Math.random()),n=t.containerId||e+"-container",i=t.name||null,r=t.value||null,a=t.small||!1,s=t.autofocus&&Garnish.isMobileBrowser(!0),o=t.disabled||!1,l=$("<div/>",{id:n,class:"flex color-container"}),c=$("<div/>",{class:"color static"+(a?" small":"")}).appendTo(l),u=($("<div/>",{class:"color-preview",style:t.value?{backgroundColor:t.value}:null}).appendTo(c),$("<div/>",{class:"color-input-container"}).append($("<div/>",{class:"color-hex-indicator light code","aria-hidden":"true",text:"#"})).appendTo(l));return this.createTextInput({id:e,name:i,value:Craft.ltrim(r,"#"),size:10,class:"color-input",autofocus:s,disabled:o,"aria-label":Craft.t("app","Color hex value")}).appendTo(u),new Craft.ColorInput(l),l},createColorField:function(t){return t.fieldset=!0,o,t.id||(t.id="color"+Math.floor(1e9*Math.random())),this.createField(this.createColorInput(t),t)},createDateInput:function(t){var e=Garnish.isMobileBrowser(),n=(t.id||"date"+Math.floor(1e9*Math.random()))+"-date",i=t.name||null,r=i?i+"[date]":null,a=t.value&&"function"==typeof t.value.getMonth?t.value:null,s=t.autofocus&&Garnish.isMobileBrowser(!0),o=t.disabled||!1,l=$("<div/>",{class:"datewrapper"}),c=this.createTextInput({id:n,type:e?"date":"text",class:!(!e||a)&&"empty-value",name:r,value:a?e?a.toISOString().split("T")[0]:Craft.formatDate(a):"",placeholder:" ",autocomplete:!1,autofocus:s,disabled:o}).appendTo(l);return $('<div data-icon="date"></div>').appendTo(l),i&&$("<input/>",{type:"hidden",name:i+"[timezone]",val:Craft.timezone}).appendTo(l),e?c.datetimeinput():c.datepicker($.extend({defaultDate:a||new Date},Craft.datepickerOptions)),t.hasOuterContainer?l:$('<div class="datetimewrapper"/>').append(l).datetime()},createDateField:function(t){return t.id||(t.id="date"+Math.floor(1e9*Math.random())),this.createField(this.createDateInput(t),t)},createDateRangePicker:function(t){var e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate());t=$.extend({class:"",options:["today","thisWeek","thisMonth","thisYear","past7Days","past30Days","past90Days","pastYear"],onChange:$.noop,selected:null,startDate:null,endDate:null},t);var i,r,a=$("<div/>",{class:"menu"}),s=$("<ul/>",{class:"padded"}).appendTo(a),o=$("<a/>").addClass("sel").text(Craft.t("app","All")).data("handle","all");$("<li/>").append(o).appendTo(s);for(var l=0;l<t.options.length;l++){var c=t.options[l];switch(c){case"today":i={label:Craft.t("app","Today"),startDate:n,endDate:n};break;case"thisWeek":var u=e.getDay()-Craft.datepickerOptions.firstDay;u<0&&(u+=7),i={label:Craft.t("app","This week"),startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()-u),endDate:n};break;case"thisMonth":i={label:Craft.t("app","This month"),startDate:new Date(e.getFullYear(),e.getMonth()),endDate:n};break;case"thisYear":i={label:Craft.t("app","This year"),startDate:new Date(e.getFullYear(),0),endDate:n};break;case"past7Days":i={label:Craft.t("app","Past {num} days",{num:7}),startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()-7),endDate:n};break;case"past30Days":i={label:Craft.t("app","Past {num} days",{num:30}),startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()-30),endDate:n};break;case"past90Days":i={label:Craft.t("app","Past {num} days",{num:90}),startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()-90),endDate:n};break;case"pastYear":i={label:Craft.t("app","Past year"),startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()-365),endDate:n}}var h=$("<li/>"),d=$("<a/>",{text:i.label}).data("handle",c).data("startDate",i.startDate).data("endDate",i.endDate).data("startTime",i.startDate?i.startDate.getTime():null).data("endTime",i.endDate?i.endDate.getTime():null);t.selected&&c==t.selected&&(r=d[0]),h.append(d),h.appendTo(s)}$("<hr/>").appendTo(a);var f=$("<div/>",{class:"flex flex-nowrap padded"}).appendTo(a),p=this.createDateField({label:Craft.t("app","From")}).appendTo(f).find("input"),g=this.createDateField({label:Craft.t("app","To")}).appendTo(f).find("input"),m=p.add(g);m.on("keyup",(function(t){t.keyCode===Garnish.ESC_KEY&&$(this).data("datepicker")&&$(this).data("datepicker").dpDiv.is(":visible")&&t.stopPropagation()})),p.data("datepicker")&&p.data("datepicker").dpDiv.on("mousedown",(function(t){t.stopPropagation()})),g.data("datepicker")&&g.data("datepicker").dpDiv.on("mousedown",(function(t){t.stopPropagation()}));var v=new Garnish.Menu(a,{onOptionSelect:function(e){var n=$(e);b.text(n.text()),v.setPositionRelativeToAnchor(),a.find(".sel").removeClass("sel"),n.addClass("sel"),p.hasClass("hasDatepicker")?(p.datepicker("setDate",n.data("startDate")),g.datepicker("setDate",n.data("endDate"))):(p.val(n.data("startDate")),g.val(n.data("endDate"))),t.onChange(n.data("startDate")||null,n.data("endDate")||null,n.data("handle"))}});m.on("change",(function(){var e=null,n=null;if(p.hasClass("hasDatepicker"))e=p.datepicker("getDate"),n=g.datepicker("getDate");else{var i=p.val();""!==i&&(e=new Date(Date.parse(i)));var r=g.val();""!==r&&(n=new Date(Date.parse(r)))}for(var o,l=e?e.getTime():null,c=n?n.getTime():null,u=s.find("a"),h=!1,d=0;d<u.length;d++)if(l===((o=u.eq(d)).data("startTime")||null)&&c===(o.data("endTime")||null)){v.selectOption(o[0]),h=!0,t.onChange(null,null,o.data("handle"));break}h||(a.find(".sel").removeClass("sel"),f.addClass("sel"),l||c?l&&c?b.text(p.val()+" - "+g.val()):l?b.text(Craft.t("app","From {date}",{date:p.val()})):b.text(Craft.t("app","To {date}",{date:g.val()})):b.text(Craft.t("app","All")),v.setPositionRelativeToAnchor(),t.onChange(e,n,"custom"))})),v.on("hide",(function(){p.datepicker("hide"),g.datepicker("hide")}));var y="btn menubtn";t.class&&(y=y+" "+t.class);var b=$("<button/>",{type:"button",class:y,"data-icon":"date",text:Craft.t("app","All")});if(new Garnish.MenuBtn(b,v),r&&v.selectOption(r),t.startDate)if(p.hasClass("hasDatepicker"))p.datepicker("setDate",t.startDate);else{var w=t.startDate.getTimezoneOffset(),C=new Date(t.startDate.getTime()-60*w*1e3);p.val(C.toISOString().split("T")[0])}if(t.endDate)if(g.hasClass("hasDatepicker"))g.datepicker("setDate",t.endDate);else{var _=t.endDate.getTimezoneOffset(),S=new Date(t.endDate.getTime()-60*_*1e3);g.val(S.toISOString().split("T")[0])}return(t.startDate||t.endDate)&&m.trigger("change"),b},remediateTimepickerA11y:function(t){var e=$(t),n=null,i=null,a=e.attr("id"),s="".concat(a,"-wrapper-").concat(Math.floor(1e9*Math.random())),o=function(){var t;return null===(t=e[0])||void 0===t?void 0:t.timepickerObj};getAccessibleName=function(){return e.attr("aria-label")};var l=function(t,n){var i,a=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}(t);try{for(a.s();!(i=a.n()).done;){var s=i.value.target;if($(s).hasClass("ui-timepicker-selected")){var o=s.id;e.attr("aria-activedescendant",o),$(s).attr("aria-selected","true")}else $(s).attr("aria-selected","false")}}catch(t){a.e(t)}finally{a.f()}};o()&&(e.attr("aria-controls",s),e.on("showTimepicker",(function(){var t;e.attr("aria-expanded","true"),t=o(),n=$(t.list),setTimeout((function(){n.attr({role:"listbox",id:s,"aria-label":getAccessibleName()}),n.find("li").each((function(t){var n=$(this).hasClass("ui-timepicker-selected"),i="".concat(a,"-option-").concat(t);$(this).attr({id:i,role:"option","aria-selected":n}),n&&e.attr("aria-activedescendant",i)})),i||(i=new MutationObserver(l)),i.observe(n[0],{subtree:!0,attributeFilter:["class"]})}),0)})),e.on("hideTimepicker",(function(){e.attr("aria-expanded","false"),i&&i.disconnect()})))},createTimeInput:function(t){var e=Garnish.isMobileBrowser(),n=(t.id||"time"+Math.floor(1e9*Math.random()))+"-time",i=t.name||null,r=i?i+"[time]":null,a=t.value&&"function"==typeof t.value.getMonth?t.value:null,s=t.autofocus&&Garnish.isMobileBrowser(!0),o=t.disabled||!1,l=$("<div/>",{class:"timewrapper"}),c=this.createTextInput({id:n,type:e?"time":"text",class:!(!e||a)&&"empty-value",name:r,placeholder:" ",autocomplete:!1,autofocus:s,disabled:o}).appendTo(l);return $('<div data-icon="time"></div>').appendTo(l),i&&$("<input/>",{type:"hidden",name:i+"[timezone]",val:Craft.timezone}).appendTo(l),e?(a&&c.val(a.toISOString().split("T")[1]),c.datetimeinput()):(c.timepicker(Craft.timepickerOptions),this.remediateTimepickerA11y(c),a&&c.timepicker("setTime",3600*a.getHours()+60*a.getMinutes()+a.getSeconds())),t.hasOuterContainer?l:$('<div class="datetimewrapper"/>').append(l).datetime()},createTimeField:function(t){return t.id||(t.id="time"+Math.floor(1e9*Math.random())),this.createField(this.createTimeInput(t),t)},createField:function(t,e){var n=e.label&&"__blank__"!==e.label?e.label:null,i=$(e.fieldset?"<fieldset/>":"<div/>",{class:"field",id:e.fieldId||(e.id?e.id+"-field":null),"aria-describedby":e.fieldset?this.getDescribedByValue(e):null});if(e.first&&i.addClass("first"),e.fieldClass&&i.addClass(e.fieldClass),n&&e.fieldset&&$("<legend/>",{text:n,class:"visually-hidden","data-label":n}).appendTo(i),n){var r=$('<div class="heading"/>').appendTo(i),a=$(e.fieldset?"<legend/>":"<label/>",{id:e.labelId||(e.id?"".concat(e.id,"-").concat(e.fieldset?"legend":"label"):null),for:!e.fieldset&&e.id||null,text:n}).appendTo(r);e.required&&($("<span/>",{class:"visually-hidden",text:Craft.t("app","Required")}).appendTo(a),$("<span/>",{class:"required","aria-hidden":"true"}).appendTo(a))}if(e.instructions&&$('<div class="instructions"/>').text(e.instructions).attr("id",this.getInstructionsId(e)).appendTo(i),$('<div class="input"/>').append(t).appendTo(i),e.tip){var s=$('<p class="notice has-icon"/>');$('<span class="icon" aria-hidden="true"/>').appendTo(s),$('<span class="visually-hidden"/>').text(Craft.t("app","Tip")+": ").appendTo(s),$("<span/>").text(e.tip).appendTo(s),s.appendTo(i)}if(e.warning){var o=$('<p class="warning has-icon"/>');$('<span class="icon" aria-hidden="true"/>').appendTo(o),$('<span class="visually-hidden"/>').text(Craft.t("app","Warning")+": ").appendTo(o),$("<span/>").text(e.warning).appendTo(o),o.appendTo(i)}return e.errors&&this.addErrorsToField(i,e.errors),i},addAttributes:function(t,e){for(var n in e){var r=e[n];if("boolean"==typeof r)r&&t.attr(n,"");else if($.isPlainObject(r))if(["aria","data","data-ng","ng"].includes(n))for(var a in r){var s=r[a];"object"===i(s)?t.attr("".concat(n,"-").concat(a),JSON.stringify(s)):"boolean"==typeof s?s&&t.attr("".concat(n,"-").concat(a),""):null!==s&&t.attr("".concat(n,"-").concat(a),s)}else"class"===n?t.addClass(r):"style"===n?t.css(r):t.attr(n,r)}},createErrorList:function(t,e){var n=$('<ul class="errors" tabindex="-1"/>');return e&&n.attr("id",e),t&&this.addErrorsToList(n,t),n},addErrorsToList:function(t,e){for(var n=0;n<e.length;n++)$("<li/>").text(e[n].replaceAll("*","")).appendTo(t)},addErrorsToField:function(t,e){if(e){this.clearErrorsFromField(t),t.addClass("has-errors"),t.children(".input").addClass("errors prevalidate");var n=t.attr("id"),i="";n&&(i=n.replace(new RegExp("(-field)$"),"-errors"));var r=t.children("ul.errors");r.length||(r=this.createErrorList(null,i).appendTo(t)),this.addErrorsToList(r,e)}},clearErrorsFromField:function(t){t.removeClass("has-errors"),t.children(".input").removeClass("errors prevalidate"),t.children("ul.errors").remove()},clearErrorSummary:function(t){t.find(".error-summary").remove()},setFocusOnErrorSummary:function(t){var e=this,n=t.find(".error-summary");n.length>0&&(n.focus(),n.find("a").on("click",(function(n){0==$(n.currentTarget).hasClass("cross-site-validate")&&(n.preventDefault(),e.anchorSummaryErrorToField(n.currentTarget,t))})))},findErrorsContainerByErrorKey:function(t,e){var n=t.find('[data-error-key="'.concat(e,'"]')).find("ul.errors");return $(n)},anchorSummaryErrorToField:function(t,e){var n=$(t).attr("data-field-error-key");if(n){var i=this.findErrorsContainerByErrorKey(e,n);if(i){var r=this.findTabAnchorForField(i,e);if(r.length>0)for(var a=0;a<r.length;a++){var s=$(r[a]);"false"==s.attr("aria-selected")&&s.click()}var o=i.parents(".collapsed, .is-collapsed");if(o.length>0)for(var l=o.length;l>0;l--){var c=$(o[l-1]);null!=c.data("block")?c.data("block").expand():c.find(".titlebar").trigger("doubletap")}var u=i.parents(".field:first");u.is(":visible")?u.attr("tabindex","-1").focus():setTimeout((function(){u.attr("tabindex","-1").focus()}),201)}}},findTabAnchorForField:function(t,e){var n=t.parents('div[data-id^=tab][role="tabpanel"]'),i=[];return n.each((function(t,n){var r=e.find('[role="tablist"]').find('a[href="#'+$(n).attr("id")+'"]');i.push(r)})),i},getInstructionsId:function(t){return t.id?"".concat(t.id,"-instructions"):"".concat(Math.floor(1e9*Math.random()),"-instructions")},getAutofocusValue:function(t){return t&&!Garnish.isMobileBrowser(!0)?"autofocus":null},getDisabledValue:function(t){return t?"disabled":null},getDescribedByValue:function(t){var e="";return t.instructions&&(e+=this.getInstructionsId(t)),e.length?e:null},icon:(c=n(t().mark((function e(i){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Craft.icons||(Craft.icons={}),Craft.icons[i]){e.next=4;break}return e.next=4,Craft.queue.push(n(t().mark((function e(){var n,r;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Craft.icons[i]){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Craft.sendActionRequest("POST","app/icon-svg",{data:{icon:i}});case 4:n=t.sent,r=n.data,Craft.icons[i]=r.iconSvg;case 7:case"end":return t.stop()}}),e)}))));case 4:return e.abrupt("return",$(Craft.icons[i])[0]);case 5:case"end":return e.stop()}}),e)}))),function(t){return c.apply(this,arguments)})}},5794:function(){Craft.Grid=Garnish.Base.extend({$container:null,$items:null,items:null,totalCols:null,colGutterDrop:null,colPctWidth:null,possibleItemColspans:null,possibleItemPositionsByColspan:null,itemPositions:null,itemColspansByPosition:null,layouts:null,layout:null,itemHeights:null,leftPadding:null,_refreshingCols:!1,_refreshColsAfterRefresh:!1,_forceRefreshColsAfterRefresh:!1,init:function(t,e){var n=this;this.$container=$(t),this.$container.data("grid")&&(console.warn("Double-instantiating a grid on an element"),this.$container.data("grid").destroy()),this.$container.data("grid",this),this.setSettings(e,Craft.Grid.defaults),this.handleContainerHeightProxy=function(){n.refreshCols(!1,!0)},this.$items=this.$container.children(this.settings.itemSelector),this.setItems(),this.refreshCols(!0,!1),Garnish.$doc.ready((function(){n.refreshCols(!1,!1)}))},addItems:function(t){this.$items=$().add(this.$items.add(t)),this.setItems(),this.refreshCols(!0,!0)},removeItems:function(t){this.$items=$().add(this.$items.not(t)),this.setItems(),this.refreshCols(!0,!0)},resetItemOrder:function(){this.$items=$().add(this.$items),this.setItems(),this.refreshCols(!0,!0)},setItems:function(){for(this.setItems._={},this.items=[],this.setItems._.i=0;this.setItems._.i<this.$items.length;this.setItems._.i++)this.items.push($(this.$items[this.setItems._.i]));delete this.setItems._},refreshCols:function(t){var e=this;if(this._refreshingCols)return this._refreshColsAfterRefresh=!0,void(t&&(this._forceRefreshColsAfterRefresh=!0));this._refreshingCols=!0,this.items.length?(this.refreshCols._={},this.refreshCols._.oldHeight=this.$container[0].style.height,this.$container[0].style.height=1,this.refreshCols._.scrollHeight=this.$container[0].scrollHeight,this.$container[0].style.height=this.refreshCols._.oldHeight,0!==this.refreshCols._.scrollHeight?(this.settings.cols?this.refreshCols._.totalCols=this.settings.cols:(this.refreshCols._.totalCols=Math.floor(this.$container.width()/this.settings.minColWidth),null!==this.totalCols&&this.refreshCols._.totalCols>this.totalCols&&(this.refreshCols._.totalCols=Math.floor((this.$container.width()-20)/this.settings.minColWidth)),this.settings.maxCols&&this.refreshCols._.totalCols>this.settings.maxCols&&(this.refreshCols._.totalCols=this.settings.maxCols)),0===this.refreshCols._.totalCols&&(this.refreshCols._.totalCols=1),!0===t||this.totalCols!==this.refreshCols._.totalCols||this.settings.snapToGrid?(this.totalCols=this.refreshCols._.totalCols,this.colGutterDrop=this.settings.gutter*(this.totalCols-1)/this.totalCols,Garnish.muteResizeEvents((function(){if("grid"===e.settings.fillMode)for(e.refreshCols._.itemIndex=0;e.refreshCols._.itemIndex<e.items.length;){for(e.refreshCols._.tallestItemHeight=-1,e.refreshCols._.colIndex=0,e.refreshCols._.i=e.refreshCols._.itemIndex;e.refreshCols._.i<e.refreshCols._.itemIndex+e.totalCols&&e.refreshCols._.i<e.items.length;e.refreshCols._.i++)e.refreshCols._.itemHeight=e.items[e.refreshCols._.i].height("auto").height(),e.refreshCols._.itemHeight>e.refreshCols._.tallestItemHeight&&(e.refreshCols._.tallestItemHeight=e.refreshCols._.itemHeight),e.refreshCols._.colIndex++;for(e.settings.snapToGrid&&(e.refreshCols._.remainder=e.refreshCols._.tallestItemHeight%e.settings.snapToGrid,e.refreshCols._.remainder&&(e.refreshCols._.tallestItemHeight+=e.settings.snapToGrid-e.refreshCols._.remainder)),e.refreshCols._.i=e.refreshCols._.itemIndex;e.refreshCols._.i<e.refreshCols._.itemIndex+e.totalCols&&e.refreshCols._.i<e.items.length;e.refreshCols._.i++)e.items[e.refreshCols._.i].height(e.refreshCols._.tallestItemHeight);e.refreshCols._.itemIndex+=e.totalCols}else if(1===e.totalCols)e.$container.height("auto"),e.$items.show().css({position:"relative",width:"auto",top:0}).css(Craft.left,0);else{for(e.$items.css("position","absolute"),e.colPctWidth=100/e.totalCols,e.layouts=[],e.itemPositions=[],e.itemColspansByPosition=[],e.possibleItemColspans=[],e.possibleItemPositionsByColspan=[],e.itemHeightsByColspan=[],e.refreshCols._.item=0;e.refreshCols._.item<e.items.length;e.refreshCols._.item++)for(e.possibleItemColspans[e.refreshCols._.item]=[],e.possibleItemPositionsByColspan[e.refreshCols._.item]={},e.itemHeightsByColspan[e.refreshCols._.item]={},e.refreshCols._.$item=e.items[e.refreshCols._.item].show(),e.refreshCols._.positionRight="right"===e.refreshCols._.$item.data("position"),e.refreshCols._.positionLeft="left"===e.refreshCols._.$item.data("position"),e.refreshCols._.minColspan=e.refreshCols._.$item.data("colspan")?e.refreshCols._.$item.data("colspan"):e.refreshCols._.$item.data("min-colspan")?e.refreshCols._.$item.data("min-colspan"):1,e.refreshCols._.maxColspan=e.refreshCols._.$item.data("colspan")?e.refreshCols._.$item.data("colspan"):e.refreshCols._.$item.data("max-colspan")?e.refreshCols._.$item.data("max-colspan"):e.totalCols,e.refreshCols._.minColspan>e.totalCols&&(e.refreshCols._.minColspan=e.totalCols),e.refreshCols._.maxColspan>e.totalCols&&(e.refreshCols._.maxColspan=e.totalCols),e.refreshCols._.colspan=e.refreshCols._.minColspan;e.refreshCols._.colspan<=e.refreshCols._.maxColspan;e.refreshCols._.colspan++)for(e.refreshCols._.$item.css("width",e.getItemWidthCss(e.refreshCols._.colspan)),e.itemHeightsByColspan[e.refreshCols._.item][e.refreshCols._.colspan]=e.refreshCols._.$item.outerHeight(),e.possibleItemColspans[e.refreshCols._.item].push(e.refreshCols._.colspan),e.possibleItemPositionsByColspan[e.refreshCols._.item][e.refreshCols._.colspan]=[],e.refreshCols._.positionLeft?(e.refreshCols._.minPosition=0,e.refreshCols._.maxPosition=0):e.refreshCols._.positionRight?(e.refreshCols._.minPosition=e.totalCols-e.refreshCols._.colspan,e.refreshCols._.maxPosition=e.refreshCols._.minPosition):(e.refreshCols._.minPosition=0,e.refreshCols._.maxPosition=e.totalCols-e.refreshCols._.colspan),e.refreshCols._.position=e.refreshCols._.minPosition;e.refreshCols._.position<=e.refreshCols._.maxPosition;e.refreshCols._.position++)e.possibleItemPositionsByColspan[e.refreshCols._.item][e.refreshCols._.colspan].push(e.refreshCols._.position);for(e.refreshCols._.colHeights=[],e.refreshCols._.i=0;e.refreshCols._.i<e.totalCols;e.refreshCols._.i++)e.refreshCols._.colHeights.push(0);for(e.createLayouts(0,[],[],e.refreshCols._.colHeights,0),e.refreshCols._.layoutTotalCols=[],e.refreshCols._.i=0;e.refreshCols._.i<e.layouts.length;e.refreshCols._.i++)for(e.refreshCols._.layoutTotalCols[e.refreshCols._.i]=0,e.refreshCols._.j=0;e.refreshCols._.j<e.totalCols;e.refreshCols._.j++)e.layouts[e.refreshCols._.i].colHeights[e.refreshCols._.j]&&e.refreshCols._.layoutTotalCols[e.refreshCols._.i]++;for(e.refreshCols._.highestTotalCols=Math.max.apply(null,e.refreshCols._.layoutTotalCols),e.refreshCols._.i=e.layouts.length-1;e.refreshCols._.i>=0;e.refreshCols._.i--)e.refreshCols._.layoutTotalCols[e.refreshCols._.i]!==e.refreshCols._.highestTotalCols&&e.layouts.splice(e.refreshCols._.i,1);for(e.refreshCols._.layoutHeights=[],e.refreshCols._.i=0;e.refreshCols._.i<e.layouts.length;e.refreshCols._.i++)e.refreshCols._.layoutHeights.push(Math.max.apply(null,e.layouts[e.refreshCols._.i].colHeights));for(e.refreshCols._.shortestHeight=Math.min.apply(null,e.refreshCols._.layoutHeights),e.refreshCols._.shortestLayouts=[],e.refreshCols._.emptySpaces=[],e.refreshCols._.i=0;e.refreshCols._.i<e.refreshCols._.layoutHeights.length;e.refreshCols._.i++)if(e.refreshCols._.layoutHeights[e.refreshCols._.i]===e.refreshCols._.shortestHeight){for(e.refreshCols._.shortestLayouts.push(e.layouts[e.refreshCols._.i]),e.refreshCols._.emptySpace=e.layouts[e.refreshCols._.i].emptySpace,e.refreshCols._.j=0;e.refreshCols._.j<e.totalCols;e.refreshCols._.j++)e.refreshCols._.emptySpace+=e.refreshCols._.shortestHeight-e.layouts[e.refreshCols._.i].colHeights[e.refreshCols._.j];e.refreshCols._.emptySpaces.push(e.refreshCols._.emptySpace)}for(e.layout=e.refreshCols._.shortestLayouts[$.inArray(Math.min.apply(null,e.refreshCols._.emptySpaces),e.refreshCols._.emptySpaces)],e.refreshCols._.i=0;e.refreshCols._.i<e.items.length;e.refreshCols._.i++)e.refreshCols._.css={width:e.getItemWidthCss(e.layout.colspans[e.refreshCols._.i])},e.refreshCols._.css[Craft.left]=e.getItemLeftPosCss(e.layout.positions[e.refreshCols._.i]),e.items[e.refreshCols._.i].css(e.refreshCols._.css);e.isSimpleLayout()?(e.$container.height("auto"),e.$items.css({position:"relative",top:0,"margin-bottom":e.settings.gutter+"px"})):(e.$items.css("position","absolute"),e.positionItems(),e.addListener(e.$items,"resize","onItemResize"))}e.completeRefreshCols()})),this.onRefreshCols()):this.completeRefreshCols()):this.completeRefreshCols()):this.completeRefreshCols()},completeRefreshCols:function(){var t=this;if(void 0!==this.refreshCols._&&delete this.refreshCols._,this._refreshingCols=!1,this._refreshColsAfterRefresh){var e=this._forceRefreshColsAfterRefresh;this._refreshColsAfterRefresh=!1,this._forceRefreshColsAfterRefresh=!1,Garnish.requestAnimationFrame((function(){t.refreshCols(e)}))}},getItemWidth:function(t){return this.colPctWidth*t},getItemWidthCss:function(t){return"calc("+this.getItemWidth(t)+"% - "+this.colGutterDrop+"px)"},getItemWidthInPx:function(t){return this.getItemWidth(t)/100*this.$container.width()-this.colGutterDrop},getItemLeftPosCss:function(t){return"calc(("+this.getItemWidth(1)+"% + "+(this.settings.gutter-this.colGutterDrop)+"px) * "+t+")"},getItemLeftPosInPx:function(t){return(this.getItemWidth(1)/100*this.$container.width()+(this.settings.gutter-this.colGutterDrop))*t},createLayouts:function(t,e,n,i,r){new Craft.Grid.LayoutGenerator(this).createLayouts(t,e,n,i,r)},isSimpleLayout:function(){for(this.isSimpleLayout._={},this.isSimpleLayout._.i=0;this.isSimpleLayout._.i<this.layout.positions.length;this.isSimpleLayout._.i++)if(0!==this.layout.positions[this.isSimpleLayout._.i])return delete this.isSimpleLayout._,!1;return delete this.isSimpleLayout._,!0},positionItems:function(){for(this.positionItems._={},this.positionItems._.colHeights=[],this.positionItems._.i=0;this.positionItems._.i<this.totalCols;this.positionItems._.i++)this.positionItems._.colHeights.push(0);for(this.positionItems._.i=0;this.positionItems._.i<this.items.length;this.positionItems._.i++){for(this.positionItems._.endingCol=this.layout.positions[this.positionItems._.i]+this.layout.colspans[this.positionItems._.i]-1,this.positionItems._.affectedColHeights=[],this.positionItems._.col=this.layout.positions[this.positionItems._.i];this.positionItems._.col<=this.positionItems._.endingCol;this.positionItems._.col++)this.positionItems._.affectedColHeights.push(this.positionItems._.colHeights[this.positionItems._.col]);for(this.positionItems._.top=Math.max.apply(null,this.positionItems._.affectedColHeights),this.positionItems._.top>0&&(this.positionItems._.top+=this.settings.gutter),this.items[this.positionItems._.i].css("top",this.positionItems._.top),this.positionItems._.col=this.layout.positions[this.positionItems._.i];this.positionItems._.col<=this.positionItems._.endingCol;this.positionItems._.col++)this.positionItems._.colHeights[this.positionItems._.col]=this.positionItems._.top+this.itemHeightsByColspan[this.positionItems._.i][this.layout.colspans[this.positionItems._.i]]}this.$container.height(Math.max.apply(null,this.positionItems._.colHeights)),delete this.positionItems._},onItemResize:function(t){this.onItemResize._={},t.stopPropagation(),this.onItemResize._.item=$.inArray(t.currentTarget,this.$items),-1!==this.onItemResize._.item&&(this.onItemResize._.newHeight=this.items[this.onItemResize._.item].outerHeight(),this.onItemResize._.newHeight!==this.itemHeightsByColspan[this.onItemResize._.item][this.layout.colspans[this.onItemResize._.item]]&&(this.itemHeightsByColspan[this.onItemResize._.item][this.layout.colspans[this.onItemResize._.item]]=this.onItemResize._.newHeight,this.positionItems(!1))),delete this.onItemResize._},onRefreshCols:function(){this.trigger("refreshCols"),this.settings.onRefreshCols()},destroy:function(){this.$container.removeData("grid"),this.base()}},{defaults:{itemSelector:".item",cols:null,maxCols:null,minColWidth:320,gutter:14,fillMode:"top",colClass:"col",snapToGrid:null,onRefreshCols:$.noop}}),Craft.Grid.LayoutGenerator=Garnish.Base.extend({grid:null,_:null,init:function(t){this.grid=t},createLayouts:function(t,e,n,i,r){for(this._={},this._.c=0;this._.c<this.grid.possibleItemColspans[t].length;this._.c++){for(this._.colspan=this.grid.possibleItemColspans[t][this._.c],this._.tallestColHeightsByPosition=[],this._.p=0;this._.p<this.grid.possibleItemPositionsByColspan[t][this._.colspan].length;this._.p++){for(this._.position=this.grid.possibleItemPositionsByColspan[t][this._.colspan][this._.p],this._.colHeightsForPosition=[],this._.endingCol=this._.position+this._.colspan-1,this._.col=this._.position;this._.col<=this._.endingCol;this._.col++)this._.colHeightsForPosition.push(i[this._.col]);this._.tallestColHeightsByPosition[this._.p]=Math.max.apply(null,this._.colHeightsForPosition)}for(this._.p=$.inArray(Math.min.apply(null,this._.tallestColHeightsByPosition),this._.tallestColHeightsByPosition),this._.position=this.grid.possibleItemPositionsByColspan[t][this._.colspan][this._.p],this._.positions=e.slice(0),this._.colspans=n.slice(0),this._.colHeights=i.slice(0),this._.emptySpace=r,this._.positions.push(this._.position),this._.colspans.push(this._.colspan),this._.tallestColHeight=this._.tallestColHeightsByPosition[this._.p],this._.endingCol=this._.position+this._.colspan-1,this._.col=this._.position;this._.col<=this._.endingCol;this._.col++)this._.emptySpace+=this._.tallestColHeight-this._.colHeights[this._.col],this._.colHeights[this._.col]=this._.tallestColHeight+this.grid.itemHeightsByColspan[t][this._.colspan];t===this.grid.items.length-1?this.grid.layouts.push({positions:this._.positions,colspans:this._.colspans,colHeights:this._.colHeights,emptySpace:this._.emptySpace}):this.grid.createLayouts(t+1,this._.positions,this._.colspans,this._.colHeights,this._.emptySpace)}delete this._}})},5970:function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.CardsElementIndexView=Craft.BaseElementIndexView.extend({cardSort:null,afterInit:function(){var e=this;this.settings.sortable&&Craft.hasMousePointerEvents()?this.cardSort=new Garnish.DragSort(this.getAllElements(),{container:this.$elementContainer,filter:this.settings.selectable?function(){return e.cardSort.$targetItem.children(".element").hasClass("sel")?e.elementSelect.getSelectedItems().parent("li"):e.cardSort.$targetItem}:null,ignoreHandleSelector:null,handle:"> .element > .card-titlebar > .card-actions-container > .card-actions > .move-btn",collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,helper:function(t){return t.children().outerHeight(e.cardSort.$draggee.height()),t},onInsertionPointChange:function(){var n,i=function(e,n){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}(e.cardSort.helpers);try{for(i.s();!(n=i.n()).done;)n.value.children().outerHeight(e.cardSort.$draggee.height())}catch(t){i.e(t)}finally{i.f()}},onSortChange:function(){e.settings.selectable&&e.elementSelect.resetItemOrder(),e.settings.onSortChange(e.cardSort.$draggee)}}):$(".element > .card-titlebar > .card-actions-container > .card-actions > .move-btn").hide()},getElementContainer:function(){return this.$container.find("> .card-grid")}})},6054:function(t,e,n){"use strict";function i(t,e){for(var n=[],i={},r=0;r<e.length;r++){var a=e[r],s=a[0],o={id:t+":"+r,css:a[1],media:a[2],sourceMap:a[3]};i[s]?i[s].parts.push(o):n.push(i[s]={id:s,parts:[o]})}return n}n.d(e,{A:function(){return p}});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},s=r&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,c=!1,u=function(){},h=null,d="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(t,e,n,r){c=n,h=r||{};var s=i(t,e);return g(s),function(e){for(var n=[],r=0;r<s.length;r++){var o=s[r];(l=a[o.id]).refs--,n.push(l)}for(e?g(s=i(t,e)):s=[],r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete a[l.id]}}}}function g(t){for(var e=0;e<t.length;e++){var n=t[e],i=a[n.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](n.parts[r]);for(;r<n.parts.length;r++)i.parts.push(v(n.parts[r]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var s=[];for(r=0;r<n.parts.length;r++)s.push(v(n.parts[r]));a[n.id]={id:n.id,refs:1,parts:s}}}}function m(){var t=document.createElement("style");return t.type="text/css",s.appendChild(t),t}function v(t){var e,n,i=document.querySelector("style["+d+'~="'+t.id+'"]');if(i){if(c)return u;i.parentNode.removeChild(i)}if(f){var r=l++;i=o||(o=m()),e=w.bind(null,i,r,!1),n=w.bind(null,i,r,!0)}else i=m(),e=C.bind(null,i),n=function(){i.parentNode.removeChild(i)};return e(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;e(t=i)}else n()}}var y,b=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function w(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var a=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}function C(t,e){var n=e.css,i=e.media,r=e.sourceMap;if(i&&t.setAttribute("media",i),h.ssrId&&t.setAttribute(d,e.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},6322:function(){Craft.Accordion=Garnish.Base.extend({$trigger:null,targetSelector:null,_$target:null,init:function(t){var e=this;this.$trigger=$(t),this.$trigger.data("accordion")&&(console.warn("Double-instantiating an accordion trigger on an element"),this.$trigger.data("accordion").destroy()),this.$trigger.data("accordion",this),this.targetSelector=this.$trigger.attr("aria-controls")?"#".concat(this.$trigger.attr("aria-controls")):null,this.targetSelector&&(this._$target=$(this.targetSelector)),this.addListener(this.$trigger,"click","onTriggerClick"),this.addListener(this.$trigger,"keypress",(function(t){var n=t.keyCode;n!==Garnish.SPACE_KEY&&n!==Garnish.RETURN_KEY||(t.preventDefault(),e.onTriggerClick())}))},onTriggerClick:function(){"true"===this.$trigger.attr("aria-expanded")?this.hideTarget(this._$target):this.showTarget(this._$target)},showTarget:function(t){var e=this;if(t&&t.length){this.showTarget._currentHeight=t.height(),t.removeClass("hidden"),this.$trigger.removeClass("collapsed").addClass("expanded").attr("aria-expanded","true");for(var n=0;n<t.length;n++)!function(t){"SPAN"!==t.prop("nodeName")&&(t.height("auto"),e.showTarget._targetHeight=t.height(),t.css({height:e.showTarget._currentHeight,overflow:"hidden"}),t.velocity("stop"),t.velocity({height:e.showTarget._targetHeight},Garnish.getUserPreferredAnimationDuration("fast"),(function(){t.css({height:"",overflow:""})})))}(t.eq(n));delete this.showTarget._targetHeight,delete this.showTarget._currentHeight,Garnish.$win.trigger("resize")}},hideTarget:function(t){if(t&&t.length){this.$trigger.removeClass("expanded").addClass("collapsed").attr("aria-expanded","false");for(var e=0;e<t.length;e++)!function(t){t.hasClass("hidden")||("SPAN"===t.prop("nodeName")?t.addClass("hidden"):(t.css("overflow","hidden"),t.velocity("stop"),t.velocity({height:0},Garnish.getUserPreferredAnimationDuration("fast"),(function(){t.addClass("hidden")}))))}(t.eq(e))}},destroy:function(){this.$trigger.removeData("accordion"),this.base()}})},6407:function(t){var e="-".charCodeAt(0),n="+".charCodeAt(0),i=".".charCodeAt(0),r="e".charCodeAt(0),a="E".charCodeAt(0);t.exports=function(t){var s,o,l,c=0,u=t.length;if(0===u||!function(t){var r,a=t.charCodeAt(0);if(a===n||a===e){if((r=t.charCodeAt(1))>=48&&r<=57)return!0;var s=t.charCodeAt(2);return r===i&&s>=48&&s<=57}return a===i?(r=t.charCodeAt(1))>=48&&r<=57:a>=48&&a<=57}(t))return!1;for((s=t.charCodeAt(c))!==n&&s!==e||c++;c<u&&!((s=t.charCodeAt(c))<48||s>57);)c+=1;if(s=t.charCodeAt(c),o=t.charCodeAt(c+1),s===i&&o>=48&&o<=57)for(c+=2;c<u&&!((s=t.charCodeAt(c))<48||s>57);)c+=1;if(s=t.charCodeAt(c),o=t.charCodeAt(c+1),l=t.charCodeAt(c+2),(s===r||s===a)&&(o>=48&&o<=57||(o===n||o===e)&&l>=48&&l<=57))for(c+=o===n||o===e?3:2;c<u&&!((s=t.charCodeAt(c))<48||s>57);)c+=1;return{number:t.slice(0,c),unit:t.slice(c)}}},6452:function(){Craft.UriFormatGenerator=Craft.BaseInputGenerator.extend({generateTargetValue:function(t){return t=(t=t.replace(/<(.*?)>/g,"")).toLowerCase(),t=(t=(t=Craft.asciiString(t)).replace(/^[^a-z]+/,"")).replace(/[^a-z0-9]+$/,""),Craft.filterArray(t.split(/[^a-z0-9]+/)).join(Craft.slugWordSeparator)}})},6465:function(){Craft.ElementTableSorter=Garnish.DragSort.extend({tableView:null,_helperMargin:null,_$firstRowCells:null,_$titleHelperCell:null,_titleHelperCellOuterWidth:null,_ancestors:null,_updateAncestorsFrame:null,_draggeeLevel:null,_draggeeLevelDelta:null,draggingLastElements:null,_loadingDraggeeLevelDelta:!1,_targetLevel:null,_targetLevelBounds:null,_positionChanged:null,init:function(t,e,n){this.tableView=t,this._helperMargin=this.tableView.elementIndex.actions?40:0,n=$.extend({},Craft.ElementTableSorter.defaults,n,{handle:".move",collapseDraggees:!0,singleHelper:!0,helperSpacingY:2,magnetStrength:4,helper:this.getHelper.bind(this),helperLagBase:1.5,axis:Garnish.Y_AXIS}),this.base(e,n)},findDraggee:function(){var t=this;this._draggeeLevel=this._targetLevel=this._level(this.$targetItem),this._draggeeLevelDelta=0;for(var e=$(this.$targetItem),n=this.$targetItem.next();n.length;){var i=this._level(n);if(i<=this._draggeeLevel)break;var r=i-this._draggeeLevel;r>this._draggeeLevelDelta&&(this._draggeeLevelDelta=r),e=e.add(n),n=n.next()}if(this.draggingLastElements=!n.length,this.tableView.elementIndex.paginated&&null==this.settings.structureId)return e;if(this.settings.maxLevels&&(e.has("> th button.toggle[aria-expanded=false]").length||this.draggingLastElements&&this.tableView.getMorePending())){this._loadingDraggeeLevelDelta=!0;var a=this._getAjaxBaseData(this.$targetItem);Craft.sendActionRequest("POST","structures/get-element-level-delta",{data:a}).then((function(e){t._loadingDraggeeLevelDelta=!1,t.dragging&&(t._draggeeLevelDelta=e.data.delta,t._setTargetLevelBounds(),t.drag(!1))}))}return e},getHelper:function(t){var e=$('<div class="elements datatablesorthelper"/>').appendTo(Garnish.$bod),n=$('<div class="tableview"/>').appendTo(e),i=$('<table class="data"/>').appendTo(n),r=$("<tbody/>").appendTo(i);t.appendTo(r),this._$firstRowCells=this.tableView.$elementContainer.children("tr:first").children();for(var a=t.children(),s=0;s<a.length;s++){var o=$(a[s]);if(o.hasClass("checkbox-cell"))o.remove();else{var l=$(this._$firstRowCells[s]),c=l[0].getBoundingClientRect().width;l.css("width",c+"px"),o.css("width",c+"px"),Garnish.hasAttr(l,"data-titlecell")&&(this._$titleHelperCell=o,this._titleHelperCellOuterWidth=c,o.children("div").css("padding-".concat(Craft.left),"24px"))}}return e},canInsertBefore:function(t){return!1!==this._getLevelBounds(t.prev(),t)},canInsertAfter:function(t){return!1!==this._getLevelBounds(t,t.next())},onDragStart:function(){this._ancestors=this._getAncestors(this.$targetItem,this._level(this.$targetItem)),this._setTargetLevelBounds(),this.tableView.elementIndex.paginated||this.tableView.maybeLoadMore(),this.base()},onDrag:function(){this.base(),this._updateIndent()},onInsertionPointChange:function(){this._setTargetLevelBounds(),this._updateAncestorsBeforeRepaint(),this.base()},onDragStop:function(){var t=this;if(this._positionChanged=!1,this.base(),this._targetLevel!=this._draggeeLevel){for(var e=this._targetLevel-this._draggeeLevel,n=0;n<this.$draggee.length;n++){var i=$(this.$draggee[n]),r=this._level(i)+e,a=24+this._getLevelIndent(r),s=i.find("[data-text-alternative]"),o=Craft.t("app","Level {num}",{num:r});i.data("level",r),i.find(".element").data("level",r),i.find("> [data-titlecell]:first > div").css("padding-".concat(Craft.left),a),s.text(o)}this._positionChanged=!0}if(this._positionChanged&&this.settings.structureId){for(var l,c=this._getAjaxBaseData(this.$draggee),u=this.$draggee.first().prev();u.length;){var h=this._level(u);if(h==this._targetLevel){c.prevId=u.data("id");break}if(h<this._targetLevel){c.parentId=u.data("id");var d=u.find("> th .toggle");d.hasClass("expanded")||(d.addClass("expanded"),l=this.tableView._createSpinnerRowAfter(u),this.tableView.elementSelect&&this.tableView.elementSelect.removeItems(this.$targetItem),this.removeItems(this.$targetItem),this.$targetItem.remove(),this.tableView._totalVisible--);break}u=u.prev()}Craft.sendActionRequest("POST","structures/move-element",{data:c}).then((function(e){Craft.cp.displaySuccess(Craft.t("app","New position saved.")),t.onPositionChange(),l&&l.parent().length&&(l.remove(),t.tableView._expandElement($toggle,!0)),Craft.cp.runQueue()})).catch((function(e){var n;Craft.cp.displayError(null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message),t.tableView.elementIndex.updateElements()}))}},onSortChange:function(){this.tableView.elementSelect&&this.tableView.elementSelect.resetItemOrder(),this._positionChanged=!0,this.base()},onPositionChange:function(){var t=this;Garnish.requestAnimationFrame((function(){t.trigger("positionChange"),t.settings.onPositionChange()}))},onReturnHelpersToDraggees:function(){if(this._$firstRowCells.css("width",""),this.draggingLastElements&&!this.tableView.elementIndex.paginated&&this.tableView.getMorePending()){this.tableView._totalVisible+=this.newDraggeeIndexes[0]-this.oldDraggeeIndexes[0];var t=this.$draggee.last().nextAll();t.length&&(this.removeItems(t),t.remove(),this.tableView.maybeLoadMore())}this.base()},_getLevelBounds:function(t,e){if(this._loadingDraggeeLevelDelta)return!1;if(e&&e.length?this._getLevelBounds._minLevel=this._level(e):this._getLevelBounds._minLevel=1,t&&t.length?this._getLevelBounds._maxLevel=this._level(t)+1:this._getLevelBounds._maxLevel=1,this.settings.maxLevels){if(1!=this._getLevelBounds._minLevel&&this._getLevelBounds._minLevel+this._draggeeLevelDelta>this.settings.maxLevels)return!1;this._getLevelBounds._maxLevel+this._draggeeLevelDelta>this.settings.maxLevels&&(this._getLevelBounds._maxLevel=this.settings.maxLevels-this._draggeeLevelDelta,this._getLevelBounds._maxLevel<this._getLevelBounds._minLevel&&(this._getLevelBounds._maxLevel=this._getLevelBounds._minLevel))}return{min:this._getLevelBounds._minLevel,max:this._getLevelBounds._maxLevel}},_setTargetLevelBounds:function(){this._targetLevelBounds=this._getLevelBounds(this.$draggee.first().prev(),this.$draggee.last().next())},_updateIndent:function(t){this._updateIndent._mouseDist=this.realMouseX-this.mousedownX,"rtl"===Craft.orientation&&(this._updateIndent._mouseDist*=-1),this._updateIndent._indentationDist=Math.round(this._updateIndent._mouseDist/Craft.ElementTableSorter.LEVEL_INDENT),this._updateIndent._targetLevel=this._draggeeLevel+this._updateIndent._indentationDist,this._updateIndent._targetLevel<this._targetLevelBounds.min?(this._updateIndent._indentationDist+=this._targetLevelBounds.min-this._updateIndent._targetLevel,this._updateIndent._targetLevel=this._targetLevelBounds.min):this._updateIndent._targetLevel>this._targetLevelBounds.max&&(this._updateIndent._indentationDist-=this._updateIndent._targetLevel-this._targetLevelBounds.max,this._updateIndent._targetLevel=this._targetLevelBounds.max),this._targetLevel!==(this._targetLevel=this._updateIndent._targetLevel)&&this._updateAncestorsBeforeRepaint(),this._updateIndent._targetLevelMouseDiff=this._updateIndent._mouseDist-this._updateIndent._indentationDist*Craft.ElementTableSorter.LEVEL_INDENT,this._updateIndent._magnetImpact=Math.round(this._updateIndent._targetLevelMouseDiff/15),Math.abs(this._updateIndent._magnetImpact)>Craft.ElementTableSorter.MAX_GIVE&&(this._updateIndent._magnetImpact=(this._updateIndent._magnetImpact>0?1:-1)*Craft.ElementTableSorter.MAX_GIVE),this._updateIndent._closestLevelMagnetIndent=this._getLevelIndent(this._targetLevel)+this._updateIndent._magnetImpact,this.helpers[0].css("margin-".concat(Craft.left),this._updateIndent._closestLevelMagnetIndent+this._helperMargin),this._$titleHelperCell.css("width",this._titleHelperCellOuterWidth-this._updateIndent._closestLevelMagnetIndent)},_getLevelIndent:function(t){return(t-1)*Craft.ElementTableSorter.LEVEL_INDENT},_getAjaxBaseData:function(t){return{structureId:this.settings.structureId,elementId:t.data("id"),siteId:t.find(".element:first").data("site-id")}},_getAncestors:function(t,e){if(this._getAncestors._ancestors=[],0!=e)for(this._getAncestors._level=e,this._getAncestors._$prevRow=t.prev();this._getAncestors._$prevRow.length&&!(this._level(this._getAncestors._$prevRow)<this._getAncestors._level&&(this._getAncestors._ancestors.unshift(this._getAncestors._$prevRow),this._getAncestors._level=this._level(this._getAncestors._$prevRow),0==this._getAncestors._level));)this._getAncestors._$prevRow=this._getAncestors._$prevRow.prev();return this._getAncestors._ancestors},_level:function(t){return t.data("level")||1},_updateAncestorsBeforeRepaint:function(){this._updateAncestorsFrame&&Garnish.cancelAnimationFrame(this._updateAncestorsFrame),this._updateAncestorsFrame=Garnish.requestAnimationFrame(this._updateAncestors.bind(this))},_updateAncestors:function(){for(this._updateAncestorsFrame=null,this._updateAncestors._i=0;this._updateAncestors._i<this._ancestors.length;this._updateAncestors._i++)this._updateAncestors._$ancestor=this._ancestors[this._updateAncestors._i],this._updateAncestors._$ancestor.data("descendants",this._updateAncestors._$ancestor.data("descendants")-1),0==this._updateAncestors._$ancestor.data("descendants")&&this._updateAncestors._$ancestor.find("> th .toggle:first").remove();for(this._updateAncestors._newAncestors=this._getAncestors(this.$targetItem,this._targetLevel),this._updateAncestors._i=0;this._updateAncestors._i<this._updateAncestors._newAncestors.length;this._updateAncestors._i++)if(this._updateAncestors._$ancestor=this._updateAncestors._newAncestors[this._updateAncestors._i],this._updateAncestors._$ancestor.data("descendants",this._updateAncestors._$ancestor.data("descendants")+1),1==this._updateAncestors._$ancestor.data("descendants")){var t=this._updateAncestors._$ancestor.data("title");$('<button class="toggle expanded" type="button" aria-expanded="true" title="'+Craft.t("app","Show/hide children")+'" aria-label="'+Craft.t("app","Show {title} children",{title:t})+'"></button>').insertAfter(this._updateAncestors._$ancestor.find("> th .move:first"))}this._ancestors=this._updateAncestors._newAncestors,delete this._updateAncestors._i,delete this._updateAncestors._$ancestor,delete this._updateAncestors._newAncestors}},{HELPER_MARGIN:0,LEVEL_INDENT:44,MAX_GIVE:22,defaults:{structureId:null,maxLevels:1,onPositionChange:$.noop}})},6618:function(){Craft.AssetsFieldSettings=Garnish.Base.extend({$useSingleFolderInput:null,$sourceInputs:null,$defaultUploadLocationSelect:null,$showSearchInputField:null,$defaultUploadLocationOptions:null,init:function(t,e,n,i){var r=this;this.$useSingleFolderInput=$("#".concat(t)),this.$sourceInputs=$("#".concat(e," input")),this.$defaultUploadLocationSelect=$("#".concat(n)),this.$showSearchInputField=$("#".concat(i)),this.$defaultUploadLocationOptions=this.$defaultUploadLocationSelect.children("option"),this.updateDefaultUploadLocationSelect(),Garnish.requestAnimationFrame((function(){r.addListener(r.$useSingleFolderInput,"change",(function(){r.updateDefaultUploadLocationSelect(),"true"===r.$useSingleFolderInput.attr("aria-checked")?r.$showSearchInputField.removeClass("hidden"):setTimeout((function(){r.$sourceInputs.first().trigger("change")}),1)})),r.addListener(r.$sourceInputs,"change",(function(){r.updateDefaultUploadLocationSelect()}))}))},updateDefaultUploadLocationSelect:function(){if("true"!==this.$useSingleFolderInput.attr("aria-checked")){for(var t,e=this.$defaultUploadLocationSelect.val(),n=0;n<this.$sourceInputs.length;n++){var i=this.$sourceInputs.eq(n),r=i.val(),a=i.prop("checked");if("*"===r){if(a)return void this.$defaultUploadLocationOptions.prop("disabled",!1)}else this.getOption(r).prop("disabled",!a),a&&!t&&(t=r)}var s=this.getOption(e);(!s.length||s.prop("disabled")&&t)&&this.$defaultUploadLocationSelect.val(t)}},getOption:function(t){return this.$defaultUploadLocationOptions.filter('[value="'.concat(t,'"]'))}})},7145:function(){function t(t,e,n){return(e=function(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t){throw new TypeError('"'+t+'" is read-only')}function n(){"use strict";n=function(){return e};var t,e={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,s=Object.create(r.prototype),o=new A(i||[]);return a(s,"_invoke",{value:T(t,n,o)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==i&&r.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,a,o,l){var c=f(t[i],t,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==s(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var i;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(a,a):a()}})}function T(e,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(e,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,D(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=C,a(x,"constructor",{value:C,configurable:!0}),a(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:P(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function i(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){i(s,r,a,o,l,"next",t)}function l(t){i(s,r,a,o,l,"throw",t)}o(void 0)}))}}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function o(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var c,u,h,d,f,p;Craft.CP=Garnish.Base.extend({elementThumbLoader:null,animationBlocker:null,authManager:null,announcerTimeout:null,modalLayers:[],$nav:null,$navToggle:null,$globalLiveRegion:null,$globalSkipLinkList:null,$activeLiveRegion:null,$globalSidebar:null,$globalContainer:null,$mainContainer:null,$pageContainer:null,$alerts:null,$crumbs:null,$crumbList:null,$crumbItems:null,$crumbMenuTriggerItem:null,$crumbMenu:null,$crumbMenuList:null,$crumbMenuItems:null,$notificationContainer:null,$notificationHeading:null,$main:null,$primaryForm:null,$headerContainer:null,$header:null,$mainContent:null,$details:null,$detailsToggle:null,$detailsSkipLink:null,$sidebarContainer:null,$sidebarToggle:null,$sidebar:null,$contentContainer:null,$edition:null,$confirmUnloadForms:null,$deltaForms:null,$collapsibleTables:null,isMobile:null,fixedHeader:!1,tabManager:null,enableQueue:!0,totalJobs:0,jobInfo:null,displayedJobInfo:null,displayedJobInfoUnchanged:1,trackJobProgressTimeout:null,trackingJobProgress:!1,jobProgressCancelToken:null,jobProgressIcon:null,checkingForUpdates:!1,forcingRefreshOnUpdatesCheck:!1,includingDetailsOnUpdatesCheck:!1,checkForUpdatesCallbacks:null,checkForUpdatesFailureCallbacks:null,copyElementCallbacks:null,elementCopyNotification:null,resizeTimeout:null,init:function(){var t,e,n=this;if(this.elementThumbLoader=new Craft.ElementThumbLoader,0!==Craft.remainingSessionTime&&(this.authManager=new Craft.AuthManager),this.$nav=$("#nav"),this.$navToggle=$("#primary-nav-toggle"),this.$globalLiveRegion=$("#global-live-region"),this.$globalSkipLinkList=$("#global-skip-links"),this.$activeLiveRegion=this.$globalLiveRegion,this.$globalSidebar=$("#global-sidebar"),this.$globalContainer=$("#global-container"),this.$mainContainer=$("#main-container"),this.$pageContainer=$("#page-container"),this.$alerts=$("#alerts"),this.$crumbs=$("#crumbs"),this.$crumbList=$("#crumb-list"),this.$crumbItems=this.$crumbList.children("li"),this.$notificationContainer=$("#notifications"),this.$notificationHeading=$("#cp-notification-heading"),this.$main=$("#main"),this.$primaryForm=$("#main-form"),this.$headerContainer=$("#header-container"),this.$header=$("#header"),this.$mainContent=$("#main-content"),this.$details=$("#details"),this.$detailsToggle=$("#details-toggle"),this.$detailsSkipLink=$('[href="#details-container"]'),this.$detailsContainer=$("#details-container"),this.$sidebarContainer=$("#sidebar-container"),this.$sidebarToggle=$("#sidebar-toggle"),this.$sidebar=$("#sidebar"),this.$contentContainer=$("#content-container"),this.$collapsibleTables=$("table.collapsible"),this.isMobile=Garnish.isMobileBrowser(),!this.isMobile&&this.$header.length&&(this.addListener(Garnish.$win,"scroll","updateFixedHeader"),this.updateFixedHeader()),Garnish.$doc.ready((function(){n.addListener(Garnish.$win,"resize",(function(t){if(t.target===window){n.handleWindowResize(),clearTimeout(n.resizeTimeout);var e=n;n.resizeTimeout=setTimeout((function(){e.setSidebarNavAttributes()}),100)}})),n.handleWindowResize(),n.setSidebarNavAttributes(),Garnish.requestAnimationFrame(n.initSpecialForms.bind(n))})),this.$alerts.length&&this.initAlerts(),this.animationBlocker=new Craft.AnimationBlocker,this.addListener(this.$navToggle,"click","toggleNav"),this.addListener(this.$sidebarToggle,"click","toggleSidebar"),this.addListener(this.$detailsToggle,"open",(function(){n.$detailsSkipLink.attr("href","#details-container")})),this.addListener(this.$detailsToggle,"close",(function(){n.$detailsSkipLink.attr("href","#details-toggle-wrapper")})),Garnish.uiLayerManager.on("addLayer",(function(){n.handleLayerUpdates()})),Garnish.uiLayerManager.on("removeLayer",(function(){n.handleLayerUpdates()})),this.$primaryForm.length||(this.$primaryForm=$("form[data-saveshortcut]:first")),this.$primaryForm.length&&Garnish.hasAttr(this.$primaryForm,"data-saveshortcut")){var i=[],r=this.$primaryForm.data("actions");if(void 0===r)i.push([{keyCode:Garnish.S_KEY,ctrl:!0},{redirect:this.$primaryForm.data("saveshortcut-redirect"),retainScroll:Garnish.hasAttr(this.$primaryForm,"saveshortcut-scroll")}]);else for(var a=0;a<r.length;a++){var s=r[a];s.shortcut&&i.push([{keyCode:Garnish.S_KEY,ctrl:!0,shift:!!s.shift},{action:s.action,redirect:s.redirect,confirm:s.confirm,params:s.params,data:s.data,retainScroll:s.retainScroll}])}for(var l=function(t){Garnish.uiLayerManager.registerShortcut(i[t][0],(function(){n.submitPrimaryForm(i[t][1])}))},c=0;c<i.length;c++)l(c)}if(this.initTabs(),this.tabManager&&window.LOCATION_HASH){var u=this.tabManager.$tabs.filter('[href="#'.concat(window.LOCATION_HASH,'"]'));u.length&&this.tabManager.selectTab(u)}var h=document.location,d=new URLSearchParams(h.search);if(d.has("scrollY")?(e=d.get("scrollY"),d.delete("scrollY"),Craft.setUrl(Craft.getUrl("".concat(h.origin).concat(h.pathname).concat(h.hash),d.toString()))):void 0!==(e=Craft.getLocalStorage("scrollY"))&&Craft.removeLocalStorage("scrollY"),void 0!==e&&Garnish.$doc.ready((function(){Garnish.requestAnimationFrame((function(){window.scrollTo(0,e)}))})),$.isTouchCapable()&&(this.$mainContainer.on("focus","input, textarea, .focusable-input",this._handleInputFocus.bind(this)),this.$mainContainer.on("blur","input, textarea, .focusable-input",this._handleInputBlur.bind(this))),null!==(t=Craft.announcements)&&void 0!==t&&t.length){var f,p,g=$("#announcements-btn").removeClass("hidden"),m=Craft.announcements.some((function(t){return t.unread}));m&&(f=$("<span/>",{class:"visually-hidden",html:Craft.t("app","Unread messages")}),g.addClass("unread").append(f)),this.addListener(g,"click",(function(){if(p)p.show();else{var t="";Craft.announcements.forEach((function(e){t+='<div class="announcement '.concat(e.unread?"unread":"",'" role="listitem">')+'<div class="announcement__header">'+'<h3 class="announcement__heading h2">'.concat(e.heading,"</h3>")+'<div class="announcement-label-container">'+'<div class="announcement-icon" aria-hidden="true">'.concat(e.icon,"</div>")+'<div class="announcement-label">'.concat(e.label,"</div>")+"</div></div>"+"<p>".concat(e.body,"</p>")+"</div>"})),p=new Garnish.HUD(g,'<h2 class="visually-hidden">'.concat(Craft.t("app","Announcements"),'</h2><div id="announcements" role="list">').concat(t,"</div>"),{onShow:function(){g.addClass("active")},onHide:function(){g.removeClass("active")}}),$("a",p.$main).each((function(){this.hostname.length&&this.hostname!==h.hostname&&void 0===$(this).attr("target")&&$(this).attr("rel","noopener").attr("target","_blank")})),m&&(g.removeClass("unread"),f.remove(),Craft.sendActionRequest("POST","users/mark-announcements-as-read",{data:{ids:Craft.announcements.map((function(t){return t.id}))}}))}}))}var v=document.getElementById("footer");if(v&&new IntersectionObserver((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,1)[0];e.target.classList.toggle("stuck",e.intersectionRatio<1)}),{rootMargin:"0px 0px -1px 0px",threshold:[1]}).observe(v),this.elementThumbLoader.load(this.$pageContainer),this.on("notificationClose",(function(){n.updateNotificationHeadingDisplay()})),this.copyElementCallbacks=[],Craft.username){var y=Craft.getLocalStorage("copiedElements");y&&this.showElementCopyNotification(y,{animate:!1})}},get $contentHeader(){var t=$("#content-header");return t.length?t:$("<header/>",{id:"content-header",class:"pane-header"}).prependTo($("#content"))},get $noticeContainer(){var t=$("#content-notice");return t.length?t:$('<div id="content-notice"/>').attr("role","status").prependTo(this.$contentHeader)},get notificationCount(){return this.$notificationContainer.find(".notification").length},initSpecialForms:function(){var t=this;if(this.$confirmUnloadForms=$("form[data-confirm-unload]"),this.$deltaForms=$("form[data-delta]"),this.$confirmUnloadForms.length){for(var e=this.$confirmUnloadForms.add(this.$deltaForms),n=function(){var n=e.eq(i);if(!n.data("initialSerializedValue")){var r=n.data("serializer")||function(){return n.serialize()};n.data("initialSerializedValue",r())}t.addListener(n,"submit",(function(t){if(Garnish.hasAttr(n,"data-confirm-unload")&&this.removeListener(Garnish.$win,"beforeunload"),Garnish.hasAttr(n,"data-delta")){t.preventDefault();var e=n.data("serializer")||function(){return n.serialize()},i=Craft.findDeltaData(n.data("initialSerializedValue"),e(),n.data("delta-names"),null,n.data("initial-delta-values"),n.data("modified-delta-names"));Craft.createForm(i).appendTo(Garnish.$bod).submit()}}))},i=0;i<e.length;i++)n();this.addListener(Garnish.$win,"beforeunload",(function(t){var e=!1;if(void 0!==Craft.livePreview&&Craft.livePreview.inPreviewMode)e=!0;else for(var n=0;n<this.$confirmUnloadForms.length;n++){var i,r=this.$confirmUnloadForms.eq(n);if(i="function"==typeof r.data("serializer")?r.data("serializer")():r.serialize(),r.data("initialSerializedValue")!==i){e=!0;break}}if(e){var a=Craft.t("app","Any changes will be lost if you leave this page.");return t?t.originalEvent.returnValue=a:window.event.returnValue=a,a}}))}},_handleInputFocus:function(){this.updateFixedHeader()},_handleInputBlur:function(){this.updateFixedHeader()},submitPrimaryForm:function(t){this.trigger("beforeSaveShortcut"),"object"===s(t)&&$.isPlainObject(t)||(t={}),t.redirect||(t.redirect=this.$primaryForm.data("saveshortcut-redirect")),t.data||(t.data={}),t.data.saveShortcut=!0,Craft.submitForm(this.$primaryForm,t)},toggleNav:function(){var t=this.navIsExpanded();null!==t&&(t?(this.disableGlobalSidebar(),this.$navToggle.focus(),this.$navToggle.attr("aria-expanded","false"),Garnish.$bod.removeClass("showing-nav")):(this.enableGlobalSidebar(),this.$globalSidebar.find(":focusable")[0].focus(),this.$navToggle.attr("aria-expanded","true"),Garnish.$bod.addClass("showing-nav")))},enableGlobalSidebar:function(){this.$globalSidebar.attr("aria-hidden","false"),this.$globalSidebar.find(":focusable").attr("tabindex","0")},disableGlobalSidebar:function(){this.$globalSidebar.attr("aria-hidden","true"),this.$globalSidebar.find(":focusable").attr("tabindex","-1")},setSidebarNavAttributes:function(){var t=this.navIsExpanded();null!==t&&(t?this.enableGlobalSidebar():this.disableGlobalSidebar())},navIsExpanded:function(){if(!this.$globalSidebar[0])return null;var t=getComputedStyle(this.$globalSidebar[0]).getPropertyValue("--is-always-visible").trim();return"true"===this.$navToggle.attr("aria-expanded")||"true"===t},toggleSidebar:function(){var t="true"===this.$sidebarToggle.attr("aria-expanded")?"false":"true";this.$sidebarToggle.attr("aria-expanded",t),Garnish.$bod.toggleClass("showing-sidebar")},initTabs:function(){this.tabManager&&(this.tabManager.destroy(),this.tabManager=null);var t=$("#tabs");t.length&&(this.tabManager=new Craft.Tabs(t,{handleCtrlClicks:!0}),this.tabManager.on("selectTab",(function(t){var e=t.$tab.attr("href");if(e&&"#"===e.charAt(0)&&$(e).removeClass("hidden"),Garnish.$win.trigger("resize"),Garnish.$doc.trigger("scroll"),e&&"#"===e.charAt(0)){var n,i=a(document.querySelectorAll("#site-crumb-menu a[href], #context-menu a[href]"));try{for(i.s();!(n=i.n()).done;){var r=n.value;r.href=r.href.match(/^[^#]*/)[0]+e}}catch(t){i.e(t)}finally{i.f()}}"undefined"!=typeof history&&Garnish.requestAnimationFrame((function(){history.replaceState(void 0,void 0,e)}))})),this.tabManager.on("deselectTab",(function(t){var e=t.$tab.attr("href");e&&"#"===e.charAt(0)&&$(t.$tab.attr("href")).addClass("hidden")})))},updateTabs:function(t){if(t){var e=$(t).attr("id","tabs");this.tabManager?this.tabManager.$container.replaceWith(e):e.appendTo(this.$contentHeader),this.initTabs()}else this.tabManager&&(this.tabManager.$container.siblings().length?this.tabManager.$container.remove():this.tabManager.$container.parent().remove(),this.tabManager.destroy(),this.tabManager=null)},get $tabsContainer(){return this.tabManager?this.tabManager.$container:void 0},get $tabsList(){return this.tabManager?this.tabManager.$tablist:void 0},get $tabs(){return this.tabManager?this.tabManager.$tablist.find("> a"):void 0},get $selectedTab(){return this.tabManager?this.tabManager.$selectedTab:void 0},get selectedTabIndex(){return this.tabManager?this.tabManager.$tabs.index(this.tabManager.$selectedTab):void 0},get $focusableTab(){return this.tabManager?this.tabManager.$focusableTab:void 0},selectTab:function(t){this.tabManager&&this.tabManager.selectTab(t)},deselectTab:function(){this.tabManager&&this.tabManager.deselectTab()},handleSkipLinkVisibility:function(){this.$globalSkipLinkList.length&&this.$globalSkipLinkList.find("a").each((function(t,e){var n=$(e);$(n.attr("href")).length?n.removeClass("hidden"):n.addClass("hidden")}))},handleBreadcrumbVisibility:function(){if(this.$crumbItems.length){this.$crumbMenuItems&&(this.$crumbItems.css("max-width",""),this.$crumbMenuItems.insertAfter(this.$crumbMenuTriggerItem),this.$crumbMenuTriggerItem.detach(),this.$crumbMenuItems=null);for(var t=Math.ceil(this.$crumbs[0].getBoundingClientRect().width-this.$navToggle[0].getBoundingClientRect().width),e=[],n=0;n<this.$crumbItems.length;n++){var i=this.$crumbItems.eq(n);e[n]=i[0].getBoundingClientRect().width}if(e.reduce((function(t,e){return t+e}),0)>t){if(this.$crumbMenuTriggerItem)this.$crumbMenuTriggerItem.prependTo(this.$crumbList);else{this.$crumbMenuTriggerItem=$("<li/>",{class:"crumb"}).prependTo(this.$crumbList);var r=$("<div/>",{class:"crumb-label"}).appendTo(this.$crumbMenuTriggerItem),a=$("<button/>",{id:"crumb-menu-trigger","data-icon":"ellipsis","data-disclosure-trigger":"true","aria-controls":"crumb-menu","aria-haspopup":"true","aria-label":Craft.t("app","More…"),title:Craft.t("app","More…")}).appendTo(r);this.$crumbMenu=$("<div/>",{id:"crumb-menu",class:"menu menu--disclosure","data-disclosure-menu":"true"}).appendTo(r),this.$crumbMenuList=$("<ul/>").appendTo(this.$crumbMenu),a.disclosureMenu()}for(var s=this.$crumbMenuTriggerItem[0].getBoundingClientRect().width,o=this.$crumbItems.length-1;o>=0;o--){if(s+e[o]>t){this.$crumbMenuItems=this.$crumbItems.slice(0,o+1),this.$crumbMenuItems.appendTo(this.$crumbMenuList);break}s+=e[o]}}}},handleWindowResize:function(){this.updateResponsiveTables(),this.handleBreadcrumbVisibility(),this.handleSkipLinkVisibility()},handleLayerUpdates:function(){var t;if(Garnish.uiLayerManager.modalLayers.length!==this.modalLayers.length){if(this.modalLayers=Garnish.uiLayerManager.modalLayers,this.announcerTimeout&&clearTimeout(this.announcerTimeout),0===Garnish.uiLayerManager.modalLayers.length)this.$activeLiveRegion=this.$globalLiveRegion;else{var e,n,i=Garnish.uiLayerManager.highestModalLayer.$container;i.hasClass("modal")?n=i.data("modal"):i.hasClass("slideout-container")&&(n=i.find(".slideout").data("slideout")),n||console.warn("There is no modal object"),null!==(e=n)&&void 0!==e&&e.$liveRegion?this.$activeLiveRegion=n.$liveRegion:(console.warn("There is no live region in the active modal layer."),this.$activeLiveRegion=null)}null===(t=this.$activeLiveRegion)||void 0===t||t.empty()}},updateResponsiveTables:function(){for(this.updateResponsiveTables._i=0;this.updateResponsiveTables._i<this.$collapsibleTables.length;this.updateResponsiveTables._i++)this.updateResponsiveTables._$table=this.$collapsibleTables.eq(this.updateResponsiveTables._i),this.updateResponsiveTables._containerWidth=this.updateResponsiveTables._$table.parent().width(),this.updateResponsiveTables._check=!1,this.updateResponsiveTables._containerWidth>0&&(void 0===this.updateResponsiveTables._$table.data("lastContainerWidth")?this.updateResponsiveTables._check=!0:(this.updateResponsiveTables._isCollapsed=this.updateResponsiveTables._$table.hasClass("collapsed"),this.updateResponsiveTables._containerWidth>this.updateResponsiveTables._$table.data("lastContainerWidth")?this.updateResponsiveTables._isCollapsed&&(this.updateResponsiveTables._$table.removeClass("collapsed"),this.updateResponsiveTables._check=!0):this.updateResponsiveTables._isCollapsed||(this.updateResponsiveTables._check=!0)),this.updateResponsiveTables._check&&this.updateResponsiveTables._$table.width()-30>this.updateResponsiveTables._containerWidth&&this.updateResponsiveTables._$table.addClass("collapsed"),this.updateResponsiveTables._$table.data("lastContainerWidth",this.updateResponsiveTables._containerWidth))},updateFixedHeader:function(){var t;if(!(this.isMobile||null!==(t=this.$sidebarToggle)&&void 0!==t&&t.length&&null!==this.$sidebarToggle[0].offsetParent))if(this.$main.length&&this.$headerContainer[0].getBoundingClientRect().top<0){var e=this.$headerContainer.height(),n=this.$header.width();this.fixedHeader||(this.$contentContainer.css("min-height","calc(100vh - "+(e+14+48-1)+"px)"),this.$headerContainer.height(e),this.$header.width(n),Garnish.$bod.addClass("fixed-header"),this.fixedHeader=!0),this._setFixedTopPos(this.$sidebar,e),this.$detailsContainer.css("top",e+14)}else this.fixedHeader&&(this.$headerContainer.height("auto"),this.$header.width("auto"),Garnish.$bod.removeClass("fixed-header"),this.$contentContainer.css("min-height",""),this.$sidebar.removeClass("fixed").css("top",""),this.$detailsContainer.css("top",""),this.fixedHeader=!1)},updateNotificationHeadingDisplay:function(){this.notificationCount>0?this.$notificationHeading.removeClass("hidden"):this.$notificationHeading.addClass("hidden")},_setFixedTopPos:function(t,e){t.length&&this.$contentContainer.length&&(t.outerHeight()>=this.$contentContainer.outerHeight()?t.removeClass("fixed").css("top",""):t.addClass("fixed").css("top",Math.min(e+14,Math.max(this.$mainContent[0].getBoundingClientRect().top,document.documentElement.clientHeight-t.outerHeight()))+"px"))},announce:function(t){var e,n=this;t&&this.$activeLiveRegion&&document.contains(this.$activeLiveRegion[0])?(this.announcerTimeout&&clearTimeout(this.announcerTimeout),null===(e=this.$activeLiveRegion)||void 0===e||e.empty().text(t),this.announcerTimeout=setTimeout((function(){var t;null===(t=n.$activeLiveRegion)||void 0===t||t.empty()}),5e3)):console.warn("There was an error announcing this message.")},displayNotification:function(t,e,n){var i,r=this;return(i=t instanceof Craft.CP.Notification?t:new Craft.CP.Notification(t,e,n)).show().then((function(){r.trigger("displayNotification",{notificationType:i.type,message:i.message,notification:i}),r.updateNotificationHeadingDisplay()})),i},displayNotice:function(t,e){return this.displayNotification("notice",t,Object.assign({icon:"info",iconLabel:Craft.t("app","Notice")},e))},displaySuccess:function(t,e){return this.displayNotification("success",t,Object.assign({icon:"check",iconLabel:Craft.t("app","Success")},e))},displayError:function(t,e){return t&&"object"!==s(t)||(e=t,t=Craft.t("app","A server error occurred.")),this.displayNotification("error",t,Object.assign({icon:"alert",iconLabel:Craft.t("app","Error")},e))},copyElements:function(t){if(t instanceof jQuery){var e=t;t=[],e.each((function(e,n){var i=$(n);t.push({type:i.data("type"),id:i.data("id"),draftId:i.data("draftId"),revisionId:i.data("revisionId"),fieldId:i.data("fieldId"),ownerId:i.data("ownerId"),siteId:i.data("siteId")})}))}t.length?Craft.setLocalStorage("copiedElements",t):Craft.removeLocalStorage("copiedElements"),this.showElementCopyNotification(t),Craft.broadcaster&&Craft.broadcaster.postMessage({event:"copyElements"})},clearCopiedElements:function(){this.copyElements([])},showElementCopyNotification:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.closeElementCopyNotification(!1),e.length?(this.elementCopyNotification=new Craft.CP.ElementCopyNotification(e,n),this.displayNotification(this.elementCopyNotification),this.elementCopyNotification.on("show",(function(){t.elementCopyNotification&&t._invokeElementCopyCallbacks(t.elementCopyNotification.elementInfo)}))):this._invokeElementCopyCallbacks(e)},_invokeElementCopyCallbacks:function(t){var e,n=this._pasteElementsButtonLabel(t),i=a(this.copyElementCallbacks);try{for(i.s();!(e=i.n()).done;)callback=e.value,callback(t,n)}catch(t){i.e(t)}finally{i.f()}},_pasteElementsButtonLabel:function(t){if(!t.length)return null;var e=t[0].type;return Craft.uppercaseFirst(Craft.t("app","Paste {type}",{type:1===t.length?Craft.elementTypeNames[e][2]:Craft.elementTypeNames[e][3]}))},closeElementCopyNotification:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.elementCopyNotification){var e=this.elementCopyNotification;this.elementCopyNotification=null,e.close(),t&&this._invokeElementCopyCallbacks([])}},onCopyElements:function(t){var e;this.copyElementCallbacks.push(t),null!==(e=this.elementCopyNotification)&&void 0!==e&&e.loaded&&t(this.elementCopyNotification.elementInfo,this._pasteElementsButtonLabel(this.elementCopyNotification.elementInfo))},getCopiedElements:function(){var t;return null!==(t=this.elementCopyNotification)&&void 0!==t&&t.loaded?this.elementCopyNotification.elementInfo:[]},pasteElements:function(){var t=arguments,e=this;return r(n().mark((function i(){var r,a,s,o,l;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:{},null!=(a=Craft.getLocalStorage("copiedElements"))&&a.length){n.next=4;break}return n.abrupt("return");case 4:return n.prev=4,n.next=7,Craft.sendActionRequest("POST","elements/bulk-duplicate",{data:{elements:a,newAttributes:r}});case 7:o=n.sent,s=o.data,n.next=15;break;case 11:return n.prev=11,n.t0=n.catch(4),Craft.cp.displayError(null===n.t0||void 0===n.t0||null===(l=n.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message),n.abrupt("return",[]);case 15:return e.clearCopiedElements(),e.displaySuccess(s.message),n.abrupt("return",s.newElements);case 18:case"end":return n.stop()}}),i,null,[[4,11]])})))()},fetchAlerts:function(){return Craft.queue.push((function(){return new Promise((function(t,e){var n={path:Craft.path};Craft.sendActionRequest("POST","app/get-cp-alerts",{data:n}).then((function(e){var n=e.data;t(n.alerts)})).catch(e)}))}))},displayAlerts:(u=r(n().mark((function t(i){var r,s,o,l,c,u,h=arguments;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(h.length>1&&void 0!==h[1])||h[1],this.$alerts.remove(),!Array.isArray(i)||!i.length){t.next=12;break}this.$alerts=$('<ul id="alerts"/>').prependTo(this.$pageContainer),s=a(i);try{for(s.s();!(o=s.n()).done;)l=o.value,$.isPlainObject(l)||e("alert"),c=l.content,l.showIcon&&(c='<span data-icon="alert" aria-label="'.concat(Craft.t("app","Error"),'"></span> ').concat(c)),$("<li><div>".concat(c,"</div></li>")).appendTo(this.$alerts)}catch(t){s.e(t)}finally{s.f()}if(!r){t.next=11;break}return u=this.$alerts.outerHeight(),this.$alerts.css("margin-top",-u),t.next=11,Craft.animate(this.$alerts,{"margin-top":0});case 11:this.initAlerts();case 12:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)}),initAlerts:function(){for(var t=this,e=this.$alerts.find('a[class^="shun:"]'),i=0;i<e.length;i++)this.addListener(e[i],"click",(function(e){e.preventDefault(),Craft.queue.push((function(){return new Promise((function(n,i){var r=$(e.currentTarget),a={message:r.prop("className").substring(5)};Craft.sendActionRequest("POST","app/shun-cp-alert",{data:a}).then((function(){r.parent().remove(),n()})).catch((function(e){var n=e.response;t.displayError(n.data.message),i()}))}))}))}));var a=this.$alerts.find(".resolvable-alert-buttons");if(a.length){var s=Craft.ui.createButton({label:Craft.t("app","Refresh"),spinner:!0}).appendTo(a);s.on("click",r(n().mark((function e(){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.addClass("loading"),e.prev=1,e.next=4,Craft.sendApiRequest("GET","ping");case 4:return e.next=6,t.fetchAlerts();case 6:i=e.sent,t.displayAlerts(i,!1);case 8:return e.prev=8,s.removeClass("loading"),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[1,,8,11]])}))))}},updateContext:function(t,e){var n=document.querySelector("#context-menu-container > span");n&&(n.textContent=t);var i=document.querySelector("#context-menu a.sel");if(i){i.querySelector(".menu-item-label").textContent=t;var r=i.querySelector(".menu-item-description");e?(r||((r=document.createElement("div")).className="menu-item-description smalltext light",i.append(r)),r.textContent=e):r&&r.remove()}},showSiteCrumbMenuItem:function(t){var e=document.querySelector('#site-crumb-menu a[data-site-id="'.concat(t,'"]'));if(e){var n=e.closest("li");n.classList.remove("hidden");var i=n.closest(".menu-group");i&&i.classList.remove("hidden")}},setSiteCrumbMenuItemStatus:function(t,e){var n=document.querySelector('#site-crumb-menu a[data-site-id="'.concat(t,'"]'));if(n){var i=n.querySelector(".status");e?(i||(i=document.createElement("div"),n.prepend(i)),i.className="status ".concat(e)):i&&i.remove()}},checkForUpdates:(c=r(n().mark((function t(e,i,r,s){var o,l,c,u,h,d,f,p,g,m=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"==typeof i&&(s=r,r=i,i=!1),this.checkingForUpdates&&(!0===e&&!this.forcingRefreshOnUpdatesCheck||!0===i&&!this.includingDetailsOnUpdatesCheck)&&(o=r,l=s,r=function(){m.checkForUpdates(e,i,o,l)}),"function"==typeof r&&(Array.isArray(this.checkForUpdatesCallbacks)||(this.checkForUpdatesCallbacks=[]),this.checkForUpdatesCallbacks.push(r)),"function"==typeof s&&(Array.isArray(this.checkForUpdatesFailureCallbacks)||(this.checkForUpdatesFailureCallbacks=[]),this.checkForUpdatesFailureCallbacks.push(s)),this.checkingForUpdates){t.next=23;break}return this.checkingForUpdates=!0,this.forcingRefreshOnUpdatesCheck=!0===e,this.includingDetailsOnUpdatesCheck=!0===i,t.prev=8,t.next=11,this._checkForUpdates(e,i);case 11:c=t.sent,t.next=19;break;case 14:if(t.prev=14,t.t0=t.catch(8),this.checkingForUpdates=!1,Array.isArray(this.checkForUpdatesFailureCallbacks)){u=this.checkForUpdatesFailureCallbacks,this.checkForUpdatesFailureCallbacks=null,h=a(u);try{for(h.s();!(d=h.n()).done;)(0,d.value)()}catch(t){h.e(t)}finally{h.f()}}return t.abrupt("return");case 19:if(this.updateUtilitiesBadge(),this.checkingForUpdates=!1,Array.isArray(this.checkForUpdatesCallbacks)){f=this.checkForUpdatesCallbacks,this.checkForUpdatesCallbacks=null,p=a(f);try{for(p.s();!(g=p.n()).done;)(0,g.value)(c)}catch(t){p.e(t)}finally{p.f()}}this.trigger("checkForUpdates",{updateInfo:c});case 23:case"end":return t.stop()}}),t,this,[[8,14]])}))),function(t,e,n,i){return c.apply(this,arguments)}),_checkForUpdates:function(t,e){var n=this;return new Promise((function(i,r){t?n._getUpdates(e).then(i).catch(r):n._checkForCachedUpdates(e).then((function(t){t.cached?i(t):n._getUpdates(e).then((function(t){i(t)})).catch(r)})).catch(r)}))},_checkForCachedUpdates:function(t){return new Promise((function(e,n){var i={onlyIfCached:!0,includeDetails:t};Craft.sendActionRequest("POST","app/check-for-updates",{data:i}).then((function(t){var n=t.data;e(n)})).catch((function(){e({cached:!1})}))}))},_getUpdates:function(t){var e=this;return new Promise((function(n,i){Craft.sendApiRequest("GET","updates").then((function(r){e._cacheUpdates(r,t).then((function(t){n(t)})).catch(i)})).catch(i)}))},_cacheUpdates:function(t,e){return new Promise((function(n,i){var r={updates:t,includeDetails:e};Craft.sendActionRequest("POST","app/cache-updates",{data:r}).then((function(t){var e=t.data;n(e)})).catch(i)}))},updateUtilitiesBadge:function(){var t=$("#nav-utilities").find("> a:not(.sel)");t.length&&Craft.queue.push((function(){return new Promise((function(e,n){Craft.sendActionRequest("POST","app/get-utilities-badge-count").then((function(n){var i=n.data,r=t.children(".sidebar-action__badge");i.badgeCount&&!r.length&&(r=$('<span class="sidebar-action__badge"><span class="badge" aria-hidden="true"></span><span class="visually-hidden" data-notification></span></span>').appendTo(t));var a=r.children(".badge"),s=r.children("[data-notification]");i.badgeCount?(a.text(i.badgeCount),s.text(Craft.t("app","{num, number} {num, plural, =1{notification} other{notifications}}",{num:i.badgeCount}))):r.length&&r.remove(),e()})).catch(n)}))}))},runQueue:function(){var t=this;this.enableQueue&&(Craft.runQueueAutomatically?Craft.queue.push((function(){return new Promise((function(e,n){Craft.sendActionRequest("POST","queue/run").then((function(){t.trackJobProgress(!1,!0),e()})).catch(n)}))})):this.trackJobProgress(!1,!0))},trackJobProgress:function(t,e){this.trackJobProgressTimeout&&!e||!this.enableQueue||(this.cancelJobTracking(),t?(!0===t&&(t=this.getNextJobDelay()),this.trackJobProgressTimeout=setTimeout(this._trackJobProgressInternal.bind(this),t)):this._trackJobProgressInternal())},getNextJobDelay:function(){return Math.min(6e4,500*this.displayedJobInfoUnchanged)},_trackJobProgressInternal:function(){var t=this;Craft.remainingSessionTime?(this.trackingJobProgress=!0,Craft.queue.push(r(n().mark((function e(){var i,r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.trackingJobProgress){e.next=2;break}return e.abrupt("return");case 2:return Craft.broadcaster&&Craft.broadcaster.postMessage({event:"beforeTrackJobProgress"}),t.jobProgressCancelToken=axios.CancelToken.source(),e.prev=4,e.next=7,Craft.sendActionRequest("POST","queue/get-job-info?limit=50&dontExtendSession=1",{cancelToken:t.jobProgressCancelToken.token});case 7:r=e.sent,i=r.data,e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(4),400!==(null===e.t0||void 0===e.t0||null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=17;break}Garnish.once(Craft.AuthManager,"login",(function(){t._trackJobProgressInternal()})),e.next=19;break;case 17:if(!t.trackingJobProgress){e.next=19;break}throw e.t0;case 19:return e.abrupt("return");case 20:return e.prev=20,t.trackingJobProgress=!1,t.trackJobProgressTimeout=null,t.jobProgressCancelToken=null,e.finish(20);case 25:t.setJobData(i),t.jobInfo.length&&t.trackJobProgress(!0),Craft.broadcaster&&Craft.broadcaster.postMessage({event:"trackJobProgress",jobData:i});case 28:case"end":return e.stop()}}),e,null,[[4,11,20,25]])}))))):Garnish.once(Craft.AuthManager,"login",(function(){t._trackJobProgressInternal()}))},setJobData:function(t){this.totalJobs=t.total,this.setJobInfo(t.jobs)},setJobInfo:function(t){if(this.enableQueue){this.jobInfo=t;var e=this.displayedJobInfo;this.displayedJobInfo=this.getDisplayedJobInfo(),e&&this.displayedJobInfo&&e.id===this.displayedJobInfo.id&&e.progress===this.displayedJobInfo.progress&&e.progressLabel===this.displayedJobInfo.progressLabel&&e.status===this.displayedJobInfo.status?this.displayedJobInfoUnchanged++:this.displayedJobInfoUnchanged=1,this.updateJobIcon(),this.trigger("setJobInfo")}},cancelJobTracking:function(){this.trackingJobProgress=!1,this.trackJobProgressTimeout&&(clearTimeout(this.trackJobProgressTimeout),this.trackJobProgressTimeout=null),this.jobProgressCancelToken&&this.jobProgressCancelToken.cancel()},getDisplayedJobInfo:function(){if(!this.enableQueue)return null;for(var t=[Craft.CP.JOB_STATUS_RESERVED,Craft.CP.JOB_STATUS_FAILED,Craft.CP.JOB_STATUS_WAITING],e=0;e<t.length;e++)for(var n=0;n<this.jobInfo.length;n++)if(this.jobInfo[n].status===t[e]&&(t[e]!==Craft.CP.JOB_STATUS_WAITING||!this.jobInfo[n].delay))return this.jobInfo[n];return null},updateJobIcon:function(){this.enableQueue&&this.$nav.length&&(this.displayedJobInfo?(this.jobProgressIcon||(this.jobProgressIcon=new g),this.displayedJobInfo.status===Craft.CP.JOB_STATUS_RESERVED||this.displayedJobInfo.status===Craft.CP.JOB_STATUS_WAITING?(this.jobProgressIcon.hideFailMode(),this.jobProgressIcon.setDescription(this.displayedJobInfo.description,this.displayedJobInfo.progressLabel),this.jobProgressIcon.setProgress(this.displayedJobInfo.progress)):this.displayedJobInfo.status===Craft.CP.JOB_STATUS_FAILED&&(Craft.canAccessQueueManager?this.jobProgressIcon.showFailMode(Craft.t("app","Failed")):(this.jobProgressIcon.$a.remove(),this.jobProgressIcon.destroy()))):this.jobProgressIcon&&(this.jobProgressIcon.hideFailMode(),this.jobProgressIcon.complete(),delete this.jobProgressIcon))},getSiteId:function(){var t=Craft.getLocalStorage("BaseElementIndex.siteId");if(void 0!==t){Craft.removeLocalStorage("BaseElementIndex.siteId");try{this.setSiteId(t)}catch(t){}}return Craft.siteId},setSiteId:function(t){var e=Craft.sites.find((function(e){return e.id===t}));if(!e)throw"Invalid site ID: ".concat(t);Craft.siteId=t,Craft.actionUrl=Craft.getUrl(Craft.actionUrl,{site:e.handle}),Craft.baseCpUrl&&(Craft.baseCpUrl=Craft.getUrl(Craft.baseCpUrl,{site:e.handle})),Craft.baseUrl=Craft.getUrl(Craft.baseUrl,{site:e.handle});var n=Craft.getUrl(document.location.href,{site:e.handle});history.replaceState({},"",n);var i,r=a(document.body.classList);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.match(/^site--/)&&document.body.classList.remove(s)}}catch(t){r.e(t)}finally{r.f()}document.body.classList.add("site--".concat(e.handle)),$("a").each((function(){Craft.cpTrigger&&this.hostname.length&&this.hostname===location.hostname&&-1!==this.href.indexOf(Craft.cpTrigger)&&(this.href=Craft.getUrl(this.href,{site:e.handle}))}))},previewCountBadge:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t||window.event;if("click"==i.type||32==i.keyCode||13==i.keyCode){i.preventDefault();var r=$(i.target).prev(),a=$(e).parent(),s=$(e).data("other");s&&(s=JSON.parse(s),$(e).replaceWith(s),n&&this.elementThumbLoader.load(a)),Garnish.firstFocusableElement(r.next()).trigger("focus")}}},{notificationDuration:5e3,JOB_STATUS_WAITING:1,JOB_STATUS_RESERVED:2,JOB_STATUS_DONE:3,JOB_STATUS_FAILED:4}),Craft.CP.Notification=Garnish.Base.extend({type:null,message:null,settings:null,closing:!1,closeTimeout:null,_preventDelayedClose:!1,$container:null,$innerContainer:null,$closeBtn:null,$main:null,$message:null,$detailsContainer:null,originalActiveElement:null,init:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.type=t,this.message=e,this.setSettings(n,Craft.CP.Notification.defaults)},show:(f=r(n().mark((function e(){var i,r,a,s,o,l=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$container=$("<div/>",{class:"notification","data-type":this.type}),this.settings.class&&this.$container.addClass(this.settings.class),this.$innerContainer=$("<div/>",{class:"notification-inner"}).appendTo(this.$container),i=$('<div class="notification-body"/>').appendTo(this.$innerContainer),e.t0=$("<div/>",{class:"cp-icon notification-icon"}),e.next=7,Craft.ui.icon(this.settings.icon);case 7:return e.t1=e.sent,r=e.t0.append.call(e.t0,e.t1).appendTo(i),this.settings.iconLabel?r.attr({"aria-label":this.settings.iconLabel,role:"img"}):r.attr("aria-hidden","true"),this.$main=$('<div class="notification-main"/>').appendTo(i),this.$message=$("<div/>",{class:"notification-message",text:this.message}).appendTo(this.$main),a=$("<div/>").appendTo(this.$innerContainer),this.$closeBtn=this.createCloseButton().appendTo(a),e.next=16,this.getDetails();case 16:if((s=e.sent)&&(this.$detailsContainer=$('<div class="notification-details"/>').append(s).appendTo(this.$main),this.$detailsContainer.find("button,input").length&&(this.originalActiveElement=document.activeElement,this.$container.attr("tabindex","-1").focus(),this.addListener(this.$container,"keydown",(function(t){t.keyCode===Garnish.ESC_KEY&&l.close()})))),Craft.initUiElements(this.$innerContainer),this.addListener(this.$closeBtn,"click",(function(){l.handleCloseButtonClick()})),this.$container.appendTo(Craft.cp.$notificationContainer),!this.settings.animate){e.next=26;break}return o=Craft.notificationPosition.startsWith("start-")?"top":"bottom",this.$container.css(t({opacity:0},"margin-".concat(o),this._negMargin())),e.next=26,Craft.animate(this.$container,t({opacity:1},"margin-".concat(o),0));case 26:this.$detailsContainer&&Craft.cp.elementThumbLoader.load(this.$detailsContainer),Craft.notificationDuration&&!this.settings.persist&&this._initDelayedClose(),this.trigger("show");case 29:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)}),createCloseButton:function(){return $("<button/>",{type:"button",class:"notification-close-btn","aria-label":Craft.t("app","Close"),"data-icon":"remove"})},updateMessage:function(t){this.message=t,this.$message.text(t)},getDetails:(d=r(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.settings.details);case 1:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)}),_initDelayedClose:function(){var t=this;this._preventDelayedClose||(Craft.isVisible()?(this.delayedClose(),this.$container.on("keypress keyup change focus click mousedown mouseup",(function(e){e.target!=t.$closeBtn[0]&&(t.$container.off("keypress keyup change focus click mousedown mouseup"),t.preventDelayedClose())}))):Garnish.$doc.one("visibilitychange",(function(){t._initDelayedClose()})))},_negMargin:function(){return"-".concat(this.$container.outerHeight()+12,"px")},handleCloseButtonClick:function(){this.close()},close:(h=r(n().mark((function e(){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closing){e.next=2;break}return e.abrupt("return");case 2:return this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null),this.closing=!0,this.originalActiveElement&&document.activeElement&&(document.activeElement===this.$container[0]||$.contains(this.$container[0],document.activeElement))&&$(this.originalActiveElement).focus(),i=Craft.notificationPosition.startsWith("start-")?"top":"bottom",e.next=8,Craft.animate(this.$container,t({opacity:0},"margin-".concat(i),this._negMargin()));case 8:this.destroy(),Craft.cp.trigger("notificationClose");case 10:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)}),delayedClose:function(){var t=this;this.closeTimeout=setTimeout((function(){t.close()}),Craft.notificationDuration),this.$container.one("mouseover",(function(){clearTimeout(t.closeTimeout),t.closeTimeout=null,t.$container.on("mouseout",(function(e){e.currentTarget==t.$container[0]&&(t.$container.off("mouseout"),t.delayedClose())}))}))},preventDelayedClose:function(){this._preventDelayedClose=!0,this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null),this.$container.off("mouseover mouseout")},destroy:function(){this.$container.remove(),this.base()}},{defaults:{icon:"info",iconLabel:null,details:null,persist:!1,class:null,animate:!0}}),Craft.CP.ElementCopyNotification=Craft.CP.Notification.extend({elementInfo:null,elementType:null,loaded:!1,$copiedElements:null,init:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.elementInfo=t,null===(e=this.elementInfo)||void 0===e||!e.length)throw"No elements are copied.";this.elementType=this.elementInfo[0].type;var i=this.getMessage();this.base("notice",i,Object.assign({icon:"clone-dashed",persist:!0,class:"copied-elements-notification"},n))},createCloseButton:function(){return Craft.ui.createButton({icon:"xmark",label:Craft.t("app","Cancel"),class:"chromeless notification-close-btn"})},getMessage:function(){return 1===this.elementInfo.length?Craft.t("app","{type} copied.",{type:Craft.elementTypeNames[this.elementType][0]}):Craft.uppercaseFirst(Craft.t("app","{total, number} {type} copied.",{total:this.elementInfo.length,type:Craft.elementTypeNames[this.elementType][3]}))},getDetails:(p=r(n().mark((function t(){var e,i,s,o,l,c,u,h,d,f,p,g,m;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.sendActionRequest("POST","app/render-elements",{data:{elements:this.elementInfo.map((function(t){return{type:t.type,id:t.id,siteId:t.siteId,instances:[{ui:"chip",hyperlink:!1}]}}))}});case 2:if(e=t.sent,i=e.data,$.isPlainObject(i.elements)){t.next=7;break}return Craft.cp.clearCopiedElements(),t.abrupt("return");case 7:setTimeout(r(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.appendHeadHtml(i.headHtml);case 2:return t.next=4,Craft.appendBodyHtml(i.bodyHtml);case 4:case"end":return t.stop()}}),t)}))),1),this.$copiedElements=$('<div class="copied-elements"/>'),s=$(),o=a(this.elementInfo);try{for(o.s();!(l=o.n()).done;){c=l.value,u=a(i.elements[c.id]||[]);try{for(u.s();!(h=u.n()).done;)d=h.value,s=s.add(d)}catch(t){u.e(t)}finally{u.f()}}}catch(t){o.e(t)}finally{o.f()}for(f=[],p=0;p<this.elementInfo.length;p++)g=this.elementInfo[p],(m=s.filter("[data-id=".concat(g.id,"][data-site-id=").concat(g.siteId,"]:first"))).length&&(g.data=m.data(),m.css("z-index",this.elementInfo.length-p).addClass("copied-element-chip").appendTo(this.$copiedElements),0!==p&&m.css({"inset-block-start":4*p,"inset-inline-start":4*p,"--overlay-opacity":Math.min(.25+.15*p,1)}),f.push(g));return f.length!==this.elementInfo.length&&(this.elementInfo=f,this.updateMessage(this.getMessage())),this.loaded=!0,t.abrupt("return",this.$copiedElements);case 18:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)}),handleCloseButtonClick:function(){Craft.cp.clearCopiedElements()}}),Garnish.$scrollContainer=Garnish.$win,Craft.cp=new Craft.CP;var g=Garnish.Base.extend({$li:null,$container:null,$a:null,$label:null,$progressLabel:null,$tooltip:$(),progress:null,failMode:!1,_$bgCanvas:null,_$staticCanvas:null,_$hoverCanvas:null,_$failCanvas:null,_staticCtx:null,_hoverCtx:null,_canvasSize:null,_arcPos:null,_arcRadius:null,_lineWidth:null,_arcStartPos:0,_arcEndPos:0,_arcStartStepSize:null,_arcEndStepSize:null,_arcStep:null,_arcStepTimeout:null,_arcAnimateCallback:null,_progressBar:null,init:function(){this.$li=$("<li/>").appendTo(Craft.cp.$nav.children("ul")),this.$container=$("<div/>",{class:"nav-item nav-item--job"}).appendTo(this.$li),this.$a=$("<a/>",{id:"job-icon",class:"sidebar-action sidebar-action--job",href:Craft.canAccessQueueManager?Craft.getUrl("utilities/queue-manager"):null}).appendTo(this.$container);var t=$('<span class="sidebar-action__prefix"/>');this.$canvasContainer=$('<span class="nav-icon"/>').appendTo(t),t.appendTo(this.$a);var e=$('<span class="sidebar-action__label">');e.appendTo(this.$a),this.$label=$('<span class="label"/>').appendTo(e),this.$progressLabel=$('<span class="progress-label"/>').appendTo(e).hide(),"collapsed"===Garnish.$bod.data("sidebar")&&(this.$tooltip=$("<craft-tooltip/>",{placement:"right","self-managed":!0,"aria-label":this.$label.text()}).appendTo(this.$a));var n=window.devicePixelRatio>1?2:1;this._canvasSize=18*n,this._arcPos=this._canvasSize/2,this._arcRadius=7*n,this._lineWidth=3*n,this._$bgCanvas=this._createCanvas("bg","#a3afbb"),this._$staticCanvas=this._createCanvas("static",this.$container.css("color")),this._$hoverCanvas=this._createCanvas("hover",this.$container.css("color")),this._$failCanvas=this._createCanvas("fail","#da5a47").hide(),this._staticCtx=this._$staticCanvas[0].getContext("2d"),this._hoverCtx=this._$hoverCanvas[0].getContext("2d"),this._drawArc(this._$bgCanvas[0].getContext("2d"),0,1),this._drawArc(this._$failCanvas[0].getContext("2d"),0,1)},setDescription:function(t,e){this.$label.text(t),e?this.$progressLabel.text(e).show():this.$progressLabel.hide(),this.$tooltip.length&&this.$tooltip.attr("aria-label",t)},setProgress:function(t){0==t?(this._$staticCanvas.hide(),this._$hoverCanvas.hide()):(this._$staticCanvas.show(),this._$hoverCanvas.show(),this.progress&&t>this.progress?this._animateArc(0,t/100):this._setArc(0,t/100)),this.progress=t},complete:function(){var t=this;this._animateArc(0,1,(function(){t._$bgCanvas.velocity("fadeOut"),t._animateArc(1,1,(function(){t.$li.remove(),t.destroy()}))}))},showFailMode:function(t){this.failMode||(this.failMode=!0,this.progress=null,this._$bgCanvas.hide(),this._$staticCanvas.hide(),this._$hoverCanvas.hide(),this._$failCanvas.show(),this.setDescription(t))},hideFailMode:function(){this.failMode&&(this.failMode=!1,this._$bgCanvas.show(),this._$staticCanvas.show(),this._$hoverCanvas.show(),this._$failCanvas.hide())},_createCanvas:function(t,e){var n=$('<canvas id="job-icon-'+t+'" width="'+this._canvasSize+'" height="'+this._canvasSize+'"/>').appendTo(this.$canvasContainer),i=n[0].getContext("2d");return i.strokeStyle=e,i.lineWidth=this._lineWidth,i.lineCap="round",n},_setArc:function(t,e){this._arcStartPos=t,this._arcEndPos=e,this._drawArc(this._staticCtx,t,e),this._drawArc(this._hoverCtx,t,e)},_drawArc:function(t,e,n){t.clearRect(0,0,this._canvasSize,this._canvasSize),t.beginPath(),t.arc(this._arcPos,this._arcPos,this._arcRadius,(1.5+2*e)*Math.PI,(1.5+2*n)*Math.PI),t.stroke(),t.closePath()},_animateArc:function(t,e,n){this._arcStepTimeout&&clearTimeout(this._arcStepTimeout),this._arcStep=0,this._arcStartStepSize=(t-this._arcStartPos)/10,this._arcEndStepSize=(e-this._arcEndPos)/10,this._arcAnimateCallback=n,this._takeNextArcStep()},_takeNextArcStep:function(){this._setArc(this._arcStartPos+this._arcStartStepSize,this._arcEndPos+this._arcEndStepSize),this._arcStep++,this._arcStep<10?this._arcStepTimeout=setTimeout(this._takeNextArcStep.bind(this),50):this._arcAnimateCallback&&this._arcAnimateCallback()}})},7297:function(t,e,n){var i=n(3254);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals),(0,n(6054).A)("80058a3c",i,!0,{})},7337:function(){Craft.UserIndex=Craft.BaseElementIndex.extend({init:function(t,e,n){this.on("selectSource",this.updateUrl.bind(this)),this.base(t,e,n)},getDefaultSourceKey:function(){if("index"===this.settings.context&&"undefined"!=typeof defaultSourceSlug)for(var t=0;t<this.$sources.length;t++){var e=$(this.$sources[t]);if(e.data("slug")===defaultSourceSlug)return e.data("key")}return this.base()},updateUrl:function(){if("index"===this.settings.context){var t="users",e=this.$source.data("slug");e&&(t+="/".concat(e)),Craft.setPath(t)}}}),Craft.registerElementIndexClass("craft\\elements\\User",Craft.UserIndex)},7429:function(){},7459:function(){Craft.DataTableSorter=Garnish.DragSort.extend({$table:null,init:function(t,e){this.$table=$(t);var n=this.$table.children("tbody").children(":not(.filler)");(e=$.extend({},Craft.DataTableSorter.defaults,e)).container=this.$table.children("tbody"),e.helper=this.getHelper.bind(this),e.caboose="<tr/>",e.axis=Garnish.Y_AXIS,e.magnetStrength=4,e.helperLagBase=1.5,this.base(n,e)},getHelper:function(t){var e=$('<div class="'+this.settings.helperClass+'"/>').appendTo(Garnish.$bod),n=$("<table/>").appendTo(e),i=$("<tbody/>").appendTo(n);t.appendTo(i),n.width(this.$table.width()),n.prop("className",this.$table.prop("className"));for(var r=this.$table.find("tr:first").children(),a=t.children(),s=0;s<a.length;s++)$(a[s]).width($(r[s]).width());return e}},{defaults:{handle:".move",helperClass:"datatablesorthelper"}})},7493:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(r())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(t.bind.apply(t,i));return n&&a(s,n.prototype),s}(t,arguments,s(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}var o=document.createElement("template");o.innerHTML='\n  <div class="wrapper hidden" style="" tabindex="-1">\n    <div class="spinner"></div>\n    <span class="message visually-hidden">'.concat(Craft.t("app","Loading"),"</span>\n  </div>\n");var l=function(n){function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,n,i){return n=s(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,r()?Reflect.construct(n,i||[],s(e).constructor):n.apply(e,i))}(this,i,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,n),function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(i,[{key:"connectedCallback",value:function(){this.root=this;var t=o.content.cloneNode(!0);this.root.append(t),"true"===this.visible&&this.wrapper.classList.remove("hidden"),this.initialized=!0}},{key:"visible",get:function(){return this.getAttribute("visible")},set:function(t){this.setAttribute("visible",t)}},{key:"messageWrapper",get:function(){return this.querySelector(".message")}},{key:"wrapper",get:function(){return this.querySelector(".wrapper")}},{key:"attributeChangedCallback",value:function(t,e,n){if(this.initialized)return"visible"===t.toLowerCase()?"true"===n?this.show():this.hide():void 0}},{key:"disconnectedCallback",value:function(){}},{key:"show",value:function(){this.wrapper.classList.remove("hidden"),this.dispatchEvent(new CustomEvent("show"))}},{key:"hide",value:function(){this.wrapper.classList.add("hidden"),this.dispatchEvent(new CustomEvent("hide"))}},{key:"focus",value:function(){this.wrapper.focus()}}],[{key:"observedAttributes",get:function(){return["visible"]}}])}(i(HTMLElement));customElements.define("craft-spinner",l)},7536:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.EditableTable=Garnish.Base.extend({initialized:!1,id:null,baseName:null,columns:null,sorter:null,biggestId:-1,$table:null,$tbody:null,$addRowBtn:null,$tableParent:null,$statusMessage:null,rowCount:0,hasMaxRows:!1,hasMinRows:!1,radioCheckboxes:null,init:function(t,e,n,i){var r=this;this.id=t,this.baseName=e,this.columns=n,this.setSettings(i,Craft.EditableTable.defaults),this.radioCheckboxes={},this.$table=$("#"+t),this.$tbody=this.$table.children("tbody"),this.$tableParent=this.$table.parent(),this.$statusMessage=this.$tableParent.find("[data-status-message]");var a=this.$tbody.children();this.rowCount=a.length,this.$table.data("editable-table")&&(console.warn("Double-instantiating an editable table on an element"),this.$table.data("editable-table").destroy()),this.$table.data("editable-table",this),Craft.hasMousePointerEvents()?this.sorter=new Craft.DataTableSorter(this.$table,{helperClass:"editabletablesorthelper",copyDraggeeInputValuesToHelper:!0,onSortChange:function(){r.updateAllRows()}}):a.find(".move").hide();for(var s=0;s<a.length;s++){var o=a.eq(s),l=parseInt(o.attr("data-id").substring(this.settings.rowIdPrefix.length));l>this.biggestId&&(this.biggestId=l)}if(this.isVisible()?this.initialize():window.setTimeout(this.initializeIfVisible.bind(this),500),this.settings.minRows&&this.rowCount<this.settings.minRows)for(var c=this.rowCount;c<this.settings.minRows;c++)this.addRow()},isVisible:function(){return this.$table.parent().height()>0},initialize:function(){var t=this;if(this.initialized)return!1;this.initialized=!0,this.removeListener(Garnish.$win,"resize");var e=this.$table.parent(".input");e.length&&this.$table.width()>e.width()&&e.css("overflow-x","auto"),this.$addRowBtn=this.$table.next(".add"),this.updateAddRowButton();var n=this.$tbody.find(".action-btn");if(1===this.rowCount&&n.attr("disabled","disabled").addClass("disabled"),this.addListener(this.$addRowBtn,"activate","addRow"),this.settings.lazyInitRows=this.settings.lazyInitRows&&!Object.entries(this.columns).some((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=(e[0],e[1]);return"checkbox"===n.type&&n.radioMode})),this.settings.lazyInitRows)this.addListener(this.$tbody.add(n),"keypress,keyup,change,focus,blur,click,mousedown,mouseup",(function(e){var n=$(e.target),i=n.closest("tr");if(i.length&&!i.data("editable-table-row")){var r=n.hasClass("editable-table-preview")?n.next():null;t.createRowObj(i),setTimeout((function(){r&&!r.is(":focus")&&r.focus()}),100)}}));else for(var i=this.$tbody.children(),a=0;a<i.length;a++)this.createRowObj(i.eq(a));return!0},initializeIfVisible:function(){this.removeListener(Garnish.$win,"resize"),this.isVisible()?this.initialize():this.addListener(Garnish.$win,"resize","initializeIfVisible")},updateAddRowButton:function(){this.canAddRow()?(this.$addRowBtn.css("opacity","1"),this.$addRowBtn.css("pointer-events","auto"),this.$addRowBtn.attr("aria-disabled","false")):(this.$addRowBtn.css("opacity","0.2"),this.$addRowBtn.css("pointer-events","none"),this.$addRowBtn.attr("aria-disabled","true"))},updateAllRows:function(){if(!this.settings.staticRows)for(var t=this.$table.find("> tbody > tr"),e=0;e<t.length;e++)this.updateRow(t.eq(e))},updateRow:function(t){if(!this.settings.staticRows){var e=t.children("td.action").find(".delete"),n=t.children("td.action").find(".action-btn");if(e.length&&(e.attr("aria-label",Craft.t("app","Delete row {index}",{index:t.index()+1})),this.canDeleteRow()?e.removeAttr("disabled").removeClass("disabled"):e.attr("disabled","disabled").addClass("disabled")),n.length){var i="".concat(Craft.t("app","Row {index}",{index:t.index()+1})," ").concat(Craft.t("app","Actions"));n.attr("aria-label",i),1===this.rowCount?(n.attr("disabled","disabled").addClass("disabled"),n.attr("disabled","disabled").addClass("disabled")):n.removeAttr("disabled").removeClass("disabled")}}},updateDeleteRowButton:function(t){this.updateRow(this.$table.find('tr[data-id="'.concat(t,'"]')))},updateStatusMessage:function(){var t,e=this;this.$statusMessage.empty(),t=this.canAddRow()?Craft.t("app","Row could not be deleted. Minimum number of rows reached."):Craft.t("app","Row could not be added. Maximum number of rows reached."),setTimeout((function(){e.$statusMessage.text(t)}),250)},canDeleteRow:function(){return!!this.settings.allowDelete&&this.rowCount>this.settings.minRows},deleteRow:function(t){var e;this.canDeleteRow()?(null===(e=this.sorter)||void 0===e||e.removeItems(t.$tr),t.$tr.remove(),this.rowCount--,this.updateAllRows(),this.updateAddRowButton(),0===this.rowCount?(this.$table.addClass("hidden"),this.$addRowBtn.focus()):this.$tbody.find(":focusable").last().focus(),this.settings.onDeleteRow(t.$tr),this.trigger("deleteRow",{$tr:t.$tr}),t.destroy()):this.updateStatusMessage()},canAddRow:function(){return!!this.settings.allowAdd&&(!this.settings.maxRows||this.rowCount<this.settings.maxRows)},addRow:function(t,e){var n;if(this.canAddRow()){var i=this.settings.rowIdPrefix+(this.biggestId+1),r=this.createRow(i,this.columns,this.baseName,$.extend({},this.settings.defaultValues));e?r.prependTo(this.$tbody):r.appendTo(this.$tbody);var a=this.createRowObj(r);return null===(n=this.sorter)||void 0===n||n.addItems(r),!1!==t&&r.find("input:visible,textarea:visible,select:visible").first().focus(),this.rowCount++,this.updateAllRows(),this.updateAddRowButton(),this.$table.removeClass("hidden"),this.settings.onAddRow(r),this.trigger("addRow",{$tr:r}),a}this.updateStatusMessage()},createRow:function(t,e,n,i){return Craft.EditableTable.createRow(t,e,n,i,this.settings.allowReorder,this.settings.allowDelete,this.settings.staticRows,this.settings.includeRowId)},getRowObj:function(t){return t.data("editable-table-row")||this.createRowObj(t)},createRowObj:function(t){return new Craft.EditableTable.Row(this,t)},focusOnPrevRow:function(t,e,n){var i,r=t.prev("tr");if((i=r.length?this.getRowObj(r):this.addRow(!1,!0))&&i.$tds[e])if($(i.$tds[e]).hasClass("disabled"))r&&this.focusOnPrevRow(r,e,n);else{var a=$("textarea,input.text",i.$tds[e]);a.length&&($(n).trigger("blur"),a.focus())}},focusOnNextRow:function(t,e,n){var i,r=t.next("tr");if((i=r.length?this.getRowObj(r):this.addRow(!1))&&i.$tds[e])if($(i.$tds[e]).hasClass("disabled"))r&&this.focusOnNextRow(r,e,n);else{var a=$("textarea,input.text",i.$tds[e]);a.length&&($(n).trigger("blur"),a.focus())}},importData:function(t,e,n){for(var i=t.split(/\r?\n|\r/),r=0;r<i.length;r++){for(var a=i[r].split("\t"),s=0;s<a.length;s++){var o=a[s];e.$tds.eq(n+s).find("textarea,input[type!=hidden]").val(o).trigger("input")}var l=e.$tr.next("tr");e=l.length?this.getRowObj(l):this.addRow(!1)}},destroy:function(){this.$table.removeData("editable-table"),this.base()}},{textualColTypes:["autosuggest","color","date","email","multiline","number","singleline","template","time","url"],defaults:{rowIdPrefix:"",defaultValues:{},allowAdd:!1,allowReorder:!1,allowDelete:!1,minRows:null,maxRows:null,lazyInitRows:!0,onAddRow:$.noop,onDeleteRow:$.noop,staticRows:!1,includeRowId:!1,maxRowId:null},createRow:function(n,r,a,s,o,l){var c,u,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=$("<tr/>",{"data-id":n}),p=function(){if(!r.hasOwnProperty(g))return 1;var e,i=r[g],o=void 0!==s[g]?s[g]:"";if("heading"===i.type)e=$("<th/>",{scope:"row",class:i.class,html:o});else{var l,c="".concat(a,"[").concat(n,"][").concat(g,"]");switch(e=$("<td/>",{class:"".concat(null!==(l=i.class)&&void 0!==l?l:""," ").concat(i.type,"-cell"),width:i.width}),Craft.inArray(i.type,Craft.EditableTable.textualColTypes)&&e.addClass("textual"),i.code&&e.addClass("code"),i.type){case"checkbox":$('<div class="checkbox-wrapper"/>').append(Craft.ui.createCheckbox({name:c,value:i.value||"1",checked:!!o})).appendTo(e);break;case"icon":Craft.ui.createIconPicker({name:c,value:"object"!==t(o)?o:null,small:!0}).appendTo(e);break;case"color":Craft.ui.createColorInput({name:c,value:"object"!==t(o)?o:null,small:!0}).appendTo(e);break;case"date":Craft.ui.createDateInput({name:c,value:o}).appendTo(e);break;case"lightswitch":Craft.ui.createLightswitch({name:c,value:i.value||"1",on:!!o,small:!0}).appendTo(e);break;case"select":Craft.ui.createSelect({name:c,options:i.options,value:o||function(){for(var t in i.options)if(i.options.hasOwnProperty(t)&&i.options[t].default)return void 0!==i.options[t].value?i.options[t].value:t;return null}(),class:"small"}).appendTo(e);break;case"time":Craft.ui.createTimeInput({name:c,value:o}).appendTo(e);break;case"email":case"url":Craft.ui.createTextInput({name:c,value:"object"!==t(o)?o:null,type:i.type,placeholder:i.placeholder||null}).appendTo(e);break;default:var u=$("<textarea/>",{name:c,rows:i.rows||1,val:"object"!==t(o)?o:null,placeholder:i.placeholder}).appendTo(e);i.code&&u.attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"})}}e.appendTo(f)};for(var g in r)p();if(o){var m="menu-".concat(Math.floor(1e6*Math.random())),v=$("<button/>",{class:"btn menu-btn action-btn",type:"button",title:Craft.t("app","Actions"),"aria-controls":m,"data-disclosure-trigger":"true"}),y=$("<div/>",{id:m,class:"menu menu--disclosure"}),b=$("<td/>",{class:"thin action"}).appendTo(f),w=$("<div/>",{class:"flex flex-nowrap"});Craft.hasMousePointerEvents()&&w.append($("<a/>",{class:"move icon",title:Craft.t("app","Reorder")})),w.append(v).append(y).appendTo(b),v.disclosureMenu().data("disclosureMenu").addItems([{icon:(u=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-up");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)}),label:Craft.t("app","Move up"),attributes:{"data-action":"moveUp"}},{icon:(c=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("arrow-down");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)}),label:Craft.t("app","Move down"),attributes:{"data-action":"moveDown"}}])}return l&&$("<td/>",{class:"thin action"}).append($("<button/>",{class:"delete icon",title:Craft.t("app","Delete"),type:"button"})).appendTo(f),h&&d&&$("<input/>",{type:"hidden",name:"".concat(a,"[").concat(n,"][rowId]"),value:Craft.uuid()}).appendTo(f),f}}),Craft.EditableTable.Row=Garnish.Base.extend({table:null,id:null,niceTexts:null,$tr:null,$tds:null,tds:null,$textareas:null,$deleteBtn:null,get prevRow(){return this.$tr.prev("tr")},get nextRow(){return this.$tr.next("tr")},init:function(t,e){var n=this;this.table=t,this.$tr=$(e),this.$tds=this.$tr.children(),this.tds=[],this.id=this.$tr.attr("data-id"),this.$tr.data("editable-table-row",this),Craft.hasMousePointerEvents()||this.$tr.find(".move").hide();var i=parseInt(this.id.substring(this.table.settings.rowIdPrefix.length));i>this.table.biggestId&&(this.table.biggestId=i),this.$textareas=$(),this.niceTexts=[];var r,a,s,o,l={},c=0;for(r in this.table.columns)if(this.table.columns.hasOwnProperty(r)){if(a=this.table.columns[r],s=this.tds[r]=this.$tds[c],Craft.inArray(a.type,Craft.EditableTable.textualColTypes)){$(".editable-table-preview",s).remove();var u=void 0;"color"===a.type?u=$("input.color-input",s):(u=$("textarea",s),this.$textareas=this.$textareas.add(u),this.niceTexts.push(new Garnish.NiceText(u,{onHeightChange:this.onTextareaHeightChange.bind(this)}))),this.addListener(u,"focus","onTextareaFocus"),this.addListener(u,"mousedown","ignoreNextTextareaFocus"),this.addListener(u,"keypress",{tdIndex:c,type:a.type},"handleKeypress"),this.addListener(u,"input",{type:a.type},"validateValue"),u.trigger("input"),"multiline"!==a.type&&this.addListener(u,"paste",{tdIndex:c,type:a.type},"handlePaste"),l[r]=u}else"checkbox"===a.type&&(o=$('input[type="checkbox"]',s),a.radioMode&&(void 0===this.table.radioCheckboxes[r]&&(this.table.radioCheckboxes[r]=[]),this.table.radioCheckboxes[r].push(o[0]),this.addListener(o,"change",{colId:r},"onRadioCheckboxChange")),a.toggle&&this.addListener(o,"change",{colId:r},(function(t){this.applyToggleCheckbox(t.data.colId)})));$(s).hasClass("disabled")||this.addListener(s,"click",{td:s},(function(t){t.target===t.data.td&&$(t.data.td).find("textarea,input,select,.lightswitch").focus()})),c++}for(r in this.onTextareaHeightChange(),this.table.columns)this.table.columns.hasOwnProperty(r)&&"checkbox"===(a=this.table.columns[r]).type&&a.toggle&&this.applyToggleCheckbox(r);for(r in this.table.columns)this.table.columns.hasOwnProperty(r)&&(!(a=this.table.columns[r]).autopopulate||void 0===l[a.autopopulate]||l[r].val()||l[a.autopopulate].val()||new Craft.HandleGenerator(l[r],l[a.autopopulate],{allowNonAlphaStart:!0}));var h=this.$tr.children("td.action").find(".delete");this.addListener(h,"click","deleteRow");var d=this.$tr.find("input,textarea,select,.lightswitch");this.addListener(d,"focus",(function(t){$(t.currentTarget).closest("td:not(.disabled)").addClass("focus")})),this.addListener(d,"blur",(function(t){$(t.currentTarget).closest("td").removeClass("focus")}));var f=this.$tr.find("> .action .action-btn");f.length&&(this.actionDisclosure=f.data("trigger")||new Garnish.DisclosureMenu(f),this.$actionMenu=this.actionDisclosure.$container,this.actionDisclosure.on("show",(function(){n.updateDisclosureMenu(),Garnish.firstFocusableElement(n.$actionMenu).focus()})),this.$actionMenuOptions=this.$actionMenu.find("button[data-action]"),this.addListener(this.$actionMenuOptions,"activate",this.handleActionClick))},updateDisclosureMenu:function(){this.prevRow.length?this.$actionMenu.find("button[data-action=moveUp]:first").parent().removeClass("hidden"):this.$actionMenu.find("button[data-action=moveUp]:first").parent().addClass("hidden"),this.nextRow.length?this.$actionMenu.find("button[data-action=moveDown]:first").parent().removeClass("hidden"):this.$actionMenu.find("button[data-action=moveDown]:first").parent().addClass("hidden")},handleActionClick:function(t){t.preventDefault(),this.onActionSelect(t.target)},onActionSelect:function(t){switch($option=$(t),$option.data("action")){case"moveUp":this.moveUp();break;case"moveDown":this.moveDown()}this.actionDisclosure.hide()},moveUp:function(){var t=this.prevRow;t.length&&(this.$tr.insertBefore(t),this.table.updateAllRows())},moveDown:function(){var t=this.nextRow;t.length&&(this.$tr.insertAfter(t),this.table.updateAllRows())},onTextareaFocus:function(t){this.onTextareaHeightChange();var e=$(t.currentTarget);e.data("ignoreNextFocus")?e.data("ignoreNextFocus",!1):window.setTimeout((function(){Craft.selectFullValue(e)}),0)},onRadioCheckboxChange:function(t){if(t.currentTarget.checked)for(var e=0;e<this.table.radioCheckboxes[t.data.colId].length;e++){var n=this.table.radioCheckboxes[t.data.colId][e];n.checked=n===t.currentTarget}},applyToggleCheckbox:function(t){for(var e,n,i=this.table.columns[t],r=$('input[type="checkbox"]',this.tds[t]).prop("checked"),a=0;a<i.toggle.length;a++)e=i.toggle[a],this.table.colum,(n="!"===e[0])&&(e=e.substring(1)),r&&!n||!r&&n?$(this.tds[e]).removeClass("disabled").find("textarea, input").prop("disabled",!1):$(this.tds[e]).addClass("disabled").find("textarea, input").prop("disabled",!0)},ignoreNextTextareaFocus:function(t){$.data(t.currentTarget,"ignoreNextFocus",!0)},handleKeypress:function(t){var e=t.keyCode?t.keyCode:t.charCode,n=Garnish.isCtrlKeyPressed(t);if(e===Garnish.RETURN_KEY&&("multiline"!==t.data.type||n))return t.preventDefault(),t.stopPropagation(),void(t.shiftKey?this.table.focusOnPrevRow(this.$tr,t.data.tdIndex,t.currentTarget):this.table.focusOnNextRow(this.$tr,t.data.tdIndex,t.currentTarget))},handlePaste:function(t){var e=Craft.trim(t.originalEvent.clipboardData.getData("Text")," \n\r");e.match(/[\t\r\n]/)&&(t.preventDefault(),this.table.importData(e,this,t.data.tdIndex))},validateValue:function(t){if("multiline"!==t.data.type)if("number"!==t.data.type){var e=t.currentTarget.value.replace(/[\r\n]/g,"");e!==t.currentTarget.value&&(t.currentTarget.value=e)}else Craft.filterNumberInputVal(t.currentTarget)},onTextareaHeightChange:function(){for(var t=-1,e=0;e<this.niceTexts.length;e++)this.niceTexts[e].height>t&&(t=this.niceTexts[e].height);this.$textareas.css("min-height",t);var n=this.$textareas.filter(":visible").first().parent().height();n>t&&this.$textareas.css("min-height",n)},deleteRow:function(){this.table.deleteRow(this)}},{numericKeyCodes:[9,8,37,38,39,40,45,91,46,190,48,49,50,51,52,53,54,55,56,57]})},7573:function(){function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.ElementThumbLoader=Garnish.Base.extend({queue:null,workers:[],init:function(){this.queue=[];for(var t=0;t<3;t++)this.workers.push(new Craft.ElementThumbLoader.Worker(this))},load:function(t){for(var e=this,n=t.find(".thumb[data-sizes]"),i=function(){var t=n.eq(r);if(t.is(":visible"))e.addToQueue(t[0]);else{var i="thumb"+Math.floor(1e6*Math.random());Craft.ElementThumbLoader.invisibleThumbs[i]=[e,t],Garnish.$doc.on("scroll.".concat(i),{$thumb:t,key:i},(function(n){t&&(delete Craft.ElementThumbLoader.invisibleThumbs[n.data.key],e.addToQueue(n.data.$thumb[0]))}))}},r=0;r<n.length;r++)i()},addToQueue:function(t){this.queue.push(t);for(var e=0;e<this.workers.length;e++)this.workers[e].active||this.workers[e].loadNext()},destroy:function(){for(var t=0;t<this.workers.length;t++)this.workers[t].destroy();this.base()}},{invisibleThumbs:{},retryAll:function(){for(var e in Craft.ElementThumbLoader.invisibleThumbs){var n=t(Craft.ElementThumbLoader.invisibleThumbs[e],2),i=n[0],r=n[1];delete Craft.ElementThumbLoader.invisibleThumbs[e],i.load(r.parent())}}}),Craft.ElementThumbLoader.Worker=Garnish.Base.extend({loader:null,active:!1,container:null,_interval:null,_timeout:null,init:function(t){this.loader=t},activate:function(){var t=this;this.active||(this.active=!0,this.clearInterval(),this._interval=setInterval((function(){t.loadNextIfRemoved()}),500))},deactivate:function(){this.active&&(this.active=!1,this.clearInterval(),this.clearTimeout())},clearInterval:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this._interval&&(clearInterval(this._interval),this._interval=null)})),clearTimeout:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)})),loadNext:function(){var t=this;if(this.clearTimeout(),this.container=this.loader.queue.shift(),void 0!==this.container){if(!this.loadNextIfRemoved()){var e=$(this.container);if(e.find("img").length)this.loadNext();else{this.activate(),this._timeout=setTimeout((function(){t.loadNext()}),3e4);var n=$("<img/>",{sizes:e.attr("data-sizes"),srcset:e.attr("data-srcset"),alt:e.attr("data-alt")||"","data-animated":e.attr("data-animated")});this.addListener(n,"load,abort,error","loadNext"),n.appendTo(e),picturefill({elements:[n[0]]})}}}else this.deactivate()},loadNextIfRemoved:function(){return!(!this.container||document.body.contains(this.container)||(this.loadNext(),0))}})},7754:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function n(e,n,i){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function i(){"use strict";i=function(){return n};var e,n={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(e){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:e,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,D(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(n){if(n||""===n){var i=n[l];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,s=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return s.next=s}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,i,r),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return o.type="throw",o.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},n}function r(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)}))}}var s,o;Craft.AssetIndex=Craft.BaseElementIndex.extend({$includeSubfoldersContainer:null,$includeSubfoldersCheckbox:null,showingIncludeSubfoldersCheckbox:!1,$uploadButton:null,$uploadInput:null,$progressBar:null,uploader:null,promptHandler:null,progressBar:null,currentFolderId:null,$listedFolders:null,itemDrag:null,_uploadTotalFiles:0,_uploadFileProgress:{},_currentUploaderSettings:{},_includeSubfolders:null,init:function(t,e,r){var s,o=this;if(r=Object.assign({},Craft.AssetIndex.defaults,r),this.setSettings(r,Craft.BaseElementIndex.defaults),"index"===this.settings.context){var l=Craft.getQueryParams();void 0!==l.includeSubfolders&&(this._includeSubfolders=!!parseInt(l.includeSubfolders))}this.base(t,e,this.settings),"index"===this.settings.context?(this.itemDrag=new Garnish.DragDrop(n(n(n(n(n(n(n({activeDropTargetClass:"sel",minMouseDist:10,hideDraggee:!1,moveHelperToCursor:!0},"activeDropTargetClass","active-drop-target"),"handle",(function(t){return $(t).closest("tr,li")})),"filter",(function(){var t=o.itemDrag.$targetItem.closest("tr,li");return o.view.elementSelect.selectItem(t),o._findDraggableItems(o.view.getSelectedElements())})),"helper",(function(t,e){return $('<div class="offset-drag-helper"/>').append(t).css({opacity:Math.max(.9-.05*e,0),width:"",height:""})})),"dropTargets",(function(){var t=$(o.$visibleSources.toArray().filter((function(t){return Garnish.hasAttr(t,"data-folder-id")&&Garnish.hasAttr(t,"data-can-move-peer-files-to")})));if(o.sourcePath.length<=1)t=t.not(o.$source);else for(var e=0;e<o.sourcePath.length-1;e++){var n=o.sourcePath[e];n.folderId&&(t=t.add(n.$btn))}return o.$listedFolders&&(t=t.add(o.$listedFolders.filter("[data-folder-id]").closest("tr,li")).not(o.view.getSelectedElements())),t})),"onDragStart",(function(){Garnish.$bod.addClass("dragging"),o.itemDrag.$draggee.closest("tr,li").addClass("draggee")})),"onDragStop",(s=a(i().mark((function t(){var e,n,r,a,s,l,c,u,h,d,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Garnish.$bod.removeClass("dragging"),e=o.itemDrag.$draggee,n=o._targetFolderId(o.itemDrag.$activeDropTarget)){t.next=7;break}return e.closest("tr,li").removeClass("draggee"),o.itemDrag.returnHelpersToDraggees(),t.abrupt("return");case 7:return o.itemDrag.fadeOutHelpers(),r=e.filter("[data-is-folder]"),a=e.not(r),s=r.toArray().map((function(t){return parseInt($(t).data("folder-id"))})),l=a.toArray().map((function(t){return parseInt($(t).data("id"))})),c=new Craft.AssetMover,t.next=15,c.getMoveParams(s,l);case 15:if((u=t.sent).proceed){t.next=19;break}return e.closest("tr,li").removeClass("draggee"),t.abrupt("return");case 19:return t.next=21,c.moveFolders(s,n,o.currentFolderId);case 21:return h=t.sent,t.next=24,c.moveAssets(l,n,o.currentFolderId);case 24:d=t.sent,(f=h+d)?(c.successNotice(u,Craft.t("app","{totalItems, plural, =1{Item} other{Items}} moved.",{totalItems:f})),Craft.elementIndex.updateElements(!0)):e.closest("tr,li").removeClass("draggee");case 27:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)}))),this.addListener(Garnish.$win,"resize,scroll","_positionProgressBar")):(this.addListener(this.$main,"scroll","_positionProgressBar"),this.settings.modal&&this.settings.modal.on("updateSizeAndPosition",this._positionProgressBar.bind(this))),this.addListener(this.$elements,"keydown",this._onKeyDown.bind(this))},_findDraggableItems:function(t){return $(t.toArray().map((function(t){return $(t).find(".element:first")[0]})).filter((function(t){return t&&Garnish.hasAttr(t,"data-movable")})))},_targetFolderId:function(t){if(!t||!t.length)return!1;if(t.is(this.$visibleSources))return t.data("folder-id");for(var e=0;e<this.sourcePath.length-1;e++){var n=this.sourcePath[e];if(t.is(n.$btn))return n.folderId}return t.find(".element:first").data("folder-id")||!1},afterInit:function(){this.settings.foldersOnly||this.initForFiles(),this.addListener(this.$elements,"doubletap",(function(t,e){if(e.firstTap.target===e.secondTap.target){var n=$(e.firstTap.target).closest("tr,ul.thumbsview > li").find(".element:first");Garnish.hasAttr(n,"data-is-folder")&&n.find("a").trigger("activate")}})),this.base()},initForFiles:function(){this.promptHandler=new Craft.PromptHandler,this.progressBar=new Craft.ProgressBar(this.$main,!1)},createUploadInputs:function(){var t,e,n=this;null===(t=this.$uploadButton)||void 0===t||t.remove(),null===(e=this.$uploadInput)||void 0===e||e.remove(),this.$uploadButton=$("<button/>",{type:"button",class:"btn submit","data-icon":"upload",style:"position: relative; overflow: hidden;","aria-label":Craft.t("app","Upload files"),text:Craft.t("app","Upload files")}),this.addButton(this.$uploadButton),this.$uploadInput=$('<input type="file" multiple="multiple" name="assets-upload" />').hide().insertBefore(this.$uploadButton),this.$uploadButton.on("click",(function(){n.$uploadButton.hasClass("disabled")||n.isIndexBusy||n.$uploadButton.parent().find("input[name=assets-upload]").trigger("click")}))},onSelectSource:function(){if(!this.settings.foldersOnly){this.currentFolderId=this.currentFolderId||this.$source.data("folder-id");var t=this.$source.data("fs-type");if(this.createUploadInputs(),this.currentFolderId&&Garnish.hasAttr(this.$source,"data-can-upload")){var e,n;null===(e=this.uploader)||void 0===e||e.destroy(),this.$uploadButton.removeClass("disabled");var i={fileInput:this.$uploadInput,dropZone:this.$container,events:{fileuploadstart:this._onUploadStart.bind(this),fileuploadprogressall:this._onUploadProgress.bind(this),fileuploaddone:this._onUploadSuccess.bind(this),fileuploadalways:this._onUploadAlways.bind(this),fileuploadfail:this._onUploadFailure.bind(this)}};null!==(n=this.settings)&&void 0!==n&&null!==(n=n.criteria)&&void 0!==n&&n.kind&&(i.allowedKinds=this.settings.criteria.kind),this._currentUploaderSettings=i,this.uploader=Craft.createUploader(t,this.$uploadButton,i),this.uploader.setParams({folderId:this.currentFolderId})}else this.$uploadButton.addClass("disabled")}this.base()},onSourcePathChange:function(){var t=this.sourcePath.length?this.sourcePath[this.sourcePath.length-1]:null;if(this.currentFolderId=null==t?void 0:t.folderId,!this.settings.foldersOnly&&this.currentFolderId){var e;null===(e=this.uploader)||void 0===e||e.setParams({folderId:this.currentFolderId});var n="index"===this.context&&!!t.canMoveSubItems;this.settings.selectable=this.settings.selectable||n,this.settings.multiSelect=this.settings.multiSelect||n}this.base()},startSearching:function(){if(!this.settings.hideSidebar&&this.sourcePath.length&&this.sourcePath[this.sourcePath.length-1].hasChildren){if(null===this.$includeSubfoldersContainer){var t="includeSubfolders-"+Math.floor(1e9*Math.random());this.$includeSubfoldersContainer=$('<div style="margin-bottom: -25px; opacity: 0;"/>').insertAfter(this.$search);var e=$('<div style="padding-top: 5px;"/>').appendTo(this.$includeSubfoldersContainer);this.$includeSubfoldersCheckbox=$('<input type="checkbox" id="'+t+'" class="checkbox"/>').appendTo(e),$('<label class="light smalltext" for="'+t+'"/>').text(" "+Craft.t("app","Search in subfolders")).appendTo(e),this.addListener(this.$includeSubfoldersCheckbox,"change",(function(){this.setSelecetedSourceState("includeSubfolders",this.$includeSubfoldersCheckbox.prop("checked")),this.updateElements()}))}else this.$includeSubfoldersContainer.velocity("stop").removeClass("hidden");var n;null!==this._includeSubfolders?(n=this._includeSubfolders,this._includeSubfolders=null):n=this.getSelectedSourceState("includeSubfolders",!1),this.$includeSubfoldersCheckbox.prop("checked",n),this.$includeSubfoldersContainer.velocity({marginBottom:0,opacity:1},"fast"),this.showingIncludeSubfoldersCheckbox=!0}this.base()},stopSearching:function(){var t=this;this.showingIncludeSubfoldersCheckbox&&(this.$includeSubfoldersContainer.velocity("stop"),this.$includeSubfoldersContainer.velocity({marginBottom:-25,opacity:0},{duration:"fast",complete:function(){t.$includeSubfoldersContainer.addClass("hidden")}}),this.showingIncludeSubfoldersCheckbox=!1),this.base()},getViewSettings:function(){var t={};return"index"===this.settings.context&&(t.canSelectElement=function(){return!0}),t},getViewParams:function(){var t=Object.assign(this.base(),{showFolders:this.settings.showFolders&&!this.trashed,foldersOnly:this.settings.foldersOnly});return this.showingIncludeSubfoldersCheckbox&&this.$includeSubfoldersCheckbox.prop("checked")&&(t.criteria.includeSubfolders=!0),t},_onUploadStart:function(){this.setIndexBusy(),this._positionProgressBar(),this.progressBar.resetProgressBar(),this.progressBar.showProgressBar(),this.promptHandler.resetPrompts()},_onUploadProgress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=t instanceof CustomEvent?t.detail:e;var n=parseInt(100*Math.min(e.loaded/e.total,1),10);this.progressBar.setProgressPercentage(n)},_onUploadSuccess:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t instanceof CustomEvent?t.detail:e.result;this.selectElementAfterUpdate(n.assetId),n.conflict&&(n.prompt={message:Craft.t("app",n.conflict,{file:n.filename}),choices:[{value:"keepBoth",title:Craft.t("app","Keep both")},{value:"replace",title:Craft.t("app","Replace it")}],modalSettings:{hideOnEsc:!1,hideOnShadeClick:!1}},this.promptHandler.addPrompt(n)),Craft.cp.runQueue()},_onUploadAlways:function(){this.uploader.isLastUpload()&&(this.progressBar.hideProgressBar(),this.setIndexAvailable(),this.promptHandler.getPromptCount()?this.promptHandler.showBatchPrompts(this._uploadFollowup.bind(this)):this._updateAfterUpload())},_onUploadFailure:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(t instanceof CustomEvent?t.detail:null==i||null===(e=i.jqXHR)||void 0===e?void 0:e.responseJSON)||{},a=r.message,s=r.filename,o=r.errors;s=s||(null==i||null===(n=i.files)||void 0===n?void 0:n[0].name);var l=o?Object.values(o).flat():[];a||(a=l.length?l.join("\n"):s?Craft.t("app","Upload failed for “{filename}”.",{filename:s}):Craft.t("app","Upload failed.")),Craft.cp.displayError(a)},_updateAfterUpload:function(){"index"!==this.settings.context&&(this.clearSearch(),this.setSelectedSortAttribute("dateCreated","desc")),this.updateElements()},_uploadFollowup:function(t){var e=this;this.setIndexBusy(),this.progressBar.resetProgressBar(),this.promptHandler.resetPrompts(),this.progressBar.setItemCount(t.length);var n=function(t,i,r){var a={},s=null,o=e.uploader.settings,l=o.replaceAction,c=o.deleteAction,u=function(){i++,e.progressBar.incrementProcessedItemCount(1),e.progressBar.updateProgressBar(),i===t.length?r():n(t,i,r)},h=function(t){t.assetId&&e.selectElementAfterUpdate(t.assetId),u()};"replace"===t[i].choice?(s=l,a.sourceAssetId=t[i].assetId,t[i].conflictingAssetId?a.assetId=t[i].conflictingAssetId:a.targetFilename=t[i].filename):"cancel"===t[i].choice&&(s=c,a.assetId=t[i].assetId),s?Craft.sendActionRequest("POST",s,{data:a}).then((function(t){return h(t.data)})).catch((function(t){return function(t){Craft.cp.displayError(t.message),u()}(t.response.data)})):h({assetId:t[i].assetId})};this.progressBar.showProgressBar(),n(t,0,(function(){e.progressBar.hideProgressBar(),e.setIndexAvailable(),e._updateAfterUpload()}))},onUpdateElements:function(){var t=this;this._onUpdateElements(!1,this.view.getAllElements()),this.view.on("appendElements",(function(e){t._onUpdateElements(!0,e.newElements)})),this.base()},_onUpdateElements:function(t,e){var n=this;this.$listedFolders=e.find(".element[data-is-folder][data-folder-name]");for(var i=function(){var t=n.$listedFolders.eq(r),i=t.find(".label"),a=i.find(".label-link"),s=parseInt(t.data("folder-id")),o=t.data("folder-name"),l=Craft.t("app","{name} folder",{name:o});if(n.settings.disabledFolderIds.includes(s))return i.attr("aria-label",l),e.has(t).addClass("disabled"),1;var c=t.data("source-path");if(c){var u=$('<a class="label-link"/>').html(a.html()).attr({href:Craft.getCpUrl(c[c.length-1].uri),role:"button","aria-label":l});a.replaceWith(u),n.addListener(u,"activate",(function(t){n.sourcePath=c,n.clearSearch(!1),n.updateElements().then((function(){var t=n.$elements.find(":focusable:not(.selectallcontainer)")[0];t&&t.focus()}))}))}},r=0;r<this.$listedFolders.length;r++)i();if(this.itemDrag){var a=this.sourcePath[this.sourcePath.length-1],s=!!(a&&a.folderId&&a.canMoveSubItems);s&&t||this.itemDrag.removeAllItems(),s&&this.itemDrag.addItems(this._findDraggableItems(e))}},_onKeyDown:function(t){if(t.keyCode===Garnish.SPACE_KEY&&t.shiftKey){if(Craft.PreviewFileModal.openInstance)Craft.PreviewFileModal.openInstance.hide();else if(this.view.elementSelect){var e=$(t.target).closest(".element");e.length||(e=$(t.target).find(".element:first")),e.length&&!Garnish.hasAttr(e,"data-folder-id")&&Craft.PreviewFileModal.showForAsset(e,this.view.elementSelect)}return t.stopPropagation(),!1}},getSourcePathLabel:function(){return Craft.t("app","Volume path")},getSourcePathActionLabel:function(){return Craft.t("app","Folder actions")},getSourcePathActions:function(){var t=this,e=[],n=this.sourcePath[this.sourcePath.length-1];return n.canCreate&&e.push({label:Craft.t("app","New subfolder"),onSelect:function(){t._createSubfolder()}}),"index"===this.settings.context&&n.canRename&&(e.push({label:Craft.t("app","Rename folder"),onSelect:function(){t._renameFolder()}}),n.canMove&&this.getMoveTargetSourceKeys(!0).length&&e.push({label:Craft.t("app","Move folder"),onSelect:function(){t._moveFolder()}}),n.canDelete&&e.push({label:Craft.t("app","Delete folder"),destructive:!0,onSelect:function(){t.deleteCurrentFolder()}})),e},_createSubfolder:function(){var t=this,e=this.sourcePath[this.sourcePath.length-1],n=prompt(Craft.t("app","Enter the name of the folder"));if(n){var i={parentId:e.folderId,folderName:n};this.setIndexBusy(),Craft.sendActionRequest("POST","assets/create-folder",{data:i}).then((function(e){t.setIndexAvailable(),Craft.cp.displayNotice(Craft.t("app","Folder created.")),t.updateElements(!0)})).catch((function(e){var n=e.response;t.setIndexAvailable(),Craft.cp.displayError(n.data.message)}))}},deleteCurrentFolder:(o=a(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deleteFolder(this.sourcePath[this.sourcePath.length-1]);case 2:if(!t.sent){t.next=5;break}this.sourcePath=this.sourcePath.slice(0,this.sourcePath.length-1),this.updateElements();case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),deleteFolder:(s=a(i().mark((function t(e){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm(Craft.t("app","Really delete folder “{folder}”?",{folder:e.label}))){t.next=2;break}return t.abrupt("return",!1);case 2:return this.setIndexBusy(),t.prev=3,t.next=6,Craft.sendActionRequest("POST","assets/delete-folder",{data:{folderId:e.folderId}});case 6:t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(3),Craft.cp.displayError(null===t.t0||void 0===t.t0||null===(n=t.t0.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message),t.abrupt("return",!1);case 12:return t.prev=12,this.setIndexAvailable(),t.finish(12);case 15:return Craft.cp.displayNotice(Craft.t("app","Folder deleted.")),t.abrupt("return",!0);case 17:case"end":return t.stop()}}),t,this,[[3,8,12,15]])}))),function(t){return s.apply(this,arguments)}),_renameFolder:function(){var t=this,e=this.sourcePath[this.sourcePath.length-1],n=prompt(Craft.t("app","Rename folder"),e.label);n&&n!==e.label&&(this.setIndexBusy(),Craft.sendActionRequest("POST","assets/rename-folder",{data:{folderId:e.folderId,newName:n}}).then((function(e){Craft.cp.displayNotice(Craft.t("app","Folder renamed."));var n=t.sourcePath.slice();n[n.length-1].label=e.data.newName,n[n.length-1].uri=n[n.length-2].uri+"/".concat(e.data.newName),t.sourcePath=n})).catch((function(t){var e=t.response;Craft.cp.displayError(e.data.message)})).finally((function(){t.setIndexAvailable()})))},getMoveTargetSourceKeys:function(t){var e=t?"data-can-move-peer-files-to":"data-can-move-to";return this.$sources.toArray().filter((function(t){var n=$(t).data("volume-handle");return n&&"temp"!==n&&Garnish.hasAttr(t,e)})).map((function(t){return $(t).data("key")}))},_moveFolder:function(){var t=this,n=this.sourcePath[this.sourcePath.length-1],i=this.sourcePath[this.sourcePath.length-2],r=[n.folderId];i&&r.push(i.folderId),new Craft.VolumeFolderSelectorModal({sources:this.getMoveTargetSourceKeys(!0),showTitle:!0,modalTitle:Craft.t("app","Move to"),selectBtnLabel:Craft.t("app","Move"),disabledFolderIds:r,indexSettings:{defaultSource:this.sourceKey,defaultSourcePath:this.sourcePath.slice(0,this.sourcePath.length-1)},onSelect:function(i){var r=function(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i,1)[0];t.$sourcePathActionsBtn.focus(),(new Craft.AssetMover).moveFolders([n.folderId],r.folderId).then((function(e){e&&(Craft.cp.displayNotice(Craft.t("app","{totalItems, plural, =1{Item} other{Items}} moved.",{totalItems:e})),t.sourcePath=t.sourcePath.slice(0,t.sourcePath.length-1),t.clearSearch(!1),t.updateElements())}))}})},_positionProgressBar:function(){this.progressBar||(this.progressBar=new Craft.ProgressBar(this.$main,!0));var t=$(),e=0,n=0;"index"===this.settings.context?(t=this.progressBar.$progressBar.closest("#content"),e=Garnish.$win.scrollTop()):(t=this.progressBar.$progressBar.closest(".main"),e=this.$main.scrollTop());var i=e-t.offset().top,r=Garnish.$win.height();n=t.height()>r?r/2-6+i:t.height()/2-6,"index"!==this.settings.context&&(n=e+(t.height()/2-6)),this.progressBar.$progressBar.css({top:n})}},{defaults:{showFolders:!0,foldersOnly:!1,disabledFolderIds:[]}}),Craft.registerElementIndexClass("craft\\elements\\Asset",Craft.AssetIndex)},7845:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}!function(t){var n;Craft.GroupedEntryTypeManager=Garnish.Base.extend({$container:null,$groupsContainer:null,$addGroupBtn:null,groups:null,groupSort:null,entryTypeSort:null,init:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$container=e,this.setSettings(i,Craft.GroupedEntryTypeManager.defaults),this.$container.data("entryTypeManager",this),this.$groupsContainer=e.find(".entry-type-groups"),this.$addGroupBtn=Craft.ui.createButton({class:"dashed",label:Craft.t("app","Add Group"),icon:"plus"}).appendTo(this.$container),Craft.hasMousePointerEvents()?(this.groupSort=new Garnish.DragSort({container:this.$groupsContainer,handle:"> .entry-type-group--titlebar > .entry-type-group--actions > .move",ignoreHandleSelector:null,magnetStrength:4,helperLagBase:1.5}),this.entryTypeSort=new Garnish.DragSort({container:this.$groupsContainer,ignoreHandleSelector:null,handle:"> .chip > .chip-content > .chip-actions > .move",collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,canInsertAfter:function(t){return!t.hasClass("entry-type-group--caboose")},onSortChange:function(){n.refresh()}})):t(".entry-type-manager .move").hide(),this.groups=[],this.$groupsContainer.children(".entry-type-group").each((function(e,i){n.groups.push(new Craft.GroupedEntryTypeManager.Group(n,t(i)))})),this.addListener(this.$addGroupBtn,"activate",(function(){n.addGroup()}))},addGroup:(n=i(e().mark((function n(){var i,r,a,s,o,l,c,u;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=prompt(Craft.t("app","Group Name")))&&""!==i){e.next=3;break}return e.abrupt("return");case 3:return r=t("<li/>",{class:"entry-type-group","data-name":i}).appendTo(this.$groupsContainer),a=t("<div/>",{class:"entry-type-group--titlebar"}).appendTo(r),t("<span/>",{text:i}).appendTo(a),s=Craft.namespaceId("TEMP_ID",this.settings.namespace),o=Craft.namespaceId("entry-type-select-".concat(Math.floor(1e6*Math.random())),this.settings.namespace),l=this.settings.entryTypeSelectHtml.replaceAll(s,o),c=this.settings.entryTypeSelectJs.replaceAll(s,o),t(l).appendTo(r),e.next=13,Craft.appendBodyHtml(c);case 13:u=new Craft.GroupedEntryTypeManager.Group(this,r),this.groups.push(u),this.groups.filter((function(t){return t!==u})).forEach((function(e){e.componentSelect.$components.each((function(e,n){u.componentSelect.hideOption(t(n).data("id"),!1)}))}));case 16:case"end":return e.stop()}}),n,this)}))),function(){return n.apply(this,arguments)}),updateDefaultColumns:function(){var t=this,e=this.settings.$defaultColumnsContainer.find("input:checked").toArray().map((function(t){return t.value}));Craft.sendActionRequest("POST","matrix/default-table-column-options",{data:{entryTypeIds:this.groups.map((function(t){return t.componentSelect.getSelectedComponentIds()})).flat()}}).then((function(n){var i=n.data;t.settings.$defaultColumnsContainer.empty().append(Craft.ui.createSortableCheckboxSelect({name:Craft.namespaceInputName("defaultTableColumns",t.settings.namespace),options:i.options,values:e}))}))},refresh:function(){this.groups.forEach((function(t){t.refresh()}))}},{defaults:{$defaultColumnsContainer:null,namespace:null,entryTypeSelectHtml:null,entryTypeSelectJs:null}}),Craft.GroupedEntryTypeManager.Group=Garnish.Base.extend({manager:null,$container:null,$titlebar:null,$headingContainer:null,$dragHandle:null,componentSelect:null,init:function(n,r){var a,s,o,l=this;this.manager=n,this.$container=r,this.$container.data("entryTypeGroup",this),this.$titlebar=r.find(".entry-type-group--titlebar"),this.$headingContainer=this.$titlebar.children("span");var c=t("<div/>",{class:"entry-type-group--actions"}).appendTo(this.$titlebar),u="menu-".concat(Math.floor(1e6*Math.random())),h=Craft.ui.createButton({class:"menubtn action-btn",controls:u,ariaLabel:Craft.t("app","Actions")}).attr("data-disclosure-trigger","true").appendTo(c);t("<div/>",{id:u,class:"menu menu--disclosure"}).appendTo(c);var d,f=h.disclosureMenu().data("disclosureMenu");f.addItem({icon:(d=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("pencil");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return d.apply(this,arguments)}),label:Craft.t("app","Rename"),onActivate:function(){l.showNamePrompt()}}),f.addGroup();var p,g,m=f.addItem({icon:(p=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-left":"arrow-right");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return p.apply(this,arguments)}),label:Craft.t("app","Move backward"),onActivate:function(){l.moveBackward()},attributes:{"data-move-backward":!0}}),v=f.addItem({icon:(g=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-right":"arrow-left");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return g.apply(this,arguments)}),label:Craft.t("app","Move forward"),onActivate:function(){l.moveForward()},attributes:{"data-move-forward":!0}});f.addGroup(),f.addItem({icon:"remove",label:Craft.t("app","Remove"),destructive:!0,onActivate:function(){l.remove()}}),f.on("show",(function(){var t=l.$container.prev("li.entry-type-group"),e=l.$container.next("li.entry-type-group");f.toggleItem(m,t.length),f.toggleItem(v,e.length)})),this.componentSelect=this.$container.find(".componentselect").data("componentSelect"),null===(a=this.manager.entryTypeSort)||void 0===a||a.addItems(this.componentSelect.$components.parent("li"));var y=t("<li/>",{class:"entry-type-group--caboose"}).appendTo(this.componentSelect.$list);null===(s=this.manager.entryTypeSort)||void 0===s||s.addItems(y),this.componentSelect.on("change",(function(){l.manager.updateDefaultColumns()})),Craft.hasMousePointerEvents()&&(this.$dragHandle=t("<button/>",{type:"button",class:"icon move",title:Craft.t("app","Reorder"),"aria-label":Craft.t("app","Reorder")}).appendTo(c)),null===(o=this.manager.groupSort)||void 0===o||o.addItems(this.$container)},get name(){return this.$container.data("name")},showNamePrompt:function(){var e=prompt(Craft.t("app","Group Name"),this.name);null!==e&&""!==e&&(this.$container.data("name",e),this.$headingContainer.text(e),this.componentSelect.$components.each((function(n,i){var r=t(i).find("input"),a=JSON.parse(r.val());a.group=e,r.val(JSON.stringify(a))})))},moveBackward:function(){var t=this.$container.prev(".entry-type-group");t.length&&this.$container.insertBefore(t)},moveForward:function(){var t=this.$container.next(".entry-type-group");t.length&&this.$container.insertAfter(t)},refresh:function(){var e=this;this.componentSelect.destroy(),setTimeout((function(){e.componentSelect=new Craft.GroupedEntryTypeSelectInput(Object.assign(e.componentSelect.settings,{addItemsToActionMenus:!1})),e.componentSelect.$components.each((function(n,i){var r=t(i).find("input");r.val(JSON.stringify(Object.assign(JSON.parse(r.val()),{group:e.name})))}))}),1)},remove:function(){var t=this;this.componentSelect.removeComponents(this.componentSelect.$components),this.manager.groups=this.manager.groups.filter((function(e){return e!==t})),this.$container.remove(),this.destroy()},destroy:function(){this.componentSelect.destroy(),delete this.componentSelect,this.base()}})}(jQuery)},7916:function(t){t.exports=function t(e,n,i){var r,a,s,o;for(r=0,a=e.length;r<a;r+=1)s=e[r],i||(o=n(s,r,e)),!1!==o&&"function"===s.type&&Array.isArray(s.nodes)&&t(s.nodes,n,i),i&&n(s,r,e)}},8081:function(){Craft.Listbox=Garnish.Base.extend({$container:null,$options:null,$selectedOption:null,selectedOptionIndex:null,init:function(t,e){var n=this;this.$container=$(t),this.setSettings(e,Craft.Listbox.defaults),this.$container.data("listbox")&&(console.warn("Double-instantiating a listbox on an element"),this.$container.data("listbox").destroy()),this.$container.data("listbox",this),this.$options=this.$container.find("button,[role=option]"),this.$selectedOption=this.$options.filter("[aria-pressed=true],[aria-selected=true]").removeAttr("aria-selected").attr("aria-pressed","true"),this.$selectedOption.length?this.selectedOptionIndex=this.$options.index(this.$selectedOption):this.$selectedOption=null,this.settings.readOnly||this.addListener(this.$options,"click",(function(t){n.select(n.$options.index($(t.currentTarget))),t.preventDefault()})),this.settings.readOnly&&this.$options.each((function(t,e){$(e).attr("tabindex","-1")}))},select:function(t){t<0||t>=this.$options.length||t===this.selectedOptionIndex||(this.$selectedOption&&this.$selectedOption.removeClass(this.settings.selectedClass).attr("aria-pressed","false"),this.$selectedOption=this.$options.eq(t).addClass(this.settings.selectedClass).attr("aria-pressed","true"),this.selectedOptionIndex=t,this.settings.onChange(this.$selectedOption,t),this.trigger("change",{$selectedOption:this.$selectedOption,selectedOptionIndex:t}))},disable:function(){this.base(),this.$container.attr("aria-disabled","true")},enable:function(){this.base(),this.$container.removeAttr("aria-disabled")},destroy:function(){this.$container.removeData("listbox"),this.base()}},{defaults:{selectedClass:"active",focusClass:"focus",onChange:$.noop,readOnly:!1}})},8250:function(){Craft.TagSelectInput=Craft.BaseElementSelectInput.extend({searchTimeout:null,searchMenu:null,$container:null,$elementsContainer:null,$elements:null,$addTagInput:null,$spinner:null,_ignoreBlur:!1,init:function(t){var e=this;if(!$.isPlainObject(t)){for(var n={},i=["id","name","tagGroupId","sourceElementId"],r=0;r<i.length&&void 0!==arguments[r];r++)n[i[r]]=arguments[r];t=n}this.base($.extend({},Craft.TagSelectInput.defaults,t)),this.$addTagInput=this.$container.children(".add").children(".text"),this.$spinner=this.$addTagInput.next(),this.addListener(this.$addTagInput,"input",(function(){e.searchTimeout&&clearTimeout(e.searchTimeout),e.searchTimeout=setTimeout(e.searchForTags.bind(e),500)})),this.addListener(this.$addTagInput,"keydown",(function(t){switch(t.keyCode===Garnish.RETURN_KEY&&t.preventDefault(),t.keyCode){case Garnish.RETURN_KEY:return t.preventDefault(),void(this.searchMenu&&this.selectTag(this.searchMenu.$options.filter(".hover")));case Garnish.DOWN_KEY:if(t.preventDefault(),this.searchMenu){var e=this.searchMenu.$options.filter(".hover");if(e.length){var n=e.parent().nextAll().find(".menu-item:not(.disabled)").first();n.length&&this.focusOption(n)}else this.focusOption(this.searchMenu.$options.eq(0))}return;case Garnish.UP_KEY:if(t.preventDefault(),this.searchMenu){var i=this.searchMenu.$options.filter(".hover");if(i.length){var r=i.parent().prevAll().find(".menu-item:not(.disabled)").last();r.length&&this.focusOption(r)}else this.focusOption(this.searchMenu.$options.eq(this.searchMenu.$options.length-1))}return}})),this.addListener(this.$addTagInput,"focus",(function(){this.searchMenu&&this.searchMenu.show()})),this.addListener(this.$addTagInput,"blur",(function(){var t=this;this._ignoreBlur?this._ignoreBlur=!1:setTimeout((function(){t.searchMenu&&t.searchMenu.hide()}),1)}))},get fieldName(){var t=this.$container.closest("fieldset").find("legend");return 0==t.length?null:t[0].innerText},focusOption:function(t){this.searchMenu.$options.removeClass("hover"),this.searchMenu.$ariaOptions.attr("aria-selected","false"),t.parent("li").attr("id"),t.addClass("hover"),this.$addTagInput.attr("aria-activedescendant",t.parent("li").attr("id"))},getAddElementsBtn:function(){return[]},getElementSortAxis:function(){return 1==this.$container.parents(".inline-editing").length?"y":"x"},searchForTags:function(){var t=this;if(this.searchMenu&&this.killSearchMenu(),this.$addTagInput.val()){this.$spinner.removeClass("hidden"),Craft.cp.announce(Craft.t("app","Loading"));for(var e=[],n=0;n<this.$elements.length;n++){var i=$(this.$elements[n]).data("id");i&&e.push(i)}this.settings.sourceElementId&&!this.settings.allowSelfRelations&&e.push(this.settings.sourceElementId);var r={search:this.$addTagInput.val(),tagGroupId:this.settings.tagGroupId,excludeIds:e};Craft.sendActionRequest("POST","tags/search-for-tags",{data:r}).then((function(e){t.searchMenu&&t.killSearchMenu(),t.$spinner.addClass("hidden"),Craft.cp.announce(Craft.t("app","Loading complete"));var n=t.fieldName,i=$('<div class="menu tagmenu"/>');null!==n&&i.attr("aria-label",n),i.appendTo(Garnish.$bod);for(var a,s,o=$("<ul/>").appendTo(i),l=0;l<e.data.tags.length;l++)a=$("<li/>").appendTo(o),s="".concat(Craft.t("app","Existing {type}",{type:Craft.t("app","Tag")}),": ").concat(e.data.tags[l].title),a.attr("aria-label",s),$('<div class="menu-item" data-icon="tag"/>').appendTo(a).text(e.data.tags[l].title).data("id",e.data.tags[l].id).addClass(e.data.tags[l].exclude?"disabled":"");e.data.exactMatch||(a=$("<li/>").appendTo(o),s="".concat(Craft.t("app","Create {type}",{type:Craft.t("app","Tag")}),": ").concat(r.search),a.attr("aria-label",s),$('<div class="menu-item" data-icon="plus"/>').appendTo(a).text(r.search)),o.find(".menu-item:not(.disabled):first").addClass("hover"),t.searchMenu=new Garnish.Menu(i,{anchor:t.$addTagInput,onOptionSelect:t.selectTag.bind(t)}),t.$addTagInput.attr("aria-controls",t.searchMenu.menuId),t.searchMenu.on("show",(function(){t.$addTagInput.attr("aria-expanded","true"),t.focusSelectedOption()})),t.searchMenu.on("hide",(function(){t.$addTagInput.attr("aria-expanded","false"),t.$addTagInput.removeAttr("aria-activedescendant")})),t.addListener(i,"mousedown",(function(){t._ignoreBlur=!0})),t.searchMenu.show()})).catch((function(e){e.response,t.searchMenu&&t.killSearchMenu(),t.$spinner.addClass("hidden"),Craft.cp.announce(Craft.t("app","Loading complete"))}))}else this.$spinner.addClass("hidden")},focusSelectedOption:function(){var t=this.searchMenu.$options.filter(".hover:first");t.length?this.focusOption(t):this.focusFirstOption()},focusFirstOption:function(){var t=this.searchMenu.$options.first();this.focusOption(t)},selectTag:function(t){var e=this,n=$(t);if(!n.hasClass("disabled")){var i=$("<li/>");"beginning"===this.settings.defaultPlacement?i.prependTo(this.$elementsContainer):i.appendTo(this.$elementsContainer);var r=n.data("id"),a=n.text(),s=$("<div/>",{class:"chip element small removable","data-id":r,"data-site-id":this.settings.targetSiteId,"data-label":a,"data-editable":"1"}).appendTo(i),o=$("<div/>",{class:"chip-content"}).appendTo(s),l=$("<craft-element-label/>",{class:"label"}).appendTo(o);$("<span/>",{class:"label-link",text:a}).appendTo(l),$("<div/>",{class:"chip-actions"}).appendTo(o);var c=$("<input/>",{type:"hidden",name:this.settings.name+"[]",value:r}).appendTo(o);if(this.$elements=this.$elements.add(s),this.addElements(s),this.killSearchMenu(),this.$addTagInput.val(""),this.$addTagInput.focus(),!r){s.addClass("loading disabled");var u={groupId:this.settings.tagGroupId,title:a};Craft.sendActionRequest("POST","tags/create-tag",{data:u}).then((function(t){s.attr("data-id",t.data.id),c.val(t.data.id),s.removeClass("loading disabled")})).catch((function(t){var n;e.removeElement(s),Craft.cp.displayError(null==t||null===(n=t.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)}))}}},killSearchMenu:function(){this.searchMenu.hide(),this.searchMenu.destroy(),this.searchMenu=null}},{defaults:{tagGroupId:null}})},8287:function(){Craft.InfoIcon=Garnish.Base.extend({$container:null,$icon:null,$liveRegion:null,content:null,hud:null,init:function(t){var e=this;if(!$(t).hasClass("disabled")){if(this.$icon=$(t),this.$liveRegion=$("<span/>",{role:"status",class:"visually-hidden"}),this.$icon.data("infoicon")?(console.warn("Double-instantiating an info icon on an element"),this.content=this.$icon.data("infoicon").content,this.$icon.data("infoicon").destroy()):(this.content=this.$icon.html(),this.$icon.html("").attr({tabindex:0,role:"button",type:"button","aria-label":Craft.t("app","More info")}).wrap($("<span/>",{class:"infoicon-container"})),this.$container=this.$icon.parent(),this.$container.append(this.$liveRegion)),this.$icon.data("infoicon",this),this.$icon[0].previousSibling&&this.$icon[0].previousSibling.nodeType===Node.TEXT_NODE&&!this.$icon.parent().hasClass("nowrap")){var n=this.$icon[0].previousSibling.nodeValue.match(/[^\s\-]+\s*$/);n&&(this.$icon[0].previousSibling.nodeValue=this.$icon[0].previousSibling.nodeValue.substring(0,n.index),$("<span/>",{class:"nowrap",html:n[0].replace(/\s+$/,"")+" "}).insertAfter(this.$icon[0].previousSibling).append(this.$icon))}this.addListener(this.$icon,"click",(function(t){t.preventDefault(),t.stopPropagation(),e.showHud()})),this.addListener(this.$icon,"keydown",(function(t){e.hud&&e.hud.showing||![Garnish.SPACE_KEY,Garnish.RETURN_KEY].includes(t.keyCode)||(t.preventDefault(),t.stopPropagation(),e.showHud())}))}},showHud:function(t){var e=this;this.hud?this.hud.show():(this.hud=new Garnish.HUD(this.$icon,this.content,{hudClass:"hud info-hud",closeOtherHUDs:!1,onShow:function(){Garnish.uiLayerManager.registerShortcut(Garnish.SPACE_KEY,(function(){e.hud.hide()})),e.$liveRegion.html(""),setTimeout((function(){e.$liveRegion.html(e.content)}),200)},onHide:function(){e.$liveRegion.html("")}}),Craft.initUiElements(this.hud.$body))},destroy:function(){this.$icon.removeData("infoicon"),this.base()}})},8323:function(){function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function e(e){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?t(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function n(t,e,n){return(e=function(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function c(){"use strict";c=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var a=e&&e.prototype instanceof b?e:b,s=Object.create(a.prototype),o=new A(i||[]);return r(s,"_invoke",{value:T(t,n,o)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,o,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==n&&i.call(S,o)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(r,s,o,l){var c=f(t[r],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==a(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var s;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return s=s?s.then(r,r):r()}})}function T(e,n,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(e,n,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,D(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=C,r(x,"constructor",{value:C,configurable:!0}),r(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,l,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new E(d(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,o,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:P(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function u(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){u(a,i,r,s,o,"next",t)}function o(t){u(a,i,r,s,o,"throw",t)}s(void 0)}))}}var d,f,p,g,m,v,y,b,w,C,_,S,x,I,E,T,D,L;Craft.BaseElementIndex=Garnish.Base.extend({initialized:!1,elementType:null,idPrefix:null,instanceState:null,_sourceStates:null,sourceStatesStorageKey:null,searchTimeout:null,sourceNav:null,$container:null,$main:null,isIndexBusy:!1,$sidebar:null,showingSidebar:null,hasImplicitSource:!1,sourceKey:null,rootSourceKey:null,sourceViewModes:null,$source:null,$rootSource:null,sourcesByKey:null,$visibleSources:null,$sourceActionsContainer:null,$sourceActionsBtn:null,$toolbar:null,toolbarOffset:null,$srStatusContainer:null,$searchContainer:null,$search:null,$filterBtn:null,searching:!1,searchText:null,sortByScore:null,trashed:!1,drafts:!1,$clearSearchBtn:null,$statusMenuBtn:null,$statusMenuContainer:null,statusMenu:null,status:null,$siteMenuBtn:null,siteMenu:null,siteId:null,sourcePaths:null,$sourcePathOuterContainer:null,$sourcePathInnerContainer:null,$sourcePathOverflowBtnContainer:null,$sourcePathActionsBtn:null,$elements:null,$updateSpinner:null,$viewModeBtnContainer:null,viewModeBtns:null,defaultViewMode:null,_viewParams:null,_previousViewParams:null,_viewMode:null,view:null,_autoSelectElements:null,$countSpinner:null,$countContainer:null,$actionsContainer:null,$actionMenuBtn:null,$pasteBtn:null,page:1,prevPage:null,resultSet:null,totalResults:null,totalUnfilteredResults:null,$exportBtn:null,actions:null,actionsHeadHtml:null,actionsBodyHtml:null,$selectAllContainer:null,$selectAllCheckbox:null,showingActionTriggers:!1,exporters:null,exportersByType:null,triggers:null,_$triggers:null,_cancelToken:null,viewMenus:null,activeViewMenu:null,filterHuds:null,_activeElement:null,inlineEditing:!1,nestedInputNamespace:null,get viewMode(){return"structure"!==this._viewMode||this.canViewAsStructure?this.validateViewMode(this._viewMode):this.doesSourceHaveViewMode("table")?"table":"cards"},set viewMode(t){this._viewMode=t?this.validateViewMode(t):null},get paginated(){return!(!this.isAdministrative||"structure"===this.viewMode)},get selectable(){return!(!this.actions&&!this.settings.selectable||this.inlineEditing)},get multiSelect(){return!!(this.actions||this.settings.selectable&&this.settings.multiSelect)},get sortable(){return this.settings.sortable&&this.canSort&&!this.inlineEditing},get canViewAsStructure(){return!this.trashed&&!this.drafts&&!this.searching},get canSort(){return this.isAdministrative&&!this.status&&!this.trashed&&!this.drafts&&!this.searching&&!this.hasActiveFilter},get isAdministrative(){return["index","embedded-index"].includes(this.settings.context)},get hasActiveFilter(){return this.filterHuds[this.siteId]&&this.filterHuds[this.siteId][this.sourceKey]&&this.filterHuds[this.siteId][this.sourceKey].isActive},get baseCriteria(){var t={};if(this.$source&&Object.assign(t,this.$source.data("criteria")),this.settings.criteria&&Object.assign(t,this.settings.criteria),this.sourcePath.length){var e=this.sourcePath[this.sourcePath.length-1];e.criteria&&Object.assign(t,e.criteria)}return t},get sourceStates(){return this.hasImplicitSource?{__IMP__:this.instanceState.source||{}}:this._sourceStates},set sourceStates(t){this.hasImplicitSource?this.setInstanceState("source",t.__IMP__||{}):(this._sourceStates=t,Craft.setLocalStorage(this.sourceStatesStorageKey,this.sourceStates))},init:function(t,e,n){var i=this;this.elementType=t,this.$container=e,this.setSettings(n,Craft.BaseElementIndex.defaults),this.$container.data("elementIndex",this),this.nestedInputNamespace="elementindex-".concat(Math.floor(1e5*Math.random())),this.sourcePaths={},this.idPrefix=Craft.randomString(10),this.$main=this.$container.find(".main"),this.$toolbar=this.$container.find(this.settings.toolbarSelector),this.$statusMenuBtn=this.$toolbar.find(".statusmenubtn:first"),this.$statusMenuContainer=this.$statusMenuBtn.parent(),this.$siteMenuBtn=this.$container.find(".sitemenubtn:first"),this.$searchContainer=this.$toolbar.find(".search-container:first"),this.$search=this.$searchContainer.children("input:first"),this.$filterBtn=this.$searchContainer.children(".filter-btn:first"),this.$clearSearchBtn=this.$searchContainer.children(".clear-btn:first"),this.$sidebar=this.$container.find(".sidebar:first"),this.$sourceActionsContainer=this.$sidebar.find("#".concat(this.namespaceId("source-actions"))),this.$sourceActionsContainer=this.$sidebar.find("#source-actions"),this.$srStatusContainer=this.$container.find("[data-status-message]"),this.$elements=this.$container.find(".elements:first"),this.$updateSpinner=this.$elements.find(".update-spinner"),this.$updateSpinner.length||(this.$updateSpinner=$("<div/>",{class:"update-spinner spinner spinner-absolute"}).appendTo(this.$elements)),this.$countSpinner=this.$container.find("#".concat(this.namespaceId("count-spinner"))),this.$countContainer=this.$container.find("#".concat(this.namespaceId("count-container"))),this.$actionsContainer=this.$container.find("#".concat(this.namespaceId("actions-container"))),this.$exportBtn=this.$container.find("#".concat(this.namespaceId("export-btn"))),this.settings.hideSidebar&&(this.$sidebar.hide(),$(".body, .content",this.$container).removeClass("has-sidebar"));var r="index"===this.settings.context?Craft.getQueryParams():{},a=this.findSources();if(1===a.length&&"__IMP__"===a.data("key")&&(this.hasImplicitSource=!0),this.instanceState=this.getDefaultInstanceState(),this.settings.storageKey&&$.extend(this.instanceState,Craft.getLocalStorage(this.settings.storageKey),{}),this.hasImplicitSource||(this._sourceStates={},this.sourceStatesStorageKey="BaseElementIndex."+this.elementType+"."+this.settings.context,Object.assign(this._sourceStates,Craft.getLocalStorage(this.sourceStatesStorageKey,{}))),this.initSources(a)){if(this.$statusMenuBtn.length&&(this.statusMenu=this.$statusMenuBtn.menubtn().data("menubtn").menu,this.statusMenu.on("optionselect",this._handleStatusChange.bind(this))),this.$siteMenuBtn.length){this.siteMenu=this.$siteMenuBtn.menubtn().data("menubtn").menu;var s=this.siteMenu.$options.filter(".sel:first");if(s.length||(s=this.siteMenu.$options.first()),s.length?this._setSite(s.data("site-id")):this.settings.criteria={id:"0"},this.siteMenu.on("optionselect",this._handleSiteChange.bind(this)),this.siteId){var o=this.settings.defaultSiteId||Craft.cp.getSiteId();if(o&&o!=this.siteId){var l=this.siteMenu.$options.filter('[data-site-id="'+o+'"]:first');l.length&&l.trigger("click")}}}else this.settings.criteria&&this.settings.criteria.siteId&&"*"!==this.settings.criteria.siteId?this._setSite(this.settings.criteria.siteId):this._setSite(Craft.siteId);var c;this.settings.criteria&&this.settings.criteria.siteId&&delete this.settings.criteria.siteId,this.addListener(this.$search,"input",(function(){!i.searching&&i.$search.val()?i.startSearching():i.searching&&!i.$search.val()&&i.stopSearching(),i.searchTimeout&&clearTimeout(i.searchTimeout),i.searchTimeout=setTimeout(i.updateElementsIfSearchTextChanged.bind(i),500)})),this.addListener(this.$search,"keypress",(function(t){t.keyCode===Garnish.RETURN_KEY&&(t.preventDefault(),i.searchTimeout&&clearTimeout(i.searchTimeout),i.updateElementsIfSearchTextChanged())})),this.addListener(this.$clearSearchBtn,"click",(function(){i.clearSearch(!0),Garnish.isMobileBrowser(!0)||i.$search.focus()})),"embedded-index"===this.settings.context||Garnish.isMobileBrowser(!0)||!1!==Craft.disableAutofocus||this.$search.focus(),this.viewMenus={},this.filterHuds={},this.addListener(this.$filterBtn,"click","showFilterHud"),this.addListener(this.$exportBtn,"click","_showExportHud"),this.initialized=!0,this.afterInit(),c="index"===this.settings.context?void 0!==r.sourcePathStep?r.sourcePathStep:this.getSelectedSourceState("sourcePathStep"):this.instanceState.sourcePathStep||null,this.asyncSelectDefaultSource().then((function(){var t=i.getDefaultSourcePath();t&&1!=t.length||!c?(t&&(i.sourcePath=t),i.afterSetInitialSource(r)):i.loadSourcePathByKey(c).then((function(t){if(t){var e=i.sourceKey.split("/").slice(-1)[0],n=t.findIndex((function(t){return t.key===e}));-1!==n&&(i.sourcePath=t.slice(n))}i.afterSetInitialSource(r)})),i.updateMainHeading(),"index"===i.settings.context&&Craft.cp.onCopyElements((function(t,e){i.updatePasteButton(t),i.$pasteBtn&&e&&i.$pasteBtn.find(".label").text(e)}))}))}},afterInit:function(){this.onAfterInit()},namespaceInputName:function(t){return Craft.namespaceInputName(t,this.settings.namespace)},namespaceId:function(t){return Craft.namespaceId(t,this.settings.namespace)},loadSourcePathByKey:function(t){var e=this;return new Promise((function(n,i){if(t!==e.sourceKey){var r=e.getViewParams();r.stepKey=t,Craft.sendActionRequest("POST","element-indexes/source-path",{data:r}).then((function(t){var e=t.data;n(e.sourcePath)})).catch(i)}else n([])}))},afterSetInitialSource:function(t){if("index"===this.settings.context&&this.addListener(Garnish.$win,"resize","handleResize"),this.handleResize(),t.search&&(this.startSearching(),this.searchText=t.search,Craft.setQueryParam("search",t.search)),t.filters&&this.createFilterHud({showOnInit:!1,serialized:t.filters}),t.sort){var e=t.sort.lastIndexOf("-");if(-1!==e){var n=t.sort.substring(0,e),i=t.sort.substring(e+1);this.setSelectedSortAttribute(n,i)}}if(t.status){var r;switch(t.status){case"trashed":r="[data-trashed]";break;case"drafts":r="[data-drafts]";break;default:r='[data-status="'.concat(t.status,'"]')}var a=this.statusMenu.$options.filter(r);a.length?this.statusMenu.selectOption(a[0]):Craft.setQueryParam("status",null)}this.setPage(Craft.pageNum),this.updateElements(!0)},handleResize:function(){this.sourcePath.length&&this.settings.showSourcePath&&this._updateSourcePathVisibility()},_createCancelToken:function(){return this._cancelToken=axios.CancelToken.source(),this._cancelToken.token},_cancelRequests:function(){this._cancelToken&&this._cancelToken.cancel()},getSourceContainer:function(){return this.$sidebar.find("nav > ul")},getSourceLabel:function(){var t;return null===(t=this.$source)||void 0===t?void 0:t.data("label")},getItemLabel:function(){return Craft.elementTypeNames[this.elementType]?Craft.elementTypeNames[this.elementType][2]:this.settings.elementTypeName.toLowerCase()},getItemsLabel:function(){return Craft.elementTypeNames[this.elementType]?Craft.elementTypeNames[this.elementType][3]:this.settings.elementTypePluralName.toLowerCase()},getFirstItemNumber:function(t){return Math.min(this.settings.batchSize*(this.page-1)+1,t)},getLastItemNumber:function(t,e){return Math.min(t+(this.settings.batchSize-1),e)},get $sources(){if(this.sourceNav)return this.sourceNav.$items},getSite:function(){var t=this;if(this.siteId)return Craft.sites.find((function(e){return e.id==t.siteId}))},initSources:function(t){if(void 0===t&&(t=this.findSources()),0===t.length)return!1;this.sourceNav||(this.sourceNav=new k(this.$sidebar.find("nav"),{onSelectionChange:this._handleSourceSelectionChange.bind(this),handleCtrlClicks:"index"===this.settings.context})),this.sourcesByKey={};for(var e=0;e<t.length;e++)this.initSource($(t[e]));return!0},findSources:function(){return this._getSourcesInList(this.getSourceContainer(),!0)},selectDefaultSource:function(){var t=this.getDefaultSource();return this.selectSource(t)},asyncSelectDefaultSource:(L=h(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getDefaultSource(),t.next=3,this.asyncSelectSource(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return L.apply(this,arguments)}),getDefaultSource:function(){var t,e;return"index"===this.settings.context&&(t=Craft.getQueryParam("source")),t||(t=this.getDefaultSourceKey()),t&&(e=this.getSourceByKey(t),-1===this.$visibleSources.index(e)&&(e=null)),t&&e||(e=this.$visibleSources.first()),e},refreshSources:function(){var t=this;this.sourceNav.removeAllItems(),this.setIndexBusy(),Craft.sendActionRequest("POST",this.settings.refreshSourcesAction,{data:{context:this.settings.context,elementType:this.elementType}}).then(function(){var e=h(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setIndexAvailable(),t.getSourceContainer().replaceWith(n.data.html),t.initSources(),e.next=5,t.asyncSelectDefaultSource();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var n;axios.isCancel(e)||(t.setIndexAvailable(),Craft.cp.displayError(null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message))}))},initSource:function(t){this.sourceNav.addItems(t),this.initSourceToggle(t),this.sourcesByKey[t.data("key")]=t,t.data("hasNestedSources")&&-1!==this.instanceState.expandedSources.indexOf(t.data("key"))&&this._expandSource(t)},initSourceToggle:function(t){this.deinitSourceToggle(t);var e=this._getSourceToggle(t);e.length?(this.addListener(t,"dblclick","_handleSourceDblClick"),this.addListener(e,"click","_handleSourceToggleClick"),t.data("hasNestedSources",!0)):t.data("hasNestedSources",!1)},updateMainHeading:function(){var t=$("#content-heading");t.length||(t=$("<span>",{id:"content-heading"})).appendTo(".screen-title"),t.text(this.getSourceLabel())},deinitSource:function(t){this.sourceNav.removeItems(t),this.deinitSourceToggle(t),delete this.sourcesByKey[t.data("key")]},deinitSourceToggle:function(t){t.data("hasNestedSources")&&(this.removeListener(t,"dblclick"),this.removeListener(this._getSourceToggle(t),"click")),t.removeData("hasNestedSources")},getDefaultInstanceState:function(){var t={selectedSource:null,expandedSources:[]};return this.hasImplicitSource&&(t.source={}),t},getDefaultSourceKey:function(){if(this.settings.preferStoredSource&&this.instanceState.selectedSource)return this.settings.defaultSource=null,this.settings.defaultSourcePath=null,this.instanceState.selectedSource;var t=null;if(this.settings.defaultSource){var e,n=null,i=!1,r=s(this.settings.defaultSource.split("/"));try{for(r.s();!(e=r.n()).done;){var a=e.value;n&&(this._expandSource(n),i=!0);var o=(null!==t?"".concat(t,"/"):"")+a,l=this.getSourceByKey(o);if(!l){n&&this._collapseSource(n);break}n=l,t=o}}catch(t){r.e(t)}finally{r.f()}i&&this._setSite(this.siteId)}return t||(this.settings.defaultSource=null,this.settings.defaultSourcePath=null),null!=t?t:this.instanceState.selectedSource},getDefaultSourcePath:function(){return null!==this.settings.defaultSourcePath&&void 0!==this.settings.defaultSourcePath[0]&&!0===this.settings.defaultSourcePath[0].canView?this.settings.defaultSourcePath:null},getDefaultExpandedSources:function(){return this.instanceState.expandedSources},get sourcePath(){return this.sourcePaths[this.sourceKey]||[]},set sourcePath(t){var e=this;if(this.sourcePaths[this.sourceKey]=t&&t.length?t:null,this.$sourcePathOuterContainer&&(this.$sourcePathOuterContainer.remove(),this.$sourcePathOuterContainer=null,this.$sourcePathInnerContainer=null,this.$sourcePathOverflowBtnContainer=null,this.$sourcePathActionsBtn=null),this.sourcePaths[this.sourceKey]&&this.settings.showSourcePath){var n=this.getSourcePathActions();this.$sourcePathOuterContainer=$("<div/>",{class:"source-path"}).insertBefore(this.$elements),this.$sourcePathInnerContainer=$("<div/>",{class:"chevron-btns"}).appendTo(this.$sourcePathOuterContainer);var i,r,a,s=$("<nav/>",{"aria-label":this.getSourcePathLabel()}).appendTo(this.$sourcePathInnerContainer),o=$("<ol/>").appendTo(s);if(t.length>1){this.$sourcePathOverflowBtnContainer=$("<li/>",{class:"first-step hidden"}).appendTo(o),r="menu"+Math.floor(1e6*Math.random()),i=$("<button/>",{type:"button",class:"btn",title:Craft.t("app","More items"),"aria-label":Craft.t("app","More items"),"data-disclosure-trigger":!0,"aria-controls":r}).append($("<span/>",{class:"btn-body"}).append($("<span/>",{class:"label"}).append($("<span/>",{"data-icon":"ellipsis","aria-hidden":"true"})))).append($("<span/>",{class:"chevron-right"})).appendTo(this.$sourcePathOverflowBtnContainer);var l=$("<div/>",{id:r,class:"menu menu--disclosure"}).appendTo(this.$sourcePathOverflowBtnContainer);a=$("<ul/>").appendTo(l),i.disclosureMenu()}for(var c=0;c<t.length;c++)!function(r){var s=t[r];a&&r<t.length-1&&(s.$overflowLi=$("<li/>",{class:"hidden"}).appendTo(a),$("<a/>",{class:"flex flex-nowrap",href:"#",type:"button",role:"button",html:s.icon?'<span data-icon="'.concat(s.icon,'" aria-hidden="true"></span><span>').concat(s.label,"</span>"):s.label}).appendTo(s.$overflowLi).on("click",(function(t){t.preventDefault(),i.data("trigger").hide(),e.selectSourcePathStep(r)})));var l=0===r,c=r===t.length-1;s.$li=$("<li/>").appendTo(o),l&&s.$li.addClass("first-step"),s.$btn=$("<a/>",{href:s.uri?Craft.getCpUrl(s.uri):"#",class:"btn",role:"button"}),s.icon&&s.$btn.attr("aria-label",s.label);var u=$("<span/>",{class:"btn-body"}).appendTo(s.$btn);s.$label=$("<span/>",{class:"label",html:s.icon?'<span data-icon="'.concat(s.icon,'" aria-hidden="true"></span>'):s.label}).appendTo(u),s.$btn.append($('<span class="chevron-left"/>')),c&&n.length?s.$btn.addClass("has-action-menu"):s.$btn.append($('<span class="chevron-right"/>')),c&&s.$btn.addClass("current-step").attr("aria-current","page"),s.$btn.appendTo(s.$li),e.addListener(s.$btn,"activate",(function(){e.selectSourcePathStep(r)}))}(c);if(n&&n.length){var u=this.getSourcePathActionLabel(),h="menu"+Math.floor(1e6*Math.random());this.$sourcePathActionsBtn=$("<button/>",{type:"button",class:"btn current-step",title:u,"aria-label":u,"data-disclosure-trigger":!0,"aria-controls":h}).append($("<span/>",{class:"btn-body"}).append($("<span/>",{class:"label"}))).append($("<span/>",{class:"chevron-right"})).appendTo(this.$sourcePathInnerContainer);var d=[n.filter((function(t){return!t.destructive&&!t.administrative})),n.filter((function(t){return t.destructive&&!t.administrative})),n.filter((function(t){return t.administrative}))].filter((function(t){return t.length})),f=$("<div/>",{id:h,class:"menu menu--disclosure"}).appendTo(this.$sourcePathInnerContainer);d.forEach((function(t,n){0!==n&&$("<hr/>").appendTo(f),e._buildSourcePathActionList(t).appendTo(f)})),this.$sourcePathActionsBtn.disclosureMenu(),this._updateSourcePathVisibility()}"index"===this.settings.context&&void 0!==t[t.length-1].uri&&"undefined"!=typeof history&&history.replaceState({},"",Craft.getCpUrl(t[t.length-1].uri))}var p=(this.sourcePaths[this.sourceKey]?this.sourcePaths[this.sourceKey][this.sourcePaths[this.sourceKey].length-1].key:null)||null;"index"===this.settings.context?this.setSelecetedSourceState("sourcePathStep",p):this.setInstanceState("sourcePathStep",p),this.onSourcePathChange()},getSourcePathLabel:function(){return""},getSourcePathActions:function(){return[]},getSourcePathActionLabel:function(){return""},_updateSourcePathVisibility:function(){var t=this.sourcePath[0],e=this.sourcePath[this.sourcePath.length-1];this.$sourcePathOverflowBtnContainer&&(this.$sourcePathOverflowBtnContainer.addClass("hidden"),t.$li.addClass("first-step"));var n,i=s(this.sourcePath);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.$overflowLi&&r.$overflowLi.addClass("hidden"),r.$li.removeClass("hidden")}}catch(t){i.e(t)}finally{i.f()}e.$label.css("width",""),e.$btn.removeAttr("title");var a=this._checkSourcePathOverage();if(a){if(this.$sourcePathOverflowBtnContainer){this.$sourcePathOverflowBtnContainer.removeClass("hidden"),t.$li.removeClass("first-step");for(var o=0;o<this.sourcePath.length-1;o++){var l=this.sourcePath[o];if(l.$overflowLi.removeClass("hidden"),l.$li.addClass("hidden"),!(a=this._checkSourcePathOverage()))return}}if(!e.icon){var c=e.$label[0].getBoundingClientRect().width;e.$label.width(Math.floor(c-a)),e.$btn.attr("title",e.label)}}},_checkSourcePathOverage:function(){var t=this.$sourcePathOuterContainer[0].getBoundingClientRect().width,e=this.$sourcePathInnerContainer[0].getBoundingClientRect().width;return Math.max(e-t,0)},_buildSourcePathActionList:function(t){var e=this,n=$("<ul/>");return t.forEach((function(t){var i=$("<a/>",{href:"#",type:"button",role:"button","aria-label":t.label,text:t.label}).on("click",(function(n){n.preventDefault(),e.$sourcePathActionsBtn.data("trigger").hide(),t.onSelect&&t.onSelect()}));t.destructive&&i.addClass("error"),$("<li/>").append(i).appendTo(n)})),n},onSourcePathChange:function(){this.settings.onSourcePathChange(),this.trigger("sourcePathChange")},selectSourcePathStep:function(t){this.sourcePath=this.sourcePath.slice(0,t+1),this.sourcePath[t].$btn.focus(),this.clearSearch(!1),this.updateElements()},startSearching:function(){this.$clearSearchBtn.removeClass("hidden"),this.searching=!0,this.sortByScore=!0},clearSearch:function(t){this.searching&&(this.$search.val(""),this.searchTimeout&&clearTimeout(this.searchTimeout),"index"===this.settings.context&&Craft.setQueryParam("search",null),this.stopSearching(),t?this.updateElementsIfSearchTextChanged():this.searchText=null)},stopSearching:function(){this.$clearSearchBtn.addClass("hidden"),this.searching=!1,this.sortByScore=!1},setInstanceState:function(t,e){"object"===a(t)?$.extend(this.instanceState,t):this.instanceState[t]=e,this.storeInstanceState()},storeInstanceState:function(){this.settings.storageKey&&Craft.setLocalStorage(this.settings.storageKey,this.instanceState)},getSourceState:function(t,e,n){if(!t)return null;if(void 0===this.sourceStates[t]){var i=t.lastIndexOf("/");if(-1!==i)return this.getSourceState(t.substring(0,i),e,n)}var r=this.sourceStates[t]||{};return void 0===e?Object.assign({},r):void 0!==r[e]?r[e]:void 0!==n?n:null},getSelectedSourceState:function(t,e){return this.getSourceState(this.instanceState.selectedSource,t,e)},setSelecetedSourceState:function(t,e){var n=this.getSelectedSourceState();if(null==n&&(n=[]),"object"===a(t))for(var i in t)t.hasOwnProperty(i)&&(null!==t[i]?n[i]=t[i]:delete n[i]);else null!==e?n[t]=e:delete n[t];var r="*";null!=this.instanceState.selectedSource&&(r=this.instanceState.selectedSource);var s=this.sourceStates;s[r]=n,this.sourceStates=s},storeSortAttributeAndDirection:function(){},setPage:function(t){if(this.isAdministrative){t=Math.max(t,1),this.page=t;var e=Craft.getPageUrl(this.page);history.replaceState({},"",e)}},_resetCount:function(){this.resultSet=null,this.totalResults=null,this.totalUnfilteredResults=null},updateSourceMenu:function(){var t=this;if(this.$sourceActionsContainer.length){this.$sourceActionsBtn&&(this.$sourceActionsBtn.data("trigger").destroy(),this.$sourceActionsContainer.empty(),$("#".concat(this.namespaceId("source-actions-menu"))).remove(),this.$sourceActionsBtn=null);var e=this.getSourceActions();if(e.length){var n=[e.filter((function(t){return!t.destructive&&!t.administrative})),e.filter((function(t){return t.destructive&&!t.administrative})),e.filter((function(t){return t.administrative}))].filter((function(t){return t.length}));this.$sourceActionsBtn=$("<button/>",{type:"button",class:"btn action-btn hairline",title:Craft.t("app","Source settings"),"aria-label":Craft.t("app","Source settings"),"aria-controls":"source-actions-menu"}).appendTo(this.$sourceActionsContainer);var i=$("<div/>",{id:"source-actions-menu",class:"menu menu--disclosure"}).appendTo(this.$sourceActionsContainer);n.forEach((function(e,n){0!==n&&$("<hr/>").appendTo(i),t._buildActionList(e).appendTo(i)})),this.$sourceActionsBtn.disclosureMenu()}}},_buildActionList:function(t){var e=this,n=$("<ul/>");return t.forEach((function(t){var i=$("<button/>",{type:"button",class:"menu-item",text:t.label}).on("click",(function(){e.$sourceActionsBtn.data("trigger").hide(),t.onSelect&&t.onSelect()}));t.destructive&&i.addClass("error"),$("<li/>").append(i).appendTo(n)})),n},getSourceActions:function(){var t=this,e=[];return Craft.userIsAdmin&&Craft.allowAdminChanges&&e.push({label:Craft.t("app","Customize sources"),administrative:!0,onSelect:function(){t.createCustomizeSourcesModal()}}),e},updateViewMenu:function(){var t;this.activeViewMenu&&this.activeViewMenu===this.viewMenus[this.sourceKey]||(this.activeViewMenu&&this.activeViewMenu.hideTrigger(),this.viewMenus[this.sourceKey]||(this.viewMenus[this.sourceKey]=new A(this,this.$source)),this.activeViewMenu=this.viewMenus[this.sourceKey],this.activeViewMenu.showTrigger(),this.activeViewMenu&&(null!==(t=this.activeViewMenu)&&void 0!==t&&t.menuHasContent()?this.activeViewMenu.enableTrigger():this.activeViewMenu.disableTrigger()))},getViewSettings:function(){return{}},getViewParams:function(){var t=Object.assign({status:null,drafts:!!this.settings.canHaveDrafts&&null,draftOf:!(!this.settings.canHaveDrafts||!this.drafts)&&null,savedDraftsOnly:!0},this.baseCriteria,{siteId:this.siteId});this.settings.canHaveDrafts&&(this.drafts||"index"===this.settings.context&&this.status)&&(t.drafts=!!this.drafts&&null,t.draftOf=!!this.drafts&&null,t.savedDraftsOnly=!0);var e={offset:this.settings.batchSize*(this.page-1),limit:this.settings.batchSize,search:this.searching?this.searchText:null};this.settings.canHaveDrafts&&this.drafts&&(e.drafts=!0),this.trashed&&(e.trashed=!0),!this.$statusMenuContainer.hasClass("hidden")&&this.status&&(e.status=this.status);var n=$.extend({},this.getSelectedSourceState());Garnish.isMobileBrowser(!0)&&(n.tableColumns=[]);var i=r(this.getSortAttributeAndDirection(),2),a=i[0],s=i[1],o={context:this.settings.context,elementType:this.elementType,canHaveDrafts:this.settings.canHaveDrafts,source:this.sourceKey,condition:this.settings.condition,referenceElementId:this.settings.referenceElementId,referenceElementOwnerId:this.settings.referenceElementOwnerId,referenceElementSiteId:this.settings.referenceElementSiteId,baseCriteria:t,criteria:e,disabledElementIds:this.settings.disabledElementIds,viewState:n,paginated:this.paginated,selectable:this.selectable,sortable:this.sortable&&"sortOrder"===a,prevalidate:this.settings.prevalidate};return o.viewState.showHeaderColumn=this.settings.showHeaderColumn,o.viewState.inlineEditing=this.inlineEditing,o.viewState.nestedInputNamespace=this.nestedInputNamespace,o.viewState.static=this.settings.static,o.viewState.mode=this.viewMode,"structure"===this.viewMode?(o.viewState.mode="table",o.viewState.order="structure",o.viewState.sort="asc",void 0===this.instanceState.collapsedElementIds&&(this.instanceState.collapsedElementIds=[]),o.collapsedElementIds=this.instanceState.collapsedElementIds):this.inlineEditing||(o.viewState.order=a,o.viewState.sort=s),this.filterHuds[this.siteId]&&this.filterHuds[this.siteId][this.sourceKey]&&(this.filterHuds[this.siteId][this.sourceKey].conditionConfig||this.filterHuds[this.siteId][this.sourceKey].serialized)&&(o.filterConfig=this.filterHuds[this.siteId][this.sourceKey].conditionConfig,o.filters=this.filterHuds[this.siteId][this.sourceKey].serialized),this.hasImplicitSource&&void 0===o.viewState.tableColumns&&(o.viewState.tableColumns=this.getDefaultTableColumns()),this.trigger("registerViewParams",{params:o}),o},updateElements:function(t,e){var n=this;return new Promise((function(e,i){n.initialized?(n.onBeforeUpdateElements(),n._cancelRequests(),n.setIndexBusy(),n.view&&n.view.disable(),!0!==t&&(n.prevPage=null,n.setPage(1)),n._resetCount(),n._previousViewParams=n._viewParams,n._viewParams=n.getViewParams(),Craft.sendActionRequest("POST",n.settings.updateElementsAction,{data:n._viewParams,cancelToken:n._createCancelToken()}).then((function(t){if("index"===n.settings.context){if(Craft.cp.fixedHeader){var i=Craft.cp.$headerContainer.height(),r=n.$main.offset().top-i;r<Garnish.$scrollContainer.scrollTop()&&Garnish.$scrollContainer.scrollTop(r)}}else n.$main.scrollTop(0);if(n._updateView(n._viewParams,t.data).then((function(){n.setIndexAvailable()})),n.criteriaHasChanged()&&!n.sourceHasChanged()){var a=n.getItemLabel(),s=n.getItemsLabel();n._countResults().then((function(t){var e;if(n.paginated){var i=n.getFirstItemNumber(t);e=Craft.t("app","Showing {first, number}-{last, number} of {total, number} {total, plural, =1{{item}} other{{items}}}",{first:i,last:n.getLastItemNumber(i,t),total:t,item:a,items:s})}else e=Craft.t("app","Showing {total, number} {total, plural, =1{{item}} other{{items}}}",{total:t,item:a,items:s});n.updateLiveRegion(e)}))}else n.updateLiveRegion(n.getSortMessage());e()})).catch((function(t){var e;axios.isCancel(t)||(n.setIndexAvailable(),Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)),i(t)}))):i("The element index isn’t initialized yet.")}))},criteriaHasChanged:function(){return!!this._previousViewParams&&!Craft.compare(this._viewParams.criteria,this._previousViewParams.criteria)},sourceHasChanged:function(){return!!this._previousViewParams&&this._viewParams.source!==this._previousViewParams.source},sortHasChanged:function(){return!!this._previousViewParams&&(this._viewParams.viewState.order!==this._previousViewParams.viewState.order||this._viewParams.viewState.sort!==this._previousViewParams.viewState.sort)},updateElementsIfSearchTextChanged:function(){this.searchText!==(this.searchText=this.searching?this.$search.val():null)&&("index"===this.settings.context&&Craft.setQueryParam("search",this.$search.val()),this.updateElements())},getSortMessage:function(){var t=this.getSelectedSortAttribute(),e="asc"===this.getSelectedSortDirection()?Craft.t("app","Ascending"):Craft.t("app","Descending"),n=this.getSortLabel(t);if(t||e||n)return Craft.t("app","{name} sorted by {attribute}, {direction}",{name:this.getSourceLabel(),attribute:n,direction:e})},updateLiveRegion:function(t){var e=this;t&&(this.$srStatusContainer.empty().text(t),setTimeout((function(){var n=e.$srStatusContainer.text();t===n&&e.$srStatusContainer.empty()}),5e3))},showActionTriggers:function(){this.showingActionTriggers||(this._$triggers?this._$triggers.appendTo(this.$actionsContainer):this._createTriggers(),this.$actionsContainer.removeClass("hidden"),this.showingActionTriggers=!0,this.updatePasteButton())},submitAction:(D=h(c().mark((function t(e,n,i){var r,a,s,o,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(r=this.view.getSelectedElementIds()).length){t.next=3;break}return t.abrupt("return",!1);case 3:if("string"==typeof e&&(e=this._findAction(e)),!e.confirm||confirm(e.confirm)){t.next=6;break}return t.abrupt("return",!1);case 6:if(!i){t.next=9;break}return t.next=9,i();case 9:if(this._cancelRequests(),a=this.getViewParams(),n=n?Craft.expandPostArray(n):{},s=$.extend(a,e.settings||{},n,{elementAction:e.type,elementIds:r}),this.setIndexBusy(),this._autoSelectElements=r,!e.download){t.next=25;break}return Craft.csrfTokenName&&(s[Craft.csrfTokenName]=Craft.csrfTokenValue),t.prev=17,t.next=20,Craft.downloadFromUrl("POST",Craft.getActionUrl(this.settings.submitActionsAction),s);case 20:return t.prev=20,this.setIndexAvailable(),t.finish(20);case 23:t.next=43;break;case 25:return t.prev=25,t.next=28,Craft.sendActionRequest("POST",this.settings.submitActionsAction,{data:s,cancelToken:this._createCancelToken()});case 28:o=t.sent,this._resetCount(),this._updateView(a,o.data),Craft.Preview.refresh(),void 0!==o.data.badgeCounts&&this._updateBadgeCounts(o.data.badgeCounts),o.data.message&&Craft.cp.displaySuccess(o.data.message),this.afterAction(e,s),t.next=40;break;case 37:t.prev=37,t.t0=t.catch(25),Craft.cp.displayError(null===t.t0||void 0===t.t0||null===(l=t.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message);case 40:return t.prev=40,this.setIndexAvailable(),t.finish(40);case 43:case"end":return t.stop()}}),t,this,[[17,,20,23],[25,37,40,43]])}))),function(t,e,n){return D.apply(this,arguments)}),_findAction:function(t){for(var e=0;e<this.actions.length;e++)if(this.actions[e].type===t)return this.actions[e];throw"Invalid element action: ".concat(t)},afterAction:function(t,e){Craft.cp.runQueue(),this.onAfterAction(t,e)},hideActionTriggers:function(){this.showingActionTriggers&&(this._$triggers.detach(),this.$actionsContainer.addClass("hidden"),this.showingActionTriggers=!1,this.updatePasteButton())},updateSelectAllCheckbox:function(){if(this.$selectAllCheckbox){var t=this.view.getSelectedElements().length;0!==t?t===this.view.getEnabledElements().length?(this.$selectAllCheckbox.removeClass("indeterminate"),this.$selectAllCheckbox.addClass("checked"),this.$selectAllCheckbox.attr("aria-checked","true")):(this.$selectAllCheckbox.addClass("indeterminate"),this.$selectAllCheckbox.removeClass("checked"),this.$selectAllCheckbox.attr("aria-checked","mixed")):(this.$selectAllCheckbox.removeClass("indeterminate checked"),this.$selectAllCheckbox.attr("aria-checked","false"))}},updateActionTriggers:function(){this.actions&&(0!==this.view.getSelectedElements().length?this.showActionTriggers():this.hideActionTriggers())},updatePasteButton:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=e||Craft.cp.getCopiedElements(),this.canPasteInternal(e)?this.$pasteBtn?this.$pasteBtn.removeClass("hidden"):(this.$pasteBtn=Craft.ui.createPasteButton().insertAfter(this.$actionsContainer),this.addListener(this.$pasteBtn,"activate","pasteElements")):null===(t=this.$pasteBtn)||void 0===t||t.addClass("hidden")},canPasteInternal:function(t){if(!t.length||!this.$source||this.showingActionTriggers)return!1;var e,n=s(t);try{for(n.s();!(e=n.n()).done;)if(e.value.type!==this.elementType)return!1}catch(t){n.e(t)}finally{n.f()}return this.canPaste(t)},canPaste:function(t){return!1},pasteAttributes:function(){return{}},pasteElements:function(){var t=this;return h(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Craft.cp.announce(Craft.t("app","Loading")),t.$pasteBtn.addClass("loading"),e.prev=2,e.next=5,Craft.cp.pasteElements(Object.assign({},t.pasteAttributes(),{siteId:t.siteId}));case 5:if(e.sent.length){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,t.$pasteBtn.removeClass("loading"),e.finish(8);case 11:return e.next=13,t.updateElements();case 13:case"end":return e.stop()}}),e,null,[[2,,8,11]])})))()},getSelectedElements:function(){return this.view?this.view.getSelectedElements():$()},getSelectedElementIds:function(){return this.view?this.view.getSelectedElementIds():[]},setStatus:function(t){var e=this.statusMenu.$options.filter('a[data-status="'+t+'"]:first');e.length&&this.statusMenu.selectOption(e[0])},getSelectedSortAttribute:function(t){if(t=t||this.$source){var e=this.getSourceState(t.data("key"),"order");if(this.getSortOption(e,t))return e}return this.getDefaultSort()[0]},getSelectedSortDirection:function(t){if(t=t||this.$source){var e=this.getSourceState(t.data("key"),"sort");if(["asc","desc"].includes(e))return e}return this.getDefaultSort()[1]},setSortAttribute:function(t){this.setSelectedSortAttribute(t)},setSelectedSortAttribute:function(t,e){if("score"!==t){this.sortByScore=!1;var n=this.getSortOption(t);if(n){"sortOrder"===t?e="asc":e||(e=n.defaultDir);var i=[],a=[t],s=this.getSelectedSourceState("order");s&&s!==t&&(i.push([s,this.getSelectedSourceState("sort")]),a.push(s));for(var o=this.getSelectedSourceState("orderHistory",[]),l=0;l<(null==o?void 0:o.length);l++){var c=r(o[l],1)[0];if(!c||a.includes(c))break;i.push(o[l]),a.push(c)}this.setSelecetedSourceState({order:t,sort:e,orderHistory:i}),"index"===this.settings.context&&Craft.setQueryParam("sort","".concat(t,"-").concat(e))}else console.warn("Invalid sort option: ".concat(t))}else this.sortByScore=!0},setSortDirection:function(t){this.setSelectedSortDirection(t)},setSelectedSortDirection:function(t){this.setSelectedSortAttribute(this.getSelectedSortAttribute(),t)},getSortAttributeAndDirection:function(){if(this.searching&&this.sortByScore)return["score","desc"];var t=this.getSelectedSortAttribute();return[t,"sortOrder"===t?"asc":this.getSelectedSortDirection()]},getSortLabel:function(t){var e=this.getSortOption(t);return e?e.label:null},getSelectedViewMode:function(){return this.validateViewMode(this.getSelectedSourceState("mode")||null)},getSourceLevel:function(t){return t.parentsUntil("nav","ul.nested").length+1},getParentSource:function(t){var e=t.parent().parent().siblings("a");return e.length?e:null},getRootSource:function(t){for(var e;e=this.getParentSource(t);)t=e;return t},getSourceByKey:function(t){return this.sourcesByKey[t]||null},ensureSourceAttributeInfo:(T=h(c().mark((function t(e){var n,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=this.getRootSource($(e))).data("table-col-opts")){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,Craft.sendActionRequest("POST","element-indexes/source-attribute-info",{data:{elementType:this.elementType,context:this.settings.context,source:n.data("key")}});case 6:i=t.sent,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(3);case 11:n.data("table-col-opts",(n.data("base-table-col-opts")||[]).concat(i.data.tableColumns)),void 0===n.data("sort-opts")&&n.data("sort-opts",(n.data("base-sort-opts")||[]).concat(i.data.sortOptions)),void 0===n.data("default-table-cols")&&n.data("default-table-cols",i.data.defaultTableColumns);case 14:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t){return T.apply(this,arguments)}),selectSource:function(t){var e=$(t);if(!this.sourcesByKey||!Object.keys(this.sourcesByKey).length)return!1;if(this.$source&&this.$source[0]&&this.$source[0]===e[0]&&e.data("key")===this.sourceKey)return!1;if(this.hideActionTriggers(),this.$source=e,this.$rootSource=this.getRootSource(e),this.sourceKey=e.data("key"),this.rootSourceKey=this.$rootSource.data("key"),this.setInstanceState("selectedSource",this.sourceKey),this.sourceNav.selectItem(e),this.updateMainHeading(),this.clearSearch(!1),this.$statusMenuBtn.length&&(void 0!==this.baseCriteria.status?this.$statusMenuContainer.addClass("hidden"):this.$statusMenuContainer.removeClass("hidden"),this.trashed)){var n=this.statusMenu.$options.first();this.setStatus(n.data("status"))}if(this.$viewModeBtnContainer&&this.$viewModeBtnContainer.remove(),this.viewModeBtns={},this.viewMode=null,this.sourceViewModes=this.getViewModesForSource(),this.defaultViewMode=this.getSourceData(this.$source,"defaultViewMode"),this.sourceViewModes.length>1){this.$viewModeBtnContainer=$('<section class="btngroup btngroup--exclusive"/>').attr("aria-label",Craft.t("app","View")).insertAfter(this.$searchContainer);for(var i=0;i<this.sourceViewModes.length;i++){var r=this.sourceViewModes[i],a=$("<button/>",{type:"button",class:"btn"+(void 0!==r.className?" ".concat(r.className):""),"data-view":r.mode,"data-icon":r.icon,"aria-label":r.title,"aria-pressed":"false",title:r.title}).appendTo(this.$viewModeBtnContainer);this.viewModeBtns[r.mode]=a,this.addListener(a,"click",{mode:r.mode},(function(t){this.selectViewMode(t.data.mode),this.updateElements()}))}}var s=this.getSelectedSourceState("mode",this.defaultViewMode);if("table"===s&&"structure"===this.getSourceState(e.data("key"),"order")&&(s="structure"),s&&this.doesSourceHaveViewMode(s)||(this.viewMode&&this.doesSourceHaveViewMode(this.viewMode)?s=this.viewMode:this.sourceViewModes&&this.sourceViewModes.length&&(s=this.sourceViewModes[0].mode)),this.selectViewMode(s),this.updateSourceMenu(),this.updateViewMenu(),!this.filterHudExists()&&this.$source.data("default-filter")?this.createFilterHud({showOnInit:!1,conditionConfig:this.$source.data("default-filter")}):this.updateFilterBtn(),this.onSelectSource(),this.sourcePath=this.sourcePaths[this.sourceKey]||this.$source.data("default-source-path"),"index"===this.settings.context){var o=Craft.getQueryParams();o.source=this.sourceKey,Craft.setUrl(Craft.getUrl(Craft.path,o))}return this.updatePasteButton(),!0},asyncSelectSource:(E=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureSourceAttributeInfo(e);case 2:return t.abrupt("return",this.selectSource(e));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return E.apply(this,arguments)}),selectSourceByKey:function(t){var e=this.getSourceByKey(t);return!!e&&this.selectSource(e)},asyncSelectSourceByKey:(I=h(c().mark((function t(e){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getSourceByKey(e)){t.next=3;break}return t.abrupt("return",!1);case 3:return t.abrupt("return",this.asyncSelectSource(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)}),getSourceData:function(t,e){if(t||(t=this.$source),t){var n=t.data(e);if(void 0===n){var i=this.getParentSource(t);if(i)return this.getSourceData(i,e)}return n}},getSortOptions:function(t){var e=i(this.getSourceData(t,"sort-opts")||[]);return e.length||e.push({label:Craft.t("app","Title"),attr:"title",defaultDir:"asc"}),e},getSortOption:function(t,e){return"sortOrder"===t?this.settings.sortable?{label:Craft.t("app","Custom"),attribute:"sortOrder",defaultDir:"asc"}:null:this.getSortOptions(e).find((function(e){return e.attr===t}))||null},getDefaultSort:function(t){var e=this.getSourceData(t,"default-sort");if(e){"string"==typeof e&&(e=[e]);var n=this.getSortOption(e[0],t);if(n)return e[1]||(e[1]=n.defaultDir),e}if(this.settings.sortable)return["sortOrder","asc"];var i=this.getSortOptions(t);return[i[0].attr,i[0].defaultDir]},getTableColumnOptions:function(t){return this.getSourceData(t,"table-col-opts")||[]},getTableColumnOption:function(t,e){return this.getTableColumnOptions(e).find((function(e){return e.attr===t}))||null},getDefaultTableColumns:function(t){return this.getSourceData(t,"default-table-cols")||[]},getSelectedTableColumns:function(t){var e=this;if(t||(t=this.$source),t){var n=this.getSourceState(t.data("key"),"tableColumns");if(n)return n.filter((function(n){return!!e.getTableColumnOption(n,t)}))}return this.getDefaultTableColumns(t)},setSelectedTableColumns:function(t){this.setSelecetedSourceState({tableColumns:t}),this.activeViewMenu&&this.activeViewMenu.updateTableColumnField()},getViewModesForSource:function(){var t=this,e=this.$source.data("viewModes");return!!e&&(Garnish.isMobileBrowser(!0)&&(e=e.filter((function(t){var e;return null===(e=t.availableOnMobile)||void 0===e||e}))),Garnish.hasAttr(this.$source,"data-has-structure")||(e=e.filter((function(t){var e;return!(null!==(e=t.structuresOnly)&&void 0!==e&&e)}))),this.settings.allowedViewModes?e.filter((function(e){return t.settings.allowedViewModes.includes(e.mode)})):e)},doesSourceHaveViewMode:function(t){if(!this.sourceViewModes)return!1;for(var e=0;e<this.sourceViewModes.length;e++)if(this.sourceViewModes[e].mode===t)return!0;return!1},validateViewMode:function(t){return t&&this.doesSourceHaveViewMode(t)?t:this.sourceViewModes&&this.sourceViewModes.length?this.sourceViewModes[0].mode:this.doesSourceHaveViewMode("table")?"table":"cards"},selectViewMode:function(t,e){var n;!e&&!this.doesSourceHaveViewMode(t)&&this.sourceViewModes&&this.sourceViewModes.length&&(t=this.sourceViewModes[0].mode),t!==this._viewMode&&(this._viewMode&&void 0!==this.viewModeBtns[this._viewMode]&&this.viewModeBtns[this._viewMode].removeClass("active").attr("aria-pressed","false"),this._viewMode=t,this.setSelecetedSourceState("mode",this._viewMode),void 0!==this.viewModeBtns[this._viewMode]&&this.viewModeBtns[this._viewMode].addClass("active").attr("aria-pressed","true"),this.activeViewMenu&&(null!==(n=this.activeViewMenu)&&void 0!==n&&n.menuHasContent()?this.activeViewMenu.enableTrigger():this.activeViewMenu.disableTrigger()))},createView:function(t,e){return new(this.getViewClass(t))(this,this.$elements,e)},getViewClass:function(t){switch(t){case"table":case"structure":return Craft.TableElementIndexView;case"cards":return Craft.CardsElementIndexView;case"thumbs":return Craft.ThumbsElementIndexView;default:throw'View mode "'.concat(t,'" not supported.')}},rememberDisabledElementId:function(t){-1===$.inArray(t,this.settings.disabledElementIds)&&this.settings.disabledElementIds.push(t)},forgetDisabledElementId:function(t){var e=$.inArray(t,this.settings.disabledElementIds);-1!==e&&this.settings.disabledElementIds.splice(e,1)},enableElements:function(t){t.removeClass("disabled").parents(".disabled").removeClass("disabled");for(var e=0;e<t.length;e++){var n=$(t[e]).data("id");this.forgetDisabledElementId(n)}this.onEnableElements(t)},disableElements:function(t){t.removeClass("sel").addClass("disabled");for(var e=0;e<t.length;e++){var n=$(t[e]).data("id");this.rememberDisabledElementId(n)}this.onDisableElements(t)},getElementById:function(t){return this.view.getElementById(t)},enableElementsById:function(t){t=$.makeArray(t);for(var e=0;e<t.length;e++){var n=t[e],i=this.getElementById(n);i&&i.length?this.enableElements(i):this.forgetDisabledElementId(n)}},disableElementsById:function(t){t=$.makeArray(t);for(var e=0;e<t.length;e++){var n=t[e],i=this.getElementById(n);i&&i.length?this.disableElements(i):this.rememberDisabledElementId(n)}},selectElementAfterUpdate:function(t){null===this._autoSelectElements&&(this._autoSelectElements=[]),this._autoSelectElements.push(t)},addButton:function(t){this.getButtonContainer().append(t)},isShowingSidebar:function(){return null===this.showingSidebar&&(this.showingSidebar=this.$sidebar.length&&!this.$sidebar.hasClass("hidden")),this.showingSidebar},getButtonContainer:function(){if(this.settings.buttonContainer)return $(this.settings.buttonContainer);var t=$("#".concat(this.namespaceId("action-buttons")));return t.length||(t=$("<div/>",{id:this.namespaceId("action-buttons")}).appendTo($("#".concat(this.namespaceId("header"))))),t},setIndexBusy:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$elements.addClass("busy"),t&&this.$updateSpinner.appendTo(this.$elements),this.isIndexBusy=!0,document.activeElement&&this.$elements[0].contains(document.activeElement)&&(this._activeElement=document.activeElement,document.activeElement.blur());var e=this.$elements.height(),n=window.innerHeight,i=$(document).scrollTop();if("modal"==this.settings.context&&(n=this.$elements.parents(".modal").height(),i=this.$elements.scrollParent().scrollTop()),e>n){var r=Math.floor(i+n/2)-100;r=Math.floor(r/e*100),this.$updateSpinner.css({insetBlockStart:"".concat(r,"%")})}this.updateLiveRegion(Craft.t("app","Loading"))},setIndexAvailable:function(){this.hideIndexLoadingStyles(),this.isIndexBusy=!1,this._activeElement&&(document.activeElement&&document.activeElement!==document.body||(document.body.contains(this._activeElement)?this._activeElement.focus():this._activeElement.id&&$("#".concat(this._activeElement.id)).focus()),this._activeElement=null)},hideIndexLoadingStyles:function(){this.$elements.removeClass("busy"),this.$updateSpinner.remove()},createCustomizeSourcesModal:function(){var t=new Craft.CustomizeSourcesModal(this,{hideOnEsc:!1,hideOnShadeClick:!1,onFadeOut:function(){t.destroy()}});return t},disable:function(){this.sourceNav&&this.sourceNav.disable(),this.view&&this.view.disable(),this.base()},enable:function(){this.sourceNav&&this.sourceNav.enable(),this.view&&this.view.enable(),this.base()},onAfterInit:function(){this.settings.onAfterInit(),this.trigger("afterInit")},onSelectSource:function(){this.settings.onSelectSource(this.sourceKey),this.trigger("selectSource",{sourceKey:this.sourceKey})},onSelectSite:function(){this.settings.onSelectSite(this.siteId),this.trigger("selectSite",{siteId:this.siteId})},onBeforeUpdateElements:function(){this.settings.onBeforeUpdateElements(),this.trigger("beforeUpdateElements")},onUpdateElements:function(){this.settings.onUpdateElements(),this.trigger("updateElements")},onCountResults:function(){this.settings.onCountResults(this.totalResults,this.totalUnfilteredResults),this.trigger("countResults",{total:this.totalResults,totalUnfiltered:this.totalUnfilteredResults})},onSelectionChange:function(){this.settings.onSelectionChange(),this.trigger("selectionChange")},onEnableElements:function(t){this.settings.onEnableElements(t),this.trigger("enableElements",{elements:t})},onDisableElements:function(t){this.settings.onDisableElements(t),this.trigger("disableElements",{elements:t})},onAfterAction:function(t,e){this.settings.onAfterAction(t,e),this.trigger("afterAction",{action:t,params:e})},_handleSourceSelectionChange:(x=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.sourceNav.$selectedItem){t.next=3;break}return this.sourceNav.selectItem(this.$visibleSources.first()),t.abrupt("return");case 3:return t.next=5,this.asyncSelectSource(this.sourceNav.$selectedItem);case 5:if(!t.sent){t.next=7;break}this.updateElements();case 7:case"end":return t.stop()}}),t,this)}))),function(){return x.apply(this,arguments)}),_handleActionTriggerSubmit:function(t){t.preventDefault();var e=$(t.currentTarget);e.hasClass("disabled")||e.data("custom-handler")||this._submitActionInternal(e.data("action"),e.data("trigger")&&e.data("trigger").data("trigger"),Garnish.getPostData(e))},_handleMenuActionTriggerSubmit:function(t){var e=$(t.option);e.hasClass("disabled")||e.data("custom-handler")||this._submitActionInternal(e.data("action"),e.data("trigger"))},_submitActionInternal:(S=h(c().mark((function t(e,n,i){var r,a=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getSelectedElements(),t.next=3,this.submitAction(e,i,h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=3;break}return t.next=3,n.settings.beforeActivate(r,a);case 3:case"end":return t.stop()}}),t)}))));case 3:if(!n){t.next=6;break}return t.next=6,n.settings.afterActivate(r,this);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return S.apply(this,arguments)}),_handleStatusChange:function(t){this.statusMenu.$options.removeClass("sel");var e=$(t.selectedOption).addClass("sel");this.$statusMenuBtn.html(e.html()),this.trashed=!1,this.drafts=!1,this.status=null;var n=null;Garnish.hasAttr(e,"data-trashed")?(this.trashed=!0,n="trashed"):Garnish.hasAttr(e,"data-drafts")?(this.drafts=!0,n="drafts"):this.status=n=e.data("status")||null,"index"===this.settings.context&&Craft.setQueryParam("status",n),this.initialized&&this.updateElements()},_handleSiteChange:(_=h(c().mark((function t(e){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.siteMenu.$options.removeClass("sel"),n=$(e.selectedOption).addClass("sel"),this.$siteMenuBtn.html(n.html()),t.next=5,this._setSite(n.data("site-id"));case 5:this.initialized&&this.updateElements(),this.onSelectSite();case 7:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)}),_setSite:(C=h(c().mark((function t(e){var n,i,r,a,s,o=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=null===this.siteId,this.siteId=e,this.updateSourceVisibility(),i=this.getSourceContainer().children(".heading"),a=0;a<i.length;a++)0!==(r=i.eq(a)).has("> ul > li .source-item:not(.hidden)").length?r.removeClass("hidden"):r.addClass("hidden");return this.initialized&&"index"===this.settings.context&&Craft.cp.setSiteId(e),s=this.initialized&&!n&&(!this.$source||!this.$source.length)&&this.$visibleSources.length,t.abrupt("return",new Promise(function(){var t=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s){t.next=3;break}return t.next=3,o.asyncSelectSource(o.$visibleSources[0]);case 3:e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return C.apply(this,arguments)}),updateSourceVisibility:function(){var t=this;this.$visibleSources=$();for(var e=0;e<this.$sources.length;e++){var n=this.$sources.eq(e);Garnish.hasAttr(n,"data-disabled")||void 0!==n.data("sites")&&!n.data("sites").toString().split(",").some((function(e){return e==t.siteId}))?(n.parent().addClass("hidden"),this.$source&&this.$source.get(0)===n.get(0)&&(this.$source=null,this.$rootSource=null,this.sourceKey=null,this.rootSourceKey=null)):(n.parent().removeClass("hidden"),this.$visibleSources=this.$visibleSources.add(n))}},_handleSelectionChange:function(){this.updateSelectAllCheckbox(),this.updateActionTriggers(),this.onSelectionChange()},_handleSourceDblClick:function(t){this._toggleSource($(t.currentTarget)),t.stopPropagation()},_handleSourceToggleClick:function(t){this._toggleSource($(t.currentTarget).prev("a")),t.stopPropagation()},_getSourcesInList:function(t,e){var n=t.find("> li:not(.heading) [data-source-item]");return e&&(n=n.add(t.find("> li.heading > ul > li [data-source-item]"))),n},_getChildSources:function(t){var e=t.siblings("ul");return this._getSourcesInList(e)},_getSourceToggle:function(t){return t.siblings(".toggle")},_toggleSource:function(t){t.parent("li").hasClass("expanded")?this._collapseSource(t):this._expandSource(t)},_expandSource:function(t){t.next(".toggle").attr({"aria-expanded":"true"}),t.parent("li").addClass("expanded");for(var e=this._getChildSources(t),n=0;n<e.length;n++)this.initSource($(e[n])),this.$visibleSources&&(this.$visibleSources=this.$visibleSources.add(e[n]));var i=t.data("key");-1===this.instanceState.expandedSources.indexOf(i)&&(this.instanceState.expandedSources.push(i),this.storeInstanceState())},_collapseSource:function(t){t.next(".toggle").attr({"aria-expanded":"false","aria-label":Craft.t("app","Show nested sources")}),t.parent("li").removeClass("expanded");for(var e=this._getChildSources(t),n=0;n<e.length;n++)this.deinitSource($(e[n])),this.$visibleSources=this.$visibleSources.not(e[n]);var i=this.instanceState.expandedSources.indexOf(t.data("key"));-1!==i&&(this.instanceState.expandedSources.splice(i,1),this.storeInstanceState())},_updateView:function(t,e){var n=this;return h(c().mark((function i(){var r,a,o,l,u,h,d,f;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.actions){if(n.hideActionTriggers(),n.triggers){r=s(n.triggers);try{for(r.s();!(a=r.n()).done;)a.value.destroy()}catch(t){r.e(t)}finally{r.f()}}n.actions=n.actionsHeadHtml=n.actionsBodyHtml=n.triggers=n._$triggers=n.$actionMenuBtn=null}return n.$countContainer.length&&(n.$countSpinner.removeClass("hidden"),n.$countContainer.html(""),n._countResults().then((function(t){n.$countSpinner.addClass("hidden");var e,i=n.getItemLabel(),r=n.getItemsLabel();if(n.paginated){var a=n.getFirstItemNumber(t),s=n.getLastItemNumber(a,t);e=Craft.t("app","{first, number}-{last, number} of {total, number} {total, plural, =1{{item}} other{{items}}}",{first:a,last:s,total:t,item:i,items:r});var o=$('<div class="flex pagination"/>').appendTo(n.$countContainer),l=Math.max(Math.ceil(t/n.settings.batchSize),1),c=$("<nav/>",{class:"flex","aria-label":Craft.t("app","{element} pagination",{element:i})}).appendTo(o),u=$("<button/>",{type:"button",role:"button",class:"page-link prev-page"+(n.page>1?"":" disabled"),disabled:1===n.page,title:Craft.t("app","Previous Page")}).appendTo(c),h=$("<button/>",{type:"button",role:"button",class:"page-link next-page"+(n.page<l?"":" disabled"),disabled:n.page===l,title:Craft.t("app","Next Page")}).appendTo(c);if(n.prevPage){var d=n.prevPage>n.page?u:h;"disabled"===d.attr("disabled")&&(d=Garnish.firstFocusableElement(c)),d.focus()}$("<div/>",{class:"page-info",text:e}).appendTo(o),n.page>1&&n.addListener(u,"click",(function(){this.removeListener(u,"click"),this.removeListener(h,"click"),this.prevPage=this.page,this.setPage(this.page-1),this.updateElements(!0)})),n.page<l&&n.addListener(h,"click",(function(){this.removeListener(u,"click"),this.removeListener(h,"click"),this.prevPage=this.page,this.setPage(this.page+1),this.updateElements(!0)}))}else e=Craft.t("app","{total, number} {total, plural, =1{{item}} other{{items}}}",{total:t,item:i,items:r}),n.$countContainer.text(e);"index"===n.settings.context&&n._addPaginationContextToDocumentTitle(e)})).catch((function(){n.$countSpinner.addClass("hidden")}))),n.$elements.html(e.html),i.next=5,Craft.appendHeadHtml(e.headHtml);case 5:return i.next=7,Craft.appendBodyHtml(e.bodyHtml);case 7:if(n.$selectAllContainer=n.$elements.find(".selectallcontainer:first"),n.multiSelect||e.actions&&e.actions.length){if(n.$selectAllContainer.length){if(e.actions&&e.actions.length&&(n.actions=e.actions,n.actionsHeadHtml=e.actionsHeadHtml,n.actionsBodyHtml=e.actionsBodyHtml),n.settings.actions&&n.settings.actions.length){n.actions||(n.actions=[]),o=s(n.settings.actions);try{for(o.s();!(l=o.n()).done;)u=l.value,(u=Object.assign({},u)).bodyHtml&&(n.actionsBodyHtml+=u.bodyHtml,delete u.bodyHtml),n.actions.push(u)}catch(t){o.e(t)}finally{o.f()}}n.$selectAllCheckbox=$('<div class="checkbox"/>').prependTo(n.$selectAllContainer).attr({role:"checkbox",tabindex:"0","aria-checked":"false","aria-label":Craft.t("app","Select all")}),n.addListener(n.$selectAllContainer,"click",(function(){0===this.view.getSelectedElements().length?this.view.selectAllElements():this.view.deselectAllElements()})),n.addListener(n.$selectAllCheckbox,"keydown",(function(t){t.keyCode===Garnish.SPACE_KEY&&(t.preventDefault(),$(t.currentTarget).trigger("click"))}))}}else"TH"!==n.$selectAllContainer.prop("nodeName")&&(n.$selectAllContainer.siblings().length||n.$selectAllContainer.parent(".header").remove(),n.$selectAllContainer.remove());if(n.selectable?(h=n.multiSelect?"checkbox":"radio",n.$elements.find(".checkbox").attr("role",h),n.multiSelect||n.$elements.attr("role","radiogroup")):n.$elements.removeAttr("role"),n.exporters=e.exporters,n.exportersByType=Craft.index(n.exporters||[],(function(t){return t.type})),n.exporters&&n.exporters.length?n.$exportBtn.removeClass("hidden"):n.$exportBtn.addClass("hidden"),d=Object.assign({page:null,context:n.settings.context,batchSize:n.isAdministrative||"structure"===n.viewMode?n.settings.batchSize:null,params:t,selectable:n.selectable,multiSelect:n.multiSelect,canSelectElement:n.settings.canSelectElement,checkboxMode:n.selectable,waitForDoubleClicks:n.settings.waitForDoubleClicks,sortable:n.sortable,onSelectionChange:n._handleSelectionChange.bind(n),onSortChange:n.settings.onSortChange},n.getViewSettings(),n.settings.viewSettings()),n.view&&(n.view.destroy(),delete n.view),n.view=n.createView(n.viewMode,d),n._autoSelectElements){if(n.selectable)for(f=0;f<n._autoSelectElements.length;f++)n.view.selectElementById(n._autoSelectElements[f]);n._autoSelectElements=null}"index"===n.settings.context&&n._addSourceNameToDocumentTitle(),n.onUpdateElements();case 19:case"end":return i.stop()}}),i)})))()},_addSourceNameToDocumentTitle:function(){var t,e=this,n=document.title.split(" - ");this.getSourceLabel()&&(this.settings.elementTypePluralName,t=e.settings.elementTypePluralName,document.title.split(" - ")[1]!==t?n.unshift(this.getSourceLabel()):n[0]=this.getSourceLabel()),document.querySelector("title").textContent=n.join(" - ")},_addPaginationContextToDocumentTitle:function(t){var e=document.title.split(" - ");e[0]===this.getSourceLabel()&&(e[0]="".concat(e[0],", ").concat(t),document.querySelector("title").textContent=e.join(" - "))},_updateBadgeCounts:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=this.getSourceByKey(e);if(n){var i=n.children(".badge");null!==t[e]?(i.length||(i=$('<span class="badge"/>').appendTo(n)),i.text(t[e])):i&&i.remove()}}},_countResults:function(){var t=this;return new Promise((function(e,n){if(null!==t.totalResults)e(t.totalResults,t.totalUnfilteredResults),t.onCountResults();else{var i=t.getViewParams();delete i.baseCriteria.offset,delete i.baseCriteria.limit,null===t.resultSet&&(t.resultSet=Math.floor(1e8*Math.random())),i.resultSet=t.resultSet,Craft.sendActionRequest("POST",t.settings.countElementsAction,{data:i,cancelToken:t._createCancelToken()}).then((function(i){i.data.resultSet==t.resultSet?(t.totalResults=i.data.total,t.totalUnfilteredResults=i.data.unfilteredTotal,e(t.totalResults,t.totalUnfilteredResults),t.onCountResults()):n()})).catch(n)}}))},_createTriggers:(w=h(c().mark((function t(){var e,n,i,r,a,s,o,l,u,h,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(this.triggers=[],this._$triggers=$(),e=[],n=[],i=0;i<this.actions.length;i++)(r=this.actions[i]).trigger?((a=$("<div/>",{id:"".concat(this.namespaceId(r.type),"-actiontrigger")}).append(r.trigger)).find(".btn").addClass("secondary"),r.settings||(r.settings={}),$.extend(r.settings,Craft.expandPostArray(Garnish.getPostData(a))),a.find("[name]").removeAttr("name"),s="element-action-form-".concat(Math.floor(1e6*Math.random())),o=$("<form/>",{id:s,method:"post",action:"",class:"hidden",data:{action:r}}).appendTo(Garnish.$bod),a.find("button[type=submit],input[type=submit],.formsubmit").addClass("formsubmit").attr("data-form",s),o.data("trigger",a),this.addListener(o,"submit","_handleActionTriggerSubmit"),this._$triggers=this._$triggers.add(a)):r.destructive?n.push(r):e.push(r);return(e.length||n.length)&&(l=$("<form/>"),this.$actionMenuBtn=$("<button/>",{type:"button",class:"btn secondary menubtn","data-icon":"settings",title:Craft.t("app","Actions")}).appendTo(l),u=$('<ul class="menu"/>').appendTo(l),h=this._createMenuTriggerList(e,!1),d=this._createMenuTriggerList(n,!0),h&&h.appendTo(u),h&&d&&$("<hr/>").appendTo(u),d&&d.appendTo(u),this._$triggers=this._$triggers.add(l)),this._$triggers.appendTo(this.$actionsContainer),this.isAdministrative&&(Craft.currentElementIndex=this),t.next=10,Craft.appendHeadHtml(this.actionsHeadHtml);case 10:return t.next=12,Craft.appendBodyHtml(this.actionsBodyHtml);case 12:Craft.initUiElements(this._$triggers),this.$actionMenuBtn&&this.$actionMenuBtn.data("menubtn").on("optionSelect",this._handleMenuActionTriggerSubmit.bind(this));case 14:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)}),_showExportHud:function(){var t=this;this.$exportBtn.addClass("active"),this.$exportBtn.attr("aria-expanded","true");for(var e=$("<form/>",{class:"export-form"}),n=[],i=0;i<this.exporters.length;i++)n.push({label:this.exporters[i].name,value:this.exporters[i].type});var r=Craft.ui.createSelectField({label:Craft.t("app","Export Type"),options:n,class:"fullwidth"}).appendTo(e),a=Craft.ui.createSelectField({label:Craft.t("app","Format"),options:[{label:"CSV",value:"csv"},{label:"XLSX",value:"xlsx"},{label:"JSON",value:"json"},{label:"XML",value:"xml"},{label:"YAML",value:"yaml"}],class:"fullwidth"}).appendTo(e),s=r.find("select");this.addListener(s,"change",(function(){var e=s.val();t.exportersByType[e].formattable?a.removeClass("hidden"):a.addClass("hidden")})),s.trigger("change");var o=this.view.getSelectedElementIds();if(!o.length)var l=Craft.ui.createTextField({label:Craft.t("app","Limit"),placeholder:Craft.t("app","No limit"),type:"number",min:1}).appendTo(e);var c=Craft.ui.createSubmitButton({class:"fullwidth",label:Craft.t("app","Export"),spinner:!0}).appendTo(e),u=new Garnish.MultiFunctionBtn(c);new Garnish.HUD(this.$exportBtn,e).on("hide",(function(){t.$exportBtn.removeClass("active"),t.$exportBtn.attr("aria-expanded","false")}));var h=!1;this.addListener(e,"submit",(function(t){if(t.preventDefault(),!h){h=!0,u.busyEvent();var e=this.getViewParams();if(delete e.baseCriteria.offset,delete e.baseCriteria.limit,delete e.criteria.offset,delete e.criteria.limit,delete e.collapsedElementIds,e.type=r.find("select").val(),e.format=a.find("select").val(),o.length)e.criteria.id=o;else{var n=parseInt(l.find("input").val());n&&!isNaN(n)?e.criteria.limit=n:delete e.criteria.limit}Craft.csrfTokenValue&&(e[Craft.csrfTokenName]=Craft.csrfTokenValue),Craft.downloadFromUrl("POST",Craft.getActionUrl("element-indexes/export"),e).catch((function(t){var e;axios.isCancel(t)||Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)})).finally((function(){h=!1,u.successEvent()}))}}))},_createMenuTriggerList:function(t,e){if(t&&t.length){var n,i=$("<ul/>"),r=s(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;$("<li/>").append($("<a/>",{id:"".concat(this.namespaceId(a.type),"-actiontrigger"),class:e?"error":null,data:{action:a},text:a.name})).appendTo(i)}}catch(t){r.e(t)}finally{r.f()}return i}},filterHudExists:function(){return this.filterHuds[this.siteId]&&this.filterHuds[this.siteId][this.sourceKey]},showFilterHud:function(){this.filterHudExists()?this.filterHuds[this.siteId][this.sourceKey].show():this.createFilterHud()},createFilterHud:function(t){this.filterHuds[this.siteId]||(this.filterHuds[this.siteId]={}),this.filterHuds[this.siteId][this.sourceKey]=new P(this,this.sourceKey,this.siteId,t),this.updateFilterBtn()},updateFilterBtn:function(){this.$filterBtn.removeClass("active"),"index"===this.settings.context&&Craft.setQueryParam("filters",null),this.filterHuds[this.siteId]&&this.filterHuds[this.siteId][this.sourceKey]?(this.$filterBtn.attr("aria-controls",this.filterHuds[this.siteId][this.sourceKey].id).attr("aria-expanded",this.filterHuds[this.siteId][this.sourceKey].showing?"true":"false"),this.hasActiveFilter&&(this.$filterBtn.addClass("active"),"index"===this.settings.context&&Craft.setQueryParam("filters",this.filterHuds[this.siteId][this.sourceKey].serialized))):this.$filterBtn.attr("aria-controls",null)}},{defaults:{context:"index",namespace:null,modal:null,storageKey:null,condition:null,referenceElementId:null,referenceElementOwnerId:null,referenceElementSiteId:null,allowedViewModes:null,showHeaderColumn:!0,static:!1,criteria:null,batchSize:100,disabledElementIds:[],selectable:!1,multiSelect:!1,waitForDoubleClicks:!1,canSelectElement:null,canDuplicateElements:function(t){return!0},onBeforeMoveElementsToPage:(b=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return b.apply(this,arguments)}),onMoveElementsToPage:(y=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return y.apply(this,arguments)}),onBeforeReorderElements:(v=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return v.apply(this,arguments)}),onReorderElements:(m=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return m.apply(this,arguments)}),onBeforeDuplicateElements:(g=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return g.apply(this,arguments)}),onDuplicateElements:(p=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return p.apply(this,arguments)}),canDeleteElements:function(t){return!0},onBeforeDeleteElements:(f=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return f.apply(this,arguments)}),onDeleteElements:(d=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return d.apply(this,arguments)}),sortable:!1,prevalidate:!1,inlineEditable:null,actions:null,buttonContainer:null,hideSidebar:!1,toolbarSelector:".toolbar:first",refreshSourcesAction:"element-indexes/get-source-tree-html",updateElementsAction:"element-indexes/get-elements",countElementsAction:"element-indexes/count-elements",submitActionsAction:"element-indexes/perform-action",defaultSiteId:null,defaultSource:null,defaultSourcePath:null,preferStoredSource:!1,showSourcePath:!0,canHaveDrafts:!1,viewSettings:$.noop,elementTypeName:Craft.t("app","Element"),elementTypePluralName:Craft.t("app","Elements"),onAfterInit:$.noop,onSelectSource:$.noop,onSelectSite:$.noop,onBeforeUpdateElements:$.noop,onUpdateElements:$.noop,onCountResults:$.noop,onSelectionChange:$.noop,onSourcePathChange:$.noop,onEnableElements:$.noop,onDisableElements:$.noop,onAfterAction:$.noop,onSortChange:$.noop}});var k=Garnish.Base.extend({$container:null,$items:null,$selectedItem:null,init:function(t,e){this.$container=$(t),this.setSettings(e,k.defaults),this.$items=$()},addItems:function(t){for(var e=$(t),n=0;n<e.length;n++){var i=e[n];this.addListener(i,"click","handleClick"),this.addListener(i,"keydown","handleKeypress")}this.$items=this.$items.add(e)},removeAllItems:function(){for(var t=0;t<this.$items.length;t++)this._deinitItem(this.$items[t]);this.$items=$(),this.$selectedItem=$()},handleKeypress:function(t){var e=t.keyCode;e!==Garnish.RETURN_KEY&&e!==Garnish.SPACE_KEY||t.shiftKey||Garnish.isCtrlKeyPressed(t)||(t.preventDefault(),this.selectItem(t.target))},handleClick:function(t){var e=this.getClosestItem(t.target);if(this.settings.handleCtrlClicks&&Garnish.isCtrlKeyPressed(t)){var n=e.data("key");if(n){var i=Craft.getQueryParams();return i.source=n,void window.open(Craft.getUrl(Craft.path,i))}}this.selectItem(e)},getClosestItem:function(t){return $(t).closest("[data-source-item]")},selectItem:function(t){if(0!==t.length){var e=$(t);this.deselectAll(),this.$selectedItem=e.attr("aria-current","true").addClass(this.settings.selectedClass),this.onSelectionChange()}},deselectAll:function(){this.$items.attr("aria-current","false").removeClass(this.settings.selectedClass),this.onSelectionChange()},removeItems:function(t){t=$.makeArray(t);for(var e=!1,n=!1,i=0;i<t.length;i++){var r=t[i],a=$.inArray(r,this.$items);-1!==a&&(this._deinitItem(r),this.$items.splice(a,1),e=!0,$(r).is(this.$selectedItem)&&(n=!0,this.$selectedItem=null))}e&&n&&($(t).removeClass(this.settings.selectedClass),this.onSelectionChange())},onSelectionChange:function(){this.callbackFrame&&(Garnish.cancelAnimationFrame(this.callbackFrame),this.callbackFrame=null),this.callbackFrame=Garnish.requestAnimationFrame(function(){this.callbackFrame=null,this.trigger("selectionChange"),this.settings.onSelectionChange()}.bind(this))},_deinitItem:function(t){var e=$(t);this.removeAllListeners(e)}},{defaults:{selectedClass:"sel",onSelectionChange:$.noop,handleCtrlClicks:!1}}),A=Garnish.Base.extend({elementIndex:null,$source:null,sourceKey:null,menu:null,id:null,$trigger:null,$container:null,$sortField:null,$sortAttributeSelect:null,$sortDirectionPicker:null,sortDirectionListbox:null,$tableColumnsField:null,$tableColumnsContainer:null,$revertContainer:null,$revertBtn:null,$closeBtn:null,init:function(t,e){var n=this;this.elementIndex=t,this.$source=e,this.sourceKey=e.data("key"),this.id="view-menu-".concat(Math.floor(1e9*Math.random())),this.$trigger=$("<button/>",{type:"button",class:"btn menubtn hidden",text:Craft.t("app","View"),"aria-label":Craft.t("app","View settings"),"aria-controls":this.id,"data-icon":"sliders"}).appendTo(this.elementIndex.$toolbar),this.$container=$("<div/>",{id:this.id,class:"menu menu--disclosure element-index-view-menu","data-align":"right"}).appendTo(Garnish.$bod),this._buildMenu(),this.addListener(this.$container,"mousedown",(function(t){t.stopPropagation()})),this.menu=new Garnish.DisclosureMenu(this.$trigger),this.menu.on("show",(function(){n.$trigger.addClass("active"),n.updateSortField()})),this.menu.on("hide",(function(){n.$trigger.removeClass("active"),setTimeout((function(){n.tidyTableColumnField()}),Garnish.FX_DURATION)}))},updateMenuContent:function(){this.updateSortField(),this.updateTableFieldVisibility()},menuHasContent:function(){return this.updateMenuContent(),this.$sortField&&!this.$sortField.hasClass("hidden")||this.$tableColumnsField&&!this.$tableColumnsField.hasClass("hidden")},showTrigger:function(){this.$trigger.removeClass("hidden")},hideTrigger:function(){this.$trigger.data("trigger").hide(),this.$trigger.addClass("hidden"),this.menu.hide()},enableTrigger:function(){this.$trigger.removeClass("disabled"),this.$trigger.attr("aria-disabled",!1)},disableTrigger:function(){this.$trigger.data("trigger").hide(),this.$trigger.addClass("disabled"),this.$trigger.attr("aria-disabled",!0),this.menu.hide()},updateTableFieldVisibility:function(){["table","structure"].includes(this.elementIndex.viewMode)&&!Garnish.isMobileBrowser(!0)?(this.$tableColumnsContainer&&this.$tableColumnsContainer.closest(".table-columns-field").removeClass("hidden"),this.$revertBtn&&this.$revertBtn.removeClass("hidden")):this.$tableColumnsContainer&&this.$tableColumnsContainer.closest(".table-columns-field").addClass("hidden")},updateSortField:function(){this.$sortField&&("structure"===this.elementIndex.viewMode?(this.$sortField.addClass("hidden"),this.$tableColumnsField&&this.$tableColumnsField.addClass("first-child")):(this.$sortField.removeClass("hidden"),this.$tableColumnsField&&this.$tableColumnsField.removeClass("first-child")));var t=r(this.elementIndex.getSortAttributeAndDirection(),2),e=t[0],n=t[1],i=this.$sortAttributeSelect.children('option[value="score"]');this.elementIndex.searching?i.length||this.$sortAttributeSelect.prepend($("<option/>",{value:"score",text:Craft.t("app","Score")})):i.length&&i.remove(),this.$sortAttributeSelect.val(e),this.sortDirectionListbox.select("asc"===n?0:1),["score","sortOrder"].includes(e)?(this.sortDirectionListbox.disable(),this.$sortDirectionPicker.addClass("disabled")):(this.sortDirectionListbox.enable(),this.$sortDirectionPicker.removeClass("disabled"))},updateTableColumnField:function(){var t=this;if(this.$tableColumnsContainer){var e,n,i=this.elementIndex.getSelectedTableColumns();i.forEach((function(i){var r=t.$tableColumnsContainer.find('input[value="'.concat(i,'"]'));r.prop("checked")||r.prop("checked",!0).trigger("change");var a=r.parent();e&&a.index()<n&&a.insertAfter(e),e=a,n=a.index()}));for(var r=this._getTableColumnCheckboxes(),a=0;a<r.length;a++){var s=r.eq(a);s.prop("checked")&&!i.includes(s.val())&&s.prop("checked",!1)}}},tidyTableColumnField:function(){if(this.$tableColumnsContainer){var t=this.elementIndex.getTableColumnOptions(this.$source).map((function(t){return t.attr})).reduce((function(t,i,r){return e(e({},t),{},n({},i,r))}),{});this.$tableColumnsContainer.children().sort((function(e,n){var i=$(e).children('input[type="checkbox"]')[0],r=$(n).children('input[type="checkbox"]')[0];return i.checked&&r.checked?0:i.checked||r.checked?i.checked?-1:1:t[i.value]<t[r.value]?-1:1})).appendTo(this.$tableColumnsContainer)}},revert:function(){this.elementIndex.setSelecetedSourceState({order:null,sort:null,tableColumns:null}),this.updateSortField(),this.updateTableColumnField(),this.tidyTableColumnField(),"index"===this.elementIndex.settings.context&&Craft.setQueryParam("sort",null),this.$revertBtn.remove(),this.$revertBtn=null,this.$closeBtn.focus(),this.elementIndex.updateElements()},_buildMenu:function(){var t=this,e=$('<div class="meta"/>').appendTo(this.$container);this.$sortField=this._createSortField().appendTo(e),Garnish.isMobileBrowser(!0)||(this.$tableColumnsField=this._createTableColumnsField().appendTo(e)),this.updateSortField(),this.$sortAttributeSelect&&this.$sortAttributeSelect.focus();var n=$("<div/>",{class:"flex menu-footer"}).appendTo(this.$container);this.$revertContainer=$("<div/>",{class:"flex-grow"}).appendTo(n),(this.elementIndex.getSelectedSourceState("order")||this.elementIndex.getSelectedSourceState("sort")||this.elementIndex.getSelectedSourceState("tableColumns"))&&this._createRevertBtn(),"table"!==this.elementIndex.viewMode&&"structure"!==this.elementIndex.viewMode&&this.$revertBtn&&this.$revertBtn.addClass("hidden"),this.$closeBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Close")}).appendTo(n).on("click",(function(){t.menu.hide()}))},_createSortField:function(){var t=this,e=$('<div class="flex"/>'),n=this.elementIndex.getSortOptions(this.$source).sort((function(t,e){return t.label===e.label?0:t.label<e.label?-1:1})).reduce((function(t,e){return t[e.attr.startsWith("field:")||e.attr.startsWith("fieldInstance:")?1:0].options.push(e),t}),[{label:Craft.t("app","Attributes"),options:[]},{label:Craft.t("app","Fields"),options:[]}]).filter((function(t){return t.options.length})).map((function(t){return[{optgroup:t.label}].concat(i(t.options.map((function(t){return{label:t.label,value:t.attr}}))))})).flat();this.elementIndex.settings.sortable&&n.unshift({label:Craft.t("app","Custom"),value:"sortOrder"});var r=Craft.ui.createSelect({options:n}).addClass("fullwidth").appendTo($('<div class="flex-grow"/>').appendTo(e));this.$sortAttributeSelect=r.children("select").attr({"aria-label":Craft.t("app","Sort attribute")}),this.$sortDirectionPicker=$("<section/>",{class:"btngroup btngroup--exclusive","aria-label":Craft.t("app","Sort direction")}).append($("<button/>",{type:"button",class:"btn",title:Craft.t("app","Sort ascending"),"aria-label":Craft.t("app","Sort ascending"),"aria-pressed":"false","data-icon":"asc","data-dir":"asc"})).append($("<button/>",{type:"button",class:"btn",title:Craft.t("app","Sort descending"),"aria-label":Craft.t("app","Sort descending"),"aria-pressed":"false","data-icon":"desc","data-dir":"desc"})).appendTo(e),this.sortDirectionListbox=new Craft.Listbox(this.$sortDirectionPicker,{onChange:function(e){e.data("dir")!==t.elementIndex.getSelectedSortDirection()&&(t.elementIndex.setSelectedSortAttribute(t.$sortAttributeSelect.val(),e.data("dir")),t.elementIndex.sortByScore||t.elementIndex.selectViewMode(t.elementIndex.viewMode),t.elementIndex.updateElements(),t._createRevertBtn())}}),this.$sortAttributeSelect.on("change",(function(){t.elementIndex.setSelectedSortAttribute(t.$sortAttributeSelect.val(),null,!1),t.elementIndex.selectViewMode(t.elementIndex.viewMode),t.elementIndex.updateElements(),t.updateSortField(),t._createRevertBtn()}));var a=Craft.ui.createField(e,{label:Craft.t("app","Sort by"),fieldset:!0});return a.addClass("sort-field"),a},_getTableColumnCheckboxes:function(){return this.$tableColumnsContainer?this.$tableColumnsContainer.find('input[type="checkbox"]'):$()},_createTableColumnsField:function(){var t=this,e=this.elementIndex.getTableColumnOptions(this.$source).sort((function(t,e){return t.label===e.label?0:t.label<e.label?-1:1}));if(!e.length)return $();this.$tableColumnsContainer=Craft.ui.createSortableCheckboxSelect({options:e.map((function(t){return{label:t.label,value:t.attr}}))}),this.updateTableColumnField(),this.tidyTableColumnField(),this.$tableColumnsContainer.data("sortableCheckboxSelect").on("sortChange",(function(){t._onTableColumnChange()})),this._getTableColumnCheckboxes().on("change",(function(e){t._onTableColumnChange()}));var n=Craft.ui.createField(this.$tableColumnsContainer,{label:Craft.t("app","Table Columns"),fieldset:!0});return n.addClass("table-columns-field"),"table"!==this.elementIndex.viewMode&&"structure"!==this.elementIndex.viewMode&&n.addClass("hidden"),n},_onTableColumnChange:function(){for(var t=[],e=this._getTableColumnCheckboxes().filter(":checked"),n=0;n<e.length;n++)t.push(e.eq(n).val());Craft.compare(t,this.elementIndex.getSelectedTableColumns(this.$source))||(this.elementIndex.setSelectedTableColumns(t,!1),this.elementIndex.updateElements(),this._createRevertBtn())},_createRevertBtn:function(){var t=this;this.$revertBtn||(this.$revertBtn=$("<button/>",{type:"button",class:"light",text:Craft.t("app","Use defaults")}).appendTo(this.$revertContainer).on("click",(function(){t.revert()})))},destroy:function(){this.menu.destroy(),delete this.menu,this.base()}}),P=Garnish.HUD.extend({elementIndex:null,sourceKey:null,siteId:null,id:null,loading:!0,conditionConfig:null,serialized:null,$clearBtn:null,cleared:!1,get isActive(){return this.showing||this.conditionConfig||this.serialized},init:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.elementIndex=t,this.sourceKey=e,this.siteId=n,this.id="filter-".concat(Math.floor(1e9*Math.random())),r.conditionConfig?(this.conditionConfig=r.conditionConfig,delete r.conditionConfig):r.serialized&&(this.serialized=r.serialized,delete r.serialized);var a=$("<div/>").append($("<div/>",{class:"spinner"})).append($("<div/>",{text:Craft.t("app","Loading"),class:"visually-hidden",role:"alert"}));this.base(this.elementIndex.$filterBtn,a,Object.assign({hudClass:"hud element-filter-hud loading",closeOtherHUDs:!1},r)),this.$hud.attr({id:this.id,"aria-live":"polite","aria-busy":"false"}),this.$tip.remove(),this.$tip=null,this.$body.on("submit",(function(t){t.preventDefault(),i.hide()})),Craft.cp.announce(Craft.t("app","Loading")),Craft.sendActionRequest("POST","element-indexes/filter-hud",{data:{context:this.elementIndex.settings.context,elementType:this.elementIndex.elementType,source:this.sourceKey,condition:this.elementIndex.settings.condition,conditionConfig:this.conditionConfig,serialized:this.serialized,fieldLayouts:this.elementIndex.$source.data("field-layouts"),id:"".concat(this.id,"-filters")}}).then(function(){var t=h(c().mark((function t(e){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.loading=!1,i.$hud.removeClass("loading"),Craft.cp.announce(Craft.t("app","Loading complete")),a.remove(),i.$main.append(e.data.hudHtml),t.next=7,Craft.appendHeadHtml(e.data.headHtml);case 7:return t.next=9,Craft.appendBodyHtml(e.data.bodyHtml);case 9:n=$("<div/>",{class:"flex flex-nowrap"}).appendTo(i.$main),$("<div/>",{class:"flex-grow"}).appendTo(n),i.$clearBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(n),$("<button/>",{type:"submit",class:"btn secondary",text:Craft.t("app","Apply")}).appendTo(n),i.$clearBtn.on("click",(function(){i.clear()})),i.$hud.find(".condition-container").on("htmx:beforeRequest",(function(){i.setBusy()})),i.$hud.find(".condition-container").on("htmx:load",(function(){i.setReady(),i.updateSizeAndPosition(!0)})),i.setFocus(),i.conditionConfig&&(i.conditionConfig=null,i.serialized=i.serialize());case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var e;Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)})),this.$hud.css("position","fixed"),this.addListener(Garnish.$win,"scroll,resize",(function(){i.updateSizeAndPosition(!0)}))},addListener:function(t,e,n,i){t===this.$main&&"resize"===e||this.base(t,e,n,i)},setBusy:function(){this.$hud.attr("aria-busy","true"),$("<div/>",{class:"visually-hidden",text:Craft.t("app","Loading")}).insertAfter(this.$main.find(".htmx-indicator"))},setReady:function(){this.$hud.attr("aria-busy","false")},setFocus:function(){Garnish.setFocusWithin(this.$main)},clear:function(){this.cleared=!0,this.hide()},updateSizeAndPositionInternal:function(){var t,e=this.elementIndex.$searchContainer[0].getBoundingClientRect(),n=Garnish.$win.height(),i=n-e.bottom;this.$body.height()>i&&(t=n-e.bottom-10);var r=this.elementIndex.$searchContainer.outerWidth()-2;r>=450?(this.$hud.css({maxWidth:"none",width:r,top:e.top+this.elementIndex.$searchContainer.outerHeight(),left:e.left+1,height:t?"".concat(t,"px"):"unset",overflowY:t?"scroll":"unset",transform:"none"}),this.$shade.css({backgroundColor:"transparent"})):(this.$hud.css({maxWidth:"680px",width:"90%",top:"50%",left:"50%",height:t?"".concat(t,"px"):"unset",overflowY:t?"scroll":"unset",transform:"translateY(-50%) translateX(-50%)"}),this.$shade.css({backgroundColor:"var(--shade-bg)"}))},onShow:function(){this.base(),this.$clearBtn&&this.$clearBtn.text(Craft.t("app","Clear")),this.elementIndex.updateFilterBtn(),this.setFocus()},onHide:function(){this.base(),this.serialized!==(this.serialized=this.serialize())&&this.elementIndex.updateElements(),this.cleared?this.destroy():(this.$hud.detach(),this.$shade.detach()),this.elementIndex.updateFilterBtn(),this.elementIndex.$filterBtn.focus()},hasRules:function(){return 0!==this.$main.has(".condition-rule").length},serialize:function(){return!this.cleared&&this.hasRules()?this.$body.serialize():null},destroy:function(){this.base(),delete this.elementIndex.filterHuds[this.siteId][this.sourceKey]}})},8413:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}Craft.PreviewFileModal=Garnish.Modal.extend({assetId:null,$spinner:null,$triggerElement:null,$bumperButtonStart:null,$bumperButtonEnd:null,$liveRegion:$('<span class="visually-hidden" role="status"></span>'),elementSelect:null,type:null,loaded:null,requestId:0,init:function(t,e,n){var i=this;void 0===n&&jQuery.isPlainObject(e)&&(n=e,e=null),n=$.extend(this.defaultSettings,n),this.$triggerElement=Garnish.getFocusedElement(),Craft.PreviewFileModal.openInstance&&Craft.PreviewFileModal.openInstance.quickHide(),Craft.PreviewFileModal.openInstance=this,this.elementSelect=e,this.$container=$('<div class="modal previewmodal loading"/>').appendTo(Garnish.$bod),this.base(this.$container,$.extend({resizable:!0},n)),Craft.cp.announce(Craft.t("app","Loading")),this.$container.velocity("stop"),this.$container.show().css("opacity",1),this.$shade.velocity("stop"),this.$shade.show().css("opacity",1),Garnish.setFocusWithin(this.$container),this.$bumperButtonStart=Craft.ui.createButton({html:Craft.t("app","Close Preview"),class:"skip-link"}),this.addListener(this.$bumperButtonStart,"click",(function(){i.hide()})),this.$bumperButtonEnd=this.$bumperButtonStart.clone(!0),this.loadAsset(t,n.startingWidth,n.startingHeight),this.addListener(this.$container,"keydown",(function(t){switch(t.keyCode){case Garnish.LEFT_KEY:case Garnish.UP_KEY:t.preventDefault(),i.previewPreviousAsset();break;case Garnish.RIGHT_KEY:case Garnish.DOWN_KEY:t.preventDefault(),i.previewNextAsset();break;case Garnish.SPACE_KEY:t.preventDefault(),t.shiftKey&&i.hide()}}))},getSelectItem:function(){var t,e=null===(t=this.elementSelect)||void 0===t?void 0:t.$items.filter("[data-id=".concat(this.assetId,"]"));return null!=e&&e.length?e:null},previewPreviousAsset:function(){var t=this.getSelectItem();if(t){var e=this.elementSelect.getItemIndex(t),n=this.elementSelect.getPreviousItem(e);null!=n&&n.length&&Craft.PreviewFileModal.showForAsset(n,this.elementSelect)&&(this.elementSelect.deselectAll(),this.elementSelect.selectItem(n,!1,!1))}},previewNextAsset:function(){var t=this.getSelectItem();if(t){var e=this.elementSelect.getItemIndex(t),n=this.elementSelect.getNextItem(e);null!=n&&n.length&&Craft.PreviewFileModal.showForAsset(n,this.elementSelect)&&(this.elementSelect.deselectAll(),this.elementSelect.selectItem(n,!1,!1))}},onFadeOut:function(){this.base();var t=this.getSelectItem();t?this.elementSelect.focusItem(t):this.$triggerElement&&this.$triggerElement.length&&this.$triggerElement.focus(),this.destroy()},_addBumperButtons:function(){this.$container.prepend(this.$bumperButtonStart).append(this.$bumperButtonEnd)},_addModalName:function(){var t="preview-heading";$("<h1/>",{class:"visually-hidden",id:t,text:Craft.t("app","Preview file")}).prependTo(this.$container),this.$container.attr("aria-labelledby",t)},_addLiveRegion:function(){this.$container.append(this.$liveRegion)},selfDestruct:function(){return this.quickHide(),!0},destroy:function(){var t;this.base(),Craft.PreviewFileModal.openInstance===this&&(Craft.PreviewFileModal.openInstance=null,null===(t=Craft.focalPoint)||void 0===t||t.destruct(),Craft.focalPoint=null)},loadAsset:function(t,i,r){var a=this;this.assetId=t,this.$container.empty(),this.loaded=!1,this.desiredHeight=null,this.desiredWidth=null;var s=.66*Garnish.$win.height(),o=Math.min(s/3*4,Garnish.$win.width()-2*this.settings.minGutter);if(s=o/4*3,i&&r){var l=i/r;o=Math.min(i,Garnish.$win.width()-2*this.settings.minGutter),(o=(s=Math.min(o/l,Garnish.$win.height()-2*this.settings.minGutter))*l)>Math.min(i,Garnish.$win.width()-2*this.settings.minGutter)&&(s=(o=Math.min(i,Garnish.$win.width()-2*this.settings.minGutter))/l)}this._resizeContainer(o,s),this.$spinner=$('<div class="spinner centeralign"></div>').appendTo(this.$container);var c=this.$container.height()/2-this.$spinner.height()/2+"px",u=this.$container.width()/2-this.$spinner.width()/2+"px";this.$spinner.css({left:u,top:c,position:"absolute"}),this.requestId++;var h={assetId:t,requestId:this.requestId},d=function(){a.$container.removeClass("loading"),a.$spinner.remove(),a.loaded=!0};Craft.sendActionRequest("POST","assets/preview-file",{data:h}).then(function(){var t,i=(t=e().mark((function t(n){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d(),n.data.requestId==a.requestId){t.next=3;break}return t.abrupt("return");case 3:if(n.data.previewHtml){t.next=8;break}return a.$container.addClass("zilch"),a.$container.append($("<p/>",{text:Craft.t("app","No preview available.")})),a._addBumperButtons(),t.abrupt("return");case 8:return a.$container.removeClass("zilch"),a.$container.attr("data-asset-id",a.assetId),a.$container.append(n.data.previewHtml),a._addBumperButtons(),a._addLiveRegion(),a._addModalName(),t.next=16,Craft.appendHeadHtml(n.data.headHtml);case 16:return t.next=18,Craft.appendBodyHtml(n.data.bodyHtml);case 18:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))});return function(t){return i.apply(this,arguments)}}()).catch((function(t){var e=t.response;d(),Craft.cp.displayError(e.data.message),a.hide()}))},_resizeContainer:function(t,e){this.$container.css({width:t,"min-width":t,"max-width":t,height:e,"min-height":e,"max-height":e,top:(Garnish.$win.height()-e)/2,left:(Garnish.$win.width()-t)/2})}},{openInstance:null,defaultSettings:{minGutter:50,startingWidth:null,startingHeight:null},resizePreviewImage:function(){var t=Craft.PreviewFileModal.openInstance;if(t){var e=.66*Garnish.$win.height(),n=Math.min(e/3*4,Garnish.$win.width()-2*t.settings.minGutter);e=n/4*3;var i,r=t.$container.find("img");if(r.css({width:n,height:e}),t.loaded&&r.length){var a=r.data("maxwidth"),s=r.data("maxheight");i=a/s;var o=t.desiredWidth?t.desiredWidth:t.getWidth(),l=t.desiredHeight?t.desiredHeight:t.getHeight(),c=Math.min(o,a),u=Math.round(Math.min(s,c/i));u>l&&(u=l),c=Math.round(u*i),r.css({width:c,height:u}),t._resizeContainer(c,u),t.desiredWidth=c,t.desiredHeight=u}t.base(),t.loaded&&r.length&&(n=Math.round(Math.min(Math.max(r.height()*i),Garnish.$win.width()-2*t.settings.minGutter)),e=Math.round(Math.min(Math.max(n/i),Garnish.$win.height()-2*t.settings.minGutter)),(n=Math.round(e*i))>Math.min(n,Garnish.$win.width()-2*t.settings.minGutter)&&(e=(n=Math.min(n,Garnish.$win.width()-2*t.settings.minGutter))/i),t._resizeContainer(n,e),r.css({width:n,height:e}),window.imageFocalPoint&&window.imageFocalPoint.renderFocal())}},showForAsset:function(t,e){if(t.hasClass("element")||(t=t.find(".element:first")),!t.hasClass("element")||Garnish.hasAttr(t,"data-folder-id"))return!1;var n={};return t.data("image-width")&&(n.startingWidth=t.data("image-width"),n.startingHeight=t.data("image-height")),new Craft.PreviewFileModal(t.data("id"),e,n),!0}})},8514:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}var r,a;Craft.ElementEditorSlideout=Craft.CpScreenSlideout.extend({$element:null,elementEditor:null,init:function(t,e){var n=this;this.$element=$(t),e=Object.assign({},Craft.ElementEditorSlideout.defaults,e,{showHeader:!0,prevalidate:this.$element.parents(".prevalidate").length>0}),this.base("elements/edit",e),this.on("load",(function(){n.elementEditor=new Craft.ElementEditor(n.$container,Object.assign({namespace:n.namespace,$contentContainer:n.$content,$sidebar:n.$sidebar,$actionBtn:n.$actionBtn,$spinnerContainer:n.$toolbar,updateTabs:function(t){n.updateTabs(t)},getTabManager:function(){return n.tabManager},handleSubmitResponse:function(t){n.handleSubmitResponse(t)},handleSubmitError:function(t){n.handleSubmitError(t)}},n.$container.data("elementEditorSettings"))),n.elementEditor.settings.isStatic&&(n.$saveBtn.remove(),n.$cancelBtn[0].innerText=Craft.t("app","Close")),n.elementEditor.on("beforeSubmit",(function(){n.settings.saveParams&&Object.keys(n.settings.saveParams).forEach((function(t){$("<input/>",{class:"hidden",name:n.elementEditor.namespaceInputName(t),value:n.settings.saveParams[t]}).appendTo(n.$container)})),n.showSubmitSpinner()})),n.elementEditor.on("afterSubmit",(function(){n.hideSubmitSpinner()}))})),this.on("submit",(function(t){if(Craft.broadcaster&&Craft.broadcaster.postMessage({event:"saveElement",id:t.response.data.element.id}),n.settings.onSaveElement){var e=Object.assign({},t.response.data,t.response.data.element);delete e.element,delete e.modelName,delete e.message,n.settings.onSaveElement(e)}Craft.Preview.refresh()}))},getParams:function(){var t,e,n,i,r,a,s={};return this.settings.elementType&&(s.elementType=this.settings.elementType),this.settings.elementId?s.elementId=this.settings.elementId:null!==(t=this.$element)&&void 0!==t&&t.data("id")&&(s.elementId=this.$element.data("id")),this.settings.draftId?s.draftId=this.settings.draftId:null!==(e=this.$element)&&void 0!==e&&e.data("draft-id")?s.draftId=this.$element.data("draft-id"):this.settings.revisionId?s.revisionId=this.settings.revisionId:null!==(n=this.$element)&&void 0!==n&&n.data("revision-id")&&(s.revisionId=this.$element.data("revision-id")),this.settings.fieldId?s.fieldId=this.settings.fieldId:null!==(i=this.$element)&&void 0!==i&&i.data("field-id")&&(s.fieldId=this.$element.data("field-id")),this.settings.ownerId?s.ownerId=this.settings.ownerId:null!==(r=this.$element)&&void 0!==r&&r.data("owner-id")&&(s.ownerId=this.$element.data("owner-id")),this.settings.siteId?s.siteId=this.settings.siteId:null!==(a=this.$element)&&void 0!==a&&a.data("site-id")&&(s.siteId=this.$element.data("site-id")),this.settings.prevalidate&&(s.prevalidate=1),s},handleSubmit:(a=i(e().mark((function t(n){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("submit"===n.type||!this.elementEditor.settings.canCreateDrafts){t.next=3;break}return t.next=3,this.elementEditor.saveDraft();case 3:return n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),t.next=8,this.settings.onBeforeSubmit();case 8:this.elementEditor.handleSubmit(n);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)}),handleSubmitError:function(t){var e;if(this.base(t),null!=t&&null!==(e=t.response)&&void 0!==e&&null!==(e=e.data)&&void 0!==e&&e.invalidNestedElementIds){var n=this.$content.find(".element.card").removeClass("error");if(n.find('craft-element-label > span[data-icon="triangle-exclamation"]').remove(),t.response.data.invalidNestedElementIds.length)for(var i=n.filter(t.response.data.invalidNestedElementIds.map((function(t){return"[data-id=".concat(t,"]")})).join(",")).addClass("error"),r=0;r<i.length;r++){var a=i.eq(r).find("craft-element-label");$("<span/>",{"data-icon":"triangle-exclamation","aria-label":Craft.t("app","Error"),role:"img"}).appendTo(a)}}},destroy:function(){this.elementEditor.destroy(),delete this.elementEditor,this.base()}},{defaults:{elementId:null,draftId:null,revisionId:null,fieldId:null,ownerId:null,elementType:null,siteId:null,prevalidate:!1,saveParams:null,onSaveElement:null,validators:[],expandData:[],isStatic:!1,onBeforeSubmit:(r=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}})},8723:function(){!function(t){Craft.SlidePicker=Garnish.Base.extend({min:null,max:null,totalSteps:null,value:null,label:null,describedBy:null,$container:null,$buttons:null,init:function(e,n){var i=this;this.setSettings(n,Craft.SlidePicker.defaults),this.$container=t("<div/>",{class:"slide-picker",role:"slider",tabindex:this.settings.readOnly?-1:0,"aria-label":Craft.t("app","Number of columns")}),this.refresh(),this.setValue(e,!1),this.settings.readOnly||this.addListener(this.$container,"keydown",(function(t){switch(t.keyCode){case Garnish.UP_KEY:i.setValue(i.value+i.settings.step),t.preventDefault();break;case Garnish.DOWN_KEY:i.setValue(i.value-i.settings.step),t.preventDefault();break;case Garnish.RIGHT_KEY:"ltr"===Craft.orientation?i.setValue(i.value+i.settings.step):i.setValue(i.value-i.settings.step),t.preventDefault();break;case Garnish.LEFT_KEY:"ltr"===Craft.orientation?i.setValue(i.value-i.settings.step):i.setValue(i.value+i.settings.step),t.preventDefault();break;case Garnish.HOME_KEY:i.setValue(i.min),t.preventDefault();break;case Garnish.END_KEY:i.setValue(i.max),t.preventDefault()}}))},refresh:function(){var e=this;if(this.min=this._min(),this.max=this._max(),this.totalSteps=(this.max-this.min)/this.settings.step,this.label=this.settings.label,this.describedBy=this.settings.describedBy,!Number.isInteger(this.totalSteps))throw"Invalid SlidePicker config";this.$buttons&&this.$buttons.remove(),this.$container.attr("aria-valuemin",this.min),this.$container.attr("aria-valuemax",this.max),this.label&&this.$container.attr("aria-label",this.label),this.describedBy&&this.$container.attr("aria-describedby",this.describedBy),this.$buttons=t();for(var n=this.min;n<=this.max;n+=this.settings.step)this.$buttons=this.$buttons.add(t("<a/>",{title:this.settings.valueLabel(n),data:{value:n}}));if(this.$buttons.appendTo(this.$container),null!==this.value){var i=this.value;this.value=null,this.setValue(i,!1)}this.addListener(this.$buttons,"mouseover",(function(n){e.$buttons.removeClass("active-hover last-active-hover"),t(n.currentTarget).addClass("active-hover last-active-hover").prevAll().addClass("active-hover")})),this.addListener(this.$buttons,"mouseout",(function(){e.$buttons.removeClass("active-hover")})),this.addListener(this.$buttons,"click",(function(n){e.setValue(t.data(n.currentTarget,"value")),n.stopPropagation(),e.$container.focus()}))},setValue:function(t,e){if(t=Math.max(Math.min(t,this.max),this.min),this.value!==(this.value=t)){this.$container.attr({"aria-valuenow":this.value,"aria-valuetext":this.settings.valueLabel(this.value)}),this.$buttons.removeClass("last-active active");var n=this.$buttons.eq((this.value-this.min)/this.settings.step);n.add(n.prevAll()).addClass("active"),n.addClass("last-active"),!1!==e&&this.settings.onChange(t)}},_min:function(){return"function"==typeof this.settings.min?this.settings.min():this.settings.min},_max:function(){return"function"==typeof this.settings.max?this.settings.max():this.settings.max}},{defaults:{min:0,max:100,step:10,valueLabel:null,onChange:t.noop,readOnly:!1}})}(jQuery)},8875:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}Craft.ComponentSelectInput=Garnish.Base.extend({componentSelect:null,componentSort:null,$container:null,$form:null,$list:null,$components:null,$addBtn:null,$createBtn:null,_initialized:!1,init:function(t){var e=this;this.setSettings(t,Craft.ComponentSelectInput.defaults),1===this.settings.limit&&(this.settings.sortable=!1),this.$container=$("#".concat(this.settings.id)),this.$form=this.$container.closest("form"),this.$container.data("componentSelect",this),this.$list=this.$container.children("ul"),this.$addBtn=this.$container.find(".add-btn:first"),this.$createBtn=this.$container.find(".create-btn:first"),this.initComponentSelect(),this.initComponentSort(),this.resetComponents(),this.$addBtn.length&&this.getOptions().on("activate",(function(t){var n=$(t.currentTarget);e.addComponent(n.data("type"),n.data("id"))})),this.$createBtn.length&&this.settings.createAction&&this.$createBtn.on("activate",(function(){var t=new Craft.CpScreenSlideout(e.settings.createAction);t.on("submit",(function(t){var n=t.response.data;e.addComponent(n.modelClass,n.modelId,!0)})),t.on("close",(function(){e.$createBtn.focus()}))})),this.componentSelect&&this.addListener(Garnish.$win,"mousedown",(function(t){var n;e.$container.is(t.target)||e.$container.find(t.target).length||null===(n=e.componentSelect)||void 0===n||n.deselectAll()})),this._initialized=!0},get totalSelected(){return this.$components.length},getComponents:function(){return this.$list.find(".chip")},getOptions:function(){return this.$addBtn.length?this.$addBtn.disclosureMenu().data("disclosureMenu").$container.find("button"):$()},getOption:function(t){return this.getOptions().filter('[data-id="'.concat(t,'"]'))},showOption:function(t){this.getOption(t).parent("li").removeClass("hidden")},hideOption:function(t){this.getOption(t).parent("li").addClass("hidden")},initComponentSelect:function(){this.settings.selectable&&(this.componentSelect=new Garnish.Select({multi:this.settings.sortable,filter:function(t){return!$(t).closest("a[href],button,[role=button]").length},makeFocusable:!1}))},initComponentSort:function(){var t=this;this.settings.sortable&&Craft.hasMousePointerEvents()&&(this.componentSort=new Garnish.DragSort({container:this.$list,filter:this.settings.selectable?function(){return t.componentSort.$targetItem.children(".chip").hasClass("sel")?t.componentSelect.getSelectedItems().parent("li"):t.componentSort.$targetItem}:null,ignoreHandleSelector:null,handle:"> .chip > .chip-content > .chip-actions > .move",axis:this.getComponentSortAxis(),collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,onSortChange:function(){t.onChange()}}))},getComponentSortAxis:function(){return this.$list.hasClass("inline-chips")?null:"y"},canAddMoreComponents:function(){return!this.settings.limit||this.$components.length<this.settings.limit},updateButtons:function(){this.canAddMoreComponents()?(this.$addBtn.length&&(this.getOptions().parent(":not(.hidden)").length?this.$addBtn.removeClass("hidden"):this.$addBtn.addClass("hidden")),this.$createBtn.length&&this.$createBtn.removeClass("hidden")):(this.$addBtn.length&&this.$addBtn.addClass("hidden"),this.$createBtn.length&&this.$createBtn.addClass("hidden"));var t=this.$addBtn.length&&this.$addBtn.parent(".flex");t&&t.length&&(t.children(":not(.hidden)").length?t.removeClass("hidden"):t.addClass("hidden"))},focusNextLogicalElement:function(){this.canAddMoreComponents()?this.$addBtn.length&&this.$addBtn.get(0).focus():this.focusLastRemoveBtn()},focusLastRemoveBtn:function(){var t=this.$container.find(".delete");t.length&&t.last()[0].focus()},resetComponents:function(){null!==this.$components?this.removeComponents(this.$components):this.$components=$(),this.addComponents(this.getComponents())},addComponents:function(t){for(var e,n=this,i=0;i<t.length;i++)this.addComponentInternal(t.eq(i));this.settings.selectable&&this.componentSelect.addItems(t),this.settings.sortable&&(null===(e=this.componentSort)||void 0===e||e.addItems(t.parent("li"))),t.on("keydown",(function(t){if([Garnish.BACKSPACE_KEY,Garnish.DELETE_KEY].includes(t.keyCode)){t.stopPropagation(),t.preventDefault();for(var e=n.componentSelect.getSelectedItems(),i=0;i<e.length;i++)n.removeComponent(e.eq(i))}})),this.$components=this.$components.add(t),this.onChange()},addComponentInternal:function(t){if(this.settings.addItemsToActionMenus){var e=this.defineComponentActions(t);Craft.addActionsToChip(t,e);var n=this.getDisclosureMenu(t),i=n.$container.find("[data-move-forward]")[0],r=n.$container.find("[data-move-backward]")[0];n.on("show",(function(){var e=t.parent(),a=e.prev("li:has(.chip)"),s=e.next("li:has(.chip)");i&&n.toggleItem(i,a.length),r&&n.toggleItem(r,s.length)})),this.addListener(t,"dblclick,taphold",(function(t){"taphold"===t.type&&"BUTTON"===t.target.nodeName||n.$container.find("[data-edit-action]").click()}))}if(this.settings.sortable&&Craft.hasMousePointerEvents()){var a=t.find(".chip-actions");a.has(".move").length||$("<button/>",{type:"button",class:"move icon",title:Craft.t("app","Reorder"),"aria-label":Craft.t("app","Reorder"),"aria-describedby":t.find(".label").attr("id")}).appendTo(a)}this.hideOption(t.data("id"))},defineComponentActions:function(t){var n,r,a,s=[];if(this.settings.sortable){var o=this.getComponentSortAxis();s.push({icon:(r=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("y"===o?"arrow-up":"ltr"===Craft.orientation?"arrow-left":"arrow-right");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),label:"y"===o?Craft.t("app","Move up"):Craft.t("app","Move forward"),onActivate:function(e){$(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").moveComponentForward(t)},attributes:{"data-move-forward":!0}}),s.push({icon:(n=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("y"===o?"arrow-down":"ltr"===Craft.orientation?"arrow-right":"arrow-left");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)}),label:"y"===o?Craft.t("app","Move down"):Craft.t("app","Move backward"),onActivate:function(e){$(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").moveComponentBackward(t)},attributes:{"data-move-backward":!0}})}return s.push({icon:(a=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("remove");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),label:Craft.t("app","Remove"),onActivate:function(e){$(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").removeComponent(t)},destructive:!0}),s},getDisclosureMenu:function(t){return t.find("> .chip-content > .chip-actions .action-btn").disclosureMenu().data("disclosureMenu")},onChange:function(){var t;null===(t=this.componentSelect)||void 0===t||t.resetItemOrder(),this.$components=$().add(this.$components),this.updateButtons(),this._initialized&&this.trigger("change")},moveComponentForward:function(t){var e=t.closest("li"),n=e.prev();n.length&&(e.insertBefore(n),this.onChange())},moveComponentBackward:function(t){var e=t.closest("li"),n=e.next();n.length&&(e.insertAfter(n),this.onChange())},removeComponents:function(t){this.settings.selectable&&this.componentSelect.removeItems(t),t.children("input").prop("disabled",!0);for(var e=0;e<t.length;e++)this.showOption(t.eq(e).data("id"));var n;if(this.settings.selectable){var i=this.$components.index(t.last());n=this.$components.eq(i+1)}n.length?n.focus():this.focusNextLogicalElement(),this.$components=this.$components.not(t),this.onChange()},removeComponent:function(t){$("[name]",t).removeAttr("name"),this.removeComponents(t),this.animateComponentAway(t,(function(){t.parent("li").remove()}))},animateComponentAway:function(t,e){t.css("z-index",0);var n={opacity:-1};n["margin-"+Craft.left]=-(t.outerWidth()+parseInt(t.css("margin-"+Craft.right))),n["margin-bottom"]=-(t.outerHeight()+parseInt(t.css("margin-bottom"))),t.velocity(n,Craft.ComponentSelectInput.REMOVE_FX_DURATION,(function(){e&&e()}))},getSelectedComponentIds:function(){for(var t=[],e=0;e<this.$components.length;e++)t.push(this.$components.eq(e).data("id"));return t},addComponent:function(t,n){var r=arguments,a=this;return i(e().mark((function i(){var s,o,l,c,u,h,d,f;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.length>2&&void 0!==r[2]&&r[2],o=a.$addBtn.length?a.$addBtn.disclosureMenu().data("disclosureMenu"):null,e.next=4,Craft.sendActionRequest("POST","app/render-components",{data:{components:[{type:t,id:n,instances:[a.renderSettings(n)]}],withMenuItems:s,menuId:null==o?void 0:o.$container.attr("id")}});case 4:return l=e.sent,c=l.data,u=a.canAddMoreComponents(),h=!1,u&&(d=$(c.components[t][n][0]),a.insertComponent(d),a.addComponents(d),h=d),s&&o&&(f=$(c.menuItems[t][n]),o.addItem(f),u&&o.hideItem(f.children()[0]),h=f,f.find("button").on("activate",(function(){a.addComponent(t,n)}))),e.next=12,Craft.appendHeadHtml(c.headHtml);case 12:return e.next=14,Craft.appendBodyHtml(c.bodyHtml);case 14:a.settings.showDescription&&h&&Craft.initUiElements(h);case 15:case"end":return e.stop()}}),i)})))()},insertComponent:function(t){$("<li/>").append(t).appendTo(this.$list)},renderSettings:function(t){return{showActionMenu:this.settings.showActionMenus,showHandle:this.settings.showHandles,showDescription:this.settings.showDescription,inputName:this.settings.name,hyperlink:this.settings.hyperlinks}},destroy:function(){var t,e;null===(t=this.componentSelect)||void 0===t||t.destroy(),null===(e=this.componentSort)||void 0===e||e.destroy(),delete this.componentSelect,delete this.componentSort,this.getOptions().off("activate"),this.$createBtn.off("activate"),this.base()}},{REMOVE_FX_DURATION:200,defaults:{id:null,name:null,limit:null,showHandles:!1,showDescription:!1,sortable:!0,selectable:!0,showActionMenus:!0,hyperlinks:!1,createAction:null,addItemsToActionMenus:!0}})},8903:function(){Craft.EntryMover=Garnish.Base.extend({modal:null,cancelToken:null,entryIds:null,currentSectionUid:null,elementIndex:null,$sectionsListContainer:null,$sectionsList:null,$cancelBtn:null,$selectBtn:null,sectionSelect:null,init:function(t,e){this.entryIds=t,this.elementIndex=e;var n=e.$source.data("key"),i=null;0===n.indexOf("section:")&&(i=n.substring(8)),this.currentSectionUid=i,this.createModal()},createModal:function(){var t=$('<div class="modal entry-mover-modal"/>'),e=$('<div class="header"/>').appendTo(t),n="sectionSelectorModalHeading-"+Math.floor(1e6*Math.random());$("<h1/>",{text:Craft.t("app","Move to"),id:n}).appendTo(e);var i=$('<div class="body"/>').appendTo(t),r=$("<div/>",{class:"footer"}).appendTo(t);this.$sectionsListContainer=$('<div class="entry-mover-modal--list"/>').appendTo(i),this.$sectionsList=$("<fieldset/>",{class:"chips","aria-labelledby":n}).appendTo(this.$sectionsListContainer),$('<div class="buttons left secondary-buttons"/>').appendTo(r);var a=$('<div class="buttons right"/>').appendTo(r);this.$cancelBtn=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(a),this.$selectBtn=Craft.ui.createSubmitButton({class:"disabled",label:Craft.t("app","Move"),spinner:!0}).attr("aria-disabled","true").appendTo(a),this.addListener(this.$cancelBtn,"activate","cancel"),this.addListener(this.$selectBtn,"activate","selectSection"),this.modal=new Garnish.Modal(t),this.getCompatibleSections()},getCompatibleSections:function(){var t=this;this.cancelToken&&this.cancelToken.cancel(),this.$selectBtn.addClass("loading"),this.cancelToken=axios.CancelToken.source(),Craft.sendActionRequest("POST","entries/move-to-section-modal-data",{data:{entryIds:this.entryIds,siteId:this.elementIndex.siteId,currentSectionUid:this.currentSectionUid},cancelToken:this.cancelToken.token}).then((function(e){var n=e.data,i=null==n?void 0:n.listHtml;i&&(t.$sectionsList.html(i),t.$sectionsList.find(".checkbox").attr("role","radio"),t.sectionSelect=new Garnish.Select(t.$sectionsList,t.$sectionsList.find(".chip"),{vertical:!0,filter:function(t){return!$(t).closest("a[href],.toggle,.btn,[role=button]").length},checkboxMode:!0,onSelectionChange:function(){t.sectionSelect.$selectedItems.length?t.$selectBtn.removeClass("disabled"):t.$selectBtn.addClass("disabled")}}))})).catch((function(e){var n,i=e.response;Craft.cp.displayError(null==i||null===(n=i.data)||void 0===n?void 0:n.message),t.modal.hide()})).finally((function(){t.$selectBtn.removeClass("loading"),t.cancelToken=null}))},selectSection:function(){var t=this;if(!this.$selectBtn.hasClass("loading")){this.$selectBtn.addClass("loading"),Craft.cp.announce(Craft.t("app","Loading"));var e={sectionId:this.sectionSelect.$selectedItems.data("id"),entryIds:this.entryIds};Craft.sendActionRequest("POST","entries/move-to-section",{data:e}).then((function(e){Craft.cp.displaySuccess(e.data.message),Craft.cp.announce(e.data.message),t.elementIndex.updateElements(),t.elementIndex.$elements.attr("tabindex","-1").focus(),t.modal.hide()})).catch((function(t){var e,n;Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message),Craft.cp.announce(null==t||null===(n=t.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)})).finally((function(){t.$selectBtn.removeClass("loading")}))}},cancel:function(){this.modal.hide()}})},8960:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(r())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(t.bind.apply(t,i));return n&&a(s,n.prototype),s}(t,arguments,s(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}var o=function(n){function i(){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=function(e,n,i){return n=s(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,r()?Reflect.construct(n,i||[],s(e).constructor):n.apply(e,i))}(this,i)).tooltip=null,e.$tabs=null,e.disabled=!1,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,n),function(t,n){return n&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(i,[{key:"labelLink",get:function(){return this.querySelector(".label-link")}},{key:"connectedCallback",value:function(){var t=this;this.hasAttribute("disabled")||(this.labelLink?(this.$tabs=$("#tabs"),this.$tabs.length&&this.$tabs.data("tabs")&&this.$tabs.data("tabs").on("selectTab",(function(){t.update()})),this.update(),$((function(){t.update()}))):console.warn("No label link found in craft-element-label."))}},{key:"update",value:function(){this.desiredWidth=this.calculateWidth(this.innerText),this.hasOverflow=this.desiredWidth>this.scrollWidth,this.hasOverflow&&(this.tooltip=this.querySelector("craft-tooltip"),this.tooltip||this.createTooltip())}},{key:"createTooltip",value:function(){this.tooltip=document.createElement("craft-tooltip"),this.tooltip.setAttribute("self-managed","true"),this.tooltip.setAttribute("text",this.innerText),this.tooltip.setAttribute("aria-hidden","true"),Object.assign(this.tooltip.style,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"});var t=this.querySelector(".context-label");t&&(this.tooltip.innerText=this.tooltip.innerText.replace(t.innerText," (".concat(t.innerText,")"))),this.insertBefore(this.tooltip,this.labelLink),this.tooltip.appendChild(this.labelLink)}},{key:"disconnectedCallback",value:function(){var t,e,n;this.append(this.labelLink),null===(t=this.tooltip)||void 0===t||t.remove(),null!==(e=this.$tabs)&&void 0!==e&&e.length&&(null===(n=this.$tabs.data("tabs"))||void 0===n||n.off("selectTab"))}},{key:"calculateWidth",value:function(t){var e=document.createElement("span");Object.assign(e.style,{position:"absolute",visibility:"hidden",whiteSpace:"nowrap",fontFamily:"inherit"}),e.innerText=t,this.appendChild(e);var n=e.clientWidth;return this.removeChild(e),n}}])}(i(HTMLElement));customElements.define("craft-element-label",o)},9626:function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Craft.LivePreview=Garnish.Base.extend({$extraFields:null,$trigger:null,$shade:null,$editorContainer:null,$editor:null,$dragHandle:null,$previewContainer:null,$iframeContainer:null,$iframe:null,$fieldPlaceholder:null,previewUrl:null,token:null,basePostData:null,inPreviewMode:!1,fields:null,lastPostData:null,updateIframeInterval:null,loading:!1,checkAgain:!1,dragger:null,dragStartEditorWidth:null,_slideInOnIframeLoad:!1,_scrollX:null,_scrollY:null,_editorWidth:null,_editorWidthInPx:null,init:function(t){var e=this;this.setSettings(t,Craft.LivePreview.defaults),this.settings.previewUrl?this.previewUrl=this.settings.previewUrl:this.previewUrl=Craft.baseSiteUrl.replace(/\/+$/,"")+"/","https:"===document.location.protocol&&(this.previewUrl=this.previewUrl.replace(/^http:/,"https:")),this.basePostData=$.extend({},this.settings.previewParams),this.$extraFields=$(this.settings.extraFields),this.$trigger=$(this.settings.trigger),this.$fieldPlaceholder=$("<div/>"),this.editorWidth=Craft.getLocalStorage("LivePreview.editorWidth",Craft.LivePreview.defaultEditorWidth),this.addListener(this.$trigger,"activate","toggle"),Craft.cp.on("beforeSaveShortcut",(function(){e.inPreviewMode&&e.moveFieldsBack()})),Craft.Preview.instances.push(this)},get editorWidth(){return this._editorWidth},get editorWidthInPx(){return this._editorWidthInPx},set editorWidth(t){var e;t>=1?(e=t,t/=Garnish.$win.width()):e=Math.round(t*Garnish.$win.width()),e<Craft.LivePreview.minEditorWidthInPx&&(t=(e=Craft.LivePreview.minEditorWidthInPx)/Garnish.$win.width()),this._editorWidth=t,this._editorWidthInPx=e},toggle:function(){this.inPreviewMode?this.exit():this.enter()},enter:function(){var t=this;if(!this.inPreviewMode)if(this.token){if(this.trigger("beforeEnter"),this.trigger("beforeOpen"),$(document.activeElement).trigger("blur"),!this.$editor){this.$shade=$("<div/>",{class:"modal-shade dark"}).appendTo(Garnish.$bod),this.$editorContainer=$("<div/>",{class:"lp-editor-container"}).appendTo(Garnish.$bod),this.$previewContainer=$("<div/>",{class:"lp-preview-container"}).appendTo(Garnish.$bod),this.$iframeContainer=$("<div/>",{class:"lp-iframe-container"}).appendTo(this.$previewContainer);var e=$("<header/>",{class:"flex"}).appendTo(this.$editorContainer);this.$editor=$("<form/>",{class:"lp-content"}).appendTo(this.$editorContainer),this.$dragHandle=$("<div/>",{class:"lp-draghandle"}).appendTo(this.$editorContainer);var n=$("<button/>",{type:"button",class:"btn",text:Craft.t("app","Close Preview")}).appendTo(e);$("<div/>",{class:"flex-grow"}).appendTo(e);var i=$("<button/>",{type:"button",class:"btn submit",text:Craft.t("app","Save")}).appendTo(e);this.dragger=new Garnish.BaseDrag(this.$dragHandle,{axis:Garnish.X_AXIS,onDragStart:this._onDragStart.bind(this),onDrag:this._onDrag.bind(this),onDragStop:this._onDragStop.bind(this)}),this.addListener(n,"click","exit"),this.addListener(i,"click","save")}this.handleWindowResize(),this.addListener(Garnish.$win,"resize","handleWindowResize"),this.$editorContainer.css(Craft.left,-this.editorWidthInPx+"px"),this.$previewContainer.css(Craft.right,-this.getIframeWidth()),this.fields=[];for(var r=$(this.settings.fields),a=0;a<r.length;a++){var s=$(r[a]),o=this._getClone(s);this.$fieldPlaceholder.insertAfter(s),s.detach(),this.$fieldPlaceholder.replaceWith(o),s.appendTo(this.$editor),this.fields.push({$field:s,$clone:o})}this.updateIframe()?this._slideInOnIframeLoad=!0:this.slideIn(),Craft.ElementThumbLoader.retryAll(),Garnish.uiLayerManager.addLayer(this.$sidebar),Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){t.exit()})),this.inPreviewMode=!0,this.trigger("enter"),this.trigger("open")}else this.createToken()},createToken:function(){var t=this,e={previewAction:this.settings.previewAction};Craft.sendActionRequest("POST","live-preview/create-token",{data:e}).then((function(e){t.token=e.data.token,t.enter()}))},save:function(){Craft.cp.submitPrimaryForm()},handleWindowResize:function(){this.editorWidth=this.editorWidth,this.updateWidths()},slideIn:function(){var t=this;$("html").addClass("noscroll"),this.$shade.velocity("fadeIn"),this.$editorContainer.show().velocity("stop").animateLeft(0,"slow",(function(){t.trigger("slideIn"),Garnish.$win.trigger("resize")})),this.$previewContainer.show().velocity("stop").animateRight(0,"slow",(function(){t.updateIframeInterval=setInterval(t.updateIframe.bind(t),1e3)}))},exit:function(){var t=this;this.inPreviewMode&&(this.trigger("beforeExit"),this.trigger("beforeClose"),$("html").removeClass("noscroll"),this.removeListener(Garnish.$win,"resize"),Garnish.uiLayerManager.removeLayer(),this.updateIframeInterval&&clearInterval(this.updateIframeInterval),this.moveFieldsBack(),this.$shade.delay(200).velocity("fadeOut"),this.$editorContainer.velocity("stop").animateLeft(-this.editorWidthInPx,"slow",(function(){for(var e=0;e<t.fields.length;e++)t.fields[e].$newClone.remove();t.$editorContainer.hide(),t.trigger("slideOut")})),this.$previewContainer.velocity("stop").animateRight(-this.getIframeWidth(),"slow",(function(){t.$previewContainer.hide()})),Craft.ElementThumbLoader.retryAll(),this.inPreviewMode=!1,this.trigger("exit"),this.trigger("close"))},moveFieldsBack:function(){for(var t=0;t<this.fields.length;t++){var e=this.fields[t];e.$newClone=this._getClone(e.$field),this.$fieldPlaceholder.insertAfter(e.$field),e.$field.detach(),this.$fieldPlaceholder.replaceWith(e.$newClone),e.$clone.replaceWith(e.$field)}Garnish.$win.trigger("resize")},getIframeWidth:function(){return Garnish.$win.width()-this.editorWidthInPx},updateWidths:function(){this.$editorContainer.css("width",this.editorWidthInPx+"px"),this.$previewContainer.width(this.getIframeWidth())},updateIframe:function(t){if(t&&(this.lastPostData=null),!this.inPreviewMode)return!1;if(this.loading)return this.checkAgain=!0,!1;var e=$.extend(Garnish.getPostData(this.$editor),Garnish.getPostData(this.$extraFields));if(this.lastPostData&&Craft.compare(e,this.lastPostData,!1))return!1;this.lastPostData=e,this.loading=!0;var n=this.$iframe?$(this.$iframe[0].contentWindow.document):null;return this._scrollX=n?n.scrollLeft():0,this._scrollY=n?n.scrollTop():0,$.ajax({url:this.previewUrl+(-1!==this.previewUrl.indexOf("?")?"&":"?")+Craft.tokenParam+"="+this.token,method:"POST",data:$.extend({},e,this.basePostData),headers:{"X-Craft-Token":this.token},xhrFields:{withCredentials:!0},crossDomain:!0,success:this.handleSuccess.bind(this),error:this.handleError.bind(this)}),!0},forceUpdateIframe:function(){return this.updateIframe(!0)},handleSuccess:function(t){var e=this,n=t+'<script type="text/javascript">window.scrollTo('+this._scrollX+", "+this._scrollY+");<\/script>",i=$('<iframe class="lp-preview" frameborder="0"/>');this.$iframe?i.insertBefore(this.$iframe):i.appendTo(this.$iframeContainer),this.addListener(i,"load",(function(){this.$iframe&&this.$iframe.remove(),this.$iframe=i,this._slideInOnIframeLoad&&(this.slideIn(),this._slideInOnIframeLoad=!1),this.removeListener(i,"load")})),Garnish.requestAnimationFrame((function(){i[0].contentWindow.document.open(),i[0].contentWindow.document.write(n),i[0].contentWindow.document.close(),e.onResponse()}))},handleError:function(){this.onResponse()},onResponse:function(){this.loading=!1,this.checkAgain&&(this.checkAgain=!1,this.updateIframe())},_getClone:function(t){var e=t.clone();return Garnish.copyInputValues(t,e),e.attr("id",""),e.find("[id]").attr("id",""),e},_onDragStart:function(){this.dragStartEditorWidth=this.editorWidthInPx,this.$previewContainer.addClass("dragging")},_onDrag:function(){"ltr"===Craft.orientation?this.editorWidth=this.dragStartEditorWidth+this.dragger.mouseDistX:this.editorWidth=this.dragStartEditorWidth-this.dragger.mouseDistX,this.updateWidths(),this.trigger("drag")},_onDragStop:function(){this.$previewContainer.removeClass("dragging"),Craft.setLocalStorage("LivePreview.editorWidth",this.editorWidth)},destroy:function(){var t=this;Craft.Preview.instances=Craft.Preview.instances.filter((function(e){return e!==t})),this.base()}},{defaultEditorWidth:.33,minEditorWidthInPx:320,instances:[],defaults:{trigger:".livepreviewbtn",fields:null,extraFields:null,previewUrl:null,previewAction:null,previewParams:{}},getActive:function(){var e,n=function(e,n){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}(Craft.LivePreview.instances);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.inPreviewMode)return i}}catch(t){n.e(t)}finally{n.f()}}}),Craft.LivePreview.init=function(t){Craft.livePreview=new Craft.LivePreview(t)}},9660:function(t,e,n){var i=n(7429);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals),(0,n(6054).A)("3790022a",i,!0,{})},9773:function(t,e,n){var i=n(3589),r=n(7916),a=n(5516);function s(t){return this instanceof s?(this.nodes=i(t),this):new s(t)}s.prototype.toString=function(){return Array.isArray(this.nodes)?a(this.nodes):""},s.prototype.walk=function(t,e){return r(this.nodes,t,e),this},s.unit=n(6407),s.walk=r,s.stringify=a,t.exports=s},9922:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return i};var n,i={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(n){h=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var r=e&&e.prototype instanceof b?e:b,a=Object.create(r.prototype),o=new A(i||[]);return s(a,"_invoke",{value:T(t,n,o)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",v="completed",y={};function b(){}function w(){}function C(){}var $={};h($,l,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,l)&&($=S);var x=C.prototype=b.prototype=Object.create($);function I(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function i(r,s,o,l){var c=f(e[r],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==t(h)&&a.call(h,"__await")?n.resolve(h.__await).then((function(t){i("next",t,o,l)}),(function(t){i("throw",t,o,l)})):n.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,l)}))}l(c.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,r){i(t,e,n,r)}))}return r=r?r.then(a,a):a()}})}function T(t,e,i){var r=p;return function(a,s){if(r===m)throw Error("Generator is already running");if(r===v){if("throw"===a)throw s;return{value:n,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=D(o,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===p)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=m;var c=f(t,e,i);if("normal"===c.type){if(r=i.done?v:g,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}function D(t,e){var i=e.method,r=t.iterator[i];if(r===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=n,D(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=f(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,y;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=h(C,u,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},I(E.prototype),h(E.prototype,c,(function(){return this})),i.AsyncIterator=E,i.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var s=new E(d(t,e,n,r),a);return i.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},I(x),h(x,u,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},i.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),y}},i}function n(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(r,a){var s=t.apply(e,i);function o(t){n(s,r,a,o,l,"next",t)}function l(t){n(s,r,a,o,l,"throw",t)}o(void 0)}))}}!function(t){Craft.GroupedEntryTypeSelectInput=Craft.EntryTypeSelectInput.extend({init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.base(t)},get group(){var t;return null===(t=this.$container.closest(".entry-type-group"))||void 0===t?void 0:t.data("entryTypeGroup")},get manager(){var t;return null===(t=this.group)||void 0===t?void 0:t.manager},initComponentSort:function(){},renderSettings:function(t){return Object.assign(this.base(),{inputValue:JSON.stringify({id:t,group:this.group.name})})},insertComponent:function(e){t("<li/>").append(e).insertBefore(this.$list.find(".entry-type-group--caboose"))},addComponents:function(t){var e;this.base(t),null===(e=this.manager)||void 0===e||null===(e=e.entryTypeSort)||void 0===e||e.addItems(t.parent("li"))},addComponentInternal:function(t){if(this.base(t),this.settings.addItemsToActionMenus){var e=this.getDisclosureMenu(t),n=e.$container.find("[data-move-to-previous-group]")[0],i=e.$container.find("[data-move-to-next-group]")[0];e.on("show",(function(){var r=t.closest(".entry-type-group"),a=r.prev("li.entry-type-group"),s=r.next("li.entry-type-group");n&&e.toggleItem(n,a.length),i&&e.toggleItem(i,s.length)}))}},defineComponentActions:function(n){var r,a,s=this.base(n);return s.push({icon:(r=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-left":"arrow-right");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)}),label:Craft.t("app","Move to previous group"),onActivate:function(e){t(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").moveEntryTypeToPreviousGroup(n)},attributes:{"data-move-to-previous-group":!0}}),s.push({icon:(a=i(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon("ltr"===Craft.orientation?"arrow-right":"arrow-left");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)}),label:Craft.t("app","Move to next group"),callback:function(e){t(e).closest(".menu").data("disclosureMenu").$trigger.closest(".componentselect").data("componentSelect").moveEntryTypeToNextGroup(n)},attributes:{"data-move-to-next-group":!0}}),s},moveEntryTypeToPreviousGroup:function(t){var e=t.closest("li"),n=e.closest(".entry-type-group").prev(".entry-type-group");n.length&&(e.insertBefore(n.data("entryTypeGroup").componentSelect.$list.find(".entry-type-group--caboose")),this.manager.refresh())},moveEntryTypeToNextGroup:function(t){var e=t.closest("li"),n=e.closest(".entry-type-group").next(".entry-type-group");n.length&&(e.insertBefore(n.data("entryTypeGroup").componentSelect.$list.find(".entry-type-group--caboose")),this.manager.refresh())},showOption:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.base(t),n){var i=function(){e.manager.groups.forEach((function(n){n.componentSelect!==e&&n.componentSelect.showOption(t,!1)}))};this.manager?i():setTimeout((function(){e.manager&&i()}),1)}},hideOption:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.base(t),n&&setTimeout((function(){e.manager.groups.forEach((function(n){n.componentSelect!==e&&n.componentSelect.hideOption(t,!1)}))}),1)}})}(jQuery)},9940:function(){Craft.LightSwitch=Garnish.Base.extend({settings:null,$outerContainer:null,$innerContainer:null,$input:null,small:!1,on:!1,indeterminate:!1,dragger:null,dragStartMargin:null,init:function(t,e){if(this.$outerContainer=$(t),this.$outerContainer.data("lightswitch")&&(console.warn("Double-instantiating a lightswitch on an element"),this.$outerContainer.data("lightswitch").destroy()),this.$outerContainer.data("lightswitch",this),this.small=this.$outerContainer.hasClass("small"),this.setSettings(e,Craft.LightSwitch.defaults),this.$innerContainer=this.$outerContainer.find(".lightswitch-container:first"),this.$input=this.$outerContainer.find("input:first"),!this.$input.prop("disabled")){this.on=this.$outerContainer.hasClass("on"),this.indeterminate=this.$outerContainer.hasClass("indeterminate"),this.addListener(this.$outerContainer,"mousedown","_onMouseDown"),this.addListener(this.$outerContainer,"keydown","_onKeyDown"),this.dragger=new Garnish.BaseDrag(this.$outerContainer,{axis:Garnish.X_AXIS,ignoreHandleSelector:null,onDragStart:this._onDragStart.bind(this),onDrag:this._onDrag.bind(this),onDragStop:this._onDragStop.bind(this)});var n=this.$outerContainer.parent(".lightswitch-inner-container");n.length&&(this.addListener(n.children('span[data-toggle="off"]'),"click",this.turnOff),this.addListener(n.children('span[data-toggle="on"]'),"click",this.turnOn))}},turnOn:function(t){var e=!this.on;if(this.on=!0,this.indeterminate=!1,this.$outerContainer.addClass("dragging"),Garnish.prefersReducedMotion())this.$innerContainer.css("margin-"+Craft.left,0);else{var n={};n["margin-"+Craft.left]=0,this.$innerContainer.velocity("stop").velocity(n,Craft.LightSwitch.animationDuration,this._onSettle.bind(this))}this.$input.val(this.settings.value),this.$outerContainer.addClass("on"),this.$outerContainer.removeClass("indeterminate"),this.$outerContainer.attr("aria-checked","true"),e&&!0!==t&&this.onChange()},turnOff:function(t){var e=this.on||this.indeterminate;if(this.on=!1,this.indeterminate=!1,this.$outerContainer.addClass("dragging"),Garnish.prefersReducedMotion())this.$innerContainer.css("margin-"+Craft.left,this._getOffMargin());else{var n={};n["margin-"+Craft.left]=this._getOffMargin(),this.$innerContainer.velocity("stop").velocity(n,Craft.LightSwitch.animationDuration,this._onSettle.bind(this))}this.$input.val(""),this.$outerContainer.removeClass("on"),this.$outerContainer.removeClass("indeterminate"),this.$outerContainer.attr("aria-checked","false"),e&&!0!==t&&this.onChange()},turnIndeterminate:function(t){var e=!this.indeterminate;this.on=!1,this.indeterminate=!0,this.$outerContainer.addClass("dragging");var n={};n["margin-"+Craft.left]=this._getOffMargin()/2,this.$innerContainer.velocity("stop").velocity(n,Craft.LightSwitch.animationDuration,this._onSettle.bind(this)),this.$input.val(this.settings.indeterminateValue),this.$outerContainer.removeClass("on"),this.$outerContainer.addClass("indeterminate"),this.$outerContainer.attr("aria-checked","mixed"),e&&!0!==t&&this.onChange()},toggle:function(){this.indeterminate||!this.on?this.turnOn():this.turnOff()},onChange:function(){this.trigger("change"),this.settings.onChange(this.on),this.$outerContainer.trigger("change")},_onMouseDown:function(){this.addListener(Garnish.$doc,"mouseup","_onMouseUp")},_onMouseUp:function(){this.removeListener(Garnish.$doc,"mouseup"),this.dragger.dragging||this.toggle()},_onKeyDown:function(t){switch(t.keyCode){case Garnish.SPACE_KEY:this.toggle(),t.preventDefault();break;case Garnish.RIGHT_KEY:"ltr"===Craft.orientation?this.turnOn():this.turnOff(),t.preventDefault();break;case Garnish.LEFT_KEY:"ltr"===Craft.orientation?this.turnOff():this.turnOn(),t.preventDefault()}},_getMargin:function(){return parseInt(this.$innerContainer.css("margin-"+Craft.left))},_onDragStart:function(){this.$outerContainer.addClass("dragging"),this.dragStartMargin=this._getMargin()},_onDrag:function(){var t;(t="ltr"===Craft.orientation?this.dragStartMargin+this.dragger.mouseDistX:this.dragStartMargin-this.dragger.mouseDistX)<this._getOffMargin()?t=this._getOffMargin():t>0&&(t=0),this.$innerContainer.css("margin-"+Craft.left,t)},_onDragStop:function(){this._getMargin()>this._getOffMargin()/2?this.turnOn():this.turnOff()},_onSettle:function(){this.$outerContainer.removeClass("dragging")},destroy:function(){this.$outerContainer.removeData("lightswitch"),this.base(),this.dragger.destroy()},_getOffMargin:function(){return this.small?-10:-12}},{animationDuration:100,defaults:{value:"1",indeterminateValue:"-",onChange:$.noop}})},9961:function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(r())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(t.bind.apply(t,i));return n&&a(s,n.prototype),s}(t,arguments,s(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}var o=function(n){function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,n,i){return n=s(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,r()?Reflect.construct(n,i||[],s(e).constructor):n.apply(e,i))}(this,i,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,n),function(t,n){return n&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(i,[{key:"items",get:function(){return this.querySelectorAll(".sidebar-action")}},{key:"connectedCallback",value:function(){this.trigger=this.querySelector("#sidebar-trigger"),this.trigger&&(this.trigger.addEventListener("open",this.expand.bind(this)),this.trigger.addEventListener("close",this.collapse.bind(this)))}},{key:"disconnectedCallback",value:function(){this.trigger&&(this.trigger.removeEventListener("open",this.expand.bind(this)),this.trigger.removeEventListener("close",this.collapse.bind(this))),this.expand()}},{key:"itemHasTooltip",value:function(t){return t.querySelector("craft-tooltip")}},{key:"createTooltips",value:function(){var t=this;this.items&&this.items.forEach((function(e){var n;if(!t.itemHasTooltip(e)){var i=document.createElement("craft-tooltip");i.setAttribute("placement","right"),i.setAttribute("trigger",".sidebar-action"),i.setAttribute("text",null===(n=e.querySelector(".label"))||void 0===n?void 0:n.textContent),e.append(i)}}))}},{key:"destroyTooltips",value:function(){this.items&&this.items.forEach((function(t){var e=t.querySelector("craft-tooltip");null==e||e.remove()}))}},{key:"expand",value:function(){document.body.setAttribute("data-sidebar","expanded"),Craft.setCookie("sidebar","expanded"),this.destroyTooltips()}},{key:"collapse",value:function(){document.body.setAttribute("data-sidebar","collapsed"),Craft.setCookie("sidebar","collapsed"),this.createTooltips()}}])}(i(HTMLElement));customElements.define("craft-global-sidebar",o)},9975:function(){Craft.Tooltip=Garnish.Base.extend({_$trigger:null,_message:null,hud:null,$p:null,hoverTimeout:null,triggerHit:!1,shownViaHover:!1,init:function(t,e){var n=this;this.$trigger=$(t),this.message=e,"BUTTON"!==this.$trigger[0].tagName&&"button"!==this.$trigger.attr("role")&&console.error("Toggletip buttons need to be <button> elements."),this.addListener(Garnish.$bod,"mousemove",(function(t){n.triggerHit!==(n.triggerHit=Garnish.hitTest(t.pageX,t.pageY,n._$trigger))&&(n.triggerHit?n.showing||(n.hoverTimeout=setTimeout((function(){n.show(),n.shownViaHover=!0}),500)):(clearTimeout(n.hoverTimeout),n.shownViaHover&&n.hide()))}))},get showing(){return this.hud&&this.hud.showing},get $trigger(){return this._$trigger},set $trigger(t){var e=this;this._$trigger&&this.removeAllListeners(this._$trigger),this._$trigger=t,this._$trigger.on("blur",(function(){e.hide()})),this._$trigger.on("activate",(function(){e.showing&&e.shownViaHover?e.shownViaHover=!1:e.toggle(),e._$trigger.focus()})),this.hud&&(this.hud.$trigger=t,this.hud.showing&&this.hud.updateSizeAndPosition(!0))},get message(){return this._message},set message(t){this._message=t,this.$p&&this.$p.text(t)},show:function(t){var e=this;this.shownViaHover=!1,this.showing||(this.$trigger.attr("aria-expanded","true"),this.hud?this.hud.show():(this.$p=$("<p/>",{text:this._message}),this.hud=new Craft.Tooltip.HUD(this._$trigger,this.$p,{hudClass:"hud tooltip-hud",withShade:!1,onShow:function(){e.onShow()},onHide:function(){e.onHide()}})))},hide:function(){this.showing&&(this.$trigger.attr("aria-expanded","false"),this.hud&&this.hud.hide())},toggle:function(){this.showing?this.hide():this.show()},onShow:function(){clearTimeout(this.hoverTimeout),this.$p.text(this.message)},onHide:function(){clearTimeout(this.hoverTimeout),this.$p.text("")}}),Craft.Tooltip.HUD=Garnish.HUD.extend({init:function(t,e,n){this.base(t,e,n),this.$hud.attr("role","status")},showContainer:function(){this.$hud.removeClass("visually-hidden")},hideContainer:function(){this.$hud.addClass("visually-hidden")}})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};!function(){"use strict";function t(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function n(t){return t}__webpack_require__(7297),__webpack_require__(9660);var i=1e-6;function r(t){return"translate("+t+",0)"}function a(t){return"translate(0,"+t+")"}function s(t){return e=>+t(e)}function o(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function l(){return!this.__axis}function c(t,e){var c=[],u=null,h=null,d=6,f=6,p=3,g="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,m=1===t||4===t?-1:1,v=4===t||2===t?"x":"y",y=1===t||3===t?r:a;function b(r){var a=null==u?e.ticks?e.ticks.apply(e,c):e.domain():u,b=null==h?e.tickFormat?e.tickFormat.apply(e,c):n:h,w=Math.max(d,0)+p,C=e.range(),$=+C[0]+g,_=+C[C.length-1]+g,S=(e.bandwidth?o:s)(e.copy(),g),x=r.selection?r.selection():r,I=x.selectAll(".domain").data([null]),E=x.selectAll(".tick").data(a,e).order(),T=E.exit(),D=E.enter().append("g").attr("class","tick"),L=E.select("line"),k=E.select("text");I=I.merge(I.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(D),L=L.merge(D.append("line").attr("stroke","currentColor").attr(v+"2",m*d)),k=k.merge(D.append("text").attr("fill","currentColor").attr(v,m*w).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),r!==x&&(I=I.transition(r),E=E.transition(r),L=L.transition(r),k=k.transition(r),T=T.transition(r).attr("opacity",i).attr("transform",(function(t){return isFinite(t=S(t))?y(t+g):this.getAttribute("transform")})),D.attr("opacity",i).attr("transform",(function(t){var e=this.parentNode.__axis;return y((e&&isFinite(e=e(t))?e:S(t))+g)}))),T.remove(),I.attr("d",4===t||2===t?f?"M"+m*f+","+$+"H"+g+"V"+_+"H"+m*f:"M"+g+","+$+"V"+_:f?"M"+$+","+m*f+"V"+g+"H"+_+"V"+m*f:"M"+$+","+g+"H"+_),E.attr("opacity",1).attr("transform",(function(t){return y(S(t)+g)})),L.attr(v+"2",m*d),k.attr(v,m*w).text(b),x.filter(l).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),x.each((function(){this.__axis=S}))}return b.scale=function(t){return arguments.length?(e=t,b):e},b.ticks=function(){return c=Array.from(arguments),b},b.tickArguments=function(t){return arguments.length?(c=null==t?[]:Array.from(t),b):c.slice()},b.tickValues=function(t){return arguments.length?(u=null==t?null:Array.from(t),b):u&&u.slice()},b.tickFormat=function(t){return arguments.length?(h=t,b):h},b.tickSize=function(t){return arguments.length?(d=f=+t,b):d},b.tickSizeInner=function(t){return arguments.length?(d=+t,b):d},b.tickSizeOuter=function(t){return arguments.length?(f=+t,b):f},b.tickPadding=function(t){return arguments.length?(p=+t,b):p},b.offset=function(t){return arguments.length?(g=+t,b):g},b}function u(t){return c(2,t)}function h(t){return c(3,t)}function d(t){return c(4,t)}function f(){}function p(t){return null==t?f:function(){return this.querySelector(t)}}function g(){return[]}function m(t){return null==t?g:function(){return this.querySelectorAll(t)}}function v(t){return function(){return this.matches(t)}}function y(t){return function(e){return e.matches(t)}}var b=Array.prototype.find;function w(){return this.firstElementChild}var C=Array.prototype.filter;function _(){return Array.from(this.children)}function S(t){return new Array(t.length)}function x(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function I(t,e,n,i,r,a){for(var s,o=0,l=e.length,c=a.length;o<c;++o)(s=e[o])?(s.__data__=a[o],i[o]=s):n[o]=new x(t,a[o]);for(;o<l;++o)(s=e[o])&&(r[o]=s)}function E(t,e,n,i,r,a,s){var o,l,c,u=new Map,h=e.length,d=a.length,f=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(f[o]=c=s.call(l,l.__data__,o,e)+"",u.has(c)?r[o]=l:u.set(c,l));for(o=0;o<d;++o)c=s.call(t,a[o],o,a)+"",(l=u.get(c))?(i[o]=l,l.__data__=a[o],u.delete(c)):n[o]=new x(t,a[o]);for(o=0;o<h;++o)(l=e[o])&&u.get(f[o])===l&&(r[o]=l)}function T(t){return t.__data__}function D(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function L(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}x.prototype={constructor:x,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var k="http://www.w3.org/1999/xhtml",A={svg:"http://www.w3.org/2000/svg",xhtml:k,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function P(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),A.hasOwnProperty(e)?{space:A[e],local:t}:t}function F(t){return function(){this.removeAttribute(t)}}function M(t){return function(){this.removeAttributeNS(t.space,t.local)}}function B(t,e){return function(){this.setAttribute(t,e)}}function O(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function H(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function R(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function j(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function G(t){return function(){this.style.removeProperty(t)}}function N(t,e,n){return function(){this.style.setProperty(t,e,n)}}function U(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function z(t,e){return t.style.getPropertyValue(e)||j(t).getComputedStyle(t,null).getPropertyValue(e)}function W(t){return function(){delete this[t]}}function Y(t,e){return function(){this[t]=e}}function V(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function q(t){return t.trim().split(/^|\s+/)}function K(t){return t.classList||new X(t)}function X(t){this._node=t,this._names=q(t.getAttribute("class")||"")}function J(t,e){for(var n=K(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Q(t,e){for(var n=K(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Z(t){return function(){J(this,t)}}function tt(t){return function(){Q(this,t)}}function et(t,e){return function(){(e.apply(this,arguments)?J:Q)(this,t)}}function nt(){this.textContent=""}function it(t){return function(){this.textContent=t}}function rt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function at(){this.innerHTML=""}function st(t){return function(){this.innerHTML=t}}function ot(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function lt(){this.nextSibling&&this.parentNode.appendChild(this)}function ct(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ut(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===k&&e.documentElement.namespaceURI===k?e.createElement(t):e.createElementNS(n,t)}}function ht(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function dt(t){var e=P(t);return(e.local?ht:ut)(e)}function ft(){return null}function pt(){var t=this.parentNode;t&&t.removeChild(this)}function gt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vt(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,a=e.length;i<a;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function yt(t,e,n){return function(){var i,r=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,o=r.length;s<o;++s)if((i=r[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),void(i.value=e);this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function bt(t,e,n){var i=j(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function wt(t,e){return function(){return bt(this,t,e)}}function Ct(t,e){return function(){return bt(this,t,e.apply(this,arguments))}}X.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var $t=[null];function _t(t,e){this._groups=t,this._parents=e}function St(){return new _t([[document.documentElement]],$t)}_t.prototype=St.prototype={constructor:_t,select:function(t){"function"!=typeof t&&(t=p(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,s,o=e[r],l=o.length,c=i[r]=new Array(l),u=0;u<l;++u)(a=o[u])&&(s=t.call(a,a.__data__,u,o))&&("__data__"in a&&(s.__data__=a.__data__),c[u]=s);return new _t(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):m(t);for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var s,o=e[a],l=o.length,c=0;c<l;++c)(s=o[c])&&(i.push(t.call(s,s.__data__,c,o)),r.push(s));return new _t(i,r)},selectChild:function(t){return this.select(null==t?w:function(t){return function(){return b.call(this.children,t)}}("function"==typeof t?t:y(t)))},selectChildren:function(t){return this.selectAll(null==t?_:function(t){return function(){return C.call(this.children,t)}}("function"==typeof t?t:y(t)))},filter:function(t){"function"!=typeof t&&(t=v(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,s=e[r],o=s.length,l=i[r]=[],c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new _t(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,T);var n,i=e?E:I,r=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=a.length,o=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var h=r[u],d=a[u],f=d.length,p=D(t.call(h,h&&h.__data__,u,r)),g=p.length,m=l[u]=new Array(g),v=o[u]=new Array(g);i(h,d,m,v,c[u]=new Array(f),p,e);for(var y,b,w=0,C=0;w<g;++w)if(y=m[w]){for(w>=C&&(C=w+1);!(b=v[C])&&++C<g;);y._next=b||null}}return(o=new _t(o,r))._enter=l,o._exit=c,o},enter:function(){return new _t(this._enter||this._groups.map(S),this._parents)},exit:function(){return new _t(this._exit||this._groups.map(S),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,a=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?a.remove():n(a),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,a=i.length,s=Math.min(r,a),o=new Array(r),l=0;l<s;++l)for(var c,u=n[l],h=i[l],d=u.length,f=o[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<r;++l)o[l]=n[l];return new _t(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],a=r.length-1,s=r[a];--a>=0;)(i=r[a])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=L);for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var s,o=n[a],l=o.length,c=r[a]=new Array(l),u=0;u<l;++u)(s=o[u])&&(c[u]=s);c.sort(e)}return new _t(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var s=i[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,a=e[n],s=0,o=a.length;s<o;++s)(r=a[s])&&t.call(r,r.__data__,s,a);return this},attr:function(t,e){var n=P(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?M:F:"function"==typeof e?n.local?R:H:n.local?O:B)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?G:"function"==typeof e?U:N)(t,e,null==n?"":n)):z(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?W:"function"==typeof e?V:Y)(t,e)):this.node()[t]},classed:function(t,e){var n=q(t+"");if(arguments.length<2){for(var i=K(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?et:e?Z:tt)(n,e))},text:function(t){return arguments.length?this.each(null==t?nt:("function"==typeof t?rt:it)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?at:("function"==typeof t?ot:st)(t)):this.node().innerHTML},raise:function(){return this.each(lt)},lower:function(){return this.each(ct)},append:function(t){var e="function"==typeof t?t:dt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:dt(t),i=null==e?ft:"function"==typeof e?e:p(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(pt)},clone:function(t){return this.select(t?mt:gt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=a.length;if(!(arguments.length<2)){for(o=e?yt:vt,i=0;i<s;++i)this.each(o(a[i],e,n));return this}var o=this.node().__on;if(o)for(var l,c=0,u=o.length;c<u;++c)for(i=0,l=o[c];i<s;++i)if((r=a[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Ct:wt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],a=0,s=r.length;a<s;++a)(i=r[a])&&(yield i)}};var xt=St,It={value:()=>{}};function Et(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Tt(i)}function Tt(t){this._=t}function Dt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Lt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=It,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Tt.prototype=Et.prototype={constructor:Tt,on:function(t,e){var n,i,r=this._,a=(i=r,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=a[s]).type)r[n]=Lt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Lt(r[n],t.name,null);return this}for(;++s<o;)if((n=(t=a[s]).type)&&(n=Dt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Tt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};var kt,At,Pt=Et,Ft=0,Mt=0,Bt=0,Ot=0,Ht=0,Rt=0,jt="object"==typeof performance&&performance.now?performance:Date,Gt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Nt(){return Ht||(Gt(Ut),Ht=jt.now()+Rt)}function Ut(){Ht=0}function zt(){this._call=this._time=this._next=null}function Wt(t,e,n){var i=new zt;return i.restart(t,e,n),i}function Yt(){Ht=(Ot=jt.now())+Rt,Ft=Mt=0;try{!function(){Nt(),++Ft;for(var t,e=kt;e;)(t=Ht-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ft}()}finally{Ft=0,function(){for(var t,e,n=kt,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:kt=e);At=t,qt(i)}(),Ht=0}}function Vt(){var t=jt.now(),e=t-Ot;e>1e3&&(Rt-=e,Ot=t)}function qt(t){Ft||(Mt&&(Mt=clearTimeout(Mt)),t-Ht>24?(t<1/0&&(Mt=setTimeout(Yt,t-jt.now()-Rt)),Bt&&(Bt=clearInterval(Bt))):(Bt||(Ot=jt.now(),Bt=setInterval(Vt,1e3)),Ft=1,Gt(Yt)))}function Kt(t,e,n){var i=new zt;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}zt.prototype=Wt.prototype={constructor:zt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Nt():+n)+(null==e?0:+e),this._next||At===this||(At?At._next=this:kt=this,At=this),this._call=t,this._time=n,qt()},stop:function(){this._call&&(this._call=null,this._time=1/0,qt())}};var Xt=Pt("start","end","cancel","interrupt"),Jt=[];function Qt(t,e,n,i,r,a){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function a(l){var c,u,h,d;if(1!==n.state)return o();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return Kt(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Kt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function s(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(o),n.state=5,1),a=-1,s=i.length;++a<s;)i[a].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),o())}function o(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Wt((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Xt,tween:Jt,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Zt(t,e){var n=ee(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function te(t,e){var n=ee(t,e);if(n.state>3)throw new Error("too late; already running");return n}function ee(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ne(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ie,re=180/Math.PI,ae={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function se(t,e,n,i,r,a){var s,o,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*re,skewX:Math.atan(l)*re,scaleX:s,scaleY:o}}function oe(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(a,s){var o=[],l=[];return a=t(a),s=t(s),function(t,i,r,a,s,o){if(t!==r||i!==a){var l=s.push("translate(",null,e,null,n);o.push({i:l-4,x:ne(t,r)},{i:l-2,x:ne(i,a)})}else(r||a)&&s.push("translate("+r+e+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,o,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(r(n)+"rotate(",null,i)-2,x:ne(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(a.rotate,s.rotate,o,l),function(t,e,n,a){t!==e?a.push({i:n.push(r(n)+"skewX(",null,i)-2,x:ne(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(a.skewX,s.skewX,o,l),function(t,e,n,i,a,s){if(t!==n||e!==i){var o=a.push(r(a)+"scale(",null,",",null,")");s.push({i:o-4,x:ne(t,n)},{i:o-2,x:ne(e,i)})}else 1===n&&1===i||a.push(r(a)+"scale("+n+","+i+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,o,l),a=s=null,function(t){for(var e,n=-1,i=l.length;++n<i;)o[(e=l[n]).i]=e.x(t);return o.join("")}}}var le=oe((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ae:se(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ce=oe((function(t){return null==t?ae:(ie||(ie=document.createElementNS("http://www.w3.org/2000/svg","g")),ie.setAttribute("transform",t),(t=ie.transform.baseVal.consolidate())?se((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ae)}),", ",")",")");function ue(t,e){var n,i;return function(){var r=te(this,t),a=r.tween;if(a!==n)for(var s=0,o=(i=n=a).length;s<o;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}function he(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var a=te(this,t),s=a.tween;if(s!==i){r=(i=s).slice();for(var o={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=o;break}l===c&&r.push(o)}a.tween=r}}function de(t,e,n){var i=t._id;return t.each((function(){var t=te(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ee(t,i).value[e]}}function fe(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function pe(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ge(){}var me=.7,ve=1/me,ye="\\s*([+-]?\\d+)\\s*",be="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ce=/^#([0-9a-f]{3,8})$/,$e=new RegExp(`^rgb\\(${ye},${ye},${ye}\\)$`),_e=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),Se=new RegExp(`^rgba\\(${ye},${ye},${ye},${be}\\)$`),xe=new RegExp(`^rgba\\(${we},${we},${we},${be}\\)$`),Ie=new RegExp(`^hsl\\(${be},${we},${we}\\)$`),Ee=new RegExp(`^hsla\\(${be},${we},${we},${be}\\)$`),Te={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function De(){return this.rgb().formatHex()}function Le(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ce.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ae(e):3===n?new Me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Pe(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Pe(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=$e.exec(t))?new Me(e[1],e[2],e[3],1):(e=_e.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Se.exec(t))?Pe(e[1],e[2],e[3],e[4]):(e=xe.exec(t))?Pe(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ie.exec(t))?Ge(e[1],e[2]/100,e[3]/100,1):(e=Ee.exec(t))?Ge(e[1],e[2]/100,e[3]/100,e[4]):Te.hasOwnProperty(t)?Ae(Te[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function Ae(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function Pe(t,e,n,i){return i<=0&&(t=e=n=NaN),new Me(t,e,n,i)}function Fe(t,e,n,i){return 1===arguments.length?function(t){return t instanceof ge||(t=ke(t)),t?new Me((t=t.rgb()).r,t.g,t.b,t.opacity):new Me}(t):new Me(t,e,n,null==i?1:i)}function Me(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Be(){return`#${je(this.r)}${je(this.g)}${je(this.b)}`}function Oe(){const t=He(this.opacity);return`${1===t?"rgb(":"rgba("}${Re(this.r)}, ${Re(this.g)}, ${Re(this.b)}${1===t?")":`, ${t})`}`}function He(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Re(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function je(t){return((t=Re(t))<16?"0":"")+t.toString(16)}function Ge(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ue(t,e,n,i)}function Ne(t){if(t instanceof Ue)return new Ue(t.h,t.s,t.l,t.opacity);if(t instanceof ge||(t=ke(t)),!t)return new Ue;if(t instanceof Ue)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,o=a-r,l=(a+r)/2;return o?(s=e===a?(n-i)/o+6*(n<i):n===a?(i-e)/o+2:(e-n)/o+4,o/=l<.5?a+r:2-a-r,s*=60):o=l>0&&l<1?0:s,new Ue(s,o,l,t.opacity)}function Ue(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function ze(t){return(t=(t||0)%360)<0?t+360:t}function We(t){return Math.max(0,Math.min(1,t||0))}function Ye(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ve(t,e,n,i,r){var a=t*t,s=a*t;return((1-3*t+3*a-s)*e+(4-6*a+3*s)*n+(1+3*t+3*a-3*s)*i+s*r)/6}fe(ge,ke,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:De,formatHex:De,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ne(this).formatHsl()},formatRgb:Le,toString:Le}),fe(Me,Fe,pe(ge,{brighter(t){return t=null==t?ve:Math.pow(ve,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?me:Math.pow(me,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Me(Re(this.r),Re(this.g),Re(this.b),He(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Be,formatHex:Be,formatHex8:function(){return`#${je(this.r)}${je(this.g)}${je(this.b)}${je(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Oe,toString:Oe})),fe(Ue,(function(t,e,n,i){return 1===arguments.length?Ne(t):new Ue(t,e,n,null==i?1:i)}),pe(ge,{brighter(t){return t=null==t?ve:Math.pow(ve,t),new Ue(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?me:Math.pow(me,t),new Ue(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Me(Ye(t>=240?t-240:t+120,r,i),Ye(t,r,i),Ye(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Ue(ze(this.h),We(this.s),We(this.l),He(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=He(this.opacity);return`${1===t?"hsl(":"hsla("}${ze(this.h)}, ${100*We(this.s)}%, ${100*We(this.l)}%${1===t?")":`, ${t})`}`}}));var qe=t=>()=>t;function Ke(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):qe(isNaN(t)?e:t)}var Xe=function t(e){var n=function(t){return 1==(t=+t)?Ke:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):qe(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Fe(t)).r,(e=Fe(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),s=Ke(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function Je(t){return function(e){var n,i,r=e.length,a=new Array(r),s=new Array(r),o=new Array(r);for(n=0;n<r;++n)i=Fe(e[n]),a[n]=i.r||0,s[n]=i.g||0,o[n]=i.b||0;return a=t(a),s=t(s),o=t(o),i.opacity=1,function(t){return i.r=a(t),i.g=s(t),i.b=o(t),i+""}}}Je((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],s=i>0?t[i-1]:2*r-a,o=i<e-1?t[i+2]:2*a-r;return Ve((n-i/e)*e,s,r,a,o)}})),Je((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],s=t[(i+1)%e],o=t[(i+2)%e];return Ve((n-i/e)*e,r,a,s,o)}}));var Qe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ze=new RegExp(Qe.source,"g");function tn(t,e){var n,i,r,a=Qe.lastIndex=Ze.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(n=Qe.exec(t))&&(i=Ze.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),o[s]?o[s]+=r:o[++s]=r),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:ne(n,i)})),a=Ze.lastIndex;return a<e.length&&(r=e.slice(a),o[s]?o[s]+=r:o[++s]=r),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}function en(t,e){var n;return("number"==typeof e?ne:e instanceof ke?Xe:(n=ke(e))?(e=n,Xe):tn)(t,e)}function nn(t){return function(){this.removeAttribute(t)}}function rn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function an(t,e,n){var i,r,a=n+"";return function(){var s=this.getAttribute(t);return s===a?null:s===i?r:r=e(i=s,n)}}function sn(t,e,n){var i,r,a=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===a?null:s===i?r:r=e(i=s,n)}}function on(t,e,n){var i,r,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(o=l+"")?null:s===i&&o===r?a:(r=o,a=e(i=s,l));this.removeAttribute(t)}}function ln(t,e,n){var i,r,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:s===i&&o===r?a:(r=o,a=e(i=s,l));this.removeAttributeNS(t.space,t.local)}}function cn(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function un(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function hn(t,e){return function(){Zt(this,t).delay=+e.apply(this,arguments)}}function dn(t,e){return e=+e,function(){Zt(this,t).delay=e}}function fn(t,e){return function(){te(this,t).duration=+e.apply(this,arguments)}}function pn(t,e){return e=+e,function(){te(this,t).duration=e}}var gn=xt.prototype.constructor;function mn(t){return function(){this.style.removeProperty(t)}}var vn=0;function yn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function bn(){return++vn}var wn=xt.prototype;yn.prototype=function(t){return xt().transition(t)}.prototype={constructor:yn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=p(t));for(var i=this._groups,r=i.length,a=new Array(r),s=0;s<r;++s)for(var o,l,c=i[s],u=c.length,h=a[s]=new Array(u),d=0;d<u;++d)(o=c[d])&&(l=t.call(o,o.__data__,d,c))&&("__data__"in o&&(l.__data__=o.__data__),h[d]=l,Qt(h[d],e,n,d,h,ee(o,n)));return new yn(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=m(t));for(var i=this._groups,r=i.length,a=[],s=[],o=0;o<r;++o)for(var l,c=i[o],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=ee(l,n),g=0,v=f.length;g<v;++g)(d=f[g])&&Qt(d,e,n,g,f,p);a.push(f),s.push(l)}return new yn(a,s,e,n)},selectChild:wn.selectChild,selectChildren:wn.selectChildren,filter:function(t){"function"!=typeof t&&(t=v(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,s=e[r],o=s.length,l=i[r]=[],c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new yn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),s=new Array(i),o=0;o<a;++o)for(var l,c=e[o],u=n[o],h=c.length,d=s[o]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;o<i;++o)s[o]=e[o];return new yn(s,this._parents,this._name,this._id)},selection:function(){return new gn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=bn(),i=this._groups,r=i.length,a=0;a<r;++a)for(var s,o=i[a],l=o.length,c=0;c<l;++c)if(s=o[c]){var u=ee(s,e);Qt(s,t,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new yn(i,this._parents,t,n)},call:wn.call,nodes:wn.nodes,node:wn.node,size:wn.size,empty:wn.empty,each:wn.each,on:function(t,e){var n=this._id;return arguments.length<2?ee(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Zt:te;return function(){var s=a(this,t),o=s.on;o!==i&&(r=(i=o).copy()).on(e,n),s.on=r}}(n,t,e))},attr:function(t,e){var n=P(t),i="transform"===n?ce:en;return this.attrTween(t,"function"==typeof e?(n.local?ln:on)(n,i,de(this,"attr."+t,e)):null==e?(n.local?rn:nn)(n):(n.local?sn:an)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=P(t);return this.tween(n,(i.local?cn:un)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?le:en;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var a=z(this,t),s=(this.style.removeProperty(t),z(this,t));return a===s?null:a===n&&s===i?r:r=e(n=a,i=s)}}(t,i)).on("end.style."+t,mn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,a;return function(){var s=z(this,t),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=z(this,t)),s===l?null:s===i&&l===r?a:(r=l,a=e(i=s,o))}}(t,i,de(this,"style."+t,e))).each(function(t,e){var n,i,r,a,s="style."+e,o="end."+s;return function(){var l=te(this,t),c=l.on,u=null==l.value[s]?a||(a=mn(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(o,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,a=n+"";return function(){var s=z(this,t);return s===a?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function a(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,a,n)),i}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(de(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=ee(this.node(),n).tween,a=0,s=r.length;a<s;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((null==e?ue:he)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?hn:dn)(e,t)):ee(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?fn:pn)(e,t)):ee(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){te(this,t).ease=e}}(e,t)):ee(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;te(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(a,s){var o={value:s},l={value:function(){0==--r&&a()}};n.each((function(){var n=te(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e})),0===r&&a()}))},[Symbol.iterator]:wn[Symbol.iterator]};var Cn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function $n(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}xt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,a=t.__transition,s=!0;if(a){for(r in e=null==e?null:e+"",a)(n=a[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[r]):s=!1;s&&delete t.__transition}}(this,t)}))},xt.prototype.transition=function(t){var e,n;t instanceof yn?(e=t._id,t=t._name):(e=bn(),(n=Cn).time=Nt(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var s,o=i[a],l=o.length,c=0;c<l;++c)(s=o[c])&&Qt(s,t,e,c,o,n||$n(s,e));return new yn(i,this._parents,t,e)};const{abs:_n,max:Sn,min:xn}=Math;function In(t){return{type:t}}function En(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Tn(t){return(t=En(Math.abs(t)))?t[1]:NaN}["w","e"].map(In),["n","s"].map(In),["n","w","e","s","nw","ne","sw","se"].map(In);var Dn,Ln=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kn(t){if(!(e=Ln.exec(t)))throw new Error("invalid format: "+t);var e;return new An({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function An(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Pn(t,e){var n=En(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}kn.prototype=An.prototype,An.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Fn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Pn(100*t,e),r:Pn,s:function(t,e){var n=En(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Dn=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+En(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Mn(t){return t}var Bn,On,Hn,Rn=Array.prototype.map,jn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Gn(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Mn:(e=Rn.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],s=0,o=e[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),a.push(t.substring(r-=o,r+o)),!((l+=o+1)>i));)o=e[s=(s+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?Mn:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Rn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=kn(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):Fn[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===d?a:/[%p]/.test(y)?l:"",C=Fn[y],$=/[defgprs%]/.test(y);function _(t){var r,a,l,d=b,_=w;if("c"===y)_=C(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:C(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,_=("s"===y?jn[8+Dn/3]:"")+_+(S&&"("===h?")":""),$)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){_=(46===l?s+t.slice(r+1):t.slice(r))+_,t=t.slice(0,r);break}}g&&!f&&(t=i(t,1/0));var x=d.length+t.length+_.length,I=x<p?new Array(p-x+1).join(e):"";switch(g&&f&&(t=i(I+t,I.length?p-_.length:1/0),I=""),n){case"<":t=d+t+_+I;break;case"=":t=d+I+t+_;break;case"^":t=I.slice(0,x=I.length>>1)+d+t+_+I.slice(x);break;default:t=I+d+t+_}return o(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=kn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Tn(e)/3))),r=Math.pow(10,-i),a=jn[8+i/3];return function(t){return n(r*t)+a}}}}Bn=Gn({thousands:",",grouping:[3],currency:["$",""]}),On=Bn.format,Hn=Bn.formatPrefix;const Nn=Math.sqrt(50),Un=Math.sqrt(10),zn=Math.sqrt(2);function Wn(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),a=i/Math.pow(10,r),s=a>=Nn?10:a>=Un?5:a>=zn?2:1;let o,l,c;return r<0?(c=Math.pow(10,-r)/s,o=Math.round(t*c),l=Math.round(e*c),o/c<t&&++o,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*s,o=Math.round(t/c),l=Math.round(e/c),o*c<t&&++o,l*c>e&&--l),l<o&&.5<=n&&n<2?Wn(t,e,2*n):[o,l,c]}function Yn(t,e,n){return Wn(t=+t,e=+e,n=+n)[2]}function Vn(t,e,n){n=+n;const i=(e=+e)<(t=+t),r=i?Yn(e,t,n):Yn(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function qn(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Kn(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xn(t){let e,n,i;function r(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<0?r=e+1:a=e}while(r<a)}return r}return 2!==t.length?(e=qn,n=(e,n)=>qn(t(e),n),i=(e,n)=>t(e)-n):(e=t===qn||t===Kn?t:Jn,n=t,i=t),{left:r,center:function(t,e,n=0,a=t.length){const s=r(t,e,n,a-1);return s>n&&i(t[s-1],e)>-i(t[s],e)?s-1:s},right:function(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<=0?r=e+1:a=e}while(r<a)}return r}}}function Jn(){return 0}const Qn=Xn(qn),Zn=Qn.right;Qn.left,Xn((function(t){return null===t?NaN:+t})).center;var ti=Zn;function ei(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),s=new Array(i);for(n=0;n<r;++n)a[n]=ai(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=a[n](t);return s}}function ni(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function ii(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=ai(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}function ri(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}}function ai(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?qe(e):("number"===r?ne:"string"===r?(n=ke(e))?(e=n,Xe):tn:e instanceof ke?Xe:e instanceof Date?ni:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?ei:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ii:ne:ri))(t,e)}function si(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function oi(t){return+t}var li=[0,1];function ci(t){return t}function ui(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function hi(t,e,n){var i=t[0],r=t[1],a=e[0],s=e[1];return r<i?(i=ui(r,i),a=n(s,a)):(i=ui(i,r),a=n(a,s)),function(t){return a(i(t))}}function di(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=ui(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(e){var n=ti(t,e,1,i)-1;return a[n](r[n](e))}}function fi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function pi(){return function(){var t,e,n,i,r,a,s=li,o=li,l=ai,c=ci;function u(){var t,e,n,l=Math.min(s.length,o.length);return c!==ci&&(t=s[0],e=s[l-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?di:hi,r=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(r||(r=i(s.map(t),o,l)))(t(c(e)))}return h.invert=function(n){return c(e((a||(a=i(o,s.map(t),ne)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,oi),u()):s.slice()},h.range=function(t){return arguments.length?(o=Array.from(t),u()):o.slice()},h.rangeRound=function(t){return o=Array.from(t),l=si,u()},h.clamp=function(t){return arguments.length?(c=!!t||ci,u()):c!==ci},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}()(ci,ci)}function gi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function mi(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const i=e<t,[r,a,s]=i?Wn(e,t,n):Wn(t,e,n);if(!(a>=r))return[];const o=a-r+1,l=new Array(o);if(i)if(s<0)for(let t=0;t<o;++t)l[t]=(a-t)/-s;else for(let t=0;t<o;++t)l[t]=(a-t)*s;else if(s<0)for(let t=0;t<o;++t)l[t]=(r+t)/-s;else for(let t=0;t<o;++t)l[t]=(r+t)*s;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return function(t,e,n,i){var r,a=Vn(t,e,n);switch((i=kn(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Tn(e)/3)))-Tn(Math.abs(t)))}(a,s))||(i.precision=r),Hn(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Tn(e)-Tn(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Tn(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return On(i)}(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,a=e(),s=0,o=a.length-1,l=a[s],c=a[o],u=10;for(c<l&&(r=l,l=c,c=r,r=s,s=o,o=r);u-- >0;){if((r=Yn(l,c,n))===i)return a[s]=l,a[o]=c,e(a);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return t},t}function vi(){var t=pi();return t.copy=function(){return fi(t,vi())},gi.apply(t,arguments),mi(t)}const yi=1e3,bi=6e4,wi=36e5,Ci=864e5,$i=6048e5,_i=31536e6,Si=new Date,xi=new Date;function Ii(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=e=>(t(e=new Date(+e)),e),r.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),r.round=t=>{const e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),r.range=(n,i,a)=>{const s=[];if(n=r.ceil(n),a=null==a?1:Math.floor(a),!(n<i&&a>0))return s;let o;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<i);return s},r.filter=n=>Ii((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,i)=>{if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););})),n&&(r.count=(e,i)=>(Si.setTime(+e),xi.setTime(+i),t(Si),t(xi),Math.floor(n(Si,xi))),r.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?e=>i(e)%t==0:e=>r.count(0,e)%t==0):r:null)),r}const Ei=Ii((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t));Ei.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?Ii((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):Ei:null),Ei.range;const Ti=Ii((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*yi)}),((t,e)=>(e-t)/yi),(t=>t.getUTCSeconds())),Di=(Ti.range,Ii((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yi)}),((t,e)=>{t.setTime(+t+e*bi)}),((t,e)=>(e-t)/bi),(t=>t.getMinutes()))),Li=(Di.range,Ii((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*bi)}),((t,e)=>(e-t)/bi),(t=>t.getUTCMinutes()))),ki=(Li.range,Ii((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yi-t.getMinutes()*bi)}),((t,e)=>{t.setTime(+t+e*wi)}),((t,e)=>(e-t)/wi),(t=>t.getHours()))),Ai=(ki.range,Ii((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*wi)}),((t,e)=>(e-t)/wi),(t=>t.getUTCHours()))),Pi=(Ai.range,Ii((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*bi)/Ci),(t=>t.getDate()-1))),Fi=(Pi.range,Ii((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Ci),(t=>t.getUTCDate()-1))),Mi=(Fi.range,Ii((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Ci),(t=>Math.floor(t/Ci))));function Bi(t){return Ii((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*bi)/$i))}Mi.range;const Oi=Bi(0),Hi=Bi(1),Ri=Bi(2),ji=Bi(3),Gi=Bi(4),Ni=Bi(5),Ui=Bi(6);function zi(t){return Ii((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/$i))}Oi.range,Hi.range,Ri.range,ji.range,Gi.range,Ni.range,Ui.range;const Wi=zi(0),Yi=zi(1),Vi=zi(2),qi=zi(3),Ki=zi(4),Xi=zi(5),Ji=zi(6),Qi=(Wi.range,Yi.range,Vi.range,qi.range,Ki.range,Xi.range,Ji.range,Ii((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth()))),Zi=(Qi.range,Ii((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),tr=(Zi.range,Ii((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));tr.every=t=>isFinite(t=Math.floor(t))&&t>0?Ii((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null,tr.range;const er=Ii((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));function nr(t,e,n,i,r,a){const s=[[Ti,1,yi],[Ti,5,5e3],[Ti,15,15e3],[Ti,30,3e4],[a,1,bi],[a,5,3e5],[a,15,9e5],[a,30,18e5],[r,1,wi],[r,3,108e5],[r,6,216e5],[r,12,432e5],[i,1,Ci],[i,2,1728e5],[n,1,$i],[e,1,2592e6],[e,3,7776e6],[t,1,_i]];function o(e,n,i){const r=Math.abs(n-e)/i,a=Xn((([,,t])=>t)).right(s,r);if(a===s.length)return t.every(Vn(e/_i,n/_i,i));if(0===a)return Ei.every(Math.max(Vn(e,n,i),1));const[o,l]=s[r/s[a-1][2]<s[a][2]/r?a-1:a];return o.every(l)}return[function(t,e,n){const i=e<t;i&&([t,e]=[e,t]);const r=n&&"function"==typeof n.range?n:o(t,e,n),a=r?r.range(t,+e+1):[];return i?a.reverse():a},o]}er.every=t=>isFinite(t=Math.floor(t))&&t>0?Ii((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null,er.range;const[ir,rr]=nr(er,Zi,Wi,Mi,Ai,Li),[ar,sr]=nr(tr,Qi,Oi,Pi,ki,Di);function or(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function lr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function cr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ur(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,c=wr(r),u=Cr(r),h=wr(a),d=Cr(a),f=wr(s),p=Cr(s),g=wr(o),m=Cr(o),v=wr(l),y=Cr(l),b={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return o[t.getMonth()]},c:null,d:Nr,e:Nr,f:Vr,g:ra,G:sa,H:Ur,I:zr,j:Wr,L:Yr,m:qr,M:Kr,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Da,s:La,S:Xr,u:Jr,U:Qr,V:ta,w:ea,W:na,x:null,X:null,y:ia,Y:aa,Z:oa,"%":Ta},w={a:function(t){return s[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return o[t.getUTCMonth()]},c:null,d:la,e:la,f:fa,g:Sa,G:Ia,H:ca,I:ua,j:ha,L:da,m:pa,M:ga,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Da,s:La,S:ma,u:va,U:ya,V:wa,w:Ca,W:$a,x:null,X:null,y:_a,Y:xa,Z:Ea,"%":Ta},C={a:function(t,e,n){var i=f.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=d.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=y.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,n,i){return S(t,e,n,i)},d:Ar,e:Ar,f:Hr,g:Tr,G:Er,H:Fr,I:Fr,j:Pr,L:Or,m:kr,M:Mr,p:function(t,e,n){var i=c.exec(e.slice(n));return i?(t.p=u.get(i[0].toLowerCase()),n+i[0].length):-1},q:Lr,Q:jr,s:Gr,S:Br,u:_r,U:Sr,V:xr,w:$r,W:Ir,x:function(t,e,i){return S(t,n,e,i)},X:function(t,e,n){return S(t,i,e,n)},y:Tr,Y:Er,Z:Dr,"%":Rr};function $(t,e){return function(n){var i,r,a,s=[],o=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++o<c;)37===t.charCodeAt(o)&&(s.push(t.slice(l,o)),null!=(r=pr[i=t.charAt(++o)])?i=t.charAt(++o):r="e"===i?" ":"0",(a=e[i])&&(i=a(n,r)),s.push(i),l=o+1);return s.push(t.slice(l,o)),s.join("")}}function _(t,e){return function(n){var i,r,a=cr(1900,void 0,1);if(S(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(i=lr(cr(a.y,0,1))).getUTCDay(),i=r>4||0===r?Yi.ceil(i):Yi(i),i=Fi.offset(i,7*(a.V-1)),a.y=i.getUTCFullYear(),a.m=i.getUTCMonth(),a.d=i.getUTCDate()+(a.w+6)%7):(r=(i=or(cr(a.y,0,1))).getDay(),i=r>4||0===r?Hi.ceil(i):Hi(i),i=Pi.offset(i,7*(a.V-1)),a.y=i.getFullYear(),a.m=i.getMonth(),a.d=i.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),r="Z"in a?lr(cr(a.y,0,1)).getUTCDay():or(cr(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(r+5)%7:a.w+7*a.U-(r+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,lr(a)):or(a)}}function S(t,e,n,i){for(var r,a,s=0,o=e.length,l=n.length;s<o;){if(i>=l)return-1;if(37===(r=e.charCodeAt(s++))){if(r=e.charAt(s++),!(a=C[r in pr?e.charAt(s++):r])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return b.x=$(n,b),b.X=$(i,b),b.c=$(e,b),w.x=$(n,w),w.X=$(i,w),w.c=$(e,w),{format:function(t){var e=$(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=$(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var hr,dr,fr,pr={"-":"",_:" ",0:"0"},gr=/^\s*\d+/,mr=/^%/,vr=/[\\^$*+?|[\]().{}]/g;function yr(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function br(t){return t.replace(vr,"\\$&")}function wr(t){return new RegExp("^(?:"+t.map(br).join("|")+")","i")}function Cr(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function $r(t,e,n){var i=gr.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function _r(t,e,n){var i=gr.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Sr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function xr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Ir(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Er(t,e,n){var i=gr.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Tr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Dr(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Lr(t,e,n){var i=gr.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function kr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Ar(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Pr(t,e,n){var i=gr.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Fr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Mr(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Br(t,e,n){var i=gr.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Or(t,e,n){var i=gr.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Hr(t,e,n){var i=gr.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Rr(t,e,n){var i=mr.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function jr(t,e,n){var i=gr.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Gr(t,e,n){var i=gr.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Nr(t,e){return yr(t.getDate(),e,2)}function Ur(t,e){return yr(t.getHours(),e,2)}function zr(t,e){return yr(t.getHours()%12||12,e,2)}function Wr(t,e){return yr(1+Pi.count(tr(t),t),e,3)}function Yr(t,e){return yr(t.getMilliseconds(),e,3)}function Vr(t,e){return Yr(t,e)+"000"}function qr(t,e){return yr(t.getMonth()+1,e,2)}function Kr(t,e){return yr(t.getMinutes(),e,2)}function Xr(t,e){return yr(t.getSeconds(),e,2)}function Jr(t){var e=t.getDay();return 0===e?7:e}function Qr(t,e){return yr(Oi.count(tr(t)-1,t),e,2)}function Zr(t){var e=t.getDay();return e>=4||0===e?Gi(t):Gi.ceil(t)}function ta(t,e){return t=Zr(t),yr(Gi.count(tr(t),t)+(4===tr(t).getDay()),e,2)}function ea(t){return t.getDay()}function na(t,e){return yr(Hi.count(tr(t)-1,t),e,2)}function ia(t,e){return yr(t.getFullYear()%100,e,2)}function ra(t,e){return yr((t=Zr(t)).getFullYear()%100,e,2)}function aa(t,e){return yr(t.getFullYear()%1e4,e,4)}function sa(t,e){var n=t.getDay();return yr((t=n>=4||0===n?Gi(t):Gi.ceil(t)).getFullYear()%1e4,e,4)}function oa(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+yr(e/60|0,"0",2)+yr(e%60,"0",2)}function la(t,e){return yr(t.getUTCDate(),e,2)}function ca(t,e){return yr(t.getUTCHours(),e,2)}function ua(t,e){return yr(t.getUTCHours()%12||12,e,2)}function ha(t,e){return yr(1+Fi.count(er(t),t),e,3)}function da(t,e){return yr(t.getUTCMilliseconds(),e,3)}function fa(t,e){return da(t,e)+"000"}function pa(t,e){return yr(t.getUTCMonth()+1,e,2)}function ga(t,e){return yr(t.getUTCMinutes(),e,2)}function ma(t,e){return yr(t.getUTCSeconds(),e,2)}function va(t){var e=t.getUTCDay();return 0===e?7:e}function ya(t,e){return yr(Wi.count(er(t)-1,t),e,2)}function ba(t){var e=t.getUTCDay();return e>=4||0===e?Ki(t):Ki.ceil(t)}function wa(t,e){return t=ba(t),yr(Ki.count(er(t),t)+(4===er(t).getUTCDay()),e,2)}function Ca(t){return t.getUTCDay()}function $a(t,e){return yr(Yi.count(er(t)-1,t),e,2)}function _a(t,e){return yr(t.getUTCFullYear()%100,e,2)}function Sa(t,e){return yr((t=ba(t)).getUTCFullYear()%100,e,2)}function xa(t,e){return yr(t.getUTCFullYear()%1e4,e,4)}function Ia(t,e){var n=t.getUTCDay();return yr((t=n>=4||0===n?Ki(t):Ki.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ea(){return"+0000"}function Ta(){return"%"}function Da(t){return+t}function La(t){return Math.floor(+t/1e3)}function ka(t){return new Date(t)}function Aa(t){return t instanceof Date?+t:+new Date(+t)}function Pa(t,e,n,i,r,a,s,o,l,c){var u=pi(),h=u.invert,d=u.domain,f=c(".%L"),p=c(":%S"),g=c("%I:%M"),m=c("%I %p"),v=c("%a %d"),y=c("%b %d"),b=c("%B"),w=c("%Y");function C(t){return(l(t)<t?f:o(t)<t?p:s(t)<t?g:a(t)<t?m:i(t)<t?r(t)<t?v:y:n(t)<t?b:w)(t)}return u.invert=function(t){return new Date(h(t))},u.domain=function(t){return arguments.length?d(Array.from(t,Aa)):d().map(ka)},u.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},u.tickFormat=function(t,e){return null==e?C:c(e)},u.nice=function(t){var n=d();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(function(t,e){var n,i=0,r=(t=t.slice()).length-1,a=t[i],s=t[r];return s<a&&(n=i,i=r,r=n,n=a,a=s,s=n),t[i]=e.floor(a),t[r]=e.ceil(s),t}(n,t)):u},u.copy=function(){return fi(u,Pa(t,e,n,i,r,a,s,o,l,c))},u}function Fa(){return gi.apply(Pa(ar,sr,tr,Qi,Oi,Pi,ki,Di,Ti,dr).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ma(t){return"string"==typeof t?new _t([[document.querySelector(t)]],[document.documentElement]):new _t([[t]],$t)}function Ba(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Oa(t){return function(){return t}}function Ha(t){this._context=t}function Ra(t){return new Ha(t)}hr=ur({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),dr=hr.format,fr=hr.parse,hr.utcFormat,hr.utcParse,Array.prototype.slice,Ha.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const ja=Math.PI,Ga=2*ja,Na=1e-6,Ua=Ga-Na;function za(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Wa{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?za:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return za;const n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,r,a){this._append`C${+t},${+e},${+n},${+i},${this._x1=+r},${this._y1=+a}`}arcTo(t,e,n,i,r){if(t=+t,e=+e,n=+n,i=+i,(r=+r)<0)throw new Error(`negative radius: ${r}`);let a=this._x1,s=this._y1,o=n-t,l=i-e,c=a-t,u=s-e,h=c*c+u*u;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>Na)if(Math.abs(u*o-l*c)>Na&&r){let d=n-a,f=i-s,p=o*o+l*l,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),y=r*Math.tan((ja-Math.acos((p+h-g)/(2*m*v)))/2),b=y/v,w=y/m;Math.abs(b-1)>Na&&this._append`L${t+b*c},${e+b*u}`,this._append`A${r},${r},0,0,${+(u*d>c*f)},${this._x1=t+w*o},${this._y1=e+w*l}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,i,r,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),o=n*Math.sin(i),l=t+s,c=e+o,u=1^a,h=a?i-r:r-i;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Na||Math.abs(this._y1-c)>Na)&&this._append`L${l},${c}`,n&&(h<0&&(h=h%Ga+Ga),h>Ua?this._append`A${n},${n},0,1,${u},${t-s},${e-o}A${n},${n},0,1,${u},${this._x1=l},${this._y1=c}`:h>Na&&this._append`A${n},${n},0,${+(h>=ja)},${u},${this._x1=t+n*Math.cos(r)},${this._y1=e+n*Math.sin(r)}`)}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function Ya(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new Wa(e)}function Va(t){return t[0]}function qa(t){return t[1]}function Ka(t,e){var n=Oa(!0),i=null,r=Ra,a=null,s=Ya(o);function o(o){var l,c,u,h=(o=Ba(o)).length,d=!1;for(null==i&&(a=r(u=s())),l=0;l<=h;++l)!(l<h&&n(c=o[l],l,o))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(c,l,o),+e(c,l,o));if(u)return a=null,u+""||null}return t="function"==typeof t?t:void 0===t?Va:Oa(t),e="function"==typeof e?e:void 0===e?qa:Oa(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:Oa(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Oa(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Oa(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(a=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=a=null:a=r(i=t),o):i},o}function Xa(t,e,n){this.k=t,this.x=e,this.y=n}function Ja(){Ja=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==as(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(as(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function Qa(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function Za(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){Qa(a,i,r,s,o,"next",t)}function o(t){Qa(a,i,r,s,o,"throw",t)}s(void 0)}))}}function ts(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||is(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function es(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=is(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function ns(t){return function(t){if(Array.isArray(t))return rs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||is(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function is(t,e){if(t){if("string"==typeof t)return rs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rs(t,e):void 0}}function rs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function as(t){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as(t)}Xa.prototype={constructor:Xa,scale:function(t){return 1===t?this:new Xa(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Xa(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Xa(1,0,0),Xa.prototype;var ss,os,ls,cs,us=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi;if(jQuery.htmlPrefilter=function(t){return t.replace(us,"<$1></$2>")},$.extend(Craft,{navHeight:48,isIterable:function(t){return t&&"function"==typeof t[Symbol.iterator]},index:function(t,e){if(t instanceof NodeList||this.isIterable(t))t=Array.from(t);else if(!Array.isArray(t))throw"The first argument passed to Craft.index() must be an array, NodeList, or iterable object.";if("string"==typeof e){var n=e;e=function(t){return t[n]}}return Object.fromEntries(t.map((function(t){return[e(t),t]})))},group:function(t,e){if(!Array.isArray(t))throw"The first argument passed to Craft.group() must be an array.";var n={};return t.reduce((function(t,i,r){var a="string"==typeof e?i[e]:e(i,r);return n.hasOwnProperty(a)||(n[a]=[[],a],t.push(n[a])),n[a][0].push(i),t}),[])},t:function(t,e,n){return void 0!==Craft.translations[t]&&void 0!==Craft.translations[t][e]&&(e=Craft.translations[t][e]),n?this.formatMessage(e,n):e},formatMessage:function(t,e){var n;if(!1===(n=this._tokenizePattern(t)))throw"Message pattern is invalid.";for(var i=0;i<n.length;i++){var r=n[i];if("object"===as(r)&&!1===(n[i]=this._parseToken(r,e)))throw"Message pattern is invalid."}return n.join("")},_tokenizePattern:function(t){var e,n,i=1,r=ns(t);if(-1===(e=n=r.indexOf("{")))return[t];for(var a=[r.slice(0,n).join("")];;){var s=r.indexOf("{",n+1),o=r.indexOf("}",n+1);if(-1===s&&(s=!1),-1===o&&(o=!1),!1===s&&!1===o)break;if(!1===s&&(s=r.length),o>s?(i++,n=s):(i--,n=o),0===i&&(a.push(r.slice(e+1,n).join("").split(",",3)),e=n+1,a.push(r.slice(e,s).join("")),e=s),0!==i&&(!1===s||!1===o))break}return 0===i&&a},_parseToken:function(t,e){var n=this,i=t[0].trim();if(void 0===e[i])return"{".concat(t.join(","),"}");var r=e[i],a=void 0!==t[1]?t[1].trim():"none";switch(a){case"number":return function(){var e=void 0!==t[2]?t[2].trim():null;if(null!==e&&"integer"!==e)throw"Message format 'number' is only supported for integer values.";var n,i=Craft.formatNumber(r);return null===e&&-1!==(n="".concat(r).indexOf("."))&&(i+=".".concat(r.substring(n+1))),i}();case"none":return r;case"select":return function(){if(void 0===t[2])return!1;for(var i=n._tokenizePattern(t[2]),a=i.length,s=!1,o=0;o+1<a;o++){if(Array.isArray(i[o])||!Array.isArray(i[o+1]))return!1;var l=i[o++].trim();(!1===s&&"other"===l||l==r)&&(s=i[o].join(","))}return!1!==s&&n.formatMessage(s,e)}();case"plural":return function(){if(void 0===t[2])return!1;for(var i=n._tokenizePattern(t[2]),a=i.length,s=!1,o=0,l=0;l+1<a;l++){if("object"===as(i[l])||"object"!==as(i[l+1]))return!1;var c=i[l++].trim(),u=ns(c);if(1===l&&"offset:"===c.substring(0,7)){var h=ns(c.replace(/[\n\r\t]/g," ")).indexOf(" ",7);if(-1===h)throw"Message pattern is invalid.";o=parseInt(u.slice(7,h).join("").trim()),c=u.slice(h+1,h+1+u.length).join("").trim()}(!1===s&&"other"===c||"="===c[0]&&parseInt(u.slice(1,1+u.length).join(""))===r||"one"===c&&r-o==1)&&(s=("string"==typeof i[l]?[i[l]]:i[l]).map((function(t){return t.replace("#",r-o)})).join(","))}return!1!==s&&n.formatMessage(s,e)}();default:throw"Message format '".concat(a,"' is not supported.")}},formatDate:function(t){return"object"!==as(t)&&(t=new Date(t)),$.datepicker.formatDate(Craft.datepickerOptions.dateFormat,t)},formatNumber:function(t,e){return void 0===e&&(e=",.0f"),Gn(d3FormatLocaleDefinition).format(e)(t)},shortcutText:function(t,e,n){return"Mac"===Craft.clientOs?(n?"⌥":"")+(e?"⇧":"")+"⌘"+t:"Ctrl+"+(n?"Alt+":"")+(e?"Shift+":"")+t},escapeHtml:function(t){return $("<div/>").text(t).html()},escapeRegex:function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getText:function(t){return $("<div/>").html(t).text()},encodeUriComponent:function(t){t=encodeURIComponent(t);var e={"!":"%21","*":"%2A","'":"%27","(":"%28",")":"%29"};for(var n in e){var i=new RegExp("\\"+n,"g");t=t.replace(i,e[n])}return t},selectFullValue:function(t){var e=$(t),n=e.val();if(void 0!==e[0].setSelectionRange){var i=2*n.length;e[0].setSelectionRange(0,i)}else e.val(n)},formatInputId:function(t){var e=t.replace(/^[^A-Za-z]+/,"");return(e=this.rtrim(e.replace(/[^A-Za-z0-9_.]+/g,"-"),"-"))||this.randomString(10)},sleep:function(t){return new Promise((function(e){setTimeout(e,t)}))},getUrl:function(t,e,n){"string"!=typeof t&&(t="");var i=null;if($.isPlainObject(e))void 0!==e["#"]&&(i=e["#"],delete e["#"]);else if("string"==typeof e){var r=e.indexOf("#");-1!==r&&(i=e.substring(r+1),e=e.substring(0,r)),e=Object.fromEntries(new URLSearchParams(e).entries())}else e={};var a=t.indexOf("#");-1!==a&&(i||(i=t.substring(a+1)),t=t.substring(0,a));var s,o,l=t.indexOf("?");if(-1!==l&&(e=$.extend(Object.fromEntries(new URLSearchParams(t.substring(l+1)).entries()),e),t=t.substring(0,l)),-1!==t.search("://")||"/"===t[0])return t+($.isEmptyObject(e)?"":"?".concat($.param(e)))+(i?"#".concat(i):"");if(t=Craft.trim(t,"/"),n){if(s=n,t&&Craft.pathParam){var c=s.match(new RegExp("[&?]"+Craft.escapeRegex(Craft.pathParam)+"=[^&]+"));c&&(s=s.replace(c[0],Craft.rtrim(c[0],"/")+"/"+t),t="")}}else s=Craft.baseUrl;return-1!==(l=s.indexOf("?"))&&(o=Object.fromEntries(new URLSearchParams(s.substring(l+1)).entries()),s=s.substring(0,l),e=Object.assign({},o,e)),!Craft.omitScriptNameInUrls&&t&&(Craft.usePathInfo||!Craft.pathParam?-1===s.search(Craft.scriptName)&&(s=Craft.rtrim(s,"/")+"/"+Craft.scriptName):(o&&void 0!==o[Craft.pathParam]&&(t=o[Craft.pathParam].trimEnd()+(t?"/"+t:"")),e[Craft.pathParam]=t,t=null)),t&&(s=Craft.rtrim(s,"/")+"/"+t),$.isEmptyObject(e)||(s+="?".concat($.param(e))),i&&(s+="#".concat(i)),s},getCpUrl:function(t,e){if(!Craft.baseCpUrl)throw"Craft.baseCpUrl is undefined.";return this.getUrl(t,e,Craft.baseCpUrl)},getSiteUrl:function(t,e){return this.getUrl(t,e,Craft.baseSiteUrl)},getActionUrl:function(t,e){return Craft.getUrl(t,e,Craft.actionUrl)},redirectTo:function(t){document.location.href=this.getUrl(t)},setUrl:function(t){if("undefined"!=typeof history){t.match(/#/)||(t+=document.location.hash),history.replaceState({},"",t);var e,n=es(document.querySelectorAll("#site-crumb-menu a[href]"));try{for(n.s();!(e=n.n()).done;){var i=e.value,r=this.getQueryParam("site",i.href);i.href=this.getUrl(t,{site:r})}}catch(t){n.e(t)}finally{n.f()}}},setPath:function(t){this.path=t,this.setUrl(Craft.getUrl(t,document.location.search))},setQueryParam:function(t,e){var n=document.location.origin+document.location.pathname,i=this.getQueryParams();null!=e&&!1!==e?i[t]=e:delete i[t],this.setUrl(Craft.getUrl(n,i))},getPageUrl:function(t){var e=document.location.origin+document.location.pathname;e=Craft.rtrim(e,"/");var n=document.location.search?document.location.search.substring(1):"";if("?"===Craft.pageTrigger[0]){var i=Craft.pageTrigger.substring(1);if(document.location.search){var r=Object.fromEntries(new URLSearchParams(n).entries());delete r[i],n=$.param(r)}1!==t&&(n+=(""!==n?"&":"")+"".concat(i,"=").concat(t))}else e=e.replace(new RegExp("/"+Craft.escapeRegex(Craft.pageTrigger)+"\\d+$"),""),1!==t&&(e+="/".concat(Craft.pageTrigger).concat(t));return e+(n?"?".concat(n):"")+document.location.hash},getCsrfInput:function(){return Craft.csrfTokenName?'<input type="hidden" name="'+Craft.csrfTokenName+'" value="'+Craft.csrfTokenValue+'"/>':""},postActionRequest:function(t,e,n,i){"function"==typeof e&&(i=n,n=e,e={}),(i=i||{}).contentType&&i.contentType.match(/\bjson\b/)&&("object"===as(e)&&(e=JSON.stringify(e)),i.contentType="application/json; charset=utf-8");var r=$.ajax($.extend({url:Craft.getActionUrl(t),type:"POST",dataType:"json",headers:this._actionHeaders(),data:e,success:n,error:function(t,e,i){4===t.readyState&&(400!==t.status&&(void 0!==Craft.cp?Craft.cp.displayError():alert(Craft.t("app","A server error occurred."))),n&&n(400===t.status?t.responseJSON:null,e,t))}},i));return"function"==typeof i.send&&i.send(r),r},_actionHeaders:function(){var t={"X-Registered-Asset-Bundles":ns(new Set(Craft.registeredAssetBundles)).join(","),"X-Registered-Js-Files":ns(new Set(Craft.registeredJsFiles)).join(",")};return Craft.csrfTokenValue&&(t["X-CSRF-Token"]=Craft.csrfTokenValue),t},sendActionRequest:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if($.isPlainObject(e)&&(i=e,e=null),"POST"===t.toUpperCase()&&e&&i.data)if("string"==typeof i.data){var r=i&&i.headers&&i.headers["X-Craft-Namespace"],a=this.namespaceInputName("action",r);i.data+="&".concat(a,"=").concat(e)}else delete i.data.action;return new Promise((function(r,a){(i=i?$.extend({},i):{}).method=t,i.url=e?Craft.getActionUrl(e):Craft.getCpUrl(),i.headers=$.extend({"X-Requested-With":"XMLHttpRequest"},i.headers||{},n._actionHeaders()),i.params=$.extend({},i.params||{},{v:(new Date).getTime()}),axios.request(i).then((function(t){t.headers["x-csrf-token"]&&(Craft.csrfTokenValue=t.headers["x-csrf-token"]),r(t)})).catch(a)}))},sendApiRequest:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,a){var s=(i=i?$.extend({},i):{}).cancelToken||null;n._getApiHeaders(s).then((function(o){i.method=t,i.baseURL=Craft.baseApiUrl,i.url=e,i.headers=$.extend(o,i.headers||{}),i.params=$.extend(Craft.apiParams||{},i.params||{},{v:(new Date).getTime()}),n._apiHeaders||(i.params.processCraftHeaders=1),Craft.httpProxy&&(i.proxy=Craft.httpProxy),axios.request(i).then((function(t){n._processApiHeaders(t.headers,s).then((function(){r(t.data)})).catch(a)})).catch(a)})).catch(a)}))},_loadingApiHeaders:!1,_apiHeaders:null,_apiHeaderWaitlist:[],_getApiHeaders:function(t){var n=this;return new Promise((function(i,r){n._loadingApiHeaders?n._apiHeaderWaitlist.push([i,r]):n._apiHeaders?i(n._apiHeaders):(n._loadingApiHeaders=!0,n.sendActionRequest("POST","app/api-headers",{cancelToken:t}).then((function(t){n._loadingApiHeaders?i(t.data):r(e)})).catch((function(t){n._rejectApiRequests(r,t)})))}))},_processApiHeaders:function(t,n){var i=this;return new Promise((function(r,a){i._apiHeaders?r():i.sendActionRequest("POST","app/process-api-response-headers",{data:{headers:t},cancelToken:n}).then((function(t){if(i._loadingApiHeaders)for(i._apiHeaders=t.data,i._loadingApiHeaders=!1,r();i._apiHeaderWaitlist.length;)i._apiHeaderWaitlist.shift()[0](i._apiHeaders);else a(e)})).catch((function(t){i._rejectApiRequests(a,t)}))}))},_rejectApiRequests:function(t,e){for(this._loadingApiHeaders=!1,t(e);this._apiHeaderWaitlist.length;)this._apiHeaderWaitlist.shift()[1](e)},clearCachedApiHeaders:function(){for(this._apiHeaders=null,this._loadingApiHeaders=!1;this._apiHeaderWaitlist.length;)this._apiHeaderWaitlist.shift()[1]()},downloadFromUrl:function(t,e,n){return new Promise((function(i,r){var a=new XMLHttpRequest;a.open(t,e,!0),"object"===as(n)?(a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n=JSON.stringify(n)):a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.responseType="blob",a.onload=function(){if(200===a.status){var t=a.getResponseHeader("content-disposition"),e=/"([^"]*)"/.exec(t),n=null!=e&&e[1]?e[1]:"Download",s=a.getResponseHeader("content-type"),o=new Blob([a.response],{type:s}),l=document.createElement("a");l.href=window.URL.createObjectURL(o),l.download=n,document.body.appendChild(l),l.click(),document.body.removeChild(l),i()}else r()},a.send(n)}))},stringToArray:function(t){if("string"!=typeof t)return t;for(var e=t.split(","),n=0;n<e.length;n++)e[n]=$.trim(e[n]);return e},findDeltaData:function(t,e,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=ts(this.findModifiedDeltaNames(t,e,n,a,s),2),c=l[0],u=l[1],h=u.__root__,d=es(c);try{for(d.s();!(i=d.n()).done;){var f=i.value;(h=h.concat(u[f])).push("modifiedDeltaNames[]=".concat(f)),r&&r(f,u[f])}}catch(t){d.e(t)}finally{d.f()}return o?h:h.join("&")},findModifiedDeltaNames:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];t="string"==typeof t?t:"",e="string"==typeof e?e:"",n=Array.isArray(n)?ns(n):[],i=$.isPlainObject(i)?i:{},r=Array.isArray(r)?ns(r):[],n.sort((function(t,e){return t.length===e.length?0:a?t.length<e.length?1:-1:t.length>e.length?1:-1}));var s,o=this._groupParamsByDeltaNames(t,n,!1,i),l=this._groupParamsByDeltaNames(e,n,!0,!1),c=es(n);try{for(c.s();!(s=c.n()).done;){var u=s.value;r.includes(u)||"object"!==as(l[u])||"object"===as(o[u])&&JSON.stringify(o[u])===JSON.stringify(l[u])||r.push(u)}}catch(t){c.e(t)}finally{c.f()}return r.sort((function(t,e){return t.length===e.length?0:a?t.length<e.length?1:-1:t.length>e.length?1:-1})),[r,l]},groupParams:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"string"==typeof t&&(t=t.split("&"));var i={};n&&(i.__root__=[]);var r,a=es(e=e.sort((function(t,e){return e.length-t.length})));try{for(a.s();!(r=a.n()).done;)i[r.value]=[]}catch(t){a.e(t)}finally{a.f()}var s,o=function(t){return encodeURIComponent(t).replace("%3D","=")},l=es(t=t.map((function(t){return decodeURIComponent(t)})));try{t:for(l.s();!(s=l.n()).done;){var c,u=s.value,h=es(e);try{for(h.s();!(c=h.n()).done;){var d=c.value,f=u.substring(0,d.length+1);if(["".concat(d,"="),"".concat(d,"[")].includes(f)){void 0===i[d]&&(i[d]=[]),i[d].push(o(u));continue t}}}catch(t){h.e(t)}finally{h.f()}n&&i.__root__.push(o(u))}}catch(t){l.e(t)}finally{l.f()}return i},_groupParamsByDeltaNames:function(t,e,n,i){var r=this.groupParams(t,e,n);if(i){var a=function(t,e){return Array.isArray(e)||$.isPlainObject(e)?e=$.param(e):"string"==typeof e?e=encodeURIComponent(e):null===e&&(e=""),"".concat(encodeURIComponent(t),"=").concat(e)};for(var s in i)if(i.hasOwnProperty(s))if($.isPlainObject(i[s]))for(var o in r[s]=[],i[s])i[s].hasOwnProperty(o)&&r[s].push(a("".concat(s,"[").concat(o,"]"),i[s][o]));else r[s]=[a(s,i[s])]}return r},expandPostArray:function(t){var e,n={};for(var i in t)if(t.hasOwnProperty(i)){var r,a=t[i],s=i.match(/^(\w+)(\[.*)?/);if(s[2])for(r=s[2].match(/\[[^\[\]]*\]/g),e=0;e<r.length;e++)r[e]=r[e].substring(1,r[e].length-1);else r=[];r.unshift(s[1]);var o=n;for(e=0;e<r.length;e++)e<r.length-1?("object"!==as(o[r[e]])&&(r[e+1]&&parseInt(r[e+1])!=r[e+1]?o[r[e]]={}:o[r[e]]=[]),o=o[r[e]]):(r[e]||(r[e]=o.length),o[r[e]]=a)}return n},createForm:function(t){var e=$("<form/>",{attr:{method:"post",action:"","accept-charset":"UTF-8"}});if("string"==typeof t)for(var n,i=t.split("&"),r=0;r<i.length;r++)n=i[r].split("=",2),$("<input/>",{type:"hidden",name:decodeURIComponent(n[0]),value:decodeURIComponent(n[1]||"")}).appendTo(e);return e},compare:function(t,e,n){if(as(t)!==as(e))return!1;if("object"===as(t)&&null!==t&&null!==e){if(t.length!==e.length)return!1;if(Array.isArray(t)!==Array.isArray(e))return!1;if(!Array.isArray(t))if(void 0===n||!0===n){if(!Craft.compare(Craft.getObjectKeys(t).sort(),Craft.getObjectKeys(e).sort()))return!1}else if(!Craft.compare(Craft.getObjectKeys(t),Craft.getObjectKeys(e)))return!1;for(var i in t)if(t.hasOwnProperty(i)&&!Craft.compare(t[i],e[i]))return!1;return!0}return t===e},getObjectKeys:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},escapeChars:function(t){Array.isArray(t)||(t=t.split());for(var e="",n=0;n<t.length;n++)e+="\\"+t[n];return e},ltrim:function(t,e){if(!t)return t;if(void 0===e)return t.trimStart();var n=new RegExp("^["+Craft.escapeChars(e)+"]+");return t.replace(n,"")},rtrim:function(t,e){if(!t)return t;if(void 0===e)return t.trimEnd();var n=new RegExp("["+Craft.escapeChars(e)+"]+$");return t.replace(n,"")},trim:function(t,e){return t?void 0===e?t.trim():(t=Craft.ltrim(t,e),t=Craft.rtrim(t,e)):t},startsWith:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t.toLowerCase().startsWith(e.toLowerCase()):t.startsWith(e)},endsWith:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t.toLowerCase().endsWith(e.toLowerCase()):t.endsWith(e)},ensureStartsWith:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Craft.startsWith(t,e,n)||(t=e+t),t},ensureEndsWith:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Craft.endsWith(t,e,n)||(t+=e),t},removeLeft:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Craft.startsWith(t,e,n)?t.slice(e.length):t},removeRight:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Craft.endsWith(t,e,n)?t.slice(0,-e.length):t},filterArray:function(t,e){for(var n=[],i=0;i<t.length;i++)("function"==typeof e?e(t[i],i):t[i])&&n.push(t[i]);return n},filterObject:function(t,e){return void 0===e&&(e=function(t){return!!t}),Object.fromEntries(Object.entries(t).filter(e))},inArray:function(t,e){return $.isPlainObject(e)&&(e=Object.values(e)),e.includes(t)},removeFromArray:function(t,e){var n=$.inArray(t,e);return-1!==n&&(e.splice(n,1),!0)},getLast:function(t){return t.length?t[t.length-1]:null},uniqueArray:function(t){return ns(new Set(t))},uppercaseFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},lowercaseFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},parseUrl:function(t){var e=t.match(/^(?:(https?):\/\/|\/\/)([^\/\:]*)(?:\:(\d+))?(\/[^\?]*)?(?:\?([^#]*))?(#.*)?/);return e?{scheme:e[1],host:e[2]+(e[3]?":"+e[3]:""),hostname:e[2],port:e[3]||null,path:e[4]||"/",query:e[5]||null,hash:e[6]||null}:{}},getQueryParams:function(t){var e;if(t){var n=t.match(/\?.+/);if(!n)return{};e=n[0]}else e=window.location.search;return Object.fromEntries(new URLSearchParams(e).entries())},getQueryParam:function(t,e){return this.getQueryParams(e)[t]},isSameHost:function(t){var e=this.parseUrl(document.location.href);if(!e)return!1;var n=this.parseUrl(t);return!!n&&e.host===n.host},secondsToHumanTimeDuration:function(t,e){void 0===e&&(e=!0);var n=604800,i=Math.floor(t/n);t%=n;var r=Math.floor(t/86400);t%=86400;var a,s=Math.floor(t/3600);t%=3600,e?(a=Math.floor(t/60),t%=60):(a=Math.round(t/60),t=0);var o=[];return i&&o.push(i+" "+(1===i?Craft.t("app","week"):Craft.t("app","weeks"))),r&&o.push(r+" "+(1===r?Craft.t("app","day"):Craft.t("app","days"))),s&&o.push(s+" "+(1===s?Craft.t("app","hour"):Craft.t("app","hours"))),!a&&(e||i||r||s)||o.push(a+" "+(1===a?Craft.t("app","minute"):Craft.t("app","minutes"))),!t&&(!e||i||r||s||a)||o.push(t+" "+(1===t?Craft.t("app","second"):Craft.t("app","seconds"))),o.join(", ")},asciiString:function(t,e){t=t.normalize("NFC");for(var n,i="",r=0;r<t.length;r++)n=t.charAt(r),i+="string"==typeof(e||Craft.asciiCharMap)[n]?(e||Craft.asciiCharMap)[n]:n;return i},uuid:function(){return"function"==typeof crypto.randomUUID?crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))},namespaceInputName:function(t,e){return e?t.replace(/([^'"\[\]]+)([^'"]*)/,"".concat(e,"[$1]$2")):t},namespaceId:function(t,e){return(e?"".concat(Craft.formatInputId(e),"-"):"")+Craft.formatInputId(t)},randomString:function(t){for(var e="",n=0;n<t;n++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e},createErrorList:function(t){for(var e=$(document.createElement("ul")).addClass("errors"),n=0;n<t.length;n++){var i=$(document.createElement("li"));i.appendTo(e),i.html(t[n])}return e},_existingCss:null,_existingJs:null,_appendHtml:(cs=Za(Ja().mark((function t(e,n){var i,r=this;return Ja().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:i=$.parseHTML(e.trim(),!0).filter((function(t){if("LINK"===t.nodeName&&t.href)return r._existingCss||(r._existingCss=$("link[href]").toArray().map((function(t){return t.href.replace(/&/g,"&amp;")}))),!r._existingCss.includes(t.href)&&(r._existingCss.push(t.href),!0);if("SCRIPT"===t.nodeName&&t.src){if(r._existingJs||(r._existingJs=$("script[src]").toArray().map((function(t){return t.src.replace(/&/g,"&amp;")}))),t.src.startsWith(r.resourceBaseUrl)&&!r.isSameHost(t.src)&&(t.src=r.getActionUrl("app/resource-js",{url:t.src})),r._existingJs.includes(t.src))return!1;r._existingJs.push(t.src)}return!0})),n.append(i);case 4:case"end":return t.stop()}}),t)}))),function(t,e){return cs.apply(this,arguments)}),appendHeadHtml:(ls=Za(Ja().mark((function t(e){return Ja().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._appendHtml(e,$("head"));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return ls.apply(this,arguments)}),appendBodyHtml:(os=Za(Ja().mark((function t(e){return Ja().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._appendHtml(e,Garnish.$bod);case 2:case"end":return t.stop()}}),t,this)}))),function(t){return os.apply(this,arguments)}),appendFootHtml:function(t){console.warn("Craft.appendFootHtml() is deprecated. Craft.appendBodyHtml() should be used instead."),this.appendBodyHtml(t)},initUiElements:function(t){$(".grid",t).grid(),$(".checkbox-select",t).checkboxselect(),$(".fieldtoggle",t).fieldtoggle(),$(".lightswitch",t).lightswitch(),$(".nicetext",t).nicetext(),$(".datetimewrapper",t).datetime(),$('.datewrapper > input[type="date"], .timewrapper > input[type="time"]',t).datetimeinput(),$(".formsubmit",t).formsubmit(),$(".menubtn:not([data-disclosure-trigger])",t).menubtn(),$("[data-disclosure-trigger]",t).disclosureMenu(),$(".expandable-button--collapsed",t).expandableButton(),$(".field.info-icon-instructions > .instructions, #details .meta > .field > .instructions",t).not(".visually-hidden").each((function(){var t=$(this),e=t.siblings(".heading").find("label");$("<div/>",{class:"info",html:t.children().html()}).appendTo(e),t.addClass("visually-hidden")})),$(".info",t).infoicon(),$("a",t).each((function(){this.hostname.length&&this.hostname!==location.hostname&&void 0===$(this).attr("target")&&$(this).attr("rel","noopener").attr("target","_blank")}))},_elementIndexClasses:{},_elementSelectorModalClasses:{},_elementEditorClasses:{},_uploaderClasses:{},_authFormHandlers:{},registerElementIndexClass:function(t,e){if(void 0!==this._elementIndexClasses[t])throw"An element index class has already been registered for the element type “"+t+"”.";this._elementIndexClasses[t]=e},registerUploaderClass:function(t,e){if(void 0!==this._uploaderClasses[t])throw"An asset uploader class has already been registered for the filesystem type “"+t+"”.";this._uploaderClasses[t]=e},registerElementSelectorModalClass:function(t,e){if(void 0!==this._elementSelectorModalClasses[t])throw"An element selector modal class has already been registered for the element type “"+t+"”.";this._elementSelectorModalClasses[t]=e},registerAuthFormHandler:function(t,e){if(void 0!==this._authFormHandlers[t])throw"An authentication form handler has already been registered for the method “".concat(t,"”.");this._authFormHandlers[t]=e},createElementIndex:function(t,e,n){return new(void 0!==this._elementIndexClasses[t]?this._elementIndexClasses[t]:Craft.BaseElementIndex)(t,e,n)},createUploader:function(t,e,n){var i=new(void 0!==this._uploaderClasses[t]?this._uploaderClasses[t]:Craft.Uploader)(e,n);return i.fsType=t,i},createElementSelectorModal:function(t,e){return new(void 0!==this._elementSelectorModalClasses[t]?this._elementSelectorModalClasses[t]:Craft.BaseElementSelectorModal)(t,e)},createAuthFormHandler:function(t,e,n,i){if(void 0===this._authFormHandlers[t])throw'No authentication form has been registered for the method "'.concat(t,'".');if(e instanceof jQuery){if(!e.length)throw"No form element specified.";e=e[0]}return i||(i=function(t){Craft.cp.displayError(t)}),new this._authFormHandlers[t](e,n,i)},createElementEditor:function(t,e,n){return void 0===n&&$.isPlainObject(e)?(n=e,e=null):"object"!==as(n)&&(n={}),n.elementType||(n.elementType=t),new Craft.ElementEditorSlideout(e,n)},getLocalStorage:function(t,e){return t="Craft-"+Craft.systemUid+"."+t,"undefined"!=typeof localStorage&&void 0!==localStorage[t]?JSON.parse(localStorage[t]):e},setLocalStorage:function(t,e){if("undefined"!=typeof localStorage){t="Craft-"+Craft.systemUid+"."+t;try{localStorage[t]=JSON.stringify(e)}catch(t){}}},removeLocalStorage:function(t){"undefined"!=typeof localStorage&&localStorage.removeItem("Craft-".concat(Craft.systemUid,".").concat(t))},getCookie:function(t){return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)Craft-".concat(Craft.systemUid,"_").concat(t,"\\s*\\=\\s*([^;]*).*$)|^.*$")),"$1")},setCookie:function(t,e,n){n=$.extend({},this.defaultCookieOptions,n);var i="Craft-".concat(Craft.systemUid,"_").concat(t,"=").concat(encodeURIComponent(e));n.path&&(i+=";path=".concat(n.path)),n.domain&&(i+=";domain=".concat(n.domain)),n.maxAge?i+=";max-age-in-seconds=".concat(n.maxAge):n.expires&&(i+=";expires=".concat(n.expires.toUTCString())),n.secure&&(i+=";secure"),document.cookie=i},removeCookie:function(t){this.setCookie(t,"",new Date("1970-01-01T00:00:00"))},getElementInfo:function(t){var e=$(t);return e.hasClass("element")||(e=e.find(".element:first")),{id:e.data("id"),siteId:e.data("site-id"),label:e.data("label"),status:e.data("status"),url:e.data("url"),hasThumb:e.hasClass("has-thumb"),$element:e}},setElementSize:function(t,e){var n=$(t);if("small"!==e&&"large"!==e&&(e="small"),!n.hasClass(e)){var i="small"===e?"large":"small";if(n.addClass(e).removeClass(i),n.hasClass("has-thumb")){var r=n.find("> .thumb > img"),a=$("<img/>",{sizes:("small"===e?"30":"100")+"px",srcset:r.attr("srcset")||r.attr("data-pfsrcset")});r.replaceWith(a),picturefill({elements:[a[0]]})}}},refreshElementInstances:function(t){var e=$('div.element[data-id="'.concat(t,'"][data-settings]'));if(e.length){for(var n={},i=0;i<e.length;i++){var r=e.eq(i),a=r.data("site-id");void 0===n[a]&&(n[a]={key:i,type:r.data("type"),id:t,fieldId:r.data("field-id"),ownerId:r.data("owner-id"),siteId:a,instances:[]}),n[a].instances.push(r.data("settings"))}var s={elements:Object.values(n)};Craft.sendActionRequest("POST","app/render-elements",{data:s}).then((function(n){for(var i=n.data.elements[t]||{},r=0,a=Object.keys(i);r<a.length;r++){var s,o=a[r],l=e.eq(o),c=$(i[o]),u=c[0].attributes,h=es(u);try{for(h.s();!(s=h.n()).done;){var d=s.value;"class"===d.name?l.addClass(d.value):l.attr(d.name,d.value)}}catch(t){h.e(t)}finally{h.f()}var f,p=es(l[0].attributes);try{for(p.s();!(f=p.n()).done;){var g=f.value;void 0===u[g.name]&&l.removeAttr(g.name)}}catch(t){p.e(t)}finally{p.f()}var m=l.find("> .chip-content .chip-actions, > .card-titlebar > .card-actions-container .card-actions").detach(),v=l.find("input,button").detach();if(l.html(c.html()).removeClass("error"),m.length){var y=m.find("span.status"),b=c.find("> .chip-content .chip-actions span.status, > .card-titlebar > .card-actions-container .card-actions span.status");y.length&&b.length&&y[0].classList!==b[0].classList&&m.find("span.status").replaceWith(b),l.find("> .chip-content .chip-actions, > .card-titlebar > .card-actions-container .card-actions").replaceWith(m)}v.length&&v.appendTo(l)}Craft.cp.elementThumbLoader.load(e)}))}},refreshComponentInstances:function(t,e){var n=$('div.chip[data-type="'.concat($.escapeSelector(t),'"][data-id="').concat(e,'"][data-settings]'));if(n.length){for(var i=[],r=0;r<n.length;r++)i.push(n.eq(r).data("settings"));var a={components:[{type:t,id:e,instances:i}]};Craft.sendActionRequest("POST","app/render-components",{data:a}).then((function(i){for(var r=i.data,a=0;a<r.components[t][e].length;a++){var s,o=n.eq(a),l=$(r.components[t][e][a]),c=es(l[0].attributes);try{for(c.s();!(s=c.n()).done;){var u=s.value;"class"===u.name?o.addClass(u.value):o.attr(u.name,u.value)}}catch(t){c.e(t)}finally{c.f()}var h=o.find(".chip-actions").detach(),d=o.find(".chip-label .indicators").detach(),f=o.find("input,button").detach();o.html(l.html()),h.length&&o.find(".chip-actions").replaceWith(h),d.length&&o.find(".chip-label").append(d),f.length&&f.appendTo(o)}}))}},addActionsToChip:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!=e&&e.length){var i=$(t).find("> .chip-content > .chip-actions, > .card-titlebar > .card-actions-container > .card-actions"),r=i.find(".action-btn").removeClass("hidden");if(!r.length){var a="actions-".concat(Math.floor(1e6*Math.random())),s="".concat(a,"-label"),o=$("<label/>",{id:s,class:"visually-hidden",text:Craft.t("app","Actions")}).appendTo(i);r=$("<button/>",{class:"btn action-btn",type:"button",title:Craft.t("app","Actions"),"aria-controls":a,"aria-describedby":s,"data-disclosure-trigger":"true"}).insertAfter(o),$("<div/>",{id:a,class:"menu menu--disclosure"}).insertAfter(r)}var l=r.disclosureMenu().data("disclosureMenu"),c=e.filter((function(t){return!t.destructive})),u=e.filter((function(t){return t.destructive})),h=n?l.$container.children().first().get(0):null;c.length&&l.addItems(c,l.addGroup(null,!0,h)),u.length&&l.addItems(u,l.addGroup(null,!0,h)),Craft.initUiElements(l.$container)}},submitForm:function(t,e){var n=this;void 0===e&&(e={}),e.confirm&&!confirm(e.confirm)||(e.requireElevatedSession?Craft.elevatedSessionManager.requireElevatedSession((function(){n._submitFormInternal(t,e)})):this._submitFormInternal(t,e))},_submitFormInternal:function(t,e){var n,i=null!==(n=e.namespace)&&void 0!==n?n:null;if(e.action&&$("<input/>",{type:"hidden",name:this.namespaceInputName("action",i),val:e.action}).appendTo(t),e.redirect&&$("<input/>",{type:"hidden",name:this.namespaceInputName("redirect",i),val:e.redirect}).appendTo(t),e.params)for(var r in e.params){var a=e.params[r];$("<input/>",{type:"hidden",name:this.namespaceInputName(r,i),val:a}).appendTo(t)}e.retainScroll&&this.setLocalStorage("scrollY",window.scrollY),t.trigger($.extend({type:"submit"},e.data))},trapFocusWithin:function(t){Garnish.trapFocusWithin(t)},releaseFocusWithin:function(t){Garnish.releaseFocusWithin(t)},setFocusWithin:function(t){Garnish.setFocusWithin(t)},filterInputVal:function(t,e){for(var n=$(t),i=n.val(),r=n[0].selectionStart,a="",s=0;s<i.length;s++)i[s].match(e)?a+=i[s]:s<r&&r--;a!==i&&(n.val(a),n[0].setSelectionRange(r,r))},filterNumberInputVal:function(t){this.filterInputVal(t,/[0-9.,\-]/)},setElementAttributes:function(t,e){var n=$(t);for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if(null===r||!1===r)n.removeAttr(i);else if(!0===r)n.attr(i,"");else if(Array.isArray(r)||$.isPlainObject(r))if(Craft.dataAttributes.includes(i)){for(var a in r=Object.assign({},r))if(r.hasOwnProperty(a)){var s=r[a];null!==s&&!1!==s&&(s=$.isPlainObject(s)||Array.isArray(s)?JSON.stringify(s):!0===s?"":this.escapeHtml(s),n.attr("".concat(i,"-").concat(a),s))}}else if("class"===i){$.isPlainObject(r)&&(r=Object.values(r));var o,l=es(r);try{for(l.s();!(o=l.n()).done;){var c=o.value;n.addClass(c)}}catch(t){l.e(t)}finally{l.f()}}else"style"===i?n.css(r):n.attr(i,JSON.stringify(r));else n.attr(i,this.escapeHtml(r))}},isVisible:function(){return void 0===document.visibilityState||"visible"===document.visibilityState},useMobileStyles:function(){return Garnish.isMobileBrowser()||document.body.clientWidth<600},animate:(ss=Za(Ja().mark((function t(e,n){return Ja().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.animateAll([[e,n]]);case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return ss.apply(this,arguments)}),transitionQueue:null,animateAll:function(t){return Craft.transitionQueue||(Craft.transitionQueue=new Craft.Queue),Craft.transitionQueue.push((function(){return new Promise((function(e,n){for(var i=0;i<t.length;i++)!t[i][0]instanceof jQuery&&(t[i][0]=$(t[i][0]));if(document.startViewTransition){var r,a=es(t);try{for(a.s();!(r=a.n()).done;){var s=ts(r.value,1)[0];"none"===s.css("view-transition-name")&&s.css("view-transition-name","vt-".concat(Math.floor(1e5*Math.random())))}}catch(t){a.e(t)}finally{a.f()}document.startViewTransition((function(){var e,n=es(t);try{for(n.s();!(e=n.n()).done;){var i=ts(e.value,2),r=i[0],a=i[1];r.css(a)}}catch(t){n.e(t)}finally{n.f()}})).finished.then(e).catch((function(t){console.warn(t),e()}))}else for(var o=0;o<t.length;o++){var l=ts(t[o],2),c=l[0],u=l[1];c.velocity(u,Craft.BaseElementSelectInput.REMOVE_FX_DURATION,o===t.length-1?e:null)}}))}))},hasMousePointerEvents:function(){return matchMedia("(pointer:fine)").matches}}),Craft.pageId=Craft.uuid(),"undefined"!=typeof BroadcastChannel){var hs="CraftCMS:".concat(Craft.appId);Craft.broadcaster=new BroadcastChannel(hs),Craft.messageReceiver=new BroadcastChannel(hs),Craft.broadcaster.addEventListener("message",(function(t){switch(t.data.event){case"beforeTrackJobProgress":Craft.cp.cancelJobTracking();break;case"trackJobProgress":if(Craft.cp.setJobData(t.data.jobData),Craft.cp.jobInfo.length){var e=Craft.cp.getNextJobDelay()+1e3;Craft.cp.trackJobProgress(e)}break;case"copyElements":var n=Craft.getLocalStorage("copiedElements");Craft.cp.showElementCopyNotification(n||[])}})),Craft.messageReceiver.addEventListener("message",(function(t){"saveElement"===t.data.event&&Craft.refreshElementInstances(t.data.id)}))}$.extend($.fn,{animateLeft:function(t,e,n,i){return"ltr"===Craft.orientation?this.velocity({left:t},e,n,i):this.velocity({right:t},e,n,i)},animateRight:function(t,e,n,i){return"ltr"===Craft.orientation?this.velocity({right:t},e,n,i):this.velocity({left:t},e,n,i)},disable:function(){return this.each((function(){var t=$(this);t.addClass("disabled"),t.data("activatable")&&t.removeAttr("tabindex")}))},enable:function(){return this.each((function(){var t=$(this);t.removeClass("disabled"),t.data("activatable")&&t.attr("tabindex","0")}))},grid:function(){return this.each((function(){var t=$(this),e={};t.data("item-selector")&&(e.itemSelector=t.data("item-selector")),t.data("cols")&&(e.cols=parseInt(t.data("cols"))),t.data("max-cols")&&(e.maxCols=parseInt(t.data("max-cols"))),t.data("min-col-width")&&(e.minColWidth=parseInt(t.data("min-col-width"))),t.data("mode")&&(e.mode=t.data("mode")),t.data("fill-mode")&&(e.fillMode=t.data("fill-mode")),t.data("col-class")&&(e.colClass=t.data("col-class")),t.data("snap-to-grid")&&(e.snapToGrid=!!t.data("snap-to-grid")),new Craft.Grid(this,e)}))},infoicon:function(){return this.each((function(){new Craft.InfoIcon(this)}))},checkboxselect:function(){return this.each((function(){$.data(this,"checkboxSelect")||new Garnish.CheckboxSelect(this,{storageKey:this.getAttribute("data-storage-key")})}))},fieldtoggle:function(){return this.each((function(){$.data(this,"fieldtoggle")||new Craft.FieldToggle(this)}))},lightswitch:function(t,e,n){return"settings"===t?("string"==typeof e?(t={})[e]=n:t=e,this.each((function(){var e=$.data(this,"lightswitch");e&&e.setSettings(t)}))):($.isPlainObject(t)||(t={}),this.each((function(){var e=$.extend({},t);Garnish.hasAttr(this,"data-value")&&(e.value=$(this).attr("data-value")),Garnish.hasAttr(this,"data-indeterminate-value")&&(e.indeterminateValue=$(this).attr("data-indeterminate-value")),$.data(this,"lightswitch")||new Craft.LightSwitch(this,e)})))},nicetext:function(){return this.each((function(){$.data(this,"nicetext")||new Garnish.NiceText(this)}))},formsubmit:function(){return this.on("activate",(function(t){var e,n=$(t.currentTarget),i=n.data("params")||{};n.data("param")&&(i[n.data("param")]=n.data("value"));var r=null;if("false"===n.attr("data-form"))e=Craft.createForm().addClass("hidden").append(Craft.getCsrfInput()).appendTo(Garnish.$bod);else{var a=n.closest(".menu--disclosure").length?n.closest(".menu--disclosure").data("trigger").$trigger:n.data("menu")?n.data("menu").$anchor:n,s=0==a.parents(".slideout").length,o=a.parents(".element-index.pane").length>0;s||o?e=a.attr("data-form")?$("#"+a.attr("data-form")):n.attr("data-form")?$("#"+n.attr("data-form")):a.closest("form"):(e=a.closest("form"),r=a.parents(".slideout").data("cpScreen").namespace),a.data("disclosureMenu")&&a.data("disclosureMenu").hide()}Craft.submitForm(e,{confirm:n.data("confirm"),action:n.data("action"),redirect:n.data("redirect"),retainScroll:Garnish.hasAttr(n,"data-retain-scroll"),requireElevatedSession:Garnish.hasAttr(n,"data-require-elevated-session"),namespace:r,params:i,data:$.extend({customTrigger:n},n.data("event-data"))})}))},menubtn:function(){return this.each((function(){var t=$(this);if(!t.data("menubtn")&&t.next().hasClass("menu")){var e={};t.data("menu-anchor")&&(e.menuAnchor=t.data("menu-anchor")),new Garnish.MenuBtn(t,e)}}))},disclosureMenu:function(t){return this.each((function(){var e=$(this);!e.data("trigger")&&e.attr("aria-controls")&&new Garnish.DisclosureMenu(e,t)}))},expandableButton:function(){return this.each((function(){var t=$(this),e=t.next(".expandable-button--expanded");e.length||(e=t.prev(".expandable-button--collapsed"));var n,i=t.parent(),r=!1,a=!1,s=function(){n&&(a||(t.addClass("hidden"),e.removeClass("hidden")),(a=i[0].scrollWidth<=n)||(t.removeClass("hidden"),e.addClass("hidden")))};new IntersectionObserver((function(t){r!==(r=0!==t[0].intersectionRatio)&&r&&s()})).observe(i[0]);var o=function(){n!==(n=i[0].getBoundingClientRect().width)&&n&&s()};o(),new ResizeObserver((function(){Garnish.requestAnimationFrame((function(){o()}))})).observe(i[0])}))},datetime:function(){return this.each((function(){var t=$(this),e=t.find("input.text"),n=function(){for(var n=!1,i=0;i<e.length;i++){if(e.eq(i).is(":disabled")){n=!1;break}if(e.eq(i).val()){n=!0;break}}if(n){if(!t.children(".clear-btn").length)var r=$("<button/>",{type:"button",class:"clear-btn",title:Craft.t("app","Clear"),"aria-label":Craft.t("app","Clear")}).appendTo(t).on("click",(function(){for(var t=0;t<e.length;t++)e.eq(t).val("").trigger("input").trigger("change");r.remove(),e.first().filter('[type="text"]').focus()}))}else t.children(".clear-btn").remove()};e.on("change",n),n()}))},datetimeinput:function(){return this.each((function(){var t=$(this),e=function(){""===t.val()?t.addClass("empty-value"):t.removeClass("empty-value")};t.on("input",e),e()}))}}),Garnish.NiceText.charsLeftHtml=function(t){return Craft.t("app",'<span class="visually-hidden">Characters left:</span> {chars, number}',{chars:t})},Garnish.$doc.ready((function(){Craft.initUiElements()})),__webpack_require__(5616),__webpack_require__(2807),__webpack_require__(8323),__webpack_require__(4750),__webpack_require__(5315),__webpack_require__(1833),__webpack_require__(2290),__webpack_require__(3517);var ds=jQuery,fs=__webpack_require__.n(ds);function ps(t){return ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(t)}function gs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ms(t,e,n){return(e=function(t){var e=function(t){if("object"!=ps(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ps(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ps(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vs(t){return vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(t)}!function(t){Craft.Slideout=Garnish.Base.extend({$outerContainer:null,$container:null,$shade:null,$liveRegion:t('<span class="visually-hidden" role="status"></span>'),$triggerElement:null,isOpen:!1,isOpening:!1,useMobileStyles:null,init:function(e,n){this.setSettings(n,Craft.Slideout.defaults),this.$outerContainer=t("<div/>",{class:"slideout-container hidden"}),this.$container=t("<".concat(this.settings.containerElement,"/>"),this.settings.containerAttributes).attr("data-slideout","").addClass("slideout").append(e).data("slideout",this).appendTo(this.$outerContainer),this.$container.attr("id")&&(Craft.Slideout.instances[this.$container.attr("id")]=this),Garnish.addModalAttributes(this.$outerContainer),Craft.trapFocusWithin(this.$container),this.$liveRegion.appendTo(this.$container),this.settings.autoOpen&&this.open()},open:function(){var e=this;if(!this.isOpen){this.setTriggerElement(this.settings.triggerElement||document.activeElement),this._cancelTransitionListeners();var n=Craft.Preview.getActive()||Craft.LivePreview.getActive();if(this.useMobileStyles=n||Craft.useMobileStyles(),this.$outerContainer.removeClass("so-mobile so-lp"),this.$container.removeClass("so-mobile so-lp"),n?(this.$outerContainer.addClass("so-lp"),this.$container.addClass("so-lp")):this.useMobileStyles&&this.$container.addClass("so-mobile"),n||!this.useMobileStyles?(this.$shade||(this.$shade=t('<div class="slideout-shade"/>'),this.settings.closeOnShadeClick&&this.addListener(this.$shade,"click",(function(t){t.stopPropagation(),e.close()}))),this.$shade.appendTo(Garnish.$bod).show()):this.$shade&&(this.$shade.remove(),delete this.$shade),this.$outerContainer.appendTo(Garnish.$bod).removeClass("hidden"),n){this.updateWidthsForPreviewPane(n);var i=n.$editorContainer.width(),r=new ResizeObserver((function(t){e.isOpen&&i!==(i=n.$editorContainer.width())&&e.updateWidthsForPreviewPane(n)}));r.observe(n.$editorContainer[0]),n.on("beforeClose",(function(){r.disconnect()}))}this.isOpening=!0,this.useMobileStyles?this.$container.css(ms({top:"100vh"},Craft.Slideout.positionProp(),"")):this.$container.css(ms({top:""},Craft.Slideout.positionProp(),"100vw")),this._afterTransition(this.$container,(function(){e.isOpening=!1,e.setFocusWithin()})),this.$shade&&(this.$shade[0].offsetWidth,this.$shade.addClass("so-visible")),this.$container[0].offsetWidth,Craft.Slideout.addPanel(this),this.enable(),Garnish.uiLayerManager.addLayer(this.$outerContainer),Garnish.hideModalBackgroundLayers(),this.settings.closeOnEsc&&Garnish.uiLayerManager.registerShortcut(Garnish.ESC_KEY,(function(){e.close()})),this.isOpen=!0,this.trigger("open")}},setFocusWithin:function(){Craft.setFocusWithin(this.$container)},updateWidthsForPreviewPane:function(t){var e=t.$editorContainer.width()-1;this.$shade&&this.$shade.width(e),this.$outerContainer.css("width","calc(".concat(e,"px - var(--m) * 2)"))},setTriggerElement:function(e){this.$triggerElement=t(e)},close:function(){var e,n=this;if(this.isOpen&&(this.trigger("beforeClose"),this.disable(),this.isOpen=!1,this._cancelTransitionListeners(),this.$shade&&(this.$shade.removeClass("so-visible"),this._afterTransition(this.$shade,(function(){n.$shade.hide()}))),Craft.Slideout.removePanel(this),Garnish.uiLayerManager.removeLayer(),Garnish.resetModalBackgroundLayerVisibility(),this._afterTransition(this.$container,(function(){n.$outerContainer.addClass("hidden"),n.trigger("close")})),null!==(e=this.$triggerElement)&&void 0!==e&&e.length)){var i=t(this.$triggerElement)[0];if(!i.checkVisibility()){var r=i.closest(".menu--disclosure");if(r){var a=r.getAttribute("id");i=document.querySelector('[aria-controls="'.concat(a,'"]'))}else i=null}i&&setTimeout((function(){i.focus()}),150)}},_afterTransition:function(t,e){Garnish.prefersReducedMotion()?e():t.one("transitionend.slideout",e)},_cancelTransitionListeners:function(){this.$shade&&this.$shade.off("transitionend.slideout"),this.$container.off("transitionend.slideout")},destroy:function(){var t=this;this.$shade&&(this.$shade.remove(),this.$shade=null),this.$outerContainer.remove(),this.$outerContainer=null,this.$container=null,Craft.Slideout.instances=Craft.filterObject(Craft.Slideout.instances,(function(e){return e!==t})),this.base()}},{defaults:{containerElement:"div",containerAttributes:{},autoOpen:!0,closeOnEsc:!0,closeOnShadeClick:!0,triggerElement:null},instances:{},openPanels:[],positionProp:function(){return"inset-inline-".concat("start"===Craft.slideoutPosition?"end":"start")},totalPanels:function(){return Craft.Slideout.openPanels.length},addPanel:function(t){Craft.Slideout.openPanels.unshift(t),t.useMobileStyles?t.$container.css("top",0):Craft.Slideout.updateStyles()},removePanel:function(t){Craft.Slideout.openPanels=Craft.Slideout.openPanels.filter((function(e){return e!==t})),t.useMobileStyles?t.$container.css("top","100vh"):(t.$container.css(Craft.Slideout.positionProp(),"100vw"),Craft.Slideout.updateStyles())},updateStyles:function(){var t=Craft.Slideout.totalPanels();Craft.Slideout.openPanels.forEach((function(e,n){e.$container.css(Craft.Slideout.positionProp(),"".concat((t-n)/t*45,"vw"))})),0!==t?Garnish.$bod.addClass("no-scroll"):Garnish.$bod.removeClass("no-scroll")}}),Garnish.on(Craft.Slideout,["open","close"],(function(){var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return gs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gs(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}(Garnish.HUD.instances);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.showing&&n.updateSizeAndPosition(!0)}}catch(t){e.e(t)}finally{e.f()}}))}(jQuery),__webpack_require__(2410),__webpack_require__(8514),__webpack_require__(308),__webpack_require__(4398),__webpack_require__(7573),__webpack_require__(6322),__webpack_require__(991),__webpack_require__(258),__webpack_require__(7754),__webpack_require__(1255),__webpack_require__(3730),__webpack_require__(1448),__webpack_require__(6618),__webpack_require__(337),__webpack_require__(7145),__webpack_require__(5970),__webpack_require__(4172),Craft.charts={},Craft.charts.DataTable=Garnish.Base.extend({columns:null,rows:null,init:function(t){var e=t.columns,n=t.rows;n.forEach((function(t){$.each(t,(function(n){var i;switch(e[n].type){case"date":i=fr("%Y-%m-%d"),t[n]=i(t[n]);break;case"datetime":i=fr("%Y-%m-%d %H:00:00"),t[n]=i(t[n]);break;case"percent":t[n]=t[n]/100;break;case"number":t[n]=+t[n]}}))})),this.columns=e,this.rows=n}}),Craft.charts.Tip=Garnish.Base.extend({$container:null,$tip:null,init:function(t){this.$container=t,this.$tip=$('<div class="tooltip"></div>').appendTo(this.$container),this.hide()},setContent:function(t){this.$tip.html(t)},setPosition:function(t){this.$tip.css("left","".concat(t.left,"px")),this.$tip.css("top","".concat(t.top,"px"))},show:function(){this.$tip.css("display","block")},hide:function(){this.$tip.css("display","none")}}),Craft.charts.BaseChart=Garnish.Base.extend({$container:null,$chart:null,chartBaseClass:"cp-chart",dataTable:null,formatLocale:null,timeFormatLocale:null,orientation:null,svg:null,width:null,height:null,init:function(t,e){var n=this;this.$container=t,this.setSettings(Craft.charts.BaseChart.defaults),this.setSettings(e);var i={formats:window.d3Formats,formatLocaleDefinition:window.d3FormatLocaleDefinition,timeFormatLocaleDefinition:window.d3TimeFormatLocaleDefinition};this.setSettings(i),Ma(window).on("resize",(function(){n.resize()}))},setSettings:function(t,e){var n=void 0===this.settings?{}:this.settings;this.settings=$.extend(!0,{},n,e,t)},draw:function(t,e){this.setSettings(e),this.dataTable=t,this.formatLocale=Gn(this.settings.formatLocaleDefinition),this.timeFormatLocale=ur(this.settings.timeFormatLocaleDefinition),this.orientation=this.settings.orientation,this.$chart&&this.$chart.remove();var n=this.chartBaseClass;this.settings.chartClass&&(n+=" "+this.settings.chartClass),this.$chart=$('<div class="'.concat(n,'" />')).appendTo(this.$container)},resize:function(){this.draw(this.dataTable,this.settings)},onAfterDrawTicks:function(){$(".tick",this.$chart).each((function(t,e){var n=$("text",e);n.clone().appendTo(e),n.attr("stroke","#ffffff"),n.attr("stroke-width",3)}))}},{defaults:{formatLocaleDefinition:null,timeFormatLocaleDefinition:null,formats:{numberFormat:",.2f",percentFormat:",.2%",currencyFormat:"$,.2f",shortDateFormats:{day:"%-m/%-d",month:"%-m/%y",year:"%Y"}},margin:{top:0,right:0,bottom:0,left:0},chartClass:null,colors:["#0594D1","#DE3800","#FF9A00","#009802","#9B009B"]}}),Craft.charts.Area=Craft.charts.BaseChart.extend({tip:null,drawingArea:null,init:function(t,e){this.base(t,Craft.charts.Area.defaults),this.setSettings(e)},draw:function(t,e){this.base(t,e),this.tip&&(this.tip=null);var n=this.getChartMargin();this.width=this.$chart.width()-n.left-n.right,this.height=this.$chart.height()-n.top-n.bottom;var i={width:this.width+(n.left+n.right),height:this.height+(n.top+n.bottom),translateX:"rtl"!==this.orientation?n.left:n.right,translateY:n.top};this.svg=Ma(this.$chart.get(0)).append("svg").attr("width",i.width).attr("height",i.height),this.drawingArea=this.svg.append("g").attr("transform","translate(".concat(i.translateX,",").concat(i.translateY,")")),this.drawTicks(),this.drawAxes(),this.drawChart(),this.drawTipTriggers()},drawTicks:function(){var t=h(this.getX(!0)).tickFormat(this.getXFormatter()).ticks(3);this.drawingArea.append("g").attr("class","x ticks-axis").attr("transform","translate(0, ".concat(this.height,")")).call(t);var e,n=this.getY();"rtl"!==this.orientation?(e=d(n).tickFormat(this.getYFormatter()).tickValues(this.getYTickValues()).ticks(2),this.drawingArea.append("g").attr("class","y ticks-axis").call(e)):(e=u(n).tickFormat(this.getYFormatter()).tickValues(this.getYTickValues()).ticks(2),this.drawingArea.append("g").attr("class","y ticks-axis").attr("transform","translate(".concat(this.width,",0)")).call(e)),this.onAfterDrawTicks()},drawAxes:function(){if(this.settings.xAxis.showAxis){var t=h(this.getX()).ticks(0).tickSizeOuter(0);this.drawingArea.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(this.height,")")).call(t)}if(this.settings.yAxis.showAxis){var e,n=this.getY();"rtl"===this.orientation?(e=d(n).ticks(0),this.drawingArea.append("g").attr("class","y axis").attr("transform","translate(".concat(this.width-0,", 0)")).call(e)):(e=u(n).ticks(0),this.drawingArea.append("g").attr("class","y axis").attr("transform","translate(".concat(0,", 0)")).call(e))}},drawChart:function(){var t=this.getX(!0),e=this.getY();if(this.settings.xAxis.gridlines){var n=h(t);this.drawingArea.append("g").attr("class","x grid-line").attr("transform","translate(0,".concat(this.height,")")).call(n.tickSize(-this.height,0,0).tickFormat(""))}if(this.settings.yAxis.gridlines){var i=d(e);this.drawingArea.append("g").attr("class","y grid-line").attr("transform","translate(0 , 0)").call(i.tickSize(-this.width,0).tickFormat("").tickValues(this.getYTickValues()).ticks(2))}var r=Ka().x((function(e){return t(e[0])})).y((function(t){return e(t[1])}));this.drawingArea.append("g").attr("class","chart-line").append("path").datum(this.dataTable.rows).style("fill","none").style("stroke",this.settings.colors[0]).style("stroke-width","3px").attr("d",r);var a=function(t,e,n){var i=null,r=Oa(!0),a=null,s=Ra,o=null,l=Ya(c);function c(c){var u,h,d,f,p,g=(c=Ba(c)).length,m=!1,v=new Array(g),y=new Array(g);for(null==a&&(o=s(p=l())),u=0;u<=g;++u){if(!(u<g&&r(f=c[u],u,c))===m)if(m=!m)h=u,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),d=u-1;d>=h;--d)o.point(v[d],y[d]);o.lineEnd(),o.areaEnd()}m&&(v[u]=+t(f,u,c),y[u]=+e(f,u,c),o.point(i?+i(f,u,c):v[u],n?+n(f,u,c):y[u]))}if(p)return o=null,p+""||null}function u(){return Ka().defined(r).curve(s).context(a)}return t="function"==typeof t?t:void 0===t?Va:Oa(+t),e="function"==typeof e?e:Oa(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?qa:Oa(+n),c.x=function(e){return arguments.length?(t="function"==typeof e?e:Oa(+e),i=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:Oa(+e),c):t},c.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Oa(+t),c):i},c.y=function(t){return arguments.length?(e="function"==typeof t?t:Oa(+t),n=null,c):e},c.y0=function(t){return arguments.length?(e="function"==typeof t?t:Oa(+t),c):e},c.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Oa(+t),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(i).y(e)},c.defined=function(t){return arguments.length?(r="function"==typeof t?t:Oa(!!t),c):r},c.curve=function(t){return arguments.length?(s=t,null!=a&&(o=s(a)),c):s},c.context=function(t){return arguments.length?(null==t?a=o=null:o=s(a=t),c):a},c}().x((function(e){return t(e[0])})).y0(this.height).y1((function(t){return e(t[1])}));this.drawingArea.append("g").attr("class","chart-area").append("path").datum(this.dataTable.rows).style("fill",this.settings.colors[0]).style("fill-opacity","0.3").attr("d",a),this.settings.plots&&this.drawingArea.append("g").attr("class","plots").selectAll("circle").data(this.dataTable.rows).enter().append("circle").style("fill",this.settings.colors[0]).attr("class",(function(t,e){return"plot plot-".concat(e)})).attr("r",4).attr("cx",(function(e){return t(e[0])})).attr("cy",(function(t){return e(t[1])}))},drawTipTriggers:function(){var t=this;if(this.settings.tips){this.tip||(this.tip=new Craft.charts.Tip(this.$chart));var e=this.getChartMargin(),n=(this.drawingArea.select(".x path.domain").node().getTotalLength()-e.left-e.right-12)/(this.dataTable.rows.length-1),i=Math.max(0,n),r=this.getX(!0),a=this.getY();this.drawingArea.append("g").attr("class","tip-triggers").selectAll("rect").data(this.dataTable.rows).enter().append("rect").attr("class",(function(t,e){return"tip-trigger tip-trigger-".concat(e)})).attr("data-index",(function(t,e){return e})).style("fill","transparent").style("fill-opacity","1").attr("width",i).attr("height",this.height).attr("x",(function(t){return r(t[0])-i/2})).on("mouseover",(function(e,n){var i=Ma(e.target).attr("data-index");t.drawingArea.select(".plot-"+i).attr("r",5);var s=$("<div />"),o=$('<div class="x-value" />').appendTo(s),l=$('<div class="y-value" />').appendTo(s);o.html(t.getXFormatter()(n[0])),l.html(t.getYFormatter()(n[1]));var c=s.get(0);t.tip.setContent(c);var u,h=t.getChartMargin(),d=24,f=a(n[1])+d;"rtl"!==t.orientation?(u=r(n[0])+h.left+d,t.$chart.offset().left+u+t.tip.$tip.width()>t.$chart.offset().left+t.$chart.width()-d&&(u=r(n[0])-(t.tip.$tip.width()+d))):u=r(n[0])-(t.tip.$tip.width()+h.left+d),u<0&&(u=r(n[0])+h.left+d);var p={top:f,left:u};t.tip.setPosition(p),t.tip.show()})).on("mouseout",(function(e,n){var i=Ma(e.target).attr("data-index");t.drawingArea.select(".plot-"+i).attr("r",4),t.tip.hide()}))}},getChartMargin:function(){var t=this,e=this.settings.margin,n=this.getYTickValues(),i=0;return $.each(n,(function(e,n){var r=8*t.getYFormatter()(n).length;r>i&&(i=r)})),i+=10,e.left=i,e},getX:function(e){var n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}(this.dataTable.rows,(function(t){return t[0]})),i=t(this.dataTable.rows,(function(t){return t[0]})),r=[n,i];"rtl"===this.orientation&&(r=[i,n]);var a=0,s=0;e&&(a=0,s=0);var o=Fa().range([a,this.width-s]);return o.domain(r),o},getY:function(){var t=[0,this.getYMaxValue()],e=vi().range([this.height,0]);return e.domain(t),e},getXFormatter:function(){return this.settings.xAxis.formatter!==$.noop?this.settings.xAxis.formatter(this):Craft.charts.utils.getTimeFormatter(this.timeFormatLocale,this.settings)},getYFormatter:function(){return this.settings.yAxis.formatter!==$.noop?this.settings.yAxis.formatter(this):Craft.charts.utils.getNumberFormatter(this.formatLocale,this.dataTable.columns[1].type,this.settings)},getYMaxValue:function(){var e=t(this.dataTable.rows,(function(t){return t[1]}));return 0===e&&(e=1),e},getYTickValues:function(){var t=this.getYMaxValue();return t>1?[t/2,t]:[0,t]}},{defaults:{chartClass:"area",margin:{top:25,right:5,bottom:25,left:0},plots:!0,tips:!0,xAxis:{gridlines:!1,showAxis:!0,formatter:$.noop},yAxis:{gridlines:!0,showAxis:!1,formatter:$.noop}}}),Craft.charts.utils={getDuration:function(t){var e=parseInt(t,10),n={hours:Math.floor(e/3600),minutes:Math.floor((e-3600*n.hours)/60),seconds:e-3600*n.hours-60*n.minutes};return n.hours<10&&(n.hours="0".concat(n.hours)),n.minutes<10&&(n.minutes="0".concat(n.minutes)),n.seconds<10&&(n.seconds="0".concat(n.seconds)),"".concat(n.hours,":").concat(n.minutes,":").concat(n.seconds)},getTimeFormatter:function(t,e){switch(e.dataScale){case"year":return t.format("%Y");case"month":return t.format(e.formats.shortDateFormats.month);case"hour":return t.format("".concat(e.formats.shortDateFormats.day," %H:00:00"));default:return t.format(e.formats.shortDateFormats.day)}},getNumberFormatter:function(t,e,n){switch(e){case"currency":return t.format(n.formats.currencyFormat);case"percent":return t.format(n.formats.percentFormat);case"time":return Craft.charts.utils.getDuration;case"number":return t.format(n.formats.numberFormat)}}},__webpack_require__(2059),__webpack_require__(8875),__webpack_require__(4885);var ys=function(){};function bs(t){return bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(t)}ys.extend=function(t,e){var n=ys.prototype.extend;ys._prototyping=!0;var i=new this;n.call(i,t),i.base=function(){},delete ys._prototyping;var r=i.constructor,a=i.constructor=function(){if(!ys._prototyping)if(this._constructing||this.constructor==a)this._constructing=!0,r.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||n).call(arguments[0],i)};return a.ancestor=this,a.extend=this.extend,a.forEach=this.forEach,a.implement=this.implement,a.prototype=i,a.toString=this.toString,a.valueOf=function(t){return"object"==t?a:r.valueOf()},n.call(a,e),"function"==typeof a.init&&a.init(),a},ys.prototype={extend:function(t,e){if(arguments.length>1){var n=this[t];if(n&&"function"==typeof e&&(!n.valueOf||n.valueOf()!=e.valueOf())&&/\bbase\b/.test(e)){var i=e.valueOf();e=function(){var t=this.base||ys.prototype.base;this.base=n;var e=i.apply(this,arguments);return this.base=t,e},e.valueOf=function(t){return"object"==t?e:i},e.toString=ys.toString}this[t]=e}else if(t){var r=ys.prototype.extend;ys._prototyping||"function"==typeof this||(r=this.extend||r);for(var a={toSource:null},s=["constructor","toString","valueOf"],o=ys._prototyping?0:1;l=s[o++];)t[l]!=a[l]&&r.call(this,l,t[l]);for(var l in t)if(!a[l]){var c=Object.getOwnPropertyDescriptor(t,l);"undefined"!=vs(c.value)?r.call(this,l,c.value):Object.defineProperty(this,l,c)}}return this}},ys=ys.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(t,e,n){for(var i in t)void 0===this.prototype[i]&&e.call(n,t[i],i,t)},implement:function(){for(var t=0;t<arguments.length;t++)"function"==typeof arguments[t]?arguments[t](this.prototype):this.prototype.extend(arguments[t]);return this},toString:function(){return String(this.valueOf())}});var ws=ys.extend({settings:null,_eventHandlers:null,_namespace:null,_$listeners:null,_disabled:!1,constructor:function(){this._eventHandlers=[],this._namespace=".Garnish"+Math.floor(1e9*Math.random()),this._listeners=[],this.init.apply(this,arguments)},init:fs().noop,setSettings:function(t,e){var n=void 0===this.settings?{}:this.settings;this.settings=fs().extend({},n,e,t)},on:function(t,e,n){"function"==typeof e&&(n=e,e={}),t=ro._normalizeEvents(t);for(var i=0;i<t.length;i++){var r=t[i];this._eventHandlers.push({type:r[0],namespace:r[1],data:e,handler:n})}},off:function(t,e){t=ro._normalizeEvents(t);for(var n=0;n<t.length;n++)for(var i=t[n],r=this._eventHandlers.length-1;r>=0;r--){var a=this._eventHandlers[r];a.type!==i[0]||i[1]&&a.namespace!==i[1]||a.handler!==e||this._eventHandlers.splice(r,1)}},once:function(t,e,n){var i=this;"function"==typeof e&&(n=e,e={});var r=function(e){i.off(t,r),n(e)};this.on(t,e,r)},trigger:function(t,e){var n=this,i={type:t,target:this};this._eventHandlers.filter((function(e){return e.type===t})).forEach((function(t){var n=fs().extend({data:t.data},e,i);t.handler(n)})),ro._eventHandlers.filter((function(e){return e&&e.target&&n instanceof e.target&&e.type===t})).forEach((function(t){var n=fs().extend({data:t.data},e,i);t.handler(n)}))},_splitEvents:function(t){if("string"==typeof t){t=t.split(",");for(var e=0;e<t.length;e++)t[e]=fs().trim(t[e])}return t},_formatEvents:function(t){t=this._splitEvents(t).slice(0);for(var e=0;e<t.length;e++)t[e]+=this._namespace;return t.join(" ")},addListener:function(t,e,n,i){var r=fs()(t);r.length&&(e=this._splitEvents(e),void 0===i&&"object"!==bs(n)&&(i=n,n={}),i="function"==typeof i?i.bind(this):this[i].bind(this),r.on(this._formatEvents(e),n,fs().proxy((function(){if(!this._disabled)return i.apply(this,arguments)}),this)),-1===fs().inArray(t,this._listeners)&&this._listeners.push(t))},removeListener:function(t,e){fs()(t).off(this._formatEvents(e))},removeAllListeners:function(t){fs()(t).off(this._namespace)},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},destroy:function(){this.trigger("destroy"),this.removeAllListeners(this._listeners)}});function Cs(t){return Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(t)}function $s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var _s=ws.extend({$items:null,dragging:!1,mousedownX:null,mousedownY:null,realMouseX:null,realMouseY:null,mouseX:null,mouseY:null,mouseDistX:null,mouseDistY:null,mouseOffsetX:null,mouseOffsetY:null,$targetItem:null,scrollProperty:null,scrollAxis:null,scrollDist:null,scrollFrame:null,_:null,init:function(t,e){void 0===e&&fs().isPlainObject(t)&&(e=t,t=null),this.settings=fs().extend({},ro.BaseDrag.defaults,e),this.$items=fs()(),this._={},t&&this.addItems(t)},allowDragging:function(){return!0},startDragging:function(){this.onBeforeDragStart(),this.dragging=!0,this.setScrollContainer(),this.onDragStart(),ro.activateEventsMuted=!0},setScrollContainer:function(){for(this._.$scrollContainer=this.$targetItem.scrollParent();;){if(this._.$scrollContainer[0]===ro.$doc[0]||this._.$scrollContainer[0]===ro.$bod[0]){this._.$scrollContainer=ro.$win;break}if(this.settings.axis!==ro.X_AXIS&&this._.$scrollContainer[0].scrollHeight>this._.$scrollContainer[0].clientHeight||this.settings.axis!==ro.Y_AXIS&&this._.$scrollContainer[0].scrollWidth>this._.$scrollContainer[0].clientWidth)break;this._.$scrollContainer=this._.$scrollContainer.scrollParent()}},isScrollingWindow:function(){return this._.$scrollContainer[0]===ro.$win[0]},drag:function(t){var e=this;t&&(this.drag._scrollProperty=null,this.settings.axis!==ro.X_AXIS&&(this.isScrollingWindow()?(this.drag._minMouseScrollY=ro.$win.scrollTop(),this.drag._maxMouseScrollY=this.drag._minMouseScrollY+ro.$win.height()):(this.drag._minMouseScrollY=this._.$scrollContainer.offset().top,this.drag._maxMouseScrollY=this.drag._minMouseScrollY+this._.$scrollContainer.outerHeight()),this.drag._minMouseScrollY+=ro.BaseDrag.windowScrollTargetSize,this.drag._maxMouseScrollY-=ro.BaseDrag.windowScrollTargetSize,this.mouseY<this.drag._minMouseScrollY?(this.drag._scrollProperty="scrollTop",this.drag._scrollAxis="Y",this.drag._scrollDist=Math.round((this.mouseY-this.drag._minMouseScrollY)/2)):this.mouseY>this.drag._maxMouseScrollY&&(this.drag._scrollProperty="scrollTop",this.drag._scrollAxis="Y",this.drag._scrollDist=Math.round((this.mouseY-this.drag._maxMouseScrollY)/2))),this.drag._scrollProperty||this.settings.axis===ro.Y_AXIS||(this.isScrollingWindow()?(this.drag._minMouseScrollX=ro.$win.scrollLeft(),this.drag._maxMouseScrollX=this.drag._minMouseScrollX+ro.$win.width()):(this.drag._minMouseScrollX=this._.$scrollContainer.offset().left,this.drag._maxMouseScrollX=this.drag._minMouseScrollX+this._.$scrollContainer.outerWidth()),this.drag._minMouseScrollX+=ro.BaseDrag.windowScrollTargetSize,this.drag._maxMouseScrollX-=ro.BaseDrag.windowScrollTargetSize,this.mouseX<this.drag._minMouseScrollX?(this.drag._scrollProperty="scrollLeft",this.drag._scrollAxis="X",this.drag._scrollDist=Math.round((this.mouseX-this.drag._minMouseScrollX)/2)):this.mouseX>this.drag._maxMouseScrollX&&(this.drag._scrollProperty="scrollLeft",this.drag._scrollAxis="X",this.drag._scrollDist=Math.round((this.mouseX-this.drag._maxMouseScrollX)/2))),this.drag._scrollProperty?(this.scrollProperty||(this.scrollFrame&&(ro.cancelAnimationFrame(this.scrollFrame),this.scrollFrame=null),this.scrollFrame=ro.requestAnimationFrame((function(){e._scrollWindow()}))),this.scrollProperty=this.drag._scrollProperty,this.scrollAxis=this.drag._scrollAxis,this.scrollDist=this.drag._scrollDist):this._cancelWindowScroll()),this.onDrag()},stopDragging:function(){this.dragging=!1,this.onDragStop(),this._cancelWindowScroll(),ro.requestAnimationFrame((function(){ro.activateEventsMuted=!1}))},addItems:function(t){var e,n=this,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $s(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}(t=fs().makeArray(t));try{var r=function(){var t=e.value;if(fs().data(t,"drag")){if(fs().data(t,"drag")===n)return 1;console.warn("Element was added to more than one dragger"),fs().data(t,"drag").removeItems(t)}fs().data(t,"drag",n),n.addListener(n._getItemHandle(t),"mousedown",(function(e){n._handleMouseDown(e,t)}))};for(i.s();!(e=i.n()).done;)r()}catch(t){i.e(t)}finally{i.f()}this.$items=this.$items.add(t)},removeItems:function(t){t=fs().makeArray(t);for(var e=0;e<t.length;e++){var n=t[e],i=fs().inArray(n,this.$items);-1!==i&&(this._deinitItem(n),this.$items.splice(i,1))}},getPrevItem:function(t){t instanceof jQuery&&(t=t[0]),this.$items=fs()().add(this.$items);var e=fs().inArray(t,this.$items);return-1===e||0===e?null:this.$items.eq(e-1)},getNextItem:function(t){t instanceof jQuery&&(t=t[0]),this.$items=fs()().add(this.$items);var e=fs().inArray(t,this.$items);return-1===e||e===this.$items.length-1?null:this.$items.eq(e+1)},removeAllItems:function(){for(var t=0;t<this.$items.length;t++)this._deinitItem(this.$items[t]);this.$items=fs()()},destroy:function(){this.removeAllItems(),this.base()},onBeforeDragStart:function(){this.trigger("beforeDragStart"),this.settings.onBeforeDragStart()},onDragStart:function(){ro.requestAnimationFrame(function(){this.trigger("dragStart"),this.settings.onDragStart()}.bind(this))},onDrag:function(){ro.requestAnimationFrame(function(){this.trigger("drag"),this.settings.onDrag()}.bind(this))},onDragStop:function(){ro.requestAnimationFrame(function(){this.trigger("dragStop"),this.settings.onDragStop()}.bind(this))},_handleMouseDown:function(t,e){if(ro.isPrimaryClick(t)&&!this.$targetItem){var n=fs()(t.target);if((e===t.target||!this.settings.ignoreHandleSelector||!n.is(this.settings.ignoreHandleSelector)&&!n.closest(this.settings.ignoreHandleSelector).length)&&(t.preventDefault(),this.allowDragging())){this.$targetItem=fs()(e),this.mousedownX=this.mouseX=t.pageX,this.mousedownY=this.mouseY=t.pageY;var i=this.$targetItem.offset();this.mouseOffsetX=t.pageX-i.left,this.mouseOffsetY=t.pageY-i.top,this.addListener(ro.$doc,"mousemove","_handleMouseMove"),this.addListener(ro.$doc,"mouseup","_handleMouseUp")}}},_getItemHandle:function(t){if(this.settings.handle){if("object"===Cs(this.settings.handle))return fs()(this.settings.handle);if("string"==typeof this.settings.handle){var e=this.settings.handle.split(",").map((function(t){return Craft.ensureEndsWith(t.trim(),":first")})).join(",");return fs()(e,t)}if("function"==typeof this.settings.handle)return fs()(this.settings.handle(t))}return fs()(t)},_handleMouseMove:function(t){var e;t.preventDefault(),this.realMouseX=t.pageX,this.realMouseY=t.pageY,this.settings.axis!==ro.Y_AXIS&&(this.mouseX=t.pageX),this.settings.axis!==ro.X_AXIS&&(this.mouseY=t.pageY),this.mouseDistX=this.mouseX-this.mousedownX,this.mouseDistY=this.mouseY-this.mousedownY,this.dragging||(this._handleMouseMove._mouseDist=ro.getDist(this.mousedownX,this.mousedownY,this.realMouseX,this.realMouseY),this._handleMouseMove._mouseDist>=(null!==(e=this.settings.minMouseDist)&&void 0!==e?e:ro.BaseDrag.minMouseDist)&&this.startDragging()),this.dragging&&this.drag(!0)},_handleMouseUp:function(t){this.removeAllListeners(ro.$doc),this.dragging&&this.stopDragging(),this.$targetItem=null},_scrollWindow:function(){var t=this;this._.scrollPos=this._.$scrollContainer[this.scrollProperty](),this._.scrollTargetPos=this._.scrollPos+this.scrollDist,this._.scrollTargetPos<0?this._.scrollTargetPos=0:("Y"===this.scrollAxis?this._.scrollMax=this._.$scrollContainer[0].scrollHeight-this._.$scrollContainer.outerHeight():this._.scrollMax=this._.$scrollContainer[0].scrollWidth-this._.$scrollContainer.outerWidth(),this._.scrollTargetPos>this._.scrollMax&&(this._.scrollTargetPos=this._.scrollMax)),this._.$scrollContainer[this.scrollProperty](this._.scrollTargetPos),this.isScrollingWindow()&&(this["mouse"+this.scrollAxis]-=this._.scrollPos-ro.$win[this.scrollProperty](),this["realMouse"+this.scrollAxis]=this["mouse"+this.scrollAxis]),this.scrollFrame=ro.requestAnimationFrame((function(){t._scrollWindow()})),this.drag(!0)},_cancelWindowScroll:function(){this.scrollFrame&&(ro.cancelAnimationFrame(this.scrollFrame),this.scrollFrame=null),this.scrollProperty=null,this.scrollAxis=null,this.scrollDist=null},_deinitItem:function(t){this.removeAllListeners(t),fs().removeData(t,"drag")}},{minMouseDist:1,windowScrollTargetSize:25,defaults:{minMouseDist:null,handle:null,axis:null,ignoreHandleSelector:"input, textarea, button, select, .btn",onBeforeDragStart:fs().noop,onDragStart:fs().noop,onDrag:fs().noop,onDragStop:fs().noop}}),Ss=ws.extend({$container:null,$all:null,$options:null,init:function(t,e){var n=this;this.$container=fs()(t),this.setSettings(e,ro.CheckboxSelect.defaults),this.$container.data("checkboxSelect")&&(console.warn("Double-instantiating a checkbox select on an element"),this.$container.data("checkboxSelect").destroy()),this.$container.data("checkboxSelect",this);var i=this.$container.find("input");if(this.$all=i.filter(".all:first"),this.$options=i.not(this.$all),this.addListener(this.$all,"change","onAllChange"),this.settings.storageKey){var r=Craft.getLocalStorage(this.settings.storageKey);r&&(this.$all.length&&r.includes(this.$all.val())?this.isAllChecked()||this.$all.prop("checked",!0).trigger("change"):(this.isAllChecked()&&this.$all.prop("checked",!1).trigger("change"),this.$options.each((function(t,e){var n=r.includes(e.value);n!==e.checked&&(e.checked=n,fs()(e).trigger("change"))})))),i.on("change",(function(){var t=[];n.$all.prop("checked")?t.push(n.$all.val()):n.$options.each((function(e,n){n.checked&&t.push(n.value)})),Craft.setLocalStorage(n.settings.storageKey,t)}))}},isAllChecked:function(){return this.$all.prop("checked")},onAllChange:function(){var t=this.isAllChecked();this.$options.prop({checked:t,disabled:t})},destroy:function(){this.$container.removeData("checkboxSelect"),this.base()}},{defaults:{storageKey:null}}),xs=ws.extend({$target:null,options:null,$menu:null,showingMenu:!1,init:function(t,e,n){this.$target=fs()(t),this.$target.data("contextmenu")&&(console.warn("Double-instantiating a context menu on an element"),this.$target.data("contextmenu").destroy()),this.$target.data("contextmenu",this),this.options=e,this.setSettings(n,ro.ContextMenu.defaults),ro.ContextMenu.counter++,this.enable()},buildMenu:function(){this.$menu=fs()('<div class="'+this.settings.menuClass+'" style="display: none" />');var t=fs()("<ul/>").appendTo(this.$menu);for(var e in this.options)if(this.options.hasOwnProperty(e)){var n=this.options[e];if("-"===n)fs()("<hr/>").appendTo(this.$menu),t=fs()("<ul/>").appendTo(this.$menu);else{var i=fs()("<li></li>").appendTo(t),r=fs()("<a>"+n.label+"</a>").appendTo(i);"function"==typeof n.onClick&&function(t,e){setTimeout(function(){t.mousedown(function(t){this.hideMenu(),e.call(this.currentTarget,fs().extend(t,{currentTarget:this.currentTarget}))}.bind(this))}.bind(this),1)}.call(this,r,n.onClick)}}},showMenu:function(t){"mousedown"===t.type&&t.which!==ro.SECONDARY_CLICK||("contextmenu"===t.type&&t.preventDefault(),this.showing&&t.currentTarget===this.currentTarget||(this.currentTarget=t.currentTarget,this.$menu||this.buildMenu(),this.$menu.appendTo(document.body),this.$menu.show(),this.$menu.css({left:t.pageX+1,top:t.pageY-4}),this.showing=!0,this.trigger("show"),ro.uiLayerManager.addLayer(this.$menu),ro.uiLayerManager.registerShortcut(ro.ESC_KEY,this.hideMenu.bind(this)),setTimeout(function(){this.addListener(ro.$doc,"mousedown","hideMenu")}.bind(this),0)))},hideMenu:function(){this.removeListener(ro.$doc,"mousedown"),this.$menu.hide(),this.showing=!1,this.trigger("hide"),ro.uiLayerManager.removeLayer()},enable:function(){this.addListener(this.$target,"contextmenu,mousedown","showMenu")},disable:function(){this.removeListener(this.$target,"contextmenu,mousedown")},destroy:function(){this.$target.removeData("contextmenu"),this.base()}},{defaults:{menuClass:"menu"},counter:0});function Is(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var Es=ws.extend({settings:null,visible:!1,$container:null,$options:null,$ariaOptions:null,$anchor:null,menuId:null,_windowWidth:null,_windowHeight:null,_windowScrollLeft:null,_windowScrollTop:null,_anchorOffset:null,_anchorWidth:null,_anchorHeight:null,_anchorOffsetRight:null,_anchorOffsetBottom:null,_menuWidth:null,_menuHeight:null,init:function(t,e){this.setSettings(e,ro.CustomSelect.defaults),this.$container=fs()(t),this.$options=fs()(),this.$ariaOptions=fs()(),this.menuId="menu"+this._namespace,this.$container.attr({role:"listbox",id:this.menuId}),this.$container.find("ul").attr("role","group"),this.addOptions(this.$container.find("a,.menu-item,.menu-option")),this.settings.attachToElement&&(this.settings.anchor=this.settings.attachToElement,console.warn("The 'attachToElement' setting is deprecated. Use 'anchor' instead.")),this.settings.anchor&&(this.$anchor=fs()(this.settings.anchor)),this.addListener(this.$container,"mousedown",(function(t){t.stopPropagation(),"INPUT"!==t.target.nodeName&&t.preventDefault()}))},addOptions:function(t){var e=this;this.$options=this.$options.add(t),t.data("menu",this);for(var n=function(){var n=t.eq(i),r=n.parent("li");n.attr({tabindex:"-1",id:n.attr("id")||"".concat(e.menuId,"-option-").concat(i+1)}),r.attr({role:"option","aria-selected":n.hasClass("sel")?"true":"false",id:r.attr("id")||"".concat(e.menuId,"-aria-option-").concat(i+1)}),e.$ariaOptions=e.$ariaOptions.add(r),n.data("menu-mutationObserver",new MutationObserver((function(t){var i,a=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Is(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Is(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;if("attributes"===s.type&&"class"===s.attributeName){var o=e.$options.is(".hover");r.attr("aria-selected",!o&&n.hasClass("sel")||n.hasClass("hover")?"true":"false");break}}}catch(t){a.e(t)}finally{a.f()}}))),n.data("menu-mutationObserver").observe(n[0],{attributes:!0})},i=0;i<t.length;i++)n();this.removeAllListeners(t),this.addListener(t,"click",(function(t){this.selectOption(t.currentTarget)}))},setPositionRelativeToAnchor:function(){this._windowWidth=ro.$win.width(),this._windowHeight=ro.$win.height(),this._windowScrollLeft=ro.$win.scrollLeft(),this._windowScrollTop=ro.$win.scrollTop(),this._anchorOffset=this.$anchor.offset(),this._anchorWidth=this.$anchor.outerWidth(),this._anchorHeight=this.$anchor.outerHeight(),this._anchorOffsetRight=this._anchorOffset.left+this._anchorHeight,this._anchorOffsetBottom=this._anchorOffset.top+this._anchorHeight,this.$container.css("minWidth",0),this.$container.css("minWidth",this._anchorWidth-(this.$container.outerWidth()-this.$container.width())),this._menuWidth=this.$container.outerWidth(),this._menuHeight=this.$container.outerHeight();var t=this._anchorOffset.top-this._windowScrollTop,e=this._windowHeight+this._windowScrollTop-this._anchorOffsetBottom;e>=this._menuHeight||t<this._menuHeight&&e>=t?this.$container.css({top:this._anchorOffsetBottom,maxHeight:e-this.settings.windowSpacing}):this.$container.css({top:this._anchorOffset.top-Math.min(this._menuHeight,t-this.settings.windowSpacing),maxHeight:t-this.settings.windowSpacing});var n=this.$container.data("align");if("left"!==n&&"center"!==n&&"right"!==n&&(n="left"),"center"===n)this._alignCenter();else{var i=this._windowWidth+this._windowScrollLeft-(this._anchorOffset.left+this._menuWidth),r=this._anchorOffsetRight-this._menuWidth;("right"===n&&r>=0||i<0)&&this._menuWidth<this._anchorOffset.left+this._anchorWidth?this._alignRight():this._alignLeft()}delete this._windowWidth,delete this._windowHeight,delete this._windowScrollLeft,delete this._windowScrollTop,delete this._anchorOffset,delete this._anchorWidth,delete this._anchorHeight,delete this._anchorOffsetRight,delete this._anchorOffsetBottom,delete this._menuWidth,delete this._menuHeight},show:function(){this.visible||(this.$container.appendTo(ro.$bod),this.$anchor&&this.setPositionRelativeToAnchor(),this.$container.velocity("stop").addClass("visible").css("opacity",1),ro.uiLayerManager.addLayer(this.$container).registerShortcut(ro.ESC_KEY,this.hide.bind(this)),this.addListener(ro.$scrollContainer,"scroll","setPositionRelativeToAnchor"),this.addListener(ro.$win,"resize","setPositionRelativeToAnchor"),this.visible=!0,this.trigger("show"))},hide:function(){var t=this;this.visible&&(this.$options.removeClass("hover"),this.$options.filter(".sel").parent("li").attr("aria-selected","true"),this.$container.velocity("stop").velocity("fadeOut",{duration:ro.FX_DURATION,complete:function(){t.$container.removeClass("visible").css("display","").detach()}}),ro.uiLayerManager.removeLayer(this.$container),this.removeListener(ro.$scrollContainer,"scroll"),this.removeListener(ro.$win,"resize"),this.visible=!1,this.trigger("hide"))},selectOption:function(t){this.settings.onOptionSelect(t),this.trigger("optionselect",{selectedOption:t}),this.hide()},_alignLeft:function(){this.$container.css({left:this._anchorOffset.left,right:"auto"}),this._menuWidth>this._windowWidth-this._anchorOffset.left&&this.$container.css({maxWidth:this._windowWidth-this._anchorOffset.left-10})},_alignRight:function(){this.$container.css({right:this._windowWidth-(this._anchorOffset.left+this._anchorWidth),left:"auto"}),this._menuWidth>this._anchorOffset.left+this._anchorWidth&&this.$container.css({maxWidth:this._anchorOffset.left+this._anchorWidth-10})},_alignCenter:function(){var t=Math.round(this._anchorOffset.left+this._anchorWidth/2-this._menuWidth/2);t<0&&(t=0),this.$container.css("left",t)},destroy:function(){for(var t=0;t<this.$options.length;t++){var e=this.$options.eq(t);e.data("menu-mutationObserver").disconnect(),e.removeData("menu-mutationObserver")}this.base()}},{defaults:{anchor:null,windowSpacing:5,onOptionSelect:fs().noop}});function Ts(t){return Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(t)}function Ds(){Ds=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Ts(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ts(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function Ls(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function ks(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return As(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?As(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function As(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var Ps=ws.extend({settings:null,$trigger:null,$container:null,$alignmentElement:null,$nextFocusableElement:null,$searchInput:null,_viewportWidth:null,_viewportHeight:null,_viewportScrollLeft:null,_viewportScrollTop:null,_alignmentElementOffset:null,_alignmentElementWidth:null,_alignmentElementHeight:null,_alignmentElementOffsetRight:null,_alignmentElementOffsetBottom:null,_menuWidth:null,_menuHeight:null,searchStr:"",clearSearchStrTimeout:null,infoIconActivated:!1,init:function(t,e){if(this.setSettings(e,ro.DisclosureMenu.defaults),this.$trigger=fs()(t),this.$trigger.data("trigger"))console.warn("Double-instantiating a disclosure menu on an element");else{this.$trigger.attr("data-disclosure-trigger","true");var n=this.$trigger.attr("aria-controls");if(this.$container=fs()("#"+n),!this.$container.length){var i=this.$trigger.next();if(!i.is("#".concat(n)))throw"No disclosure container found.";this.$container=i}this.$trigger.data("disclosureMenu",this),this.$container.data("disclosureMenu",this),this.$trigger.data("trigger",this),this.$container.data("trigger",this),this.$trigger.attr("aria-expanded")||this.$trigger.attr("aria-expanded","false");var r=this.$container.data("align-to");this.$alignmentElement=r?this.$trigger.find(r).first():this.$trigger,this.$container.appendTo(ro.$bod),this.$trigger.parents(".slideout").length>0&&Craft.initUiElements(this.$container),this.addDisclosureMenuEventListeners(),this.settings.withSearchInput=this.settings.withSearchInput||ro.hasAttr(this.$container,"data-with-search-input"),this.settings.withSearchInput&&this.addSearchInput(),ro.DisclosureMenu.instances.push(this)}},addSearchInput:function(){var t=this,e=fs()("<div/>",{class:"search-container"}).prependTo(this.$container),n=fs()("<div/>",{class:"texticon search icon clearable"}).appendTo(e);this.$searchInput=fs()("<input/>",{class:"fullwidth text",type:"text",inputmode:"search",autocomplete:"off",placeholder:Craft.t("app","Search")}).appendTo(n);var i=fs()("<div/>",{class:"clear-btn hidden",title:Craft.t("app","Clear"),"aria-label":Craft.t("app","Clear")}).appendTo(n);this.$searchInput.on("input",(function(e){var n=t.$searchInput.val().toLowerCase().replace(/['"]/g,""),r=t.$container.find("li");if(n){i.removeClass("hidden");var a=fs()();r.each((function(t,e){var i=fs()(e);i.text().toLowerCase().includes(n)&&(a=a.add(i))})),a.removeClass("filtered"),r.not(a).addClass("filtered"),t.$container.find("h3").each((function(t,e){var i=fs()(e);i.text().toLowerCase().includes(n)&&i.next("ul").find("li.filtered").removeClass("filtered")}))}else i.addClass("hidden"),r.removeClass("filtered");t.updateVisibility(),t.setContainerPosition()})),this.addListener(this.$searchInput,"keydown",(function(e){switch(e.keyCode){case ro.ESC_KEY:t.$searchInput.val("").trigger("input");break;case ro.RETURN_KEY:e.preventDefault()}})),this.addListener(i,"click",(function(){t.$searchInput.val("").trigger("input").focus()}))},addDisclosureMenuEventListeners:function(){var t=this;this.addListener(this.$trigger,"mousedown",(function(e){e.stopPropagation(),e.preventDefault();var n,i=ks(ro.DisclosureMenu.instances);try{for(i.s();!(n=i.n()).done;){var r=n.value;r!==t&&r.handleMousedown(e)}}catch(t){i.e(t)}finally{i.f()}})),this.addListener(this.$trigger,"mouseup",(function(t){t.stopPropagation(),t.preventDefault()})),this.addListener(this.$trigger,"click",(function(e){e.stopPropagation(),e.preventDefault(),t.handleTriggerClick()})),this.addListener(this.$container,"keydown",(function(e){t.handleKeypress(e)})),this.addListener(ro.$doc,"mousedown",(function(e){t.handleMousedown(e)})),this.addListener(this.$trigger,"keydown",(function(e){if(e.keyCode===ro.TAB_KEY&&!e.shiftKey&&t.isExpanded()){var n=t.$container.find(":focusable:first");n.length&&(e.preventDefault(),n.focus())}}))},focusElement:function(t){if(t instanceof HTMLElement||t instanceof jQuery){var e=fs()(t);return e.is(":focusable")||(e=e.find(":focusable")),void e.focus()}var n,i=fs()(":focus"),r=this.$container.find(":focusable"),a=r.index(i);(n="prev"===t?a-1:a+1)>=0&&n<r.length&&r[n].focus()},handleMousedown:function(t){var e=fs()(t.target);if(this.infoIconActivated)this.infoIconActivated=!1;else if(t.target.classList.contains("info")&&(this.infoIconActivated=!0),!e.closest("[data-disclosure-trigger]").is(this.$trigger)&&this.$container[0]!==t.target&&!this.$container.has(e).length){var n=e.closest(".menu--disclosure");if(n.length){var i=n.data("disclosureMenu");if(i&&this.$container.has(i.$trigger).length)return}this.hide()}},handleKeypress:function(t){var e=this;if(!ro.isCtrlKeyPressed(t)){switch(t.keyCode){case ro.RIGHT_KEY:case ro.DOWN_KEY:return t.preventDefault(),void this.focusElement("next");case ro.LEFT_KEY:case ro.UP_KEY:return t.preventDefault(),void this.focusElement("prev");case ro.TAB_KEY:var n=this.$container.find(":focusable"),i=n.index(t.target);return void(0===i&&t.shiftKey?(t.preventDefault(),this.$trigger.focus()):i===n.length-1&&!t.shiftKey&&this.$nextFocusableElement&&(t.preventDefault(),this.$nextFocusableElement.focus()))}if("INPUT"!==t.target.nodeName&&t.key&&(t.key.match(/^[^ ]$/)||this.searchStr.length&&" "===t.key)){var r;this.searchStr+=t.key.toLowerCase();for(var a=this.$container.find("li"),s=0;s<a.length;s++){var o=a.eq(s);if(void 0===o.data("searchText")){var l=o.clone();l.find("svg").remove(),o.data("searchText",l.text().toLowerCase().trimStart())}if(o.data("searchText").startsWith(this.searchStr)){r=o;break}}r&&r.length&&this.focusElement(r),this.clearSearchStrTimeout&&clearTimeout(this.clearSearchStrTimeout),this.clearSearchStrTimeout=setTimeout((function(){e.clearSearchStr()}),1e3)}}},isExpanded:function(){return"true"===this.$trigger.attr("aria-expanded")},handleTriggerClick:function(){this.isExpanded()?this.hide():this.show()},show:function(){var t=this;if(!this.isExpanded()&&!this.$trigger.hasClass("disabled")){this.trigger("beforeShow"),this.$container.appendTo(ro.$bod),this.setContainerPosition(),this.addListener(ro.$scrollContainer,"scroll","setContainerPosition");var e=this.$trigger.scrollParent();e.get(0)!==document.body&&this.addListener(e,"scroll","setContainerPosition"),this.addListener(ro.$win,"resize","setContainerPosition"),this.$container.velocity("stop").addClass("visible").css("opacity",1),"none"===this.$container.css("display")&&this.$container.css("display","block"),this.$trigger.attr("aria-expanded","true");var n=this.$container.find(":focusable")[0];n?n.focus():(this.$container.attr("tabindex","-1"),this.$container.focus());var i=ro.$bod.find(":focusable"),r=i.index(this.$trigger[0]);-1!==r&&i.length>r+1&&(this.$nextFocusableElement=i.eq(r+1),this.addListener(this.$nextFocusableElement,"keydown",(function(e){if(e.keyCode===ro.TAB_KEY&&e.shiftKey){var n=t.$container.find(":focusable:last");n.length&&(e.preventDefault(),n.focus())}}))),this.trigger("show"),this.clearSearchStr(),ro.uiLayerManager.addLayer(this.$container),ro.uiLayerManager.registerShortcut(ro.ESC_KEY,function(){this.hide()}.bind(this))}},hide:function(){var t=this;this.isExpanded()&&(this.$container.velocity("fadeOut",{duration:ro.FX_DURATION,complete:function(){t.$container.removeClass("visible").css("display","")}}),this.$trigger.attr("aria-expanded","false"),this.focusIsInMenu()&&this.$trigger.focus(),this.$nextFocusableElement&&(this.removeListener(this.$nextFocusableElement,"keydown"),this.$nextFocusableElement=null),this.$searchInput&&this.$searchInput.val("").trigger("input"),this.trigger("hide"),this.clearSearchStr(),this.removeListener(ro.$scrollContainer,"scroll"),this.removeListener(ro.$win,"resize"),ro.uiLayerManager.removeLayer(this.$container))},focusIsInMenu:function(){if(!this.$container.length)return!1;var t=ro.getFocusedElement();return t.length&&fs().contains(this.$container[0],t[0])},setContainerPosition:function(){this._viewportWidth=ro.$win.width(),this._viewportHeight=ro.$win.height(),this._viewportScrollLeft=ro.$win.scrollLeft(),this._viewportScrollTop=ro.$win.scrollTop(),this._alignmentElementOffset=this.$alignmentElement.offset(),this._alignmentElementWidth=this.$alignmentElement.outerWidth(),this._alignmentElementHeight=this.$alignmentElement.outerHeight(),this._alignmentElementOffsetRight=this._alignmentElementOffset.left+this._alignmentElementWidth,this._alignmentElementOffsetBottom=this._alignmentElementOffset.top+this._alignmentElementHeight,this.$container.css("minWidth",0),this.$container.css("minWidth",this._alignmentElementWidth-(this.$container.outerWidth()-this.$container.width())),this._menuWidth=this.$container.outerWidth(),this._menuHeight=this.$container.outerHeight(),this._menuWidth>this._viewportWidth&&(this.$container.css("maxWidth",this._viewportWidth),this._menuWidth=this._viewportWidth);var t=this._alignmentElementOffset.top-this._viewportScrollTop,e=this._viewportHeight+this._viewportScrollTop-this._alignmentElementOffsetBottom;"below"===this.settings.position||e>=this._menuHeight||t<this._menuHeight&&e>=t?this.$container.css({top:this._alignmentElementOffsetBottom,maxHeight:e-this.settings.windowSpacing}):this.$container.css({top:this._alignmentElementOffset.top-Math.min(this._menuHeight,t-this.settings.windowSpacing),maxHeight:t-this.settings.windowSpacing});var n=this.$container.data("align");if("left"!==n&&"center"!==n&&"right"!==n&&(n="left"),this._menuWidth===this._viewportWidth||"center"===n)this._alignCenter();else{var i=this._viewportWidth+this._viewportScrollLeft-(this._alignmentElementOffset.left+this._menuWidth),r=this._alignmentElementOffsetRight-this._menuWidth;r<0&&i<0?this._alignCenter():"right"===n&&r>=0||i<0?this._alignRight():this._alignLeft()}delete this._viewportWidth,delete this._viewportHeight,delete this._viewportScrollLeft,delete this._viewportScrollTop,delete this._alignmentElementOffset,delete this._alignmentElementWidth,delete this._alignmentElementHeight,delete this._alignmentElementOffsetRight,delete this._alignmentElementOffsetBottom,delete this._menuWidth,delete this._menuHeight},clearSearchStr:function(){this.searchStr="",this.clearSearchStrTimeout&&(clearTimeout(this.clearSearchStrTimeout),this.clearSearchStrTimeout=null)},isPadded:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ul";return this.$container.children("".concat(t,".padded")).length},createItem:function(t){var e,n=this;if(t.nodeType===Node.ELEMENT_NODE)return t;if(t instanceof jQuery)return t[0];if(!fs().isPlainObject(t))throw"Unsupported item configuration.";e=t.type?t.type:t.url?"link":"button";var i,r=document.createElement("li"),a=document.createElement("button"===e?"button":"a");if("button"===e&&a.setAttribute("type","button"),a.id=t.id||"menu-item-".concat(Math.floor(1e6*Math.random())),a.className="menu-item",t.selected&&a.classList.add("sel"),t.destructive&&(a.classList.add("error"),a.setAttribute("data-destructive","true")),t.disabled&&a.classList.add("disabled"),t.action&&(a.classList.add("formsubmit"),fs()(a).formsubmit()),"link"===e&&(a.href=Craft.getUrl(t.url)),t.icon&&("string"==typeof t.icon?(a.setAttribute("data-icon",t.icon),t.iconColor&&a.classList.add(t.iconColor)):(i=Ds().mark((function e(){var n,i;return Ds().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.icon instanceof Element)){e.next=4;break}n=t.icon,e.next=11;break;case 4:if("function"!=typeof t.icon){e.next=10;break}return e.next=7,t.icon();case 7:n=e.sent,e.next=11;break;case 10:throw"Unsupported icon type";case 11:(i=document.createElement("span")).className="icon",t.iconColor&&i.classList.add(t.iconColor),i.append(n),a.prepend(i);case 16:case"end":return e.stop()}}),e)})),function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function s(t){Ls(a,n,r,s,o,"next",t)}function o(t){Ls(a,n,r,s,o,"throw",t)}s(void 0)}))})()),t.action&&(a.setAttribute("data-action",t.action),a.setAttribute("data-form","false")),t.params&&a.setAttribute("data-params","string"==typeof t.params?t.params:JSON.stringify(t.params)),t.confirm&&a.setAttribute("data-confirm",t.confirm),t.redirect&&a.setAttribute("data-redirect",t.redirect),t.attributes)for(var s in t.attributes)a.setAttribute(s,t.attributes[s]);if(r.append(a),t.status){var o=document.createElement("div");o.className="status ".concat(t.status),a.append(o)}var l=document.createElement("span");if(l.className="menu-item-label",t.label?l.textContent=t.label:t.html&&(l.innerHTML=t.html),a.append(l),t.description){var c=document.createElement("div");c.className="menu-item-description smalltext light",c.textContent=t.description,a.append(c)}return"link"===e&&this.addListener(a,"keydown",(function(t){t.keyCode===ro.SPACE_KEY&&a.click()})),this.addListener(a,"activate",(function(){t.onActivate?t.onActivate(a):t.callback&&t.callback(a),setTimeout((function(){n.hide()}),1)})),r},addList:function(){return fs()("<ul/>").appendTo(this.$container)[0]},addItem:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.createItem(t);e||(e=this.$container.children("ul").last().get(0)||this.addGroup()),n?e.prepend(i):e.append(i);var r=i.querySelector("a, button");return this.toggleItem(r,!t.hidden),this.updateVisibility(),r},addItems:function(t,e){var n,i=ks(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.addItem(r,e)}}catch(t){i.e(t)}finally{i.f()}},addHr:function(t){var e=document.createElement("hr");return this.isPadded("hr")&&(e.className="padded"),t?t.parentNode.insertBefore(e,t):this.$container.append(e),e},getFirstDestructiveGroup:function(){return this.$container.children("ul:has([data-destructive]):first").get(0)},addGroup:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.isPadded();if(t){var r=document.createElement("h3");r.classList.add("h6"),i&&r.classList.add("padded"),r.textContent=t,n?n.parentNode.insertBefore(r,n):this.$container.append(r)}var a=document.createElement("ul");return i&&(a.className="padded"),n?n.parentNode.insertBefore(a,n):this.$container.append(a),e&&(a.previousElementSibling&&"HR"!==a.previousElementSibling.nodeName&&!a.previousElementSibling.classList.contains("search-container")&&this.addHr(a),a.nextElementSibling&&"HR"!==a.nextElementSibling&&this.addHr(a.nextElementSibling)),this.updateVisibility(),a},toggleItem:function(t,e){void 0===e&&(e=t.parentNode.classList.contains("hidden")),e?this.showItem(t):this.hideItem(t)},showItem:function(t){t.parentNode.classList.remove("hidden"),this.updateVisibility(),this.isExpanded()&&this.setContainerPosition()},hideItem:function(t){t.parentNode.classList.add("hidden"),this.updateVisibility(),this.isExpanded()&&this.setContainerPosition()},toggleGroup:function(t){t.querySelectorAll("li:not(.hidden):not(.filtered)").length?t.classList.remove("hidden"):t.classList.add("hidden")},removeItem:function(t){var e=t.parentNode,n=e.parentNode;e.remove(),0===n.querySelectorAll(":scope > li").length&&n.remove(),this.updateVisibility(),this.isExpanded()&&this.setContainerPosition()},updateHrVisibility:function(){this.updateVisibility()},updateVisibility:function(){var t=this;this.$container.children("ul,.menu-group").each((function(e,n){t.toggleGroup(n)})),this.$container.find("hr").each((function(t,e){var n=fs()(e),i=n.prevUntil("h3,hr").filter(":not(.hidden):not(.filtered)"),r=n.nextUntil("h3,hr").filter(":not(.hidden):not(.filtered)");i.length&&r.length?n.removeClass("hidden"):n.addClass("hidden")})),this.$container.find("h3").each((function(t,e){var n=fs()(e);n.nextUntil("h3,hr").filter(":not(.hidden):not(.filtered)").length?n.removeClass("hidden"):n.addClass("hidden")}))},hasVisibleItems:function(){return!!this.$container.find("li:not(.hidden)").length},destroy:function(){var t=this;this.$trigger.removeData("trigger"),ro.DisclosureMenu.instances=ro.DisclosureMenu.instances.filter((function(e){return e!==t})),this.base()},_alignLeft:function(){this.$container.css({left:Math.max(this._alignmentElementOffset.left,0),right:"auto"})},_alignRight:function(){var t=this._viewportWidth-(this._alignmentElementOffset.left+this._alignmentElementWidth);this.$container.css({right:Math.max(t,0),left:"auto"})},_alignCenter:function(){var t=Math.round(this._alignmentElementOffset.left+this._alignmentElementWidth/2-this._menuWidth/2);this.$container.css({left:Math.max(t,0),right:"auto"})}},{defaults:{position:null,windowSpacing:5,withSearchInput:!1},instances:[]});function Fs(t){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(t)}var Ms=_s.extend({targetItemWidth:null,targetItemHeight:null,targetItemPositionInDraggee:null,$draggee:null,otherItems:null,totalOtherItems:null,helpers:null,helperTargets:null,helperPositions:null,helperLagIncrement:null,updateHelperPosProxy:null,updateHelperPosFrame:null,lastMouseX:null,lastMouseY:null,_returningHelpersToDraggees:!1,init:function(t,e){void 0===e&&fs().isPlainObject(t)&&(e=t,t=null),e=fs().extend({},ro.Drag.defaults,e),this.base(t,e)},allowDragging:function(){return!this._returningHelpersToDraggees},startDragging:function(){this.onBeforeDragStart(),this.helpers=[],this.helperTargets=[],this.helperPositions=[],this.lastMouseX=this.lastMouseY=null,this.targetItemWidth=this.$targetItem.outerWidth(),this.targetItemHeight=this.$targetItem.outerHeight(),this.draggeeDisplay=this.$targetItem.css("display"),this.setDraggee(this.findDraggee()),this.otherItems=[];for(var t=0;t<this.$items.length;t++){var e=this.$items[t];-1===fs().inArray(e,this.$draggee)&&this.otherItems.push(e)}this.totalOtherItems=this.otherItems.length,this.updateHelperPosProxy||(this.updateHelperPosProxy=this._updateHelperPos.bind(this)),this.helperLagIncrement=1===this.helpers.length?0:this.settings.helperLagIncrementDividend/(this.helpers.length-1),this.updateHelperPosFrame=ro.requestAnimationFrame(this.updateHelperPosProxy),this.dragging=!0,this.setScrollContainer(),this.onDragStart(),ro.activateEventsMuted=!0},setDraggee:function(t){if(this.targetItemPositionInDraggee=fs().inArray(this.$targetItem[0],t.add(this.$targetItem[0])),this.$draggee=fs()([this.$targetItem[0]].concat(t.not(this.$targetItem).toArray())),this.settings.singleHelper)this._createHelper(0);else for(var e=0;e<this.$draggee.length;e++)this._createHelper(e);this.settings.removeDraggee?this.$draggee.hide():this.settings.collapseDraggees?(this.$targetItem.css("visibility","hidden"),this.$draggee.not(this.$targetItem).hide()):this.settings.hideDraggee&&this.$draggee.css("visibility","hidden")},appendDraggee:function(t){if(t.length){if(!this.settings.collapseDraggees)var e=this.$draggee.length;if(this.$draggee=fs()(this.$draggee.toArray().concat(t.toArray())),!this.settings.collapseDraggees)for(var n=this.$draggee.length,i=e;i<n;i++)this._createHelper(i);this.settings.removeDraggee||this.settings.collapseDraggees?t.hide():this.settings.hideDraggee&&t.css("visibility","hidden")}},drag:function(t){this.draggeeVirtualMidpointX=this.mouseX-this.mouseOffsetX+this.targetItemWidth/2,this.draggeeVirtualMidpointY=this.mouseY-this.mouseOffsetY+this.targetItemHeight/2,this.base(t)},stopDragging:function(){ro.cancelAnimationFrame(this.updateHelperPosFrame),this.base()},findDraggee:function(){switch(Fs(this.settings.filter)){case"function":return this.settings.filter();case"string":return this.$items.filter(this.settings.filter);default:return this.$targetItem}},getHelperTargetX:function(t){return!t&&this.settings.moveHelperToCursor?this.mouseX:this.mouseX-this.mouseOffsetX},getHelperTargetY:function(t){return!t&&this.settings.moveHelperToCursor?this.mouseY:this.mouseY-this.mouseOffsetY},returnHelpersToDraggees:function(){this._returningHelpersToDraggees=!0;for(var t=0;t<this.helpers.length;t++){var e=this.$draggee.eq(t),n=this.helpers[t];e.css({display:this.draggeeDisplay,visibility:this.settings.hideDraggee?"hidden":""});var i,r=e.offset();i=0===t?this._showDraggee.bind(this):null,n.velocity({left:r.left,top:r.top},ro.FX_DURATION,i)}},fadeOutHelpers:function(){this.helpers.forEach((function(t){t.velocity("fadeOut",{duration:ro.FX_DURATION,complete:function(){t.remove()}})}))},onReturnHelpersToDraggees:function(){ro.requestAnimationFrame(function(){this.trigger("returnHelpersToDraggees"),this.settings.onReturnHelpersToDraggees()}.bind(this))},_createHelper:function(t){var e=this.$draggee.eq(t),n=e.clone().addClass("draghelper");e.parents("#content").length&&n.addClass("drag-in-content"),e.parents(".slideout-container").length&&n.addClass("drag-in-slideout"),this.settings.copyDraggeeInputValuesToHelper&&ro.copyInputValues(e,n),n.find("[name]").attr("name",""),n.outerWidth(Math.ceil(e.outerWidth())).outerHeight(Math.ceil(e.outerHeight())).css({margin:0,"pointer-events":"none"}),this.settings.helper&&(n="function"==typeof this.settings.helper?this.settings.helper(n,t):fs()(this.settings.helper).append(n)),n.appendTo(ro.$bod);var i=this._getHelperTarget(t,!0);n.css({position:"absolute",top:i.top,left:i.left,zIndex:this.settings.helperBaseZindex+this.$draggee.length-t,display:this.draggeeDisplay}),1!=this.settings.helperOpacity&&n.css("opacity",this.settings.helperOpacity),this.helperPositions[t]={top:i.top,left:i.left},this.helpers.push(n)},_updateHelperPos:function(){if(this.mouseX!==this.lastMouseX||this.mouseY!==this.lastMouseY){for(this._updateHelperPos._i=0;this._updateHelperPos._i<this.helpers.length;this._updateHelperPos._i++)this.helperTargets[this._updateHelperPos._i]=this._getHelperTarget(this._updateHelperPos._i);this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY}for(this._updateHelperPos._j=0;this._updateHelperPos._j<this.helpers.length;this._updateHelperPos._j++)this._updateHelperPos._lag=this.settings.helperLagBase+this.helperLagIncrement*this._updateHelperPos._j,this.helperPositions[this._updateHelperPos._j]={left:this.helperPositions[this._updateHelperPos._j].left+(this.helperTargets[this._updateHelperPos._j].left-this.helperPositions[this._updateHelperPos._j].left)/this._updateHelperPos._lag,top:this.helperPositions[this._updateHelperPos._j].top+(this.helperTargets[this._updateHelperPos._j].top-this.helperPositions[this._updateHelperPos._j].top)/this._updateHelperPos._lag},this.helpers[this._updateHelperPos._j].css(this.helperPositions[this._updateHelperPos._j]);this.updateHelperPosFrame=ro.requestAnimationFrame(this.updateHelperPosProxy)},_getHelperTarget:function(t,e){return{left:this.getHelperTargetX(e)+this.settings.helperSpacingX*t,top:this.getHelperTargetY(e)+this.settings.helperSpacingY*t}},_showDraggee:function(){for(var t=0;t<this.helpers.length;t++)this.helpers[t].remove();this.helpers=null,this.$draggee.show().css("visibility",""),this.onReturnHelpersToDraggees(),this._returningHelpersToDraggees=!1}},{defaults:{filter:null,singleHelper:!1,collapseDraggees:!1,removeDraggee:!1,hideDraggee:!0,copyDraggeeInputValuesToHelper:!1,helperOpacity:1,moveHelperToCursor:!1,helper:null,helperBaseZindex:1e3,helperLagBase:3,helperLagIncrementDividend:1.5,helperSpacingX:5,helperSpacingY:5,onReturnHelpersToDraggees:fs().noop}}),Bs=Ms.extend({$dropTargets:null,$activeDropTarget:null,init:function(t){t=fs().extend({},ro.DragDrop.defaults,t),this.base(t)},updateDropTargets:function(){this.settings.dropTargets&&("function"==typeof this.settings.dropTargets?this.$dropTargets=fs()(this.settings.dropTargets()):this.$dropTargets=fs()(this.settings.dropTargets),this.$dropTargets.length||(this.$dropTargets=null))},onDragStart:function(){this.updateDropTargets(),this.$activeDropTarget=null,this.base()},onDrag:function(){if(this.$dropTargets){for(this.onDrag._activeDropTarget=null,this.onDrag._i=0;this.onDrag._i<this.$dropTargets.length;this.onDrag._i++)if(this.onDrag._elem=this.$dropTargets[this.onDrag._i],ro.hitTest(this.mouseX,this.mouseY,this.onDrag._elem)){this.onDrag._activeDropTarget=this.onDrag._elem;break}(this.$activeDropTarget&&this.onDrag._activeDropTarget!==this.$activeDropTarget[0]||!this.$activeDropTarget&&null!==this.onDrag._activeDropTarget)&&(this.$activeDropTarget&&this.$activeDropTarget.removeClass(this.settings.activeDropTargetClass),this.onDrag._activeDropTarget?this.$activeDropTarget=fs()(this.onDrag._activeDropTarget).addClass(this.settings.activeDropTargetClass):this.$activeDropTarget=null,this.settings.onDropTargetChange(this.$activeDropTarget))}this.base()},onDragStop:function(){this.$dropTargets&&this.$activeDropTarget&&this.$activeDropTarget.removeClass(this.settings.activeDropTargetClass),this.base()}},{defaults:{dropTargets:null,onDropTargetChange:fs().noop,activeDropTargetClass:"active"}}),Os=_s.extend({onDrag:function(t,e){this.$targetItem.css({left:this.mouseX-this.mouseOffsetX,top:this.mouseY-this.mouseOffsetY})}}),Hs=Ms.extend({$heightedContainer:null,$insertion:null,insertionVisible:!1,oldDraggeeIndexes:null,newDraggeeIndexes:null,closestItem:null,_midpointVersion:0,_$prevItem:null,init:function(t,e){void 0===e&&fs().isPlainObject(t)&&(e=t,t=null),e=fs().extend({},ro.DragSort.defaults,e),this.base(t,e)},createInsertion:function(){if(this.settings.insertion)return"function"==typeof this.settings.insertion?fs()(this.settings.insertion(this.$draggee)):fs()(this.settings.insertion)},getHelperTargetX:function(){return 1!==this.settings.magnetStrength?(this.getHelperTargetX._draggeeOffsetX=this.$draggee.offset().left,this.getHelperTargetX._draggeeOffsetX+(this.mouseX-this.mouseOffsetX-this.getHelperTargetX._draggeeOffsetX)/this.settings.magnetStrength):this.base()},getHelperTargetY:function(){return 1!==this.settings.magnetStrength?(this.getHelperTargetY._draggeeOffsetY=this.$draggee.offset().top,this.getHelperTargetY._draggeeOffsetY+(this.mouseY-this.mouseOffsetY-this.getHelperTargetY._draggeeOffsetY)/this.settings.magnetStrength):this.base()},canInsertBefore:function(t){return this.settings.canInsertBefore(t)},canInsertAfter:function(t){return this.settings.canInsertAfter(t)},onDragStart:function(){if(this.oldDraggeeIndexes=this._getDraggeeIndexes(),this.settings.moveTargetItemToFront&&this.$draggee.length>1&&this._getItemIndex(this.$draggee[0])>this._getItemIndex(this.$draggee[1])&&this.$draggee.first().insertBefore(this.$draggee[1]),this.$insertion=this.createInsertion(),this._placeInsertionWithDraggee(),this.closestItem=null,this._clearMidpoints(),this.settings.container)for(this.$heightedContainer=fs()(this.settings.container);!this.$heightedContainer.height();)this.$heightedContainer=this.$heightedContainer.parent();this._precalculateMidpoints(),this.base()},onDrag:function(){this.$heightedContainer&&!ro.hitTest(this.mouseX,this.mouseY,this.$heightedContainer)?this.closestItem&&(this.closestItem=null,this._removeInsertion()):this.closestItem!==(this.closestItem=this._getClosestItem())&&null!==this.closestItem&&this._updateInsertion(),this.base()},onDragStop:function(){this._removeInsertion(),this.settings.moveTargetItemToFront||0===this.targetItemPositionInDraggee||this.$targetItem.insertAfter(this.$draggee.eq(this.targetItemPositionInDraggee)),this.returnHelpersToDraggees(),this.base(),this.$items=fs()().add(this.$items),this.newDraggeeIndexes=this._getDraggeeIndexes(),this.newDraggeeIndexes.join(",")!==this.oldDraggeeIndexes.join(",")&&this.onSortChange()},onInsertionPointChange:function(){ro.requestAnimationFrame(function(){this.trigger("insertionPointChange"),this.settings.onInsertionPointChange()}.bind(this))},onSortChange:function(){ro.requestAnimationFrame(function(){this.trigger("sortChange"),this.settings.onSortChange()}.bind(this))},_precalculateMidpoints:function(){var t=this;this._allMidpoints=new Map;var e=window.pageXOffset,n=window.pageYOffset;this.$items.each((function(i,r){var a=r.getBoundingClientRect();t._allMidpoints.set(r,{x:a.left+e+a.width/2,y:a.top+n+a.height/2,width:a.width,height:a.height,top:a.top+n,bottom:a.bottom+n})}))},_getVisibleItems:function(){var t=this,e=window.pageYOffset,n=e+window.innerHeight,i=[];return this.$items.each((function(r,a){if(!t.$draggee||!fs().contains(t.$draggee[0],a)){var s=t._allMidpoints.get(a);s&&s.bottom>=e-300&&s.top<=n+300&&i.push(a)}})),i},_getItemIndex:function(t){return this.$items.index(t)},_getDraggeeIndexes:function(){for(var t=[],e=0;e<this.$draggee.length;e++)t.push(this._getItemIndex(this.$draggee[e]));return t},_getClosestItem:function(){this._getClosestItem._closestItem=null;var t=this._allMidpoints&&this.$items.length>200?this._getVisibleItems():null;if(this.settings.removeDraggee?this.insertionVisible&&this._testForClosestItem(this.$insertion[0]):this._testForClosestItem(this.$draggee[0]),this._getClosestItem._closestItem&&(this._getClosestItem._midpoint=this._getItemMidpoint(this._getClosestItem._closestItem)),this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._startXDist=this._getClosestItem._lastXDist=this._getClosestItem._closestItem?Math.abs(this._getClosestItem._midpoint.x-this.draggeeVirtualMidpointX):null),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._startYDist=this._getClosestItem._lastYDist=this._getClosestItem._closestItem?Math.abs(this._getClosestItem._midpoint.y-this.draggeeVirtualMidpointY):null),t)for(var e=0;e<t.length;e++){var n=t[e],i=fs()(n);(this.canInsertBefore(i)||this.canInsertAfter(i))&&this._testForClosestItem(n)}else{for(this._getClosestItem._$otherItem=this.getPrevItem(this.$draggee.first());this._getClosestItem._$otherItem;)this._getClosestItem._midpoint=this._getItemMidpoint(this._getClosestItem._$otherItem[0]),this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._xDist=Math.abs(this._getClosestItem._midpoint.x-this.draggeeVirtualMidpointX)),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._yDist=Math.abs(this._getClosestItem._midpoint.y-this.draggeeVirtualMidpointY)),(this.settings.axis===ro.Y_AXIS||null!==this._getClosestItem._lastXDist&&this._getClosestItem._xDist>this._getClosestItem._lastXDist)&&(this.settings.axis===ro.X_AXIS||null!==this._getClosestItem._lastYDist&&this._getClosestItem._yDist>this._getClosestItem._lastYDist)||(this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._lastXDist=this._getClosestItem._xDist),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._lastYDist=this._getClosestItem._yDist),(this.canInsertBefore(this._getClosestItem._$otherItem)||this.canInsertAfter(this._getClosestItem._$otherItem))&&this._testForClosestItem(this._getClosestItem._$otherItem[0])),this._getClosestItem._$otherItem=this.getPrevItem(this._getClosestItem._$otherItem);for(this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._lastXDist=this._getClosestItem._startXDist),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._lastYDist=this._getClosestItem._startYDist),this._getClosestItem._$otherItem=this.getNextItem(this.$draggee.last());this._getClosestItem._$otherItem;)this._getClosestItem._midpoint=this._getItemMidpoint(this._getClosestItem._$otherItem[0]),this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._xDist=Math.abs(this._getClosestItem._midpoint.x-this.draggeeVirtualMidpointX)),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._yDist=Math.abs(this._getClosestItem._midpoint.y-this.draggeeVirtualMidpointY)),(this.settings.axis===ro.Y_AXIS||null!==this._getClosestItem._lastXDist&&this._getClosestItem._xDist>this._getClosestItem._lastXDist)&&(this.settings.axis===ro.X_AXIS||null!==this._getClosestItem._lastYDist&&this._getClosestItem._yDist>this._getClosestItem._lastYDist)||(this.settings.axis!==ro.Y_AXIS&&(this._getClosestItem._lastXDist=this._getClosestItem._xDist),this.settings.axis!==ro.X_AXIS&&(this._getClosestItem._lastYDist=this._getClosestItem._yDist),(this.canInsertBefore(this._getClosestItem._$otherItem)||this.canInsertAfter(this._getClosestItem._$otherItem))&&this._testForClosestItem(this._getClosestItem._$otherItem[0])),this._getClosestItem._$otherItem=this.getNextItem(this._getClosestItem._$otherItem)}return this._getClosestItem._closestItem===this.$draggee[0]||this.insertionVisible&&this._getClosestItem._closestItem===this.$insertion[0]?null:this._getClosestItem._closestItem},_clearMidpoints:function(){this._midpointVersion++,this._$prevItem=null},_getItemMidpoint:function(t){return this._allMidpoints&&this._allMidpoints.has(t)?this._allMidpoints.get(t):(fs().data(t,"midpointVersion")!==this._midpointVersion&&(this._getItemMidpoint._repositionDraggee=!this.settings.axis&&(!this.settings.removeDraggee||this.insertionVisible)&&t!==this.$draggee[0]&&(!this.$insertion||t!==this.$insertion.get(0)),this._getItemMidpoint._repositionDraggee?(this._$prevItem||(this._$prevItem=(this.insertionVisible?this.$insertion:this.$draggee).first().prev(),this._$draggeeParent=(this.insertionVisible?this.$insertion:this.$draggee).first().parent()),this._moveDraggeeToItem(t),this.settings.removeDraggee?this._getItemMidpoint._$item=this.$insertion:this._getItemMidpoint._$item=this.$draggee):this._getItemMidpoint._$item=fs()(t),this._getItemMidpoint._offset=this._getItemMidpoint._$item.offset(),fs().data(t,"midpoint",{x:this._getItemMidpoint._offset.left+this._getItemMidpoint._$item.outerWidth()/2,y:this._getItemMidpoint._offset.top+this._getItemMidpoint._$item.outerHeight()/2}),fs().data(t,"midpointVersion",this._midpointVersion),delete this._getItemMidpoint._$item,delete this._getItemMidpoint._offset,this._getItemMidpoint._repositionDraggee&&(this._$prevItem.length?this.$draggee.insertAfter(this._$prevItem):this.$draggee.prependTo(this._$draggeeParent),this._placeInsertionWithDraggee())),fs().data(t,"midpoint"))},_testForClosestItem:function(t){switch(this._testForClosestItem._midpoint=this._getItemMidpoint(t),this._testForClosestItem._mouseDistX=Math.abs(this._testForClosestItem._midpoint.x-this.draggeeVirtualMidpointX),this._testForClosestItem._mouseDistY=Math.abs(this._testForClosestItem._midpoint.y-this.draggeeVirtualMidpointY),this.settings.axis){case ro.X_AXIS:this._testForClosestItem._mouseDist=this._testForClosestItem._mouseDistX;break;case ro.Y_AXIS:this._testForClosestItem._mouseDist=this._testForClosestItem._mouseDistY;break;default:this._testForClosestItem._mouseDist=Math.sqrt(Math.pow(this._testForClosestItem._mouseDistX,2)+Math.pow(this._testForClosestItem._mouseDistY,2))}(null===this._getClosestItem._closestItem||this._testForClosestItem._mouseDist<this._getClosestItem._closestItemMouseDist)&&(this._getClosestItem._closestItem=t,this._getClosestItem._closestItemMouseDist=this._testForClosestItem._mouseDist)},_updateInsertion:function(){var t=this;if(this.closestItem&&this._moveDraggeeToItem(this.closestItem),this._allMidpoints&&this.closestItem){var e=[this.closestItem],n=this.getPrevItem(fs()(this.closestItem)),i=this.getNextItem(fs()(this.closestItem));n&&n.length&&e.push(n[0]),i&&i.length&&e.push(i[0]);var r=window.pageXOffset,a=window.pageYOffset;e.forEach((function(e){var n=e.getBoundingClientRect();t._allMidpoints.set(e,{x:n.left+r+n.width/2,y:n.top+a+n.height/2,width:n.width,height:n.height,top:n.top+a,bottom:n.bottom+a})}))}else this._clearMidpoints();this.onInsertionPointChange()},_moveDraggeeToItem:function(t){this.canInsertAfter(fs()(t))&&this.$draggee.parent()[0]===fs()(t).parent()[0]&&this.$draggee.index()<fs()(t).index()?this.$draggee.insertAfter(t):this.$draggee.insertBefore(t),this._placeInsertionWithDraggee(),this.$items=fs()().add(this.$items)},_placeInsertionWithDraggee:function(){this.$insertion&&(this.$insertion.insertBefore(this.$draggee.first()),this.insertionVisible=!0)},_removeInsertion:function(){this.insertionVisible&&(this.$insertion.remove(),this.insertionVisible=!1)}},{defaults:{container:null,insertion:null,moveTargetItemToFront:!1,magnetStrength:1,onInsertionPointChange:fs().noop,onSortChange:fs().noop,canInsertBefore:function(){return!0},canInsertAfter:function(){return!0}}}),Rs=ws.extend({handlers:null,init:function(){this.handlers=[],this.addListener(ro.$bod,"keyup",(function(t){t.keyCode===ro.ESC_KEY&&this.escapeLatest(t)}))},register:function(t,e){this.handlers.push({obj:t,func:e})},unregister:function(t){for(var e=this.handlers.length-1;e>=0;e--)this.handlers[e].obj===t&&this.handlers.splice(e,1)},escapeLatest:function(t){if(this.handlers.length){var e=this.handlers.pop();("function"==typeof e.func?e.func:e.obj[e.func]).call(e.obj,t),"function"==typeof e.obj.trigger&&e.obj.trigger("escape")}}}),js=ws.extend({$trigger:null,$fixedTriggerParent:null,$hud:null,$tip:null,$body:null,$header:null,$footer:null,$mainContainer:null,$main:null,$shade:null,$nextFocusableElement:null,showing:!1,orientation:null,updatingSizeAndPosition:!1,windowWidth:null,windowHeight:null,scrollTop:null,scrollLeft:null,mainWidth:null,mainHeight:null,init:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.$trigger=fs()(t),fs().isPlainObject(n)&&(i=n,n=""),this.setSettings(i,ro.HUD.defaults),this.on("show",this.settings.onShow),this.on("hide",this.settings.onHide),this.on("submit",this.settings.onSubmit),this.$trigger.attr("aria-expanded","false"),void 0===ro.HUD.activeHUDs&&(ro.HUD.activeHUDs={}),this.settings.withShade&&(this.$shade=fs()("<div/>",{class:this.settings.shadeClass})),this.$hud=fs()("<div/>",{class:this.settings.hudClass}).data("hud",this),this.$tip=fs()("<div/>",{class:this.settings.tipClass}).appendTo(this.$hud),this.$body=fs()("<form/>",{class:this.settings.bodyClass}).appendTo(this.$hud),this.$mainContainer=fs()("<div/>",{class:this.settings.mainContainerClass}).appendTo(this.$body),this.$main=fs()("<div/>",{class:this.settings.mainClass}).appendTo(this.$mainContainer),this.updateBody(n);var r=this.$trigger;do{if("fixed"===r.css("position")){this.$fixedTriggerParent=r;break}r=r.offsetParent()}while(r.length&&"HTML"!==r.prop("nodeName"));this.$fixedTriggerParent?this.$hud.css("position","fixed"):this.$hud.css("position","absolute"),this.addListener(this.$body,"submit","_handleSubmit"),this.settings.withShade&&this.settings.hideOnShadeClick&&this.addListener(this.$shade,"tap,click","hide"),this.settings.closeBtn&&this.addListener(this.settings.closeBtn,"activate","hide"),this.addListener(ro.$win,"resize","updateSizeAndPosition"),this.$fixedTriggerParent||this.addListener(ro.$scrollContainer,"scroll","updateSizeAndPosition"),this.settings.listenToMainResize&&this.addListener(this.$main,"resize","updateSizeAndPosition"),this.addListener(this.$trigger,"keydown",(function(t){if(t.keyCode===ro.TAB_KEY&&!t.shiftKey&&e.showing){var n=ro.getKeyboardFocusableElements(e.$hud).first();n.length&&(t.preventDefault(),n.focus())}})),this.addListener(this.$hud,"keydown",(function(t){if(t.keyCode===ro.TAB_KEY){var e=ro.getKeyboardFocusableElements(this.$hud),n=e.index(t.target);0===n&&t.shiftKey?(t.preventDefault(),this.$trigger.focus()):n===e.length-1&&!t.shiftKey&&this.$nextFocusableElement&&(t.preventDefault(),this.$nextFocusableElement.focus())}})),this.settings.showOnInit?(this.$hud.css("opacity",0),this.show(),this.$hud.css("opacity",1)):(this.$hud.appendTo(ro.$bod),this.hideContainer()),ro.HUD.instances.push(this)},updateBody:function(t){this.$main.html(""),this.$header&&(this.$hud.removeClass("has-header"),this.$header.remove(),this.$header=null),this.$footer&&(this.$hud.removeClass("has-footer"),this.$footer.remove(),this.$footer=null),this.$main.append(t);var e=this.$main.find("."+this.settings.headerClass+":first"),n=this.$main.find("."+this.settings.footerClass+":first");e.length&&(this.$header=e.insertBefore(this.$mainContainer),this.$hud.addClass("has-header")),n.length&&(this.$footer=n.insertAfter(this.$mainContainer),this.$hud.addClass("has-footer"))},show:function(t){var e=this;if(t&&t.stopPropagation&&t.stopPropagation(),!this.showing){if(this.settings.closeOtherHUDs)for(var n in ro.HUD.activeHUDs)ro.HUD.activeHUDs.hasOwnProperty(n)&&ro.HUD.activeHUDs[n].hide();document.activeElement!==document.body&&fs()(document.activeElement).blur(),this.settings.withShade&&(this.$shade.appendTo(ro.$bod),this.$shade.show()),this.$hud.appendTo(ro.$bod),this.$trigger.attr("aria-expanded","true"),this.showContainer(),this.showing=!0,ro.HUD.activeHUDs[this._namespace]=this,ro.uiLayerManager.addLayer(this.$hud),this.settings.hideOnEsc&&ro.uiLayerManager.registerShortcut(ro.ESC_KEY,this.hide.bind(this));var i=ro.$bod.find(":focusable"),r=i.index(this.$trigger[0]);-1!==r&&i.length>r+1&&(this.$nextFocusableElement=i.eq(r+1),this.addListener(this.$nextFocusableElement,"keydown",(function(t){if(t.keyCode===ro.TAB_KEY&&t.shiftKey){var n=ro.getKeyboardFocusableElements(e.$hud).last();n.length&&(t.preventDefault(),n.focus())}}))),this.onShow(),this.enable(),this.updateRecords()&&(this.$hud.css("top",ro.$scrollContainer.scrollTop()),this.updateSizeAndPosition(!0))}},showContainer:function(){this.$hud.show()},onShow:function(){this.trigger("show")},updateRecords:function(){var t=!1;t=this.windowWidth!==(this.windowWidth=ro.$win.width())||t,t=this.windowHeight!==(this.windowHeight=ro.$win.height())||t,t=this.scrollTop!==(this.scrollTop=ro.$scrollContainer.scrollTop())||t,t=this.scrollLeft!==(this.scrollLeft=ro.$scrollContainer.scrollLeft())||t,t=this.mainWidth!==(this.mainWidth=this.$main.outerWidth())||t,t=this.mainHeight!==(this.mainHeight=this.$main.outerHeight())||t;var e=this.$trigger.scrollParent();return e.get(0)!==ro.$scrollContainer.get(0)&&(t=this.spWidth!==(this.spWidth=e.width())||t,t=this.spHeight!==(this.spHeight=e.height())||t,t=this.spScrollTop!==(this.spScrollTop=e.scrollTop())||t,t=this.spScrollLeft!==(this.spScrollLeft=e.scrollLeft())||t),t},updateSizeAndPosition:function(t){(!0===t||this.updateRecords()&&!this.updatingSizeAndPosition)&&(this.updatingSizeAndPosition=!0,ro.requestAnimationFrame(this.updateSizeAndPositionInternal.bind(this)))},updateSizeAndPositionInternal:function(){var t,e,n,i,r,a,s,o,l,c;i=ro.$win.scrollLeft(),r=ro.$win.scrollTop(),t=this.$trigger.outerWidth(),e=this.$trigger.outerHeight(),n=this.$trigger.offset(),this.$fixedTriggerParent?(n.left-=i,n.top-=r,a=n,i=0,r=0,s=0,o=0):(a=ro.getOffset(this.$trigger),s=ro.$scrollContainer.scrollLeft(),o=ro.$scrollContainer.scrollTop()),n.right=n.left+t,n.bottom=n.top+e,a.right=a.left+t,a.bottom=a.top+e,this.$hud.css({width:""}),this.$mainContainer.css({height:"","overflow-x":"","overflow-y":""}),l=this.$body.width(),c=this.$body.height();var u,h,d,f,p,g={bottom:this.windowHeight+o-a.bottom,top:a.top-o,right:this.windowWidth+s-a.right,left:a.left-s};this.orientation=null;for(var m=0;m<this.settings.orientations.length;m++){var v=this.settings.orientations[m],y="top"===v||"bottom"===v?c:l;if(g[v]-(this.settings.windowSpacing+this.settings.triggerSpacing)>=y){this.orientation=v;break}(!this.orientation||g[v]>g[this.orientation])&&(this.orientation=v)}if(this.orientation&&-1!==fs().inArray(this.orientation,["bottom","top","right","left"])||(this.orientation="bottom"),this.tipClass&&this.$tip.removeClass(this.tipClass),this.tipClass=this.settings.tipClass+"-"+ro.HUD.tipClasses[this.orientation],this.$tip.addClass(this.tipClass),"top"===this.orientation||"bottom"===this.orientation?(u=this.windowWidth-2*this.settings.windowSpacing,h=g[this.orientation]-this.settings.windowSpacing-this.settings.triggerSpacing):(u=g[this.orientation]-this.settings.windowSpacing-this.settings.triggerSpacing,h=this.windowHeight-2*this.settings.windowSpacing),u<this.settings.minBodyWidth&&(u=this.settings.minBodyWidth),h<this.settings.minBodyHeight&&(h=this.settings.minBodyHeight),(l>u||l<this.settings.minBodyWidth)&&(l=l>u?u:this.settings.minBodyWidth,this.$hud.width(l),this.mainWidth>u&&this.$mainContainer.css("overflow-x","scroll"),c=this.$body.height()),c>h||c<this.settings.minBodyHeight){var b=c=c>h?h:this.settings.minBodyHeight;this.$header&&(b-=this.$header.outerHeight()),this.$footer&&(b-=this.$footer.outerHeight()),this.$mainContainer.height(b),this.mainHeight>b&&this.$mainContainer.css("overflow-y","scroll")}this.$hud.css({"border-top-left-radius":"","border-top-right-radius":"","boredr-bottom-right-radius":"","border-bottom-left-radius":""});var w=parseInt(this.$hud.css("border-radius"));if("top"===this.orientation||"bottom"===this.orientation){var C=this.windowWidth+i-(l+this.settings.windowSpacing),$=i+this.settings.windowSpacing;(f=(d=n.left+Math.round(t/2))-Math.round(l/2))>C&&(f=C),f<$&&(f=$),this.$hud.css("left",f);var _=ro.within(d-f-this.settings.tipWidth/2,0,l-this.settings.tipWidth);this.$tip.css({left:_,top:""}),"top"===this.orientation?(p=n.top-(c+this.settings.triggerSpacing),this.$hud.css("top",p)):(p=n.bottom+this.settings.triggerSpacing,this.$hud.css("top",p));var S="top"===this.orientation?"bottom":"top";_<w?this.$hud.css("border-".concat(S,"-left-radius"),2):_>l-w-this.settings.tipWidth&&this.$hud.css("border-".concat(S,"-right-radius"),2)}else{var x=this.windowHeight+r-(c+this.settings.windowSpacing),I=r+this.settings.windowSpacing;(p=(d=n.top+Math.round(e/2))-Math.round(c/2))>x&&(p=x),p<I&&(p=I),this.$hud.css("top",p);var E=ro.within(d-p-this.settings.tipWidth/2,0,c-this.settings.tipWidth);this.$tip.css({top:E,left:""}),"left"===this.orientation?(f=n.left-(l+this.settings.triggerSpacing),this.$hud.css("left",f)):(f=n.right+this.settings.triggerSpacing,this.$hud.css("left",f));var T="left"===this.orientation?"right":"left";E<w?this.$hud.css("border-top-".concat(T,"-radius"),2):E>c-w-this.settings.tipWidth&&this.$hud.css("border-bottom-".concat(T,"-radius"),2)}this.updatingSizeAndPosition=!1,this.trigger("updateSizeAndPosition")},hide:function(){this.showing&&(this.disable(),this.$trigger.attr("aria-expanded","false"),this.hideContainer(),this.settings.withShade&&this.$shade.hide(),this.showing=!1,delete ro.HUD.activeHUDs[this._namespace],ro.uiLayerManager.removeLayer(),ro.focusIsInside(this.$hud)&&this.$trigger.focus(),this.$nextFocusableElement&&(this.removeListener(this.$nextFocusableElement,"keydown"),this.$nextFocusableElement=null),this.onHide())},hideContainer:function(){this.$hud.hide()},onHide:function(){this.trigger("hide")},toggle:function(){this.showing?this.hide():this.show()},submit:function(){this.onSubmit()},onSubmit:function(){this.trigger("submit")},_handleSubmit:function(t){t.preventDefault(),this.submit()},destroy:function(){var t=this;this.$hud&&this.$hud.remove(),this.settings.withShade&&this.$shade&&this.$shade.remove(),ro.HUD.instances=ro.HUD.instances.filter((function(e){return e!==t})),this.base()}},{tipClasses:{bottom:"top",top:"bottom",right:"left",left:"right"},defaults:{shadeClass:"hud-shade",hudClass:"hud",tipClass:"tip",bodyClass:"body",headerClass:"hud-header",footerClass:"hud-footer",mainContainerClass:"main-container",mainClass:"main",orientations:["bottom","top","right","left"],triggerSpacing:10,windowSpacing:10,tipWidth:30,minBodyWidth:200,minBodyHeight:0,withShade:!0,onShow:fs().noop,onHide:fs().noop,onSubmit:fs().noop,closeBtn:null,listenToMainResize:!0,showOnInit:!0,closeOtherHUDs:!0,hideOnEsc:!0,hideOnShadeClick:!0},instances:[]});function Gs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var Ns=ws.extend({$btn:null,menu:null,showingMenu:!1,disabled:!0,observer:null,searchStr:"",clearSearchStrTimeout:null,init:function(t,e,n){var i=this;if(void 0===n&&fs().isPlainObject(e)&&(n=e,e=null),this.$btn=fs()(t),this.$btn.length){var r;this.$btn.data("menubtn")?(e||(r=this.$btn.data("menubtn").menu.$container),console.warn("Double-instantiating a menu button on an element"),this.$btn.data("menubtn").destroy()):e||(r=this.$btn.next(".menu").detach()),this.$btn.data("menubtn",this),this.setSettings(n,ro.MenuBtn.defaults),this.menu=e||new ro.CustomSelect(r),this.menu.$anchor=fs()(this.settings.menuAnchor||this.$btn),this.menu.on("optionselect",function(t){this.onOptionSelect(t.selectedOption)}.bind(this)),this.menu.on("hide",(function(){i.clearSearchStr()})),this.menu.on("show",(function(){i.clearSearchStr()})),this.$btn.attr({role:"combobox","aria-controls":this.menu.menuId,"aria-haspopup":"listbox","aria-expanded":"false"});var a=this.$btn.attr("aria-labelledby");!this.menu.$container.attr("aria-labelledby")&&a&&this.menu.$container.attr("aria-labelledby",a),this.menu.on("hide",this.onMenuHide.bind(this)),this.addListener(this.$btn,"mousedown","onMouseDown"),this.addListener(this.$btn,"keydown","onKeyDown"),this.addListener(this.$btn,"blur","onBlur"),this.observer=new MutationObserver((function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Gs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gs(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if("attributes"===r.type&&"disabled"===r.attributeName){i.handleStatusChange();break}}}catch(t){n.e(t)}finally{n.f()}})),this.observer.observe(this.$btn[0],{attributes:!0}),this.handleStatusChange()}else console.warn("Menu button instantiated without a DOM element.")},onBlur:function(){this.showingMenu&&ro.requestAnimationFrame(function(){fs().contains(this.menu.$container.get(0),document.activeElement)||this.hideMenu()}.bind(this))},onKeyDown:function(t){var e=this;if(!ro.isCtrlKeyPressed(t)){if(t.key&&(t.key.match(/^[^ ]$/)||this.searchStr.length&&" "===t.key)){var n;this.showingMenu||(this.showMenu(),0===(n=this.menu.$options.filter(".sel:first")).length&&(n=this.menu.$options.first())),this.searchStr+=t.key.toLowerCase();for(var i=0;i<this.menu.$options.length;i++){var r=this.menu.$options.eq(i);if(void 0===r.data("searchText")){var a=r.clone();a.find("svg").remove(),r.data("searchText",a.text().toLowerCase().trimStart())}if(r.data("searchText").startsWith(this.searchStr)){n=r;break}}return n&&n.length&&this.focusOption(n),this.clearSearchStrTimeout&&clearTimeout(this.clearSearchStrTimeout),void(this.clearSearchStrTimeout=setTimeout((function(){e.clearSearchStr()}),1e3))}if(this.showingMenu)switch(t.keyCode){case ro.RETURN_KEY:case ro.SPACE_KEY:case ro.TAB_KEY:t.keyCode!==ro.TAB_KEY&&t.preventDefault();var s=this.menu.$options.filter(".hover");s.length>0?s.get(0).click():this.hideMenu();break;case ro.UP_KEY:case ro.PAGE_UP_KEY:t.preventDefault();var o=t.keyCode===ro.UP_KEY?1:10;this.moveFocusUp(o);break;case ro.DOWN_KEY:case ro.PAGE_DOWN_KEY:t.preventDefault();var l=t.keyCode===ro.DOWN_KEY?1:10;this.moveFocusDown(l);break;case ro.HOME_KEY:t.preventDefault(),this.focusFirstOption();break;case ro.END_KEY:t.preventDefault(),this.focusLastOption()}else switch(t.keyCode){case ro.RETURN_KEY:case ro.SPACE_KEY:case ro.DOWN_KEY:t.preventDefault(),this.showMenu(),this.focusSelectedOption();break;case ro.UP_KEY:case ro.HOME_KEY:t.preventDefault(),this.showMenu(),this.focusFirstOption();break;case ro.END_KEY:t.preventDefault(),this.showMenu(),this.focusLastOption()}}},clearSearchStr:function(){this.searchStr="",this.clearSearchStrTimeout&&(clearTimeout(this.clearSearchStrTimeout),this.clearSearchStrTimeout=null)},focusOption:function(t){t.hasClass("hover")||(this.menu.$options.removeClass("hover"),this.menu.$ariaOptions.attr("aria-selected","false"),t.addClass("hover"),this.$btn.attr("aria-activedescendant",t.parent("li").attr("id")),ro.scrollContainerToElement(this.menu.$container,t))},focusSelectedOption:function(){var t=this.menu.$options.filter(".sel:first");t.length?this.focusOption(t):this.focusFirstOption()},focusFirstOption:function(){var t=this.menu.$options.first();this.focusOption(t)},focusLastOption:function(){var t=this.menu.$options.last();this.focusOption(t)},moveFocusUp:function(t){var e=this.menu.$options.filter(".hover");if(e.length){for(var n=this.menu.$options.index(e[0]),i=this.menu.$options.eq(Math.max(n-t,0));i.hasClass("disabled")&&n-t>=0;)t++,i=this.menu.$options.eq(Math.max(n-t,0));this.focusOption(i)}else this.focusFirstOption()},moveFocusDown:function(t){var e=this.menu.$options.filter(".hover");if(e.length){for(var n=this.menu.$options.index(e[0]),i=this.menu.$options.eq(Math.min(n+t,this.menu.$options.length-1));i.hasClass("disabled")&&n+t<=this.menu.$options.length-1;)t++,i=this.menu.$options.eq(Math.min(n+t,this.menu.$options.length-1));this.focusOption(i)}else this.focusFirstOption()},onMouseDown:function(t){ro.isPrimaryClick(t)&&"INPUT"!==t.target.nodeName&&(t.preventDefault(),this.showingMenu?this.hideMenu():this.showMenu())},showMenu:function(){this.disabled||(this.menu.show(),this.$btn.addClass("active"),this.$btn.focus(),this.$btn.attr("aria-expanded","true"),this.showingMenu=!0,setTimeout(function(){this.addListener(ro.$doc,"mousedown","onMouseDown")}.bind(this),1))},hideMenu:function(){this.menu.hide()},onMenuHide:function(){this.$btn.removeClass("active"),this.$btn.attr({"aria-expanded":"false","aria-activedescendant":null}),this.showingMenu=!1,this.removeListener(ro.$doc,"mousedown")},onOptionSelect:function(t){this.settings.onOptionSelect(t),this.trigger("optionSelect",{option:t})},enable:function(){this.$btn&&this.$btn.removeAttr("disabled")},disable:function(){this.$btn&&this.$btn.attr("disabled","disabled")},handleStatusChange:function(){this.$btn&&(ro.hasAttr(this.$btn[0],"disabled")||"true"===this.$btn.attr("aria-disabled")?(this.disabled=!0,this.$btn.addClass("disabled")):(this.disabled=!1,this.$btn.removeClass("disabled")))},destroy:function(){this.menu.destroy(),this.$btn.removeData("menubtn"),this.observer.disconnect(),this.observer=null,this.base()}},{defaults:{menuAnchor:null,onOptionSelect:fs().noop}}),Us=ws.extend({$container:null,elements:null,focussedElement:null,blurTimeout:null,init:function(t,e){this.$container=fs()(t),this.setSettings(e,ro.MixedInput.defaults),this.elements=[],this.$container.attr("tabindex",0),this.addListener(this.$container,"focus","onFocus")},getElementIndex:function(t){return fs().inArray(t,this.elements)},isText:function(t){return"INPUT"===t.prop("nodeName")},onFocus:function(){if(this.elements.length){var t=this.elements[this.elements.length-1];this.setFocus(t),this.isText(t)&&this.setCaretPos(t,t.val().length)}else this.addTextElement()},addTextElement:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new zs(this);return this.addElement(n.$input,t,e),n.setWidth(),n},addElement:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===e)if(this.focussedElement){var i=this.focussedElement,r=this.getElementIndex(i);if(this.isText(i)){var a=i.prop("selectionStart"),s=i.prop("selectionEnd"),o=i.val(),l=o.substring(0,a),c=o.substring(s);if(l&&c){i.val(l).trigger("change");var u=new zs(this);u.$input.val(c).trigger("change"),this.addElement(u.$input,r+1),e=r+1}else e=l?r+1:r}else e=r+1}else e=this.elements.length;void 0!==this.elements[e]?(t.insertBefore(this.elements[e]),this.elements.splice(e,0,t)):(e=this.elements.length,this.$container.append(t),this.elements.push(t)),this.isText(t)||(0!==e&&this.isText(this.elements[e-1])||(this.addTextElement(e),e++),e!==this.elements.length-1&&this.isText(this.elements[e+1])||this.addTextElement(e+1)),this.addListener(t,"click",(function(){this.setFocus(t)})),n&&setTimeout(function(){this.setFocus(t)}.bind(this),1)},removeElement:function(t){var e=this.getElementIndex(t);if(-1!==e){if(this.elements.splice(e,1),!this.isText(t)){var n=this.elements[e-1],i=this.elements[e];if(this.isText(n)&&this.isText(i)){var r=n.val(),a=r+i.val();n.val(a).trigger("change"),this.removeElement(i),this.setFocus(n),this.setCaretPos(n,r.length)}}t.remove()}},setFocus:function(t){this.$container.addClass("focus"),this.focussedElement?this.blurFocussedElement():this.$container.attr("tabindex","-1"),t.attr("tabindex","0"),t.focus(),this.focussedElement=t,this.addListener(t,"blur",(function(){this.blurTimeout=setTimeout(function(){this.focussedElement===t&&(this.blurFocussedElement(),this.focussedElement=null,this.$container.removeClass("focus"),this.$container.attr("tabindex","0"))}.bind(this),1)}))},blurFocussedElement:function(){this.removeListener(this.focussedElement,"blur"),this.focussedElement.attr("tabindex","-1")},focusPreviousElement:function(t){var e=this.getElementIndex(t);if(e>0){var n=this.elements[e-1];if(this.setFocus(n),this.isText(n)){var i=n.val().length;this.setCaretPos(n,i)}}},focusNextElement:function(t){var e=this.getElementIndex(t);if(e<this.elements.length-1){var n=this.elements[e+1];this.setFocus(n),this.isText(n)&&this.setCaretPos(n,0)}},focusStart:function(){var t=this.elements[0];this.setFocus(t),this.isText(t)&&this.setCaretPos(t,0)},focusEnd:function(){var t=this.elements[this.elements.length-1];this.setFocus(t),this.isText(t)&&this.setCaretPos(t,t.val().length)},setCarotPos:function(t,e){this.setCaretPos(t,e)},setCaretPos:function(t,e){t.prop("selectionStart",e),t.prop("selectionEnd",e)}}),zs=ws.extend({parentInput:null,$input:null,$stage:null,val:null,focussed:!1,interval:null,init:function(t){this.parentInput=t,this.$input=fs()('<input type="text"/>').appendTo(this.parentInput.$container),this.$input.css("margin-right",2-zs.padding+"px"),this.setWidth(!0),this.addListener(this.$input,"focus","onFocus"),this.addListener(this.$input,"blur","onBlur"),this.addListener(this.$input,"keydown","onKeyDown"),this.addListener(this.$input,"change","checkInput")},getIndex:function(){return this.parentInput.getElementIndex(this.$input)},buildStage:function(){this.$stage=fs()("<stage/>").appendTo(ro.$bod),this.$stage.css({position:"absolute",top:-9999,left:-9999,wordWrap:"nowrap"}),ro.copyTextStyles(this.$input,this.$stage)},getTextWidth:function(t){return this.$stage||this.buildStage(),t&&(t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/ /g,"&nbsp;")),this.$stage.html(t),this.stageWidth=this.$stage.width(),this.stageWidth},onFocus:function(){this.focussed=!0,this.interval=setInterval(this.checkInput.bind(this),ro.NiceText.interval),this.checkInput()},onBlur:function(){this.focussed=!1,clearInterval(this.interval),this.checkInput()},onKeyDown:function(t){switch(setTimeout(this.checkInput.bind(this),1),t.keyCode){case ro.LEFT_KEY:ro.isCtrlKeyPressed(t)?(t.preventDefault(),this.parentInput.focusStart()):0===this.$input.prop("selectionStart")&&0===this.$input.prop("selectionEnd")&&this.parentInput.focusPreviousElement(this.$input);break;case ro.RIGHT_KEY:ro.isCtrlKeyPressed(t)?(t.preventDefault(),this.parentInput.focusEnd()):this.$input.prop("selectionStart")===this.val.length&&this.$input.prop("selectionEnd")===this.val.length&&this.parentInput.focusNextElement(this.$input);break;case ro.BACKSPACE_KEY:case ro.DELETE_KEY:0===this.$input.prop("selectionStart")&&0===this.$input.prop("selectionEnd")&&(this.parentInput.focusPreviousElement(this.$input),t.preventDefault())}},getVal:function(){return this.val=this.$input.val(),this.val},setVal:function(t){this.$input.val(t),this.checkInput()},checkInput:function(){var t=this.val!==this.getVal();return t&&(this.setWidth(),this.onChange()),t},setWidth:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.stageWidth!==this.getTextWidth(this.val)||t){var e=this.stageWidth+zs.padding;this.$input.width(e)}},onChange:fs().noop},{padding:20}),Ws=ws.extend({$container:null,$shade:null,$triggerElement:null,$liveRegion:fs()('<span class="visually-hidden" role="status"></span>'),visible:!1,dragger:null,desiredWidth:null,desiredHeight:null,resizeDragger:null,resizeStartWidth:null,resizeStartHeight:null,init:function(t,e){void 0===e&&fs().isPlainObject(t)&&(e=t,t=null),this.setSettings(e,ro.Modal.defaults),this.$shade=fs()('<div class="'+this.settings.shadeClass+'"/>'),t?this.$shade.insertBefore(t):this.$shade.appendTo(ro.$bod),t&&(this.setContainer(t),ro.addModalAttributes(t),this.settings.autoShow&&this.show()),this.settings.triggerElement||(this.settings.triggerElement=ro.getFocusedElement()),ro.Modal.instances.push(this)},addLiveRegion:function(){this.$container&&this.$liveRegion.appendTo(this.$container)},setContainer:function(t){if(this.$container=fs()(t),this.$container.data("modal")&&(console.warn("Double-instantiating a modal on an element"),this.$container.data("modal").destroy()),this.$container.data("modal",this),this.settings.draggable&&(this.dragger=new ro.DragMove(this.$container,{handle:this.settings.dragHandleSelector?this.$container.find(this.settings.dragHandleSelector):this.$container})),this.settings.resizable){var e=fs()('<div class="resizehandle"/>').appendTo(this.$container).append('<svg class="ltr" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M20 0 0 20h2L20 2V0ZM20 6 6 20h2L20 8V6ZM20 12l-8 8h2l6-6v-2Z" fill="#000"/></svg><svg class="rtl" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m0 0 20 20h-2L0 2V0ZM0 6l14 14h-2L0 8V6ZM0 12l8 8H6l-6-6v-2Z" fill="#000"/></svg>');this.resizeDragger=new ro.BaseDrag(e,{onDragStart:this._handleResizeStart.bind(this),onDrag:this._handleResize.bind(this)})}this.addLiveRegion(),this.addListener(this.$container,"click",(function(t){t.stopPropagation()})),this.visible&&this.show()},show:function(){var t=this;this.settings.closeOtherModals&&ro.Modal.visibleModal&&ro.Modal.visibleModal!==this&&ro.Modal.visibleModal.hide(),this.$container&&(this.$shade.appendTo(ro.$bod).velocity("stop"),this.$container.appendTo(ro.$bod).velocity("stop"),this.$container.show(),this.updateSizeAndPosition(),this.$shade.velocity("fadeIn",{duration:50,complete:function(){this.$container.velocity("fadeIn",{complete:function(){this.updateSizeAndPosition(),ro.setFocusWithin(this.$container),this.onFadeIn()}.bind(this)})}.bind(this)}),this.settings.hideOnShadeClick&&this.addListener(this.$shade,"click","hide"),ro.trapFocusWithin(this.$container),this.addListener(ro.$win,"resize","_handleWindowResize")),this.enable(),this.visible||(this.visible=!0,ro.Modal.visibleModal=this,ro.uiLayerManager.addLayer(this.$container),ro.hideModalBackgroundLayers(),this.settings.hideOnEsc&&ro.uiLayerManager.registerShortcut(ro.ESC_KEY,(function(){t.trigger("escape"),t.hide()})),ro.$bod.addClass("no-scroll"),this.onShow())},onShow:function(){this.trigger("show"),this.settings.onShow()},quickShow:function(){this.show(),this.$container&&(this.$container.velocity("stop"),this.$container.show().css("opacity",1),this.$shade.velocity("stop"),this.$shade.show().css("opacity",1))},hide:function(t){var e=this;this.visible&&(this.disable(),t&&t.stopPropagation(),this.$container&&(this.$container.velocity("stop").velocity("fadeOut",{duration:ro.FX_DURATION}),this.$shade.velocity("stop").velocity("fadeOut",{duration:ro.FX_DURATION,complete:this.onFadeOut.bind(this)}),this.settings.hideOnShadeClick&&this.removeListener(this.$shade,"click"),this.removeListener(ro.$win,"resize")),this.visible=!1,ro.$bod.removeClass("no-scroll"),ro.Modal.visibleModal=null,ro.uiLayerManager.removeLayer(),ro.resetModalBackgroundLayerVisibility(),this.onHide(),setTimeout((function(){var t,n,i,r=null!==(t=e.$triggerElement)&&void 0!==t?t:e.settings.triggerElement;if("function"==typeof r&&(r=r()),r instanceof jQuery||(r=fs()(r)),null!==(n=r)&&void 0!==n&&n.is(":hidden")){var a=r.closest(".menu--disclosure");if(a.length){var s=a.attr("id");r=fs()('[aria-controls="'.concat(s,'"]'))}else r=null}null!==(i=r)&&void 0!==i&&i.length?r.focus():console.error("There is no trigger element set for this modal. Set one with modal.$triggerElement = $(...)")}),200))},onHide:function(){this.trigger("hide"),this.settings.onHide()},quickHide:function(){this.hide(),this.$container&&(this.$container.velocity("stop"),this.$container.css("opacity",0).hide(),this.$shade.velocity("stop"),this.$shade.css("opacity",0).hide(),this.onFadeOut())},updateSizeAndPosition:function(){this.$container&&(this.$container.css({width:this.desiredWidth?Math.max(this.desiredWidth,200):"",height:this.desiredHeight?Math.max(this.desiredHeight,200):"","min-width":"","min-height":""}),this.updateSizeAndPosition._windowWidth=ro.$win.width(),this.updateSizeAndPosition._width=Math.min(this.getWidth(),this.updateSizeAndPosition._windowWidth-2*this.settings.minGutter),this.$container.css({width:this.updateSizeAndPosition._width,"min-width":this.updateSizeAndPosition._width,left:Math.round((this.updateSizeAndPosition._windowWidth-this.updateSizeAndPosition._width)/2)}),this.updateSizeAndPosition._windowHeight=ro.$win.height(),this.updateSizeAndPosition._height=Math.min(this.getHeight(),this.updateSizeAndPosition._windowHeight-2*this.settings.minGutter),this.$container.css({height:this.updateSizeAndPosition._height,"min-height":this.updateSizeAndPosition._height,top:Math.round((this.updateSizeAndPosition._windowHeight-this.updateSizeAndPosition._height)/2)}),this.trigger("updateSizeAndPosition"))},onFadeIn:function(){this.trigger("fadeIn"),this.settings.onFadeIn()},onFadeOut:function(){this.trigger("fadeOut"),this.settings.onFadeOut()},getHeight:function(){if(!this.$container)throw"Attempted to get the height of a modal whose container has not been set.";return this.visible||this.$container.show(),this.getHeight._height=this.$container.outerHeight(),this.visible||this.$container.hide(),this.getHeight._height},getWidth:function(){if(!this.$container)throw"Attempted to get the width of a modal whose container has not been set.";return this.visible||this.$container.show(),this.getWidth._width=this.$container.outerWidth()+1,this.visible||this.$container.hide(),this.getWidth._width},_handleWindowResize:function(t){t.target===window&&this.updateSizeAndPosition()},_handleResizeStart:function(){this.resizeStartWidth=this.getWidth(),this.resizeStartHeight=this.getHeight()},_handleResize:function(){ro.ltr?this.desiredWidth=this.resizeStartWidth+2*this.resizeDragger.mouseDistX:this.desiredWidth=this.resizeStartWidth-2*this.resizeDragger.mouseDistX,this.desiredHeight=this.resizeStartHeight+2*this.resizeDragger.mouseDistY,this.updateSizeAndPosition()},destroy:function(){var t=this;this.$container&&this.$container.removeData("modal").remove(),this.$shade&&this.$shade.remove(),this.dragger&&this.dragger.destroy(),this.resizeDragger&&this.resizeDragger.destroy(),ro.Modal.instances=ro.Modal.instances.filter((function(e){return e!==t})),this.base()}},{relativeElemPadding:8,defaults:{autoShow:!0,draggable:!1,dragHandleSelector:null,resizable:!1,minGutter:10,onShow:fs().noop,onHide:fs().noop,onFadeIn:fs().noop,onFadeOut:fs().noop,closeOtherModals:!1,hideOnEsc:!0,hideOnShadeClick:!0,triggerElement:null,shadeClass:"modal-shade"},instances:[],visibleModal:null}),Ys=ws.extend({$btn:null,$btnLabel:null,$liveRegion:null,defaultMessage:null,busyMessage:null,failureMessage:null,retryMessage:null,successMessage:null,init:function(t,e){this.setSettings(e,ro.MultiFunctionBtn.defaults),this.$btn=fs()(t),this.$btn.data("multifunction-btn")&&(console.warn("Double-instantiating a multi-function button on an element"),this.$btn.data("multifunction-btn").destroy()),this.$btnLabel=this.$btn.find(".label"),this.defaultMessage=this.$btnLabel.text(),"status"===this.$btn.prev().attr("role")?this.$liveRegion=this.$btn.prev():(this.$liveRegion=fs()("<div/>",{class:"visually-hidden",role:"status"}),this.$btn.before(this.$liveRegion)),this.busyMessage=this.$btn.data("busy-message")?this.$btn.data("busy-message"):Craft.t("app","Loading"),this.failureMessage=this.$btn.data("failure-message"),this.retryMessage=this.$btn.data("retry-message"),this.successMessage=this.$btn.data("success-message")?this.$btn.data("success-message"):Craft.t("app","Success")},busyEvent:function(){this.$btn.addClass(this.settings.busyClass),this.busyMessage&&this.updateMessages(this.busyMessage)},failureEvent:function(){var t=this;this.endBusyState(),(this.failureMessage||this.retryMessage)&&(this.failureMessage&&this.updateMessages(this.failureMessage),this.retryMessage&&(this.failureMessage?setTimeout((function(){t.updateMessages(t.retryMessage)}),this.settings.failureMessageDuration):this.updateMessages(this.retryMessage)))},successEvent:function(){this.endBusyState(),this.successMessage&&this.updateMessages(this.successMessage)},updateMessages:function(t){var e=this;this.$liveRegion.text(t),this.settings.changeButtonText&&this.$btnLabel.text(t),setTimeout((function(){e.$liveRegion.text()===t&&e.$liveRegion.empty()}),this.settings.clearLiveRegionTimeout)},endBusyState:function(){this.$btn.removeClass(this.settings.busyClass)},destroy:function(){this.$btn.removeData("multifunction-btn"),this.base()}},{defaults:{busyClass:"loading",clearLiveRegionTimeout:2500,failureMessageDuration:3e3,changeButtonText:!1}}),Vs=ws.extend({$input:null,$hint:null,$stage:null,$charsLeft:null,autoHeight:null,maxLength:null,showCharsLeft:!1,showingHint:!1,val:null,inputBoxSizing:"content-box",width:null,height:null,minHeight:null,initialized:!1,init:function(t,e){this.$input=fs()(t),this.settings=fs().extend({},ro.NiceText.defaults,e),this.isVisible()?this.initialize():this.addListener(ro.$win,"resize","initializeIfVisible")},isVisible:function(){return this.$input.height()>0},initialize:function(){this.initialized||(this.initialized=!0,this.removeListener(ro.$win,"resize"),this.maxLength=this.$input.attr("maxlength"),this.maxLength&&(this.maxLength=parseInt(this.maxLength)),this.maxLength&&(this.settings.showCharsLeft||ro.hasAttr(this.$input,"data-show-chars-left"))&&(this.showCharsLeft=!0,this.$input.removeAttr("maxlength")),this.$input.data("nicetext")&&(console.warn("Double-instantiating a transparent text input on an element"),this.$input.data("nicetext").destroy()),this.$input.data("nicetext",this),this.getVal(),this.autoHeight=this.settings.autoHeight&&"TEXTAREA"===this.$input.prop("nodeName"),this.autoHeight&&(this.minHeight=this.getHeightForValue(""),this.updateHeight(),this.width=this.$input.width(),this.addListener(ro.$win,"resize","updateHeightIfWidthChanged")),this.settings.hint&&(this.$hintContainer=fs()('<div class="texthint-container"/>').insertBefore(this.$input),this.$hint=fs()('<div class="texthint">'+this.settings.hint+"</div>").appendTo(this.$hintContainer),this.$hint.css({top:parseInt(this.$input.css("borderTopWidth"))+parseInt(this.$input.css("paddingTop")),left:parseInt(this.$input.css("borderLeftWidth"))+parseInt(this.$input.css("paddingLeft"))+1}),ro.copyTextStyles(this.$input,this.$hint),this.val?this.$hint.hide():this.showingHint=!0,this.addListener(this.$hint,"mousedown",(function(t){t.preventDefault(),this.$input.focus()}))),this.showCharsLeft&&(this.$charsLeft=fs()('<div aria-live="polite" class="'+this.settings.charsLeftClass+'"/>').insertAfter(this.$input),this.updateCharsLeft()),this.addListener(this.$input,"textchange","onTextChange"),this.addListener(this.$input,"keydown","onKeyDown"))},initializeIfVisible:function(){this.isVisible()&&this.initialize()},getVal:function(){return this.val=this.$input.val(),this.val},showHint:function(){this.$hint.velocity("fadeIn",{complete:ro.NiceText.hintFadeDuration}),this.showingHint=!0},hideHint:function(){this.$hint.velocity("fadeOut",{complete:ro.NiceText.hintFadeDuration}),this.showingHint=!1},onTextChange:function(){this.getVal(),this.$hint&&(this.showingHint&&this.val?this.hideHint():this.showingHint||this.val||this.showHint()),this.autoHeight&&this.updateHeight(),this.showCharsLeft&&this.updateCharsLeft()},onKeyDown:function(t){t.keyCode===ro.RETURN_KEY&&ro.isCtrlKeyPressed(t)&&(t.preventDefault(),this.$input.closest("form").submit())},buildStage:function(){this.$stage=fs()("<stage/>").appendTo(ro.$bod),this.$stage.css({display:"block",position:"absolute",top:-9999,left:-9999}),this.inputBoxSizing=this.$input.css("box-sizing"),"border-box"===this.inputBoxSizing&&this.$stage.css({"border-top":this.$input.css("border-top"),"border-right":this.$input.css("border-right"),"border-bottom":this.$input.css("border-bottom"),"border-left":this.$input.css("border-left"),"padding-top":this.$input.css("padding-top"),"padding-right":this.$input.css("padding-right"),"padding-bottom":this.$input.css("padding-bottom"),"padding-left":this.$input.css("padding-left"),"-webkit-box-sizing":this.inputBoxSizing,"-moz-box-sizing":this.inputBoxSizing,"box-sizing":this.inputBoxSizing}),ro.copyTextStyles(this.$input,this.$stage)},getHeightForValue:function(t){if(this.$stage||this.buildStage(),"border-box"===this.inputBoxSizing?this.$stage.css("width",this.$input.outerWidth()):this.$stage.css("width",this.$input.width()),t)t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/ {2,}/g,(function(t){for(var e="",n=0;n<t.length-1;n++)e+="&nbsp;";return e+" "})),t=(t=t.replace(/[\n\r]$/g,"<br/>&nbsp;")).replace(/[\n\r]/g,"<br/>");else{t="&nbsp;";for(var e=1;e<this.$input.prop("rows");e++)t+="<br/>&nbsp;"}return this.$stage.html(t),"border-box"===this.inputBoxSizing?this.getHeightForValue._height=this.$stage.outerHeight():this.getHeightForValue._height=this.$stage.height(),this.minHeight&&this.getHeightForValue._height<this.minHeight&&(this.getHeightForValue._height=this.minHeight),this.getHeightForValue._height},updateHeight:function(){this.height!==(this.height=this.getHeightForValue(this.val))&&(this.$input.css("min-height",this.height),this.initialized&&this.onHeightChange())},updateHeightIfWidthChanged:function(){this.isVisible()&&this.width!==(this.width=this.$input.width())&&this.width&&this.updateHeight()},onHeightChange:function(){this.settings.onHeightChange()},updateCharsLeft:function(){this.updateCharsLeft._charsLeft=this.maxLength-this.val.length,this.$charsLeft.html(ro.NiceText.charsLeftHtml(this.updateCharsLeft._charsLeft)),this.updateCharsLeft._charsLeft>=0?this.$charsLeft.removeClass(this.settings.negativeCharsLeftClass):this.$charsLeft.addClass(this.settings.negativeCharsLeftClass)},destroy:function(){this.$input.removeData("nicetext"),this.$hint&&this.$hint.remove(),this.$stage&&this.$stage.remove(),this.base()}},{interval:100,hintFadeDuration:50,charsLeftHtml:function(t){return t},defaults:{autoHeight:!0,showCharsLeft:!1,charsLeftClass:"chars-left",negativeCharsLeftClass:"negative-chars-left",onHeightChange:fs().noop}});function qs(t){return qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(t)}var Ks=ws.extend({$container:null,$items:null,$selectedItems:null,$focusedItem:null,mousedownTarget:null,mouseUpTimeout:null,callbackFrame:null,$focusable:null,$first:null,first:null,$last:null,last:null,init:function(t,e,n){this.$container=fs()(t),void 0===e&&fs().isPlainObject(t)?(n=t,t=null,e=null):void 0===n&&fs().isPlainObject(e)&&(n=e,e=null),this.$container.data("select")&&(console.warn("Double-instantiating a select on an element"),this.$container.data("select").destroy()),this.$container.data("select",this),this.setSettings(n,ro.Select.defaults),this.$items=fs()(),this.$selectedItems=fs()(),this.addItems(e),this.settings.allowEmpty&&!this.settings.checkboxMode&&this.addListener(this.$container,"click",(function(){this.ignoreClick?this.ignoreClick=!1:this.deselectAll(!0)}))},getItemIndex:function(t){return this.$items.index(t[0])},isSelected:function(t){if(ro.isJquery(t)){if(!t[0])return!1;t=t[0]}return-1!==fs().inArray(t,this.$selectedItems)},selectItem:function(t,e,n){this.settings.multi||this.deselectAll(),this.$first=this.$last=t,this.first=this.last=this.getItemIndex(t),e&&this.focusItem(t,n),this._selectItems(t)},selectAll:function(){this.settings.multi&&this.$items.length&&(this.first=0,this.last=this.$items.length-1,this.$first=this.$items.eq(this.first),this.$last=this.$items.eq(this.last),this._selectItems(this.$items))},selectRange:function(t,e){if(!this.settings.multi)return this.selectItem(t,!0,!0);var n,i;this.deselectAll(),this.$last=t,this.last=this.getItemIndex(t),this.focusItem(t,e),this.first<this.last?(n=this.first,i=this.last+1):(n=this.last,i=this.first+1),this._selectItems(this.$items.slice(n,i))},deselectItem:function(t){var e=this.getItemIndex(t);this.first===e&&(this.$first=this.first=null),this.last===e&&(this.$last=this.last=null),this._deselectItems(t)},deselectAll:function(t){t&&(this.$first=this.first=this.$last=this.last=null),this._deselectItems(this.$items)},deselectOthers:function(t){this.deselectAll(),this.selectItem(t,!0,!0)},toggleItem:function(t,e){this.isSelected(t)?this._canDeselect(t)&&this.deselectItem(t,!0):this.selectItem(t,!0,e)},clearMouseUpTimeout:function(){clearTimeout(this.mouseUpTimeout)},getFirstItem:function(){if(this.$items.length)return this.$items.first()},getLastItem:function(){if(this.$items.length)return this.$items.last()},isPreviousItem:function(t){return t>0},isNextItem:function(t){return t<this.$items.length-1},getPreviousItem:function(t){if(this.isPreviousItem(t))return this.$items.eq(t-1)},getNextItem:function(t){if(this.isNextItem(t))return this.$items.eq(t+1)},getItemToTheLeft:function(t){var e=ro.ltr?"Previous":"Next";if(this["is"+e+"Item"](t)){if(this.settings.horizontal)return this["get"+e+"Item"](t);if(!this.settings.vertical)return this.getClosestItem(t,ro.X_AXIS,"<")}},getItemToTheRight:function(t){var e=ro.ltr?"Next":"Previous";if(this["is"+e+"Item"](t)){if(this.settings.horizontal)return this["get"+e+"Item"](t);if(!this.settings.vertical)return this.getClosestItem(t,ro.X_AXIS,">")}},getItemAbove:function(t){if(this.isPreviousItem(t)){if(this.settings.vertical)return this.getPreviousItem(t);if(!this.settings.horizontal)return this.getClosestItem(t,ro.Y_AXIS,"<")}},getItemBelow:function(t){if(this.isNextItem(t)){if(this.settings.vertical)return this.getNextItem(t);if(!this.settings.horizontal)return this.getClosestItem(t,ro.Y_AXIS,">")}},getClosestItem:function(t,e,n){for(var i,r=ro.Select.closestItemAxisProps[e],a=ro.Select.closestItemDirectionProps[n],s=this.$items.eq(t),o=s.offset(),l=o[r.midpointOffset]+Math.round(s[r.midpointSizeFunc]()/2),c=null,u=null,h=null,d=t+(i=ro.rtl&&e===ro.X_AXIS?-1*a.step:a.step);void 0!==this.$items[d];d+=i){var f=this.$items.eq(d),p=f.offset();if(a.isNextRow(p[r.rowOffset],o[r.rowOffset])){if(null===c)c=p[r.rowOffset];else if(p[r.rowOffset]!==c)break;var g=p[r.midpointOffset]+Math.round(f[r.midpointSizeFunc]()/2),m=Math.abs(l-g);if(!(null===u||m<u))break;u=m,h=f}else if(a.isWrongDirection(p[r.rowOffset],o[r.rowOffset]))break}return h},getFurthestItemToTheLeft:function(t){return this.getFurthestItem(t,"ToTheLeft")},getFurthestItemToTheRight:function(t){return this.getFurthestItem(t,"ToTheRight")},getFurthestItemAbove:function(t){return this.getFurthestItem(t,"Above")},getFurthestItemBelow:function(t){return this.getFurthestItem(t,"Below")},getFurthestItem:function(t,e){for(var n,i;i=this["getItem"+e](t);)n=i,t=this.getItemIndex(n);return n},get totalSelected(){return this.getTotalSelected()},getTotalSelected:function(){return this.$selectedItems.length},addItems:function(t){for(var e=this,n=fs()(t),i=0;i<n.length;i++){var r,a=n[i];fs().data(a,"select")&&(console.warn("Element was added to more than one selector"),fs().data(a,"select").removeItems(a)),fs().data(a,"select",this),this.settings.handle?"object"===qs(this.settings.handle)?r=fs()(this.settings.handle):"string"==typeof this.settings.handle?r=fs()(a).find(this.settings.handle):"function"==typeof this.settings.handle&&(r=fs()(this.settings.handle(a))):r=fs()(a),fs().data(a,"select-handle",r),r.data("select-item",a);var s=void 0;this.settings.checkboxClass&&(s=fs()(a).find(".".concat(this.settings.checkboxClass))),this.addListener(r,"mousedown","onMouseDown"),this.addListener(r,"mouseup","onMouseUp"),this.addListener(r,"click",(function(){this.ignoreClick=!0})),s&&s.length&&(s.data("select-item",a),this.addListener(s,"keydown",(function(t){t.keyCode!==ro.RETURN_KEY&&t.keyCode!==ro.SPACE_KEY||t.shiftKey||ro.isCtrlKeyPressed(t)||(t.preventDefault(),e.onCheckboxActivate(t))}))),this.addListener(a,"keydown","onKeyDown")}this.$items=this.$items.add(n),this.updateIndexes()},removeItems:function(t){t=fs().makeArray(t);for(var e=!1,n=!1,i=0;i<t.length;i++){var r=t[i],a=fs().inArray(r,this.$items);if(-1!==a){this._deinitItem(r),this.$items.splice(a,1),e=!0;var s=fs().inArray(r,this.$selectedItems);-1!==s&&(this.$selectedItems.splice(s,1),n=!0)}}e&&(this.updateIndexes(),n&&(fs()(t).removeClass(this.settings.selectedClass),this.onSelectionChange()))},removeAllItems:function(){for(var t=0;t<this.$items.length;t++)this._deinitItem(this.$items[t]);this.$items=fs()(),this.$selectedItems=fs()(),this.updateIndexes()},updateIndexes:function(){null!==this.first?(this.first=this.getItemIndex(this.$first),this.setFocusableItem(this.$first)):this.$items.length&&this.setFocusableItem(fs()(this.$items[0])),this.$focusedItem&&this.focusItem(this.$focusedItem,!0),null!==this.last&&(this.last=this.getItemIndex(this.$last))},resetItemOrder:function(){this.$items=fs()().add(this.$items),this.$selectedItems=fs()().add(this.$selectedItems),this.updateIndexes()},setFocusableItem:function(t){this.settings.makeFocusable&&(this.$focusable&&this.$focusable.removeAttr("tabindex"),this.$focusable=t.attr("tabindex","0"))},focusItem:function(t,e){var n,i;this.settings.makeFocusable?(this.setFocusableItem(t),i=t):i=t.is(":focusable")?t:t.find(":focusable:first"),null!==(n=i)&&void 0!==n&&n.length&&i[0].focus({preventScroll:!!e}),this.$focusedItem=t,this.trigger("focusItem",{item:t})},getSelectedItems:function(){return fs()(this.$selectedItems.toArray())},destroy:function(){this.$container.removeData("select"),this.removeAllItems(),this.base()},onMouseDown:function(t){if(this.mousedownTarget=null,ro.isPrimaryClick(t)||ro.isCtrlKeyPressed(t)){if(this.settings.filter)if("function"==typeof this.settings.filter){if(!this.settings.filter(t.target))return}else if(!fs()(t.target).is(this.settings.filter))return;var e=fs()(fs().data(t.currentTarget,"select-item"));null!==this.first&&t.shiftKey?this.selectRange(e,!0):!this._actAsCheckbox(t)||this.settings.waitForDoubleClicks&&this.isSelected(e)?this.mousedownTarget=t.currentTarget:this.toggleItem(e,!0)}},onMouseUp:function(t){var e=this;if((ro.isPrimaryClick(t)||ro.isCtrlKeyPressed(t))&&(!this.settings.filter||fs()(t.target).is(this.settings.filter))){var n=fs()(fs().data(t.currentTarget,"select-item"));if(!t.shiftKey&&t.currentTarget===this.mousedownTarget)if(this.isSelected(n)){var i=function(){e._actAsCheckbox(t)?e.deselectItem(n):e.deselectOthers(n)};this.settings.waitForDoubleClicks?(this.clearMouseUpTimeout(),this.mouseUpTimeout=setTimeout(i,300)):i()}else this._actAsCheckbox(t)||(this.deselectAll(),this.selectItem(n,!0,!0))}},onCheckboxActivate:function(t){t.stopImmediatePropagation();var e=fs()(fs().data(event.currentTarget,"select-item"));this.isSelected(e)?this.deselectItem(e):this.selectItem(e)},onKeyDown:function(t){var e,n,i=t.target==t.currentTarget,r=null===(e=fs().data(t.currentTarget,"select-handle"))||void 0===e?void 0:e.filter(t.target).length,a=this.settings.checkboxClass&&fs()(t.target).hasClass(this.settings.checkboxClass);if(i||r||a){var s,o,l=ro.isCtrlKeyPressed(t),c=t.shiftKey;switch(this.settings.checkboxMode&&null!==(n=this.$focusable)&&void 0!==n&&n.length?-1===(s=fs().inArray(this.$focusable[0],this.$items))&&(s=0):s=t.shiftKey?this.last:this.first,t.keyCode){case ro.LEFT_KEY:t.preventDefault(),o=null===this.first?ro.ltr?this.getLastItem():this.getFirstItem():l?this.getFurthestItemToTheLeft(s):this.getItemToTheLeft(s);break;case ro.RIGHT_KEY:t.preventDefault(),o=null===this.first?ro.ltr?this.getFirstItem():this.getLastItem():l?this.getFurthestItemToTheRight(s):this.getItemToTheRight(s);break;case ro.UP_KEY:t.preventDefault(),null===this.first?(this.$focusable&&(o=this.$focusable.prev()),this.$focusable&&o.length||(o=this.getLastItem())):(o=l?this.getFurthestItemAbove(s):this.getItemAbove(s))||(o=this.getFirstItem());break;case ro.DOWN_KEY:t.preventDefault(),null===this.first?(this.$focusable&&(o=this.$focusable.next()),this.$focusable&&o.length||(o=this.getFirstItem())):(o=l?this.getFurthestItemBelow(s):this.getItemBelow(s))||(o=this.getLastItem());break;case ro.SPACE_KEY:l||c||(t.preventDefault(),this.isSelected(this.$focusable)?this._canDeselect(this.$focusable)&&this.deselectItem(this.$focusable):this.selectItem(this.$focusable,!0,!1));break;case ro.A_KEY:l&&(t.preventDefault(),this.selectAll())}o&&o.length&&(this.settings.checkboxMode?(this.setFocusableItem(o),this.settings.makeFocusable&&o.focus(),this.$focusedItem=o,this.trigger("focusItem",{item:o})):null!==this.first&&t.shiftKey?this.selectRange(o,!1):(this.deselectAll(),this.selectItem(o,!0,!1)))}},onSelectionChange:function(){this.callbackFrame&&(ro.cancelAnimationFrame(this.callbackFrame),this.callbackFrame=null),this.callbackFrame=ro.requestAnimationFrame(function(){this.callbackFrame=null,this.trigger("selectionChange"),this.settings.onSelectionChange()}.bind(this))},_actAsCheckbox:function(t){return ro.isCtrlKeyPressed(t)?!this.settings.checkboxMode:this.settings.checkboxMode},_canDeselect:function(t){return this.settings.allowEmpty||this.totalSelected>t.length},_selectItems:function(t){t.addClass(this.settings.selectedClass),this.settings.checkboxClass&&t.find(".".concat(this.settings.checkboxClass)).attr("aria-checked","true"),this.$selectedItems=this.$selectedItems.add(t),this.onSelectionChange()},_deselectItems:function(t){t.removeClass(this.settings.selectedClass),this.settings.checkboxClass&&t.find(".".concat(this.settings.checkboxClass)).attr("aria-checked","false"),this.$selectedItems=this.$selectedItems.not(t),this.onSelectionChange()},_deinitItem:function(t){var e=fs().data(t,"select-handle");e&&(e.removeData("select-item"),this.removeAllListeners(e)),fs().removeData(t,"select"),fs().removeData(t,"select-handle"),this.$focusedItem&&this.$focusedItem[0]===t&&(this.$focusedItem=null)}},{defaults:{selectedClass:"sel",checkboxClass:"checkbox",multi:!1,allowEmpty:!0,vertical:!1,horizontal:!1,handle:null,filter:null,checkboxMode:!1,makeFocusable:!1,waitForDoubleClicks:!1,onSelectionChange:fs().noop},closestItemAxisProps:{x:{midpointOffset:"top",midpointSizeFunc:"outerHeight",rowOffset:"left"},y:{midpointOffset:"left",midpointSizeFunc:"outerWidth",rowOffset:"top"}},closestItemDirectionProps:{"<":{step:-1,isNextRow:function(t,e){return t<e},isWrongDirection:function(t,e){return t>e}},">":{step:1,isNextRow:function(t,e){return t>e},isWrongDirection:function(t,e){return t<e}}}}),Xs=Es.extend({init:function(t,e,n,i){"function"==typeof n&&(i=n,n={}),n=fs().extend({},ro.SelectMenu.defaults,n),this.base(t,e,n,i),this.selected=-1},build:function(){this.base(),-1!==this.selected&&this._addSelectedOptionClass(this.selected)},select:function(t){t!==this.selected&&(this.dom.ul&&(-1!==this.selected&&(this.dom.options[this.selected].className=""),this._addSelectedOptionClass(t)),this.selected=t,this.setBtnText(fs()(this.options[t].label).text()),this.base(t))},_addSelectedOptionClass:function(t){this.dom.options[t].className="sel"},setBtnText:function(t){this.dom.$btnLabel.text(t)}},{defaults:{ulClass:"menu select"}}),Js=ws.extend({layers:null,init:function(){this.layers=[{$container:ro.$bod,shortcuts:[],options:{bubble:!1}}],this.addListener(ro.$bod,"keydown","triggerShortcut")},get layer(){return this.layers.length-1},get currentLayer(){return this.layers[this.layer]},get modalLayers(){return this.layers.filter((function(t){return!0===t.isModal}))},get highestModalLayer(){return this.modalLayers.pop()},addLayer:function(t,e){return fs().isPlainObject(t)&&(e=t,t=null),e=Object.assign({bubble:!1},e||{}),this.layers.push({$container:t?fs()(t):null,shortcuts:[],isModal:!!t&&"true"===fs()(t).attr("aria-modal"),options:e}),this.trigger("addLayer",{layer:this.layer,$container:this.currentLayer.$container,options:e}),this},removeLayer:function(t){if(0===this.layer)throw"Can’t remove the base layer.";if(!t)return this.layers.pop(),this.trigger("removeLayer"),this;var e=this.getLayerIndex(t);e&&this.removeLayerAtIndex(e)},getLayerIndex:function(t){var e;return t=fs()(t).get(0),fs()(this.layers).each((function(n){if(null!==this.$container&&this.$container.get(0)===t)return e=n,!1})),e},removeLayerAtIndex:function(t){return this.layers.splice(t,1),this.trigger("removeLayer"),this},registerShortcut:function(t,e,n){return t=this._normalizeShortcut(t),void 0===n&&(n=this.layer),this.layers[n].shortcuts.push({key:JSON.stringify(t),shortcut:t,callback:e}),this},unregisterShortcut:function(t,e){t=this._normalizeShortcut(t);var n=JSON.stringify(t);void 0===e&&(e=this.layer);var i=this.layers[e].shortcuts.findIndex((function(t){return t.key===n}));return-1!==i&&this.layers[e].shortcuts.splice(i,1),this},_normalizeShortcut:function(t){if("number"==typeof t&&(t={keyCode:t}),"number"!=typeof t.keyCode)throw"Invalid shortcut";return{keyCode:t.keyCode,ctrl:!!t.ctrl,shift:!!t.shift,alt:!!t.alt}},triggerShortcut:function(t,e){var n=this;void 0===e&&(e=this.layer);var i=this.layers[e],r=i.shortcuts.find((function(e){return e.shortcut.keyCode===t.keyCode&&e.shortcut.ctrl===ro.isCtrlKeyPressed(t)&&e.shortcut.shift===t.shiftKey&&e.shortcut.alt===t.altKey}));t.bubbleShortcut=function(){e>0&&n.triggerShortcut(t,e-1)},r?(t.preventDefault(),r.callback(t)):i.options.bubble&&t.bubbleShortcut()}});function Qs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}if(void 0!==no)throw"Garnish is already defined!";var Zs,to,eo,no={$win:fs()(window),$doc:fs()(document),$bod:fs()(document.body)};function io(){return eo=eo||new ResizeObserver((function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Qs(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qs(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=fs().data(i.target,"size");if(r){var a=i.target.getBoundingClientRect(),s=a.width,o=a.height;s===r.width&&o===r.height||(fs().data(i.target,"size",{width:s,height:o}),no.resizeEventsMuted||fs()(i.target).trigger("resize"))}}}catch(t){n.e(t)}finally{n.f()}}))}no.rtl=no.$bod.hasClass("rtl"),no.ltr=!no.rtl,no=fs().extend(no,{$scrollContainer:no.$win,activateEventsMuted:!1,resizeEventsMuted:!1,BACKSPACE_KEY:8,TAB_KEY:9,CLEAR_KEY:12,RETURN_KEY:13,SHIFT_KEY:16,CTRL_KEY:17,ALT_KEY:18,ESC_KEY:27,SPACE_KEY:32,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34,END_KEY:35,HOME_KEY:36,LEFT_KEY:37,UP_KEY:38,RIGHT_KEY:39,DOWN_KEY:40,DELETE_KEY:46,A_KEY:65,S_KEY:83,CMD_KEY:91,META_KEY:224,JS_ARIA_CLASS:"garnish-js-aria",JS_ARIA_TRUE_CLASS:"garnish-js-aria-true",JS_ARIA_FALSE_CLASS:"garnish-js-aria-false",PRIMARY_CLICK:1,SECONDARY_CLICK:3,X_AXIS:"x",Y_AXIS:"y",FX_DURATION:200,TEXT_NODE:3,log:function(t){"undefined"!=typeof console&&"function"==typeof console.log&&console.log(t)},_isMobileBrowser:null,_isMobileOrTabletBrowser:null,isMobileBrowser:function(t){var e=t?"_isMobileOrTabletBrowser":"_isMobileBrowser";if(null===no[e]){var n=navigator.userAgent||navigator.vendor||window.opera;no[e]=new RegExp("(android|bbd+|meego).+mobile|avantgo|bada/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)/|plucker|pocket|psp|series(4|6)0|symbian|treo|up.(browser|link)|vodafone|wap|windows ce|xda|xiino"+(t?"|android|ipad|playbook|silk":""),"i").test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substring(0,4))}return no[e]},prefersReducedMotion:function(){var t=window.matchMedia("(prefers-reduced-motion: reduce)");return!t||t.matches},getUserPreferredAnimationDuration:function(t){return no.prefersReducedMotion()?0:t},isArray:function(t){return Array.isArray(t)},isJquery:function(t){return t instanceof fs()},isString:function(t){return"string"==typeof t},hasAttr:function(t,e){var n=fs()(t).attr(e);return void 0!==n&&!1!==n},isTextNode:function(t){return t.nodeType===no.TEXT_NODE},getOffset:function(t){return this.getOffset._offset=fs()(t).offset(),no.$scrollContainer[0]!==no.$win[0]&&(this.getOffset._offset.top+=no.$scrollContainer.scrollTop(),this.getOffset._offset.left+=no.$scrollContainer.scrollLeft()),this.getOffset._offset},getDist:function(t,e,n,i){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-i,2))},hitTest:function(t,e,n){return no.hitTest._$elem=fs()(n),no.hitTest._offset=no.hitTest._$elem.offset(),no.hitTest._x1=no.hitTest._offset.left,no.hitTest._y1=no.hitTest._offset.top,no.hitTest._x2=no.hitTest._x1+no.hitTest._$elem.outerWidth(),no.hitTest._y2=no.hitTest._y1+no.hitTest._$elem.outerHeight(),t>=no.hitTest._x1&&t<no.hitTest._x2&&e>=no.hitTest._y1&&e<no.hitTest._y2},isCursorOver:function(t,e){return no.hitTest(t.pageX,t.pageY,e)},copyTextStyles:function(t,e){var n=fs()(t);fs()(e).css({fontFamily:n.css("fontFamily"),fontSize:n.css("fontSize"),fontWeight:n.css("fontWeight"),letterSpacing:n.css("letterSpacing"),lineHeight:n.css("lineHeight"),textAlign:n.css("textAlign"),textIndent:n.css("textIndent"),whiteSpace:n.css("whiteSpace"),wordSpacing:n.css("wordSpacing"),wordWrap:n.css("wordWrap")})},addModalAttributes:function(t){fs()(t),fs()(t).attr({"aria-modal":"true",role:"dialog"})},hideModalBackgroundLayers:function(){var t=no.uiLayerManager.currentLayer.$container.get(0);no.$bod.children().not("#notifications").each((function(){no.hasJsAriaClass(this)||this===t||no.isScriptOrStyleElement(this)||no.ariaHide(this)}))},resetModalBackgroundLayerVisibility:function(){var t=no.uiLayerManager.highestModalLayer,e=[no.JS_ARIA_CLASS,no.JS_ARIA_TRUE_CLASS,no.JS_ARIA_FALSE_CLASS];if(t)t.$container.removeClass(e).removeAttr("aria-hidden");else{var n=e.map((function(t){return"."+t})).join(", "),i=fs()(n);fs()(i).each((function(){fs()(this).hasClass(no.JS_ARIA_CLASS)?(fs()(this).removeClass(no.JS_ARIA_CLASS),fs()(this).removeAttr("aria-hidden")):fs()(this).hasClass(no.JS_ARIA_FALSE_CLASS)?(fs()(this).removeClass(no.JS_ARIA_FALSE_CLASS),fs()(this).attr("aria-hidden",!1)):fs()(this).hasClass(no.JS_ARIA_TRUE_CLASS)&&(fs()(this).removeClass(no.JS_ARIA_TRUE_CLASS),fs()(this).attr("aria-hidden",!0))}))}},ariaHide:function(t){var e=fs()(t).attr("aria-hidden");e?"false"===e?fs()(t).addClass(no.JS_ARIA_FALSE_CLASS):"true"===e&&fs()(t).addClass(no.JS_ARIA_TRUE_CLASS):fs()(t).addClass(no.JS_ARIA_CLASS),fs()(t).attr("aria-hidden","true")},isScriptOrStyleElement:function(t){return"SCRIPT"===fs()(t).prop("tagName")||"STYLE"===fs()(t).prop("tagName")},hasJsAriaClass:function(t){return fs()(t).hasClass(no.JS_ARIA_CLASS)||fs()(t).hasClass(no.JS_ARIA_FALSE_CLASS)||fs()(t).hasClass(no.JS_ARIA_TRUE_CLASS)},focusIsInside:function(t){return fs()(t).find(":focus").length>0},firstFocusableElement:function(t){return fs()(t).find(":focusable").first()},getKeyboardFocusableElements:function(t){return fs()(t).find(":focusable").filter((function(t,e){return no.isKeyboardFocusable(e)}))},isKeyboardFocusable:function(t){return!(!fs()(t).is(":focusable")||"-1"===fs()(t).attr("tabindex"))},trapFocusWithin:function(t){var e=fs()(t);this.releaseFocusWithin(e),e.on("keydown.focus-trap",(function(t){if(t.keyCode===no.TAB_KEY){var n=e.find(":focusable"),i=n.index(t.target);if(0===n.length)return;0===i&&t.shiftKey?(t.preventDefault(),t.stopPropagation(),n.last().focus()):i!==n.length-1||t.shiftKey||(t.preventDefault(),t.stopPropagation(),n.first().focus())}}))},releaseFocusWithin:function(t){fs()(t).off(".focus-trap")},setFocusWithin:function(t){var e=fs()(t);if(!e.has(document.activeElement).length){var n=fs()(t).find(":focusable:not(.checkbox):not(.prevent-autofocus):first");e.find(".field:visible:first")[0]!==n.parents(".field")[0]&&(n=[]),n.length>0?n.focus():e.attr("tabindex","-1").focus()}},getFocusedElement:function(){return fs()(":focus")},handleActivatingKeypress:function(t,e){var n=t.keyCode;n!==no.SPACE_KEY&&n!==no.RETURN_KEY||(t.preventDefault(),e())},getBodyScrollTop:function(){return no.getBodyScrollTop._scrollTop=document.body.scrollTop,no.getBodyScrollTop._scrollTop<0?no.getBodyScrollTop._scrollTop=0:(no.getBodyScrollTop._maxScrollTop=no.$bod.outerHeight()-no.$win.height(),no.getBodyScrollTop._scrollTop>no.getBodyScrollTop._maxScrollTop&&(no.getBodyScrollTop._scrollTop=no.getBodyScrollTop._maxScrollTop)),no.getBodyScrollTop._scrollTop},requestAnimationFrame:(to=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)},function(t){return to(t)}),cancelAnimationFrame:(Zs=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(t){return Zs(t)}),scrollContainerToElement:function(t,e){var n;if(void 0===e)i=(n=fs()(t)).scrollParent();else{var i=fs()(t);n=fs()(e)}"HTML"!==i.prop("nodeName")&&i[0]!==no.$doc[0]||(i=no.$win);var r,a=i.scrollTop(),s=n.offset().top,o=!1;if((r=i[0]===window?s-a:s-i.offset().top)<0)o=a+r-10;else{var l=n.outerHeight(),c=i[0]===window?window.innerHeight:i[0].clientHeight;r+l>c&&(o=a+(r-(c-l))+10)}!1!==o&&(i[0]===window?fs()("html").velocity("scroll",{offset:o+"px",mobileHA:!1}):i.scrollTop(o))},SHAKE_STEPS:10,SHAKE_STEP_DURATION:25,shake:function(t,e){var n=fs()(t);e||(e="margin-left");var i=parseInt(n.css(e));isNaN(i)&&(i=0);for(var r=0;r<=no.SHAKE_STEPS;r++)!function(t){setTimeout((function(){no.shake._properties={},no.shake._properties[e]=i+(t%2?-1:1)*(10-t),n.velocity(no.shake._properties,no.SHAKE_STEP_DURATION)}),no.SHAKE_STEP_DURATION*t)}(r)},getElement:function(t){return fs().makeArray(t)[0]},getInputBasename:function(t){var e=fs()(t).attr("name");return e?e.replace(/\[.*/,""):null},getInputPostVal:function(t){var e=t.attr("type"),n=t.val();return"checkbox"===e||"radio"===e?t.prop("checked")?n:null:Array.isArray(n)&&"[]"!==t.attr("name").slice(-2)?n.length?n[n.length-1]:null:null===n&&"SELECT"===t.prop("nodeName")?"":n},findInputs:function(t){return fs()(t).find("input,text,textarea,select,button")},getPostData:function(t){for(var e,n={},i={},r=no.findInputs(t),a=0;a<r.length;a++){var s=r.eq(a);if(!s.prop("disabled")&&(e=s.attr("name"))){var o=no.getInputPostVal(s);if(null!==o){var l="[]"===e.slice(-2),c=void 0;l&&void 0===i[c=e.substring(0,e.length-2)]&&(i[c]=0),Array.isArray(o)||(o=[o]);for(var u=0;u<o.length;u++)l&&(e=c+"["+i[c]+"]",i[c]++),n[e]=o[u]}}}return n},copyInputValues:function(t,e){for(var n=no.findInputs(t),i=no.findInputs(e),r=0;r<n.length&&void 0!==i[r];r++)"file"!==i.eq(r).attr("type")&&i.eq(r).val(n.eq(r).val())},isPrimaryClick:function(t){return t.which===this.PRIMARY_CLICK&&!t.ctrlKey&&!t.metaKey},isCtrlKeyPressed:function(t){return window.navigator.platform.match(/Mac/)?t.metaKey:t.ctrlKey},_eventHandlers:[],_normalizeEvents:function(t){"string"==typeof t&&(t=t.split(" "));for(var e=0;e<t.length;e++)"string"==typeof t[e]&&(t[e]=t[e].split("."));return t},on:function(t,e,n,i){if(void 0!==t){"function"==typeof n&&(i=n,n={}),e=this._normalizeEvents(e);for(var r=0;r<e.length;r++){var a=e[r];this._eventHandlers.push({target:t,type:a[0],namespace:a[1],data:n,handler:i})}}else console.warn("Garnish.on() called for an invalid target class.")},off:function(t,e,n){e=this._normalizeEvents(e);for(var i=0;i<e.length;i++)for(var r=e[i],a=this._eventHandlers.length-1;a>=0;a--){var s=this._eventHandlers[a];s.target!==t||s.type!==r[0]||r[1]&&s.namespace!==r[1]||s.handler!==n||this._eventHandlers.splice(a,1)}},once:function(t,e,n,i){var r=this;if(void 0!==t){"function"==typeof n&&(i=n,n={});var a=function(n){r.off(t,e,a),i(n)};this.on(t,e,n,a)}else console.warn("Garnish.once() called for an invalid target class.")},muteResizeEvents:function(t){var e=no.resizeEventsMuted;no.resizeEventsMuted=!0,t(),no.resizeEventsMuted=e},within:function(t,e,n){return t=Math.max(t,e),Math.min(t,n)}}),Object.assign(no,{Base:ws,BaseDrag:_s,CheckboxSelect:Ss,ContextMenu:xs,CustomSelect:Es,DisclosureMenu:Ps,Drag:Ms,DragDrop:Bs,DragMove:Os,DragSort:Hs,EscManager:Rs,HUD:js,MenuBtn:Ns,MixedInput:Us,Modal:Ws,MultiFunctionBtn:Ys,NiceText:Vs,Select:Ks,SelectMenu:Xs,UiLayerManager:Js,Menu:Es,ShortcutManager:Js}),fs().extend(fs().event.special,{activate:{setup:function(t,e,n){var i=fs()(this);i.on({"mousedown.garnish-activate":function(t){"BUTTON"!==t.currentTarget.nodeName&&"button"!==t.currentTarget.role||t.preventDefault()},"click.garnish-activate":function(t){if(!no.activateEventsMuted){var e=i.hasClass("disabled");!e&&"A"===i.prop("nodeName")&&no.hasAttr(i,"href")&&!["#",""].includes(i.attr("href"))&&no.isCtrlKeyPressed(t)||("BUTTON"!==t.currentTarget.nodeName&&"button"!==t.currentTarget.role||t.preventDefault(),e||i.trigger({type:"activate",originalEvent:t}))}},"keydown.garnish-activate":function(t){!no.activateEventsMuted&&this===i[0]&&[no.SPACE_KEY,no.RETURN_KEY].includes(t.keyCode)&&("BUTTON"!==t.currentTarget.nodeName&&"button"!==t.currentTarget.role||t.preventDefault(),i.hasClass("disabled")||i.trigger({type:"activate",originalEvent:t}))}}),i.hasClass("disabled")?i.hasClass("read-only")||i.removeAttr("tabindex"):i[0]!==no.$bod[0]&&i.attr("tabindex","0")},teardown:function(){fs()(this).off(".garnish-activate")}},textchange:{setup:function(t,e,n){var i=fs()(this);i.data("garnish-textchange-value",i.val()),i.on("keypress.garnish-textchange keyup.garnish-textchange change.garnish-textchange blur.garnish-textchange",(function(t){var e=i.val();e!==i.data("garnish-textchange-value")&&(i.data("garnish-textchange-value",e),i.trigger("textchange"))}))},teardown:function(){fs()(this).off(".garnish-textchange")},handle:function(t,e){var n,i,r,a=this,s=arguments,o=null!==(n=null!==(i=null==e?void 0:e.delay)&&void 0!==i?i:null==t||null===(r=t.data)||void 0===r?void 0:r.delay)&&void 0!==n?n:null,l=t.handleObj,c=fs().data(t.target);if(!o)return l.handler.apply(a,s);c.delayTimeout&&clearTimeout(c.delayTimeout),c.delayTimeout=setTimeout((function(){l.handler.apply(a,s)}),o)}},resize:{setup:function(t,e,n){if(this===window)return!1;var i=this.getBoundingClientRect(),r=i.width,a=i.height;fs().data(this,"size",{width:r,height:a}),io().observe(this)},teardown:function(){if(this===window)return!1;io().unobserve(this)}}}),fs().each(["activate","textchange","resize"],(function(t,e){fs().fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var ro=no,ao=new ro.UiLayerManager;Object.assign(ro,{escManager:new ro.EscManager,uiLayerManager:ao,shortcutManager:ao});var so,oo,lo,co,uo,ho,fo,po=ro;function go(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||bo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mo(t){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mo(t)}function vo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=bo(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function yo(t){return function(t){if(Array.isArray(t))return wo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||bo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bo(t,e){if(t){if("string"==typeof t)return wo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wo(t,e):void 0}}function wo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Co(){Co=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==mo(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(mo(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function $o(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function _o(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){$o(a,i,r,s,o,"next",t)}function o(t){$o(a,i,r,s,o,"throw",t)}s(void 0)}))}}function So(t){const e=new Uint8Array(t);let n="";for(const t of e)n+=String.fromCharCode(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function xo(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4,i=e.padEnd(e.length+n,"="),r=atob(i),a=new ArrayBuffer(r.length),s=new Uint8Array(a);for(let t=0;t<r.length;t++)s[t]=r.charCodeAt(t);return a}function Io(){return void 0!==window?.PublicKeyCredential&&"function"==typeof window.PublicKeyCredential}function Eo(t){const{id:e}=t;return{...t,id:xo(e),transports:t.transports}}Craft.CustomizeSourcesModal=po.Modal.extend({elementIndex:null,$body:null,$pagesSidebar:null,$pagesSidebarContent:null,$pagesSidebarItems:null,$newPageBtn:null,pageIconInputs:null,multiPage:!1,pageDrag:null,pages:null,selectedPage:null,$sourcesSidebar:null,$sourcesSidebarContent:null,sourceContainers:null,$sourcesHeader:null,$newSourceBtn:null,$sourceSettingsOuterContainer:null,$sourceSettingsContainer:null,$sourceSettingsHeader:null,$sourceMenu:null,sourceMenu:null,$footer:null,$footerBtnContainer:null,$saveBtn:null,$cancelBtn:null,$loadingSpinner:null,sourceDrag:null,sources:null,selectedSource:null,elementTypeName:null,baseSortOptions:null,availableTableAttributes:null,customFieldAttributes:null,viewModes:null,conditionBuilderHtml:null,conditionBuilderJs:null,userGroups:null,init:function(t,e){var n=this;this.base(),this.setSettings(e,{resizable:!0}),this.elementIndex=t;var i=fs()('<form class="modal cs-modal"/>').appendTo(po.$bod);this.$body=fs()('<div class="cs-body"/>').appendTo(i);var r="cs-header-".concat(Math.floor(1e6*Math.random()));this.$sourcesSidebar=fs()("<div/>",{class:"cs-sidebar cs-selected-screen",role:"navigation","aria-labelledby":r}).appendTo(this.$body),this.$sourcesHeader=fs()('<div class="cs-header"/>').appendTo(this.$sourcesSidebar).append(fs()("<h2/>",{id:r,class:"h3"}).text(Craft.t("app","Sources"))),this.$sourcesSidebarContent=fs()('<div class="cs-sidebar-content"/>').appendTo(this.$sourcesSidebar),this.sourceContainers=[],this.$sourceSettingsOuterContainer=fs()('<div class="cs-source-settings--outer"/>').appendTo(this.$body);var a=fs()('<div class="cs-header"/>').appendTo(this.$sourceSettingsOuterContainer).append(fs()('<h2 class="h3"/>').text(Craft.t("app","Settings"))),s=fs()("<button/>",{type:"button",class:"cs-back-btn",title:Craft.t("app","Back to sources"),"aria-label":Craft.t("app","Back to sources")}).prependTo(a).on("activate",(function(){n.setSelectedScreen(n.$sourcesSidebar)}));Craft.ui.icon("chevron-left").then((function(t){s.append(fs()('<div class="cp-icon"/>').html(t))})),this.$sourceSettingsContainer=fs()('<div class="cs-source-settings">').appendTo(this.$sourceSettingsOuterContainer),this.$footer=fs()('<div class="footer"/>').appendTo(i),this.$footerBtnContainer=fs()('<div class="buttons right"/>').appendTo(this.$footer),this.$cancelBtn=fs()("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")}).appendTo(this.$footerBtnContainer),this.$saveBtn=Craft.ui.createSubmitButton({class:"disabled",label:Craft.t("app","Save"),spinner:!0}).appendTo(this.$footerBtnContainer),this.$loadingSpinner=fs()('<div class="spinner"/>').appendTo(this.$sourceSettingsContainer),this.setContainer(i),this.show(),Craft.sendActionRequest("POST","element-index-settings/get-customize-sources-modal-data",{data:{elementType:this.elementIndex.elementType}}).then(function(){var t=_o(Co().mark((function t(e){return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.$saveBtn.removeClass("disabled"),t.next=3,n.buildModal(e.data);case 3:po.setFocusWithin(n.$sourcesSidebarContent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){n.$loadingSpinner.remove()})),this.addListener(this.$cancelBtn,"click","hide"),this.addListener(this.$saveBtn,"click","save"),this.addListener(this.$container,"submit","save")},buildModal:(lo=_o(Co().mark((function t(e){var n,i,r=this;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.multiPage=e.multiPage,this.baseSortOptions=e.baseSortOptions,this.defaultSortOptions=e.defaultSortOptions,this.availableTableAttributes=e.availableTableAttributes,this.customFieldAttributes=e.customFieldAttributes,this.elementTypeName=e.elementTypeName,this.conditionBuilderHtml=e.conditionBuilderHtml,this.conditionBuilderJs=e.conditionBuilderJs,this.sites=e.sites,this.userGroups=e.userGroups,this.viewModes=e.viewModes,!e.headHtml){t.next=14;break}return t.next=14,Craft.appendHeadHtml(e.headHtml);case 14:if(!e.bodyHtml){t.next=17;break}return t.next=17,Craft.appendBodyHtml(e.bodyHtml);case 17:if(!this.multiPage){t.next=27;break}return t.next=20,this.createPagesSidebar(e);case 20:return t.t0=fs()("<button/>",{type:"button",class:"cs-back-btn",title:Craft.t("app","Back to pages"),"aria-label":Craft.t("app","Back to pages")}),t.t1=fs()('<div class="cp-icon"/>'),t.next=24,Craft.ui.icon("chevron-left");case 24:t.t2=t.sent,t.t3=t.t1.html.call(t.t1,t.t2),t.t0.append.call(t.t0,t.t3).prependTo(this.$sourcesHeader).on("activate",(function(){r.setSelectedScreen(r.$pagesSidebar)}));case 27:for(Craft.hasMousePointerEvents()?this.sourceDrag=new Craft.CustomizeSourcesModal.SourceDrag(this,{handle:".move"}):this.$sourcesSidebar.find(".cs-item .move").hide(),this.sources=[],n=0;n<e.sources.length;n++)this.addSource(e.sources[n]);!this.selectedSource&&this.sources.length&&this.sources[0].select(),this.$newSourceBtn=fs()("<button/>",{class:"btn add icon dashed menubtn",type:"button",title:Craft.t("app","Source actions"),"aria-label":Craft.t("app","Source actions"),"aria-controls":"cs-source-actions","data-disclosure-trigger":"true"}).appendTo(this.$sourcesSidebarContent),this.$sourceMenu=fs()("<div/>",{id:"cs-source-actions",class:"menu menu--disclosure"}).appendTo(this.$sourcesSidebarContent),this.sourceMenu=new po.DisclosureMenu(this.$newSourceBtn),i=function(t){var e=r.addSource(t,!0);po.scrollContainerToElement(r.$sourcesSidebarContent,e.$item),e.select(),r.sourceMenu.hide()},this.sourceMenu.addItem({label:Craft.t("app","New heading"),onActivate:function(){i({type:"heading"}),r.focusLabelInput()}}),e.conditionBuilderHtml&&this.sourceMenu.addItem({label:Craft.t("app","New custom source"),onActivate:function(){var t=r.baseSortOptions.slice(0);t.push.apply(t,yo(r.defaultSortOptions)),i({type:"custom",key:"custom:".concat(Craft.uuid()),sortOptions:t,defaultSort:[t[0].attr,t[1].defaultDir],tableAttributes:[],availableTableAttributes:[]}),r.focusLabelInput()}});case 37:case"end":return t.stop()}}),t,this)}))),function(t){return lo.apply(this,arguments)}),createPagesSidebar:(oo=_o(Co().mark((function t(e){var n,i,r,a,s,o,l,c=this;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$sourcesSidebar.removeClass("cs-selected-screen"),n="cs-header-".concat(Math.floor(1e6*Math.random())),this.$pagesSidebar=fs()("<div/>",{class:"cs-sidebar cs-selected-screen",role:"navigation","aria-labelledby":n}).insertBefore(this.$sourcesSidebar),fs()('<div class="cs-header"/>').appendTo(this.$pagesSidebar).append(fs()("<h2/>",{id:n,class:"h3"}).text(Craft.t("app","Pages"))),this.$pagesSidebarContent=fs()('<div class="cs-sidebar-content"/>').appendTo(this.$pagesSidebar),this.$pagesSidebarItems=fs()('<ol class="cs-sidebar-list"/>').appendTo(this.$pagesSidebarContent),Craft.hasMousePointerEvents()?this.pageDrag=new po.DragSort({handle:".move",axis:"y"}):this.$pagesSidebar.find(".cs-item .move").hide(),this.pages=[],i=Craft.uniqueArray(e.sources.map((function(t){return t.page}))),r=vo(i),t.prev=10,r.s();case 12:if((a=r.n()).done){t.next=19;break}return o=a.value,l=e.pageSettings?null===(s=e.pageSettings[o])||void 0===s?void 0:s.icon:null,t.next=17,this.addPage(o,l);case 17:t.next=12;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(10),r.e(t.t0);case 24:return t.prev=24,r.f(),t.finish(24);case 27:!this.selectedPage&&this.pages.length&&this.pages[0].select(),this.$newPageBtn=fs()("<button/>",{class:"btn add icon dashed",type:"button",text:Craft.t("app","New page")}).appendTo(this.$pagesSidebarContent),this.$newPageBtn.on("activate",(function(){var t;new Craft.CustomizeSourcesModal.PageSettingsModal(c,{triggerElement:c.$newPageBtn,validateName:function(t){return""===Craft.CustomizeSourcesModal.Page.nameId(null!=t?t:"")?Craft.t("yii","{attribute} cannot be blank.",{attribute:Craft.t("app","Page Name")}):!!c.isPageNameUnique(t)||Craft.t("app","Another page already has that name.")},onSave:(t=_o(Co().mark((function t(e,n){return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.addPage(e,n,!0);case 2:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})})}));case 30:case"end":return t.stop()}}),t,this,[[10,21,24,27]])}))),function(t){return oo.apply(this,arguments)}),isPageNameUnique:function(t,e){var n=Craft.CustomizeSourcesModal.Page.nameId(t);return!this.pages.find((function(t){return t!==e&&Craft.CustomizeSourcesModal.Page.nameId(t.name)===n}))},addPage:(so=_o(Co().mark((function t(e){var n,i,r,a,s,o,l=arguments;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:null,r=l.length>2&&void 0!==l[2]&&l[2],a=fs()('<li class="cs-item"/>').appendTo(this.$pagesSidebarItems),t.t0=fs()('<div class="cs-item__btn cs-item__page-btn"/>').attr({tabindex:"0",role:"button"}),t.t1=fs()('<div class="cp-icon"/>'),!i){t.next=11;break}return t.next=8,Craft.ui.icon(i);case 8:t.t2=t.sent,t.next=12;break;case 11:t.t2="";case 12:return t.t3=t.t2,t.t4=t.t1.html.call(t.t1,t.t3),s=t.t0.append.call(t.t0,t.t4).append(fs()("<div/>",{id:"cs-item-label-".concat(Math.floor(1e6*Math.random())),class:"label",text:e})).appendTo(a),Craft.hasMousePointerEvents()&&fs()('<a class="move icon cs-item__move" title="'.concat(Craft.t("app","Reorder"),'" role="button"></a>')).appendTo(a),fs()("<input/>",{type:"hidden",name:"pageSettings[".concat(e,"][icon]"),value:i||"","data-icon-input":"true"}).appendTo(a),o=new Craft.CustomizeSourcesModal.Page(this,a,s,e,i,r),null===(n=this.pageDrag)||void 0===n||n.addItems(a),this.elementIndex.settings.page&&Craft.CustomizeSourcesModal.Page.nameId(this.elementIndex.settings.page)===Craft.CustomizeSourcesModal.Page.nameId(e)&&o.select(),this.pages.push(o),this.updatePageActionButtons(),r&&Craft.cp.announce(Craft.t("app","Success")),t.abrupt("return",o);case 24:case"end":return t.stop()}}),t,this)}))),function(t){return so.apply(this,arguments)}),focusLabelInput:function(){this.selectedSource.$labelInput.focus()},getSourceName:function(){return this.selectedSource?this.selectedSource.sourceData.label:this.sources[0].sourceData.label},getSourceContainer:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return void 0===this.sourceContainers[t]&&e&&(this.sourceContainers[t]=fs()('<ol class="cs-sidebar-list">'),this.$newSourceBtn?this.sourceContainers[t].insertBefore(this.$newSourceBtn):this.sourceContainers[t].appendTo(this.$sourcesSidebarContent),this.multiPage&&t!==this.selectedPage.name&&this.sourceContainers[t].addClass("hidden")),this.sourceContainers[t]},addSource:function(t,e){var n,i,r,a,s=null!==(n=null!==(i=t.page)&&void 0!==i?i:null===(r=this.selectedPage)||void 0===r?void 0:r.name)&&void 0!==n?n:"__DEFAULT__";t.page=s;var o="heading"===t.type,l=this.getSourceContainer(s),c=fs()('<li class="cs-item"/>').appendTo(l),u=fs()('<div class="cs-item__btn"/>').attr({tabindex:"0",role:"button"}).append(fs()("<div/>",{id:"cs-item-label-".concat(Math.floor(1e6*Math.random())),class:"label"})).append(fs()('<div class="handle"/>')).appendTo(c);o&&!t.key&&(t.key="heading:".concat(Craft.uuid()));var h,d,f=fs()("<input/>",{type:"hidden",name:"sourceOrder[]",value:t.key}).appendTo(c);return Craft.hasMousePointerEvents()&&fs()('<a class="move icon cs-item__move" title="'.concat(Craft.t("app","Reorder"),'" role="button"></a>')).appendTo(c),o?(c.addClass("cs-item--heading"),fs()('<input type="hidden"/>').attr("name","sources[".concat(t.key,"][heading]")).val(t.heading).appendTo(c),(h=new Craft.CustomizeSourcesModal.Heading(this,c,u,f,t,e)).updateItemLabel(t.heading)):((h="native"===t.type?new Craft.CustomizeSourcesModal.Source(this,c,u,f,t,e):new Craft.CustomizeSourcesModal.CustomSource(this,c,u,f,t,e)).updateItemLabel(t.label),null!==(d=t.data)&&void 0!==d&&d.handle&&h.updateItemHandle(t.data.handle),t.key===this.elementIndex.rootSourceKey&&h.select()),null===(a=this.sourceDrag)||void 0===a||a.addItems(c),this.sources.push(h),this.updateSourceActionButtons(),e&&Craft.cp.announce(Craft.t("app","Success")),h},updatePageActionButtons:function(){var t,e=vo(this.pages);try{for(e.s();!(t=e.n()).done;)t.value.updateActionButton()}catch(t){e.e(t)}finally{e.f()}},updateSourceActionButtons:function(){var t,e=vo(this.sources);try{for(e.s();!(t=e.n()).done;)t.value.updateActionButton()}catch(t){e.e(t)}finally{e.f()}},setSelectedScreen:function(t){var e;this.$body.width()>=700||(null===(e=this.$pagesSidebar)||void 0===e||e.removeClass("cs-selected-screen"),this.$sourcesSidebar.removeClass("cs-selected-screen"),this.$sourceSettingsOuterContainer.removeClass("cs-selected-screen"),t.addClass("cs-selected-screen"),Craft.setFocusWithin(t))},save:function(t){var e=this;if(t&&t.preventDefault(),!this.$saveBtn.hasClass("disabled")&&!this.$saveBtn.hasClass("loading")){if(this.$saveBtn.addClass("loading"),this.multiPage&&this.pages.some((function(t){return""===t.name})))return Craft.cp.displayError(Craft.t("yii","{attribute} cannot be blank.",{attribute:Craft.t("app","Page Name")})),void this.$saveBtn.removeClass("loading");Craft.sendActionRequest("POST","element-index-settings/save-customize-sources-modal-settings",{data:this.$container.serialize()+"&elementType=".concat(this.elementIndex.elementType)}).then(function(){var t=_o(Co().mark((function t(n){var i,r;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.data,r=null,e.selectedSource&&e.selectedSource.sourceData.key&&!i.disabledSourceKeys.includes(e.selectedSource.sourceData.key)?r=e.selectedSource.sourceData.key:e.elementIndex.sourceKey||(r=e.elementIndex.$visibleSources.first().data("key")),!r){t.next=6;break}return t.next=6,e.elementIndex.asyncSelectSourceByKey(r);case 6:window.location.reload();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var e;Craft.cp.displayError(null==t||null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)})).finally((function(){e.$saveBtn.removeClass("loading")}))}},destroy:function(){var t,e=vo(yo(this.sources));try{for(e.s();!(t=e.n()).done;)t.value.destroy()}catch(t){e.e(t)}finally{e.f()}if(this.pages){var n,i=vo(yo(this.pages));try{for(i.s();!(n=i.n()).done;)n.value.destroy()}catch(t){i.e(t)}finally{i.f()}}this.sourceMenu&&(this.sourceMenu.destroy(),this.$sourceMenu.remove()),this.base()}}),Craft.CustomizeSourcesModal.PageSettingsModal=po.Modal.extend({modal:null,name:null,icon:null,init:function(t,e,n,i){var r=this;"object"===mo(e)&&(i=e,e=null),this.modal=t,this.name=e,this.icon=n;var a=fs()('<form class="modal fitted"/>').appendTo(po.$bod),s=fs()('<div class="body"/>').appendTo(a),o=Craft.ui.createTextField({label:Craft.t("app","Page Name"),value:this.name,required:!0}).appendTo(s),l=Craft.ui.createIconPickerField({label:Craft.t("app","Icon"),value:this.icon}).appendTo(s),c=fs()('<div class="footer flex rightalign flex-nowrap"/>').appendTo(a),u=Craft.ui.createButton({label:Craft.t("app","Cancel")}).appendTo(c);Craft.ui.createSubmitButton({label:Craft.t("app","Save")}).appendTo(c);var h=o.find(".text");h.on("input",(function(){r.name=h.val()})),l.find(".icon-picker").data("iconpicker").on("change",(function(t){r.icon=t.iconName})),u.on("activate",(function(){r.hide()})),a.on("submit",(function(t){if(t.preventDefault(),r.settings.validateName){var e=r.settings.validateName(r.name);if(!0!==e)return Craft.ui.addErrorsToField(o,[e]),r.updateSizeAndPosition(),void h.focus();r.settings.onSave&&r.settings.onSave(r.name,r.icon),r.hide()}})),this.base(a,i)},onFadeOut:function(){this.base(),this.destroy()}}),Craft.CustomizeSourcesModal.SourceDrag=po.DragSort.extend({modal:null,activePage:null,init:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.modal=t,n.filter=function(){return e.$targetItem.hasClass("cs-item--heading")?e.$targetItem.add(e.$targetItem.nextUntil(".cs-item--heading")):e.$targetItem},this.modal.multiPage||(n.axis="y"),this.base(n)},onDragStart:function(){this.activePage=null,this.base()},onDrag:function(){if(this.modal.multiPage){this.onDrag._activePage=null;var t,e=vo(this.modal.pages);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(n!==this.modal.selectedPage&&po.hitTest(this.mouseX,this.mouseY,n.$item)){this.onDrag._activePage=n;break}}}catch(t){e.e(t)}finally{e.f()}(this.activePage&&this.onDrag._activePage!==this.activePage||!this.activePage&&null!==this.onDrag._activePage)&&(this.activePage&&this.activePage.$item.removeClass("active"),this.onDrag._activePage?(this.activePage=this.onDrag._activePage,this.activePage.$item.addClass("active")):this.activePage=null)}this.base()},onDragStop:function(){var t=this;this.activePage&&(this.$draggee.each((function(e,n){fs()(n).data("source").moveToPage(t.activePage)})),this.$draggee.show().css("visibility",""),this.activePage.$item.removeClass("active"),this.fadeOutHelpers()),this.base()},returnHelpersToDraggees:function(){this.activePage||this.base()}}),Craft.CustomizeSourcesModal.Page=po.Base.extend({modal:null,actionMenu:null,$item:null,$itemButton:null,$actionBtn:null,$actionMenu:null,_name:null,_icon:null,isNew:null,moveUpBtn:null,moveDownBtn:null,removeBtn:null,init:function(t,e,n,i,r,a){this.modal=t,this.$item=e,this.$itemButton=n,this._name=i,this._icon=r,this.isNew=a,this.$item.data("page",this),this.createActionMenu(),this.addListener(this.$itemButton,"activate",this.select)},createActionMenu:function(){var t=this;this.$actionBtn=fs()("<button/>",{class:"btn action-btn",type:"button",title:Craft.t("app","Actions"),"aria-label":Craft.t("app","Actions"),"aria-describedby":this.$item.find(".label").attr("id"),"aria-controls":"cs-source-actions","data-disclosure-trigger":"true"}).insertAfter(this.$item.find(".cs-item__btn")),this.$actionMenu=fs()("<div/>",{id:"cs-source-actions",class:"menu menu--disclosure"}).appendTo(this.$item),this.actionMenu=new po.DisclosureMenu(this.$actionBtn),this.moveUpBtn=this.actionMenu.addItem({icon:"arrow-up",label:Craft.t("app","Move up"),onActivate:function(){var e=t.getPrevPage();e&&t.$item.insertBefore(e.$item)}}),this.moveDownBtn=this.actionMenu.addItem({icon:"arrow-down",label:Craft.t("app","Move down"),onActivate:function(){var e=t.getNextPage();e&&t.$item.insertAfter(e.$item)}}),this.actionMenu.addItem({icon:"gear",label:Craft.t("app","Page settings"),onActivate:function(){new Craft.CustomizeSourcesModal.PageSettingsModal(t,t.name,t.icon,{triggerElement:t.$actionBtn,validateName:function(e){return""===Craft.CustomizeSourcesModal.Page.nameId(null!=e?e:"")?Craft.t("yii","{attribute} cannot be blank.",{attribute:Craft.t("app","Page Name")}):!!t.modal.isPageNameUnique(e,t)||Craft.t("app","Another page already has that name.")},onSave:function(e,n){t.name=e,t.icon=n}})}}),this.removeBtn=this.actionMenu.addItem({icon:"trash",label:Craft.t("app","Remove page"),destructive:!0,onActivate:function(){confirm(Craft.t("app","Are you sure you want to remove the page “{name}”?",{name:t.name}))&&t.destroy()}}),this.actionMenu.on("show",(function(){t.updateActionButton()}))},updateActionButton:function(){this.actionMenu.toggleItem(this.moveUpBtn,!!this.getPrevPage()),this.actionMenu.toggleItem(this.moveDownBtn,!!this.getNextPage()),this.actionMenu.toggleItem(this.removeBtn,this.modal.pages.length>1),this.actionMenu.hasVisibleItems()?this.$actionBtn.removeClass("hidden"):this.$actionBtn.addClass("hidden")},getPrevPage:function(){return this.$item.prev(".cs-item").data("page")},getNextPage:function(){return this.$item.next(".cs-item").data("page")},getSourceContainer:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.modal.getSourceContainer(this.name,t)},isSelected:function(){return this.modal.selectedPage===this},select:function(){this.modal.setSelectedScreen(this.modal.$sourcesSidebar),this.isSelected()||(this.modal.selectedPage&&this.modal.selectedPage.deselect(),this.$item.addClass("sel"),this.$itemButton.attr({"aria-current":"true"}),this.modal.sourceContainers[this.name]&&this.modal.sourceContainers[this.name].removeClass("hidden"),this.modal.selectedPage=this,this.modal.$sourceSettingsContainer.scrollTop(0))},deselect:function(){this.$item.removeClass("sel"),this.$itemButton.attr({"aria-current":"false"}),this.modal.sourceContainers[this.name]&&this.modal.sourceContainers[this.name].addClass("hidden"),this.modal.selectedSource&&this.modal.selectedSource.deselect(),this.modal.selectedPage=null},set name(t){if(t!==this.name){this.$item.find(".label").text(t),this.$item.find("[data-icon-input]").attr("name","pageSettings[".concat(t,"][icon]"));var e=this.getSourceContainer(!1);e&&(this.modal.sourceContainers[t]=e,delete this.modal.sourceContainers[this.name],e.find(".cs-item").each((function(e,n){fs()(n).data("source").$pageInput.val(t)}))),this._name=t}},get name(){return this._name},set icon(t){if(t!==this.icon){this.$item.find("[data-icon-input]").val(t||"");var e=this.$item.find(".cp-icon");t?Craft.ui.icon(t).then((function(t){e.html(t)})):e.html(""),this._icon=t}},get icon(){return this._icon},destroy:function(){var t,e=this;null===(t=this.modal.pageDrag)||void 0===t||t.removeItems(this.$item),this.modal.pages=this.modal.pages.filter((function(t){return t!==e}));var n=this.$item.prev(".cs-item");n.length||(n=this.$item.next(".cs-item"));var i=n.data("page");this.isSelected()&&(this.deselect(),null==i||i.select()),null==i||i.$actionBtn.focus();var r=this.getSourceContainer(!1);if(r){if(i)for(var a=i.getSourceContainer(),s=r.children(),o=0;o<s.length;o++)s.eq(o).appendTo(a).data("source").$pageInput.val(i.name);r.remove()}this.$item.data("page",null),this.$item.remove(),this.actionMenu.destroy(),this.$actionMenu.remove(),this.modal.updatePageActionButtons(),this.base()}},{nameId:function(t){return t.replace(/(?:[\0-\/:-@\[-`\{-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u086F\u0888\u088F-\u0896\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2\u09F3\u09FA\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B54\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF3-\u0BFF\u0C0D\u0C11\u0C29\u0C3A\u0C3B\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B\u0C5C\u0C5E\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDC\u0CDF\u0CE4\u0CE5\u0CF0\u0CF4-\u0CFF\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D64\u0D65\u0D79\u0D80\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u1368\u137D-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u1716-\u171E\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u17EF\u17FA-\u180A\u180E\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1ACF-\u1AFF\u1B4D-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u206F\u2072\u2073\u207A-\u207E\u208A-\u208F\u209D-\u20CF\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A-\u245F\u249C-\u24E9\u2500-\u2775\u2794-\u2BFF\u2CE5-\u2CEA\u2CF4-\u2CFC\u2CFE\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u3191\u3196-\u319F\u31C0-\u31EF\u3200-\u321F\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7CE\uA7CF\uA7D2\uA7D4\uA7DD-\uA7F1\uA828-\uA82B\uA82D-\uA82F\uA836-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDD06\uDD34-\uDD3F\uDD79-\uDD89\uDD8C-\uDDFC\uDDFE-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEDF\uDEFC-\uDEFF\uDF24-\uDF2C\uDF4B-\uDF4F\uDF7B-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56\uDC57\uDC77\uDC78\uDC9F-\uDCA6\uDCB0-\uDCDF\uDCF3\uDCF6-\uDCFA\uDD1C-\uDD1F\uDD3A-\uDD7F\uDDB8-\uDDBB\uDDD0\uDDD1\uDE04\uDE07-\uDE0B\uDE14\uDE18\uDE36\uDE37\uDE3B-\uDE3E\uDE49-\uDE5F\uDE7F\uDEA0-\uDEBF\uDEC8\uDEE7-\uDEEA\uDEF0-\uDEFF\uDF36-\uDF3F\uDF56\uDF57\uDF73-\uDF77\uDF92-\uDFA8\uDFB0-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCF9\uDD28-\uDD2F\uDD3A-\uDD3F\uDD66-\uDD68\uDD6E\uDD86-\uDE5F\uDE7F\uDEAA\uDEAD-\uDEAF\uDEB2-\uDEC1\uDEC5-\uDEFB\uDF28-\uDF2F\uDF55-\uDF6F\uDF86-\uDFAF\uDFCC-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC47-\uDC51\uDC76-\uDC7E\uDCBB-\uDCC1\uDCC3-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDCFF\uDD35\uDD40-\uDD43\uDD48-\uDD4F\uDD74\uDD75\uDD77-\uDD7F\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDE0\uDDF5-\uDDFF\uDE12\uDE38-\uDE3D\uDE42-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEEB-\uDEEF\uDEFA-\uDEFF\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A\uDF45\uDF46\uDF49\uDF4A\uDF4E\uDF4F\uDF51-\uDF56\uDF58-\uDF5C\uDF64\uDF65\uDF6D-\uDF6F\uDF75-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFC1\uDFC3\uDFC4\uDFC6\uDFCB\uDFD4-\uDFE0\uDFE3-\uDFFF]|\uD805[\uDC4B-\uDC4F\uDC5A-\uDC5D\uDC62-\uDC7F\uDCC6\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDB6\uDDB7\uDDC1-\uDDD7\uDDDE-\uDDFF\uDE41-\uDE43\uDE45-\uDE4F\uDE5A-\uDE7F\uDEB9-\uDEBF\uDECA-\uDECF\uDEE4-\uDEFF\uDF1B\uDF1C\uDF2C-\uDF2F\uDF3C-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC3B-\uDC9F\uDCF3-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD36\uDD39\uDD3A\uDD44-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD8\uDDD9\uDDE2\uDDE5-\uDDFF\uDE3F-\uDE46\uDE48-\uDE4F\uDE9A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFEF\uDFFA-\uDFFF]|\uD807[\uDC09\uDC37\uDC41-\uDC4F\uDC6D-\uDC71\uDC90\uDC91\uDCA8\uDCB7-\uDCFF\uDD07\uDD0A\uDD37-\uDD39\uDD3B\uDD3E\uDD48-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8F\uDD92\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF7-\uDEFF\uDF11\uDF3B-\uDF3D\uDF43-\uDF4F\uDF5B-\uDFAF\uDFB1-\uDFBF\uDFD5-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD832\uD83D\uD83F\uD87C\uD87D\uD87F\uD889-\uDB3F\uDB41-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC3F\uDC56-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD3A-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDE6F\uDEBF\uDECA-\uDECF\uDEEE\uDEEF\uDEF5-\uDEFF\uDF37-\uDF3F\uDF44-\uDF4F\uDF5A\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDD6F\uDD7A-\uDE3F\uDE97-\uDEFF\uDF4B-\uDF4E\uDF88-\uDF8E\uDFA0-\uDFDF\uDFE2\uDFE5-\uDFEF\uDFF2-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD09-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDC9C\uDC9F-\uDFFF]|\uD833[\uDC00-\uDCEF\uDCFA-\uDEFF\uDF2E\uDF2F\uDF47-\uDFFF]|\uD834[\uDC00-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDE41\uDE45-\uDEBF\uDED4-\uDEDF\uDEF4-\uDF5F\uDF79-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC\uDFCD]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE9A\uDEA0\uDEB0-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC07\uDC19\uDC1A\uDC22\uDC25\uDC2B-\uDC2F\uDC6E-\uDC8E\uDC90-\uDCFF\uDD2D-\uDD2F\uDD3E\uDD3F\uDD4A-\uDD4D\uDD4F-\uDE8F\uDEAF-\uDEBF\uDEFA-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCFA-\uDDCF\uDDFB-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5\uDCC6\uDCD7-\uDCFF\uDD4C-\uDD4F\uDD5A-\uDFFF]|\uD83B[\uDC00-\uDC70\uDCAC\uDCB0\uDCB5-\uDD00\uDD2E\uDD3E-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDFFF]|\uD83E[\uDC00-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86D[\uDF3A-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD888[\uDFB0-\uDFFF]|\uDB40[\uDC00-\uDCFF\uDDF0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,"").toLowerCase()}}),Craft.CustomizeSourcesModal.BaseSource=po.Base.extend({modal:null,actionMenu:null,$item:null,$itemButton:null,$itemInput:null,$pageInput:null,$actionBtn:null,$actionMenu:null,$settingsContainer:null,sourceData:null,isNew:null,moveUpBtn:null,moveDownBtn:null,init:function(t,e,n,i,r,a){this.modal=t,this.$item=e,this.$itemButton=n,this.$itemInput=i,this.sourceData=r,this.isNew=a,this.$item.data("source",this),this.createActionMenu(),this.modal.multiPage&&(this.$pageInput=fs()("<input/>",{type:"hidden",name:"sourcePages[".concat(this.sourceData.key,"]"),value:r.page}).appendTo(this.$item)),this.addListener(this.$itemButton,"activate",this.select)},createActionMenu:function(){var t=this;this.$actionBtn=fs()("<button/>",{class:"btn action-btn",type:"button",title:Craft.t("app","Actions"),"aria-label":Craft.t("app","Actions"),"aria-describedby":this.$item.find(".label").attr("id"),"aria-controls":"cs-source-actions","data-disclosure-trigger":"true"}).insertAfter(this.$item.find(".cs-item__btn")),this.$actionMenu=fs()("<div/>",{id:"cs-source-actions",class:"menu menu--disclosure"}).appendTo(this.$item),this.actionMenu=new po.DisclosureMenu(this.$actionBtn),this.moveUpBtn=this.actionMenu.addItem({icon:"arrow-up",label:Craft.t("app","Move up"),onActivate:function(){var e=t.getPrevSource();e&&t.$item.insertBefore(e.$item)}}),this.moveDownBtn=this.actionMenu.addItem({icon:"arrow-down",label:Craft.t("app","Move down"),onActivate:function(){var e=t.getNextSource();e&&t.$item.insertAfter(e.$item)}}),(this.isHeading()||this.isCustomSource())&&this.actionMenu.addItem({icon:"trash",label:Craft.t("app",this.isHeading()?"Remove heading":"Delete custom source"),destructive:!0,onActivate:function(){t.destroy()}}),this.actionMenu.on("show",(function(){t.updateActionButton()}))},getPrevSource:function(){return this.$item.prev(".cs-item").data("source")},getNextSource:function(){return this.$item.next(".cs-item").data("source")},updateActionButton:function(){var t=this;if(this.actionMenu.toggleItem(this.moveUpBtn,!!this.getPrevSource()),this.actionMenu.toggleItem(this.moveDownBtn,!!this.getNextSource()),this.modal.multiPage){var e=this.$pageInput.val(),n=this.$actionMenu.find("[data-cs-multi-page-list]");n.length||(this.actionMenu.addHr(),n=fs()(this.actionMenu.addList()).attr("data-cs-multi-page-list","true")),n.html(""),this.modal.pages.forEach((function(i){if(i.name!==e){var r=t.actionMenu.addItem({icon:i.icon?_o(Co().mark((function t(){return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Craft.ui.icon(i.icon);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))):null,label:Craft.t("app","Move to {page}",{page:i.name})},n[0]);fs()(r).on("activate",(function(){t.actionMenu.hide(),t.moveToPage(i)}))}})),this.$actionMenu.find("[cs-multi-page-action]").remove()}this.actionMenu.hasVisibleItems()?this.$actionBtn.removeClass("hidden"):this.$actionBtn.addClass("hidden")},isHeading:function(){return!1},isCustomSource:function(){return!1},isSelected:function(){return this.modal.selectedSource===this},select:function(){this.modal.setSelectedScreen(this.modal.$sourceSettingsOuterContainer),this.isSelected()||(this.modal.selectedSource&&this.modal.selectedSource.deselect(),this.$item.addClass("sel"),this.$itemButton.attr({"aria-current":"true"}),this.modal.selectedSource=this,this.$settingsContainer?this.$settingsContainer.removeClass("hidden"):(this.$settingsContainer=fs()("<div/>").appendTo(this.modal.$sourceSettingsContainer),this.createSettings(this.$settingsContainer)),this.modal.$sourceSettingsContainer.scrollTop(0))},createSettings:(co=_o(Co().mark((function t(){return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return co.apply(this,arguments)}),getIndexSourceItem:function(){},deselect:function(){this.$item.removeClass("sel"),this.$itemButton.attr({"aria-current":"false"}),this.modal.selectedSource=null,this.$settingsContainer.addClass("hidden")},updateItemLabel:function(t){t?this.$itemButton.find(".label").text(t):this.$itemButton.find(".label").html("&nbsp;")},updateItemHandle:function(t){t?this.$itemButton.find(".handle").text(t):this.$itemButton.find(".handle").empty()},moveToPage:function(t){this.$item.appendTo(this.modal.getSourceContainer(t.name)),this.$pageInput.val(t.name),this.isSelected()&&this.deselect(),this.modal.updateSourceActionButtons()},destroy:function(){var t,e=this;if(null===(t=this.modal.sourceDrag)||void 0===t||t.removeItems(this.$item),this.modal.sources=this.modal.sources.filter((function(t){return t!==e})),this.isSelected()){this.deselect();var n=this.$item.prev(".cs-item");n.length||(n=this.$item.next(".cs-item")),n.length&&n.data("source").select(),po.setFocusWithin(this.modal.$sourceSettingsContainer)}this.$item.data("source",null),this.$item.remove(),this.actionMenu.destroy(),this.$actionMenu.remove(),this.$settingsContainer&&this.$settingsContainer.remove(),this.modal.updateSourceActionButtons(),this.base()}}),Craft.CustomizeSourcesModal.Source=Craft.CustomizeSourcesModal.BaseSource.extend({$viewModeInput:null,viewModeListbox:null,$sortAttributeSelect:null,$sortDirectionPicker:null,$sortDirectionInput:null,sortDirectionListbox:null,createSettings:(uo=_o(Co().mark((function t(e){return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Craft.ui.createLightswitchField({label:Craft.t("app","Enabled"),name:"sources[".concat(this.sourceData.key,"][enabled]"),on:!this.sourceData.disabled}).appendTo(e),this.createViewModeField(e),this.createSortField(e),this.createTableAttributesField(e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return uo.apply(this,arguments)}),createViewModeField:function(t){var e,n=this,i=fs()("<section/>",{class:"btngroup btngroup--exclusive","aria-label":Craft.t("app","View mode options")}),r=this.modal.viewModes.filter((function(t){return!t.structuresOnly||n.sourceData.structureId})),a=this.sourceData.defaultViewMode;a&&r.some((function(t){return t.mode===a}))||(a=null===(e=r[0])||void 0===e?void 0:e.mode);var s,o=vo(r);try{for(o.s();!(s=o.n()).done;){var l=s.value,c=fs()("<button/>",{type:"button",class:"btn",title:l.title,"aria-label":l.title,"data-mode":l.mode}).appendTo(i);fs()("<div/>",{class:"cp-icon small"}).append(l.iconSvg).appendTo(c),l.mode===a?c.addClass("active").attr("aria-pressed","true"):c.attr("aria-pressed","false")}}catch(t){o.e(t)}finally{o.f()}i.children("button:last").addClass("btngroup-btn-last"),this.$viewModeInput=fs()("<input/>",{type:"hidden",name:"sources[".concat(this.sourceData.key,"][defaultViewMode]"),value:this.sourceData.defaultViewMode}).appendTo(i),this.viewModeListbox=new Craft.Listbox(i,{onChange:function(t){n.$viewModeInput.val(t.data("mode"))}}),Craft.ui.createField(i,{label:Craft.t("app","Default View Mode"),fieldset:!0}).appendTo(t).addClass("view-mode-field")},createSortField:function(t){var e=this,n=fs()('<div class="flex"/>'),i=this.sourceData.sortOptions.sort((function(t,e){return t.label===e.label?0:t.label<e.label?-1:1})).reduce((function(t,e){return"structure"===e.attr?t.structure.push(e):e.attr.startsWith("field:")?t.field.push(e):t.attribute.push(e),t}),{structure:[],attribute:[],field:[]});i.field.length&&i.field.unshift({optgroup:Craft.t("app","Fields")});var r=Craft.ui.createSelect({name:"sources[".concat(this.sourceData.key,"][defaultSort][0]"),options:[].concat(yo(i.structure),yo(i.attribute),yo(i.field)).map((function(t){return t.optgroup?t:{label:t.label,value:t.attr}})),value:this.sourceData.defaultSort[0]}).addClass("fullwidth").appendTo(fs()("<div/>").appendTo(n));this.$sortAttributeSelect=r.children("select").attr("aria-label",Craft.t("app","Sort attribute")),this.$sortDirectionPicker=fs()("<section/>",{class:"btngroup btngroup--exclusive","aria-label":Craft.t("app","Sort direction")}).append(fs()("<button/>",{type:"button",class:"btn",title:Craft.t("app","Sort ascending"),"aria-label":Craft.t("app","Sort ascending"),"aria-pressed":"false","data-icon":"asc","data-dir":"asc"})).append(fs()("<button/>",{type:"button",class:"btn",title:Craft.t("app","Sort descending"),"aria-label":Craft.t("app","Sort descending"),"aria-pressed":"false","data-icon":"desc","data-dir":"desc"})).appendTo(n),this.$sortDirectionInput=fs()("<input/>",{type:"hidden",name:"sources[".concat(this.sourceData.key,"][defaultSort][1]")}).appendTo(n),this.sortDirectionListbox=new Craft.Listbox(this.$sortDirectionPicker,{onChange:function(t){e.$sortDirectionInput.val(t.data("dir"))}}),this.$sortAttributeSelect.on("change",(function(){e.handleSortAttributeChange()})),this.handleSortAttributeChange(!0),Craft.ui.createField(n,{label:Craft.t("app","Default Sort"),fieldset:!0}).appendTo(t).addClass("sort-field")},handleSortAttributeChange:function(t){var e=this.$sortAttributeSelect.val();if("structure"===e)this.sortDirectionListbox.select(0),this.sortDirectionListbox.disable(),this.$sortDirectionPicker.addClass("disabled");else{this.sortDirectionListbox.enable(),this.$sortDirectionPicker.removeClass("disabled");var n=t?this.sourceData.defaultSort[1]:this.sourceData.sortOptions.find((function(t){return t.attr===e})).defaultDir;this.sortDirectionListbox.select("asc"===n?0:1)}},createTableAttributesField:function(t){var e=this.availableTableAttributes().sort((function(t,e){return t[1]===e[1]?0:t[1]<e[1]?-1:1}));if(this.sourceData.tableAttributes.length||e.length){var n="sources[".concat(this.sourceData.key,"][tableAttributes][]");fs()("<input/>",{type:"hidden",name:n,value:""}).appendTo(t),Craft.ui.createSortableCheckboxSelectField({label:Craft.t("app","Default Table Columns"),instructions:Craft.t("app","Choose which table columns should be visible for this source by default."),name:n,options:e.map((function(t){var e=go(t,2),n=e[0];return{label:e[1],value:n}})),values:this.sourceData.tableAttributes.map((function(t){return go(t,1)[0]}))}).appendTo(t)}},availableTableAttributes:function(){var t=this.modal.availableTableAttributes.slice(0);return t.push.apply(t,yo(this.sourceData.availableTableAttributes)),t},getIndexSourceItem:function(){var t=this.modal.elementIndex.getSourceByKey(this.sourceData.key);if(t)return t.closest("li")}}),Craft.CustomizeSourcesModal.CustomSource=Craft.CustomizeSourcesModal.Source.extend({$labelInput:null,isCustomSource:function(){return!0},createSettings:(ho=_o(Co().mark((function t(e){var n,i,r,a,s,o=this;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Craft.ui.createTextField({label:Craft.t("app","Label"),name:"sources[".concat(this.sourceData.key,"][label]"),value:this.sourceData.label}).appendTo(e),this.$labelInput=n.find(".text"),i="condition".concat(Math.floor(1e6*Math.random())),r=function(t){return t.replace(/__ID__/g,i).replace(/__SOURCE_KEY__(?=-)/g,Craft.formatInputId(o.sourceData.key)).replace(/__SOURCE_KEY__/g,o.sourceData.key)},a=this.sourceData.conditionBuilderHtml||r(this.modal.conditionBuilderHtml),s=this.sourceData.conditionBuilderJs||r(this.modal.conditionBuilderJs),Craft.ui.createField(fs()("<div/>").append(a),{id:"criteria",label:Craft.t("app","{type} Criteria",{type:this.modal.elementTypeName})}).appendTo(e),!s){t.next=10;break}return t.next=10,Craft.appendBodyHtml(s);case 10:this.createSortField(e),this.createTableAttributesField(e),this.createViewModeField(e),Craft.sites.length>1&&Craft.ui.createCheckboxSelectField({label:Craft.t("app","Sites"),instructions:Craft.t("app","Choose which sites this source should be visible for."),name:"sources[".concat(this.sourceData.key,"][sites]"),options:Craft.sites.map((function(t){return{label:t.name,value:t.uid}})),values:this.sourceData.sites||"*",showAllOption:!0}).appendTo(e),this.modal.userGroups.length&&Craft.ui.createCheckboxSelectField({label:Craft.t("app","User Groups"),instructions:Craft.t("app","Choose which user groups should have access to this source."),name:"sources[".concat(this.sourceData.key,"][userGroups]"),options:this.modal.userGroups,values:this.sourceData.userGroups||"*",showAllOption:!0}).appendTo(e),this.addListener(this.$labelInput,"input","handleLabelInputChange");case 16:case"end":return t.stop()}}),t,this)}))),function(t){return ho.apply(this,arguments)}),availableTableAttributes:function(){var t=this.base();if(this.isNew){var e=[],n=[];this.modal.customFieldAttributes.forEach((function(t){-1==e.indexOf(t[0])&&(e.push(t[0]),n.push(t))})),t.push.apply(t,n)}return t},handleLabelInputChange:function(){this.updateItemLabel(this.$labelInput.val())},getIndexSourceItem:function(){var t,e=this.base();if(e?t=e.find(".label"):(t=fs()("<span/>",{class:"label"}),e=fs()("<li/>").append(fs()("<a/>",{"data-key":this.sourceData.key}).append(t))),this.$labelInput){var n=this.$labelInput.val().trim();""===n&&(n=Craft.t("app","(blank)")),t.text(n)}return e}}),Craft.CustomizeSourcesModal.Heading=Craft.CustomizeSourcesModal.BaseSource.extend({$labelInput:null,isHeading:function(){return!0},createSettings:(fo=_o(Co().mark((function t(e){var n;return Co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Craft.ui.createTextField({label:Craft.t("app","Heading"),name:"sources[".concat(this.sourceData.key,"][heading]"),instructions:Craft.t("app","This can be left blank if you just want an unlabeled separator."),value:this.sourceData.heading||""}).appendTo(e),this.$labelInput=n.find(".text"),this.addListener(this.$labelInput,"input","handleLabelInputChange");case 3:case"end":return t.stop()}}),t,this)}))),function(t){return fo.apply(this,arguments)}),handleLabelInputChange:function(){this.updateItemLabel(this.$labelInput.val())},updateItemLabel:function(t){this.$itemButton.find(".label").html((t?Craft.escapeHtml(t):"<em>".concat(Craft.t("app","(blank)"),"</em>"))+"&nbsp;")},getIndexSourceItem:function(){var t=(this.$labelInput?this.$labelInput.val():null)||this.sourceData.heading||"";return fs()('<li class="heading"/>').append(fs()("<span/>").text(t)).append("<ul/>")}}),__webpack_require__(7459),__webpack_require__(2353),__webpack_require__(2776),__webpack_require__(7536),__webpack_require__(5176),__webpack_require__(4581),__webpack_require__(2211),__webpack_require__(6465),__webpack_require__(2364);class To extends Error{code;constructor({message:t,code:e,cause:n,name:i}){super(t,{cause:n}),this.name=i??n.name,this.code=e}}const Do=new class{controller;createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const t=new AbortController;return this.controller=t,t.signal}},Lo=["cross-platform","platform"];function ko(t){if(t&&!(Lo.indexOf(t)<0))return t}async function Ao(t,e=!1){if(!Io())throw new Error("WebAuthn is not supported in this browser");let n;0!==t.allowCredentials?.length&&(n=t.allowCredentials?.map(Eo));const i={...t,challenge:xo(t.challenge),allowCredentials:n},r={};if(e){if(!await async function(){const t=window.PublicKeyCredential;return void 0!==t.isConditionalMediationAvailable&&t.isConditionalMediationAvailable()}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete*='webauthn']").length<1)throw Error('No <input> with `"webauthn"` in its `autocomplete` attribute was detected');r.mediation="conditional",i.allowCredentials=[]}let a;r.publicKey=i,r.signal=Do.createNewAbortSignal();try{a=await navigator.credentials.get(r)}catch(t){throw function({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(e.signal instanceof AbortSignal)return new To({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new To({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if("localhost"!==(i=e)&&!/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i))return new To({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rpId!==e)return new To({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new To({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}var i;return t}({error:t,options:r})}if(!a)throw new Error("Authentication was not completed");const{id:s,rawId:o,response:l,type:c}=a;let u;return l.userHandle&&(u=function(t){return new TextDecoder("utf-8").decode(t)}(l.userHandle)),{id:s,rawId:So(o),response:{authenticatorData:So(l.authenticatorData),clientDataJSON:So(l.clientDataJSON),signature:So(l.signature),userHandle:u},type:c,clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:ko(a.authenticatorAttachment)}}async function Po(){return!!Io()&&PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()}function Fo(t){return Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(t)}function Mo(){Mo=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Fo(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Fo(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function Bo(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function Oo(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){Bo(a,i,r,s,o,"next",t)}function o(t){Bo(a,i,r,s,o,"throw",t)}s(void 0)}))}}var Ho,Ro;function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function Go(){Go=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==jo(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(jo(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function No(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function Uo(t){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(t)}function zo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Wo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function Wo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Yo(){Yo=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var a=e&&e.prototype instanceof v?e:v,s=Object.create(a.prototype),o=new L(i||[]);return r(s,"_invoke",{value:I(t,n,o)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};c(w,s,(function(){return this}));var C=Object.getPrototypeOf,$=C&&C(C(k([])));$&&$!==n&&i.call($,s)&&(w=$);var _=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(r,a,s,o){var l=h(t[r],t,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Uo(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var a;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function I(e,n,i){var r=d;return function(a,s){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===a)throw s;return{value:t,done:!0}}for(i.method=a,i.arg=s;;){var o=i.delegate;if(o){var l=E(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:f,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function E(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Uo(e)+" is not iterable")}return y.prototype=b,r(_,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new x(u(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(_),c(_,l,"Generator"),c(_,s,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=k,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function Vo(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function qo(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){Vo(a,i,r,s,o,"next",t)}function o(t){Vo(a,i,r,s,o,"throw",t)}s(void 0)}))}}Craft.ElevatedSessionManager=Garnish.Base.extend({fetchingTimeout:!1,loginModal:null,showingLoginModal:!1,onSuccess:null,onCancel:null,success:!1,requireElevatedSession:function(t,e,n){var i=this;return Oo(Mo().mark((function r(){var a,s;return Mo().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i.onSuccess=t,i.onCancel=e,i.fetchingTimeout=!0,r.prev=3,r.next=6,Craft.sendActionRequest("POST","users/get-elevated-session-timeout");case 6:s=r.sent,a=s.data;case 8:return r.prev=8,i.fetchingTimeout=!1,r.finish(8);case 11:!1===a.timeout||a.timeout>=(n||Craft.ElevatedSessionManager.minSafeElevatedSessionTimeout)?i.onSuccess():i.showLoginModal();case 12:case"end":return r.stop()}}),r,null,[[3,,8,11]])})))()},showLoginModal:function(){var t=this;return Oo(Mo().mark((function e(){var n,i,r;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.showingLoginModal){e.next=2;break}return e.abrupt("return");case 2:return t.showingLoginModal=!0,t.loginModal&&t.loginModal.destroy(),e.next=6,Craft.sendActionRequest("POST","users/login-modal",{data:{email:Craft.userEmail,forElevatedSession:!0}});case 6:n=e.sent,i=n.data,r=$(i.html),t.loginModal=new Garnish.Modal(r,{closeOtherModals:!1,shadeClass:"modal-shade dark login-modal-shade",onFadeIn:function(){var e=Oo(Mo().mark((function e(){return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Craft.initUiElements(r),new Craft.LoginForm(r.find(".login-container"),{showPasskeyBtn:Craft.userHasPasskeys,onLogin:function(){t.success=!0,t.loginModal.hide()}}),e.next=4,Craft.appendHeadHtml(i.headHtml);case 4:return e.next=6,Craft.appendBodyHtml(i.bodyHtml);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onFadeOut:function(){t.loginModal.destroy(),t.loginModal=null},onHide:function(){t.showingLoginModal=!1,t.success?t.onSuccess():t.onCancel&&t.onCancel()}});case 10:case"end":return e.stop()}}),e)})))()}},{minSafeElevatedSessionTimeout:5}),Craft.elevatedSessionManager=new Craft.ElevatedSessionManager,__webpack_require__(2394),__webpack_require__(146),__webpack_require__(3914),__webpack_require__(5141),__webpack_require__(8903),__webpack_require__(4843),__webpack_require__(4642),__webpack_require__(2760),__webpack_require__(9773),Craft.FieldToggle=Garnish.Base.extend({$toggle:null,targetPrefix:null,targetSelector:null,reverseTargetSelector:null,_$target:null,_$reverseTarget:null,type:null,init:function(t){var e=this;switch(this.$toggle=$(t),this.$toggle.data("fieldtoggle")&&(console.warn("Double-instantiating a field toggle on an element"),this.$toggle.data("fieldtoggle").destroy()),this.$toggle.data("fieldtoggle",this),this.type=this.getType(),"select"===this.type||"fieldset"===this.type||Garnish.hasAttr(this.$toggle,"data-target-prefix")?this.targetPrefix=this.$toggle.attr("data-target-prefix")||"":(this.targetSelector=this.normalizeTargetSelector(this.$toggle.data("target")),this.reverseTargetSelector=this.normalizeTargetSelector(this.$toggle.data("reverse-target"))),this.findTargets(),this.type){case"button":this._isButtonToggle()&&(this._$target.attr("id")||this._$target.attr("id","toggle-target-".concat(Math.floor(1e6*Math.random()))),this.$toggle.attr("aria-controls",this._$target.attr("id")),this._updateButtonExpanded()),this.addListener(this.$toggle,"activate","onToggleChange");break;case"fieldset":this.addListener(this.$toggle.find("input"),"change","onToggleChange");break;default:this.addListener(this.$toggle,"change",(function(){e.onToggleChange(),"radio"===e.$toggle.attr("type")&&$('input[type="radio"][name="'.concat(e.$toggle.attr("name"),'"]')).not(e.$toggle).each((function(t,e){var n;null===(n=$(e).data("fieldtoggle"))||void 0===n||n.onToggleChange()}))})),this.onToggleChange()}},normalizeTargetSelector:function(t){return t&&!t.match(/^[#\.]/)&&(t="#"+t),t},getType:function(){var t=this._toggleNodeName();if("INPUT"===t&&["checkbox","radio"].includes(this.$toggle.attr("type"))||"checkbox"===this.$toggle.attr("role")||"switch"===this.$toggle.attr("role"))return"checkbox";switch(t){case"SELECT":return Garnish.hasAttr(this.$toggle,"data-boolean-menu")?"booleanMenu":"select";case"BUTTON":case"A":return"button";default:return"fieldset"}},findTargets:function(){null!==this.targetPrefix?this._$target=$(this.normalizeTargetSelector(this.targetPrefix+(this.getToggleVal()||""))):(this.targetSelector&&(this._$target=$(this.targetSelector)),this.reverseTargetSelector&&(this._$reverseTarget=$(this.reverseTargetSelector)))},getToggleVal:function(){if("checkbox"===this.type&&null===this.targetPrefix)return void 0!==this.$toggle.prop("checked")?this.$toggle.prop("checked"):"true"===this.$toggle.attr("aria-checked");if("booleanMenu"===this.type){var t=this.$toggle.data("boolean");if(void 0!==t)return t;var e=this.$toggle.val();return e&&"0"!==e}return"fieldset"===this.type?this.normalizeToggleVal(this.$toggle.find("input:checked:first").val()):this.normalizeToggleVal(this.$toggle.val())},normalizeToggleVal:function(t){return t?t.replace(/[^\w]+/g,"-"):null},onToggleChange:(Ho=Go().mark((function t(){var e;return Go().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.$toggle.data("selectize"))||""!==this.$toggle.val()){t.next=7;break}return t.next=5,Craft.sleep(1);case 5:if(!e.isOpen){t.next=7;break}return t.abrupt("return");case 7:"select"===this.type||"fieldset"===this.type?(this.hideTarget(this._$target),this.findTargets(),this.showTarget(this._$target)):(this.findTargets(),"button"===this.type?this.onToggleChange._show=this._buttonIsCollapsed():"checkbox"===this.type&&null!==this.targetPrefix?this.onToggleChange._show=this.$toggle.prop("checked"):this.onToggleChange._show=!!this.getToggleVal(),this.onToggleChange._show?(this.showTarget(this._$target),this.hideTarget(this._$reverseTarget)):(this.hideTarget(this._$target),this.showTarget(this._$reverseTarget)),delete this.onToggleChange._show),this.trigger("toggleChange");case 9:case"end":return t.stop()}}),t,this)})),Ro=function(){var t=this,e=arguments;return new Promise((function(n,i){var r=Ho.apply(t,e);function a(t){No(r,n,i,a,s,"next",t)}function s(t){No(r,n,i,a,s,"throw",t)}a(void 0)}))},function(){return Ro.apply(this,arguments)}),showTarget:function(t){var e=this;if(t&&t.length){if(this.showTarget._currentHeight=t.height(),t.removeClass("hidden"),"select"!==this.type&&"fieldset"!==this.type){"button"===this.type&&(this.$toggle.removeClass("collapsed"),this.$toggle.addClass("expanded"),this._isButtonToggle()&&this._updateButtonExpanded());for(var n=0;n<t.length;n++)!function(t){"SPAN"!==t.prop("nodeName")&&(t.height("auto"),e.showTarget._targetHeight=t.height(),t.css({height:e.showTarget._currentHeight,overflow:"hidden"}),t.velocity("stop"),t.velocity({height:e.showTarget._targetHeight},"fast",(function(){t.css({height:"",overflow:""})})))}(t.eq(n));delete this.showTarget._targetHeight}delete this.showTarget._currentHeight,Garnish.$win.trigger("resize")}},hideTarget:function(t){if(t&&t.length)if("select"===this.type||"fieldset"===this.type)t.addClass("hidden");else{"button"===this.type&&(this.$toggle.removeClass("expanded"),this.$toggle.addClass("collapsed"),this._isButtonToggle()&&this._updateButtonExpanded());for(var e=0;e<t.length;e++)!function(t){t.hasClass("hidden")||("SPAN"===t.prop("nodeName")?t.addClass("hidden"):(t.css("overflow","hidden"),t.velocity("stop"),t.velocity({height:0},"fast",(function(){t.addClass("hidden")}))))}(t.eq(e))}},_toggleNodeName:function(){return this.$toggle.prop("nodeName")},_isButtonToggle:function(){return"BUTTON"===this._toggleNodeName()},_buttonIsCollapsed:function(){return this.$toggle.hasClass("collapsed")||!this.$toggle.hasClass("expanded")},_updateButtonExpanded:function(){this.$toggle.attr("aria-expanded",this._buttonIsCollapsed()?"false":"true")},destroy:function(){this.$toggle.removeData("fieldtoggle"),this.base()}}),__webpack_require__(5026),__webpack_require__(5794),__webpack_require__(7845),__webpack_require__(9922),__webpack_require__(743),__webpack_require__(341),__webpack_require__(2756),__webpack_require__(8287),__webpack_require__(1980),__webpack_require__(9940),__webpack_require__(2200),__webpack_require__(5540),__webpack_require__(8081),__webpack_require__(9626),Craft.LoginForm=Garnish.Base.extend({$container:null,$form:null,$spinner:null,$usernameInput:null,$passwordInput:null,$rememberMeCheckbox:null,$forgotPasswordLink:null,$submitBtn:null,submitBtn:null,$errors:null,$altMethodContainer:null,$passkeyBtn:null,passkeyBtn:null,modal:null,resetPasswordForm:null,validateOnInput:!1,init:function(t,e){var n=this;return qo(Yo().mark((function i(){return Yo().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.$container=$(t),n.$pane=n.$container.find(".login-form-container"),n.$form=n.$container.find(".login-form"),n.$usernameInput=n.$form.find(".login-username"),n.$passwordInput=n.$form.find(".login-password"),n.$rememberMeCheckbox=n.$form.find(".login-remember-me"),n.$forgotPasswordLink=n.$form.find(".login-forgot-password"),n.$submitBtn=n.$form.find("button.submit"),n.$errors=n.$container.find(".login-errors"),n.$altMethodContainer=n.$container.find(".alternative-login-methods"),n.$passkeyBtn=n.$altMethodContainer.find(".login-passkey-btn"),n.setSettings(e,Craft.LoginForm.defaults),n.modal=n.$container.closest(".modal").data("modal"),n.submitBtn=new Garnish.MultiFunctionBtn(n.$submitBtn,{changeButtonText:!0}),n.passkeyBtn=new Garnish.MultiFunctionBtn(n.$passkeyBtn),n.$spinner=document.createElement("craft-spinner"),n.$spinner.setAttribute("visible",!1),n.$spinner.classList.add("center-absolute"),$(n.$spinner).insertAfter(n.$form),new Craft.PasswordInput(n.$passwordInput,{onToggleInput:function(t){n.removeListener(n.$passwordInput,"input"),n.$passwordInput=t,n.addListener(n.$passwordInput,"input","onInput")}}),n.addListener(n.$usernameInput,"input","onInput"),n.addListener(n.$passwordInput,"input","onInput"),n.addListener(n.$forgotPasswordLink,"activate","showResetPasswordForm"),n.addListener(n.$form,"submit","onSubmit"),Garnish.isMobileBrowser()||(n.$usernameInput.val()?n.$passwordInput.focus():n.$usernameInput.focus()),i.t0=n.settings.showPasskeyBtn&&Io(),!i.t0){i.next=30;break}return i.next=29,Po();case 29:i.t0=i.sent;case 30:if(!i.t0){i.next=34;break}n.$passkeyBtn.removeClass("hidden"),n.onResize(),n.addListener(n.$passkeyBtn,"activate",(function(){n.loginWithPasskey()}));case 34:n.$altMethodContainer.children().filter(".btn:not(.hidden)").length&&(n.$altMethodContainer.removeClass("hidden"),Garnish.$win.trigger("resize"));case 35:case"end":return i.stop()}}),i)})))()},validate:function(){var t=Craft.LoginForm.validateUsernameOrEmail(this.$usernameInput.val());if(!0!==t)return t;var e=this.$passwordInput.val().length;return e<Craft.minPasswordLength?Craft.t("yii","{attribute} should contain at least {min, number} {min, plural, one{character} other{characters}}.",{attribute:Craft.t("app","Password"),min:Craft.minPasswordLength}):!(e>Craft.maxPasswordLength)||Craft.t("yii","{attribute} should contain at most {max, number} {max, plural, one{character} other{characters}}.",{attribute:Craft.t("app","Password"),max:Craft.maxPasswordLength})},onInput:function(){this.validateOnInput&&!0===this.validate()&&this.clearErrors()},onSubmit:function(t){var e=this;t.preventDefault();var n=this.validate();if(!0!==n)return this.showError(n),void(this.validateOnInput=!0);this.clearErrors(),this.submitBtn.busyEvent();var i={loginName:this.$usernameInput.val(),password:this.$passwordInput.val(),rememberMe:this.$rememberMeCheckbox.prop("checked")?"y":""};Craft.sendActionRequest("POST","users/login",{data:i}).then((function(t){var n=t.data;n.authMethod?e.show2faForm(n):(e.submitBtn.successEvent(),e.settings.onLogin(n.returnUrl))})).catch((function(t){var n;e.submitBtn.failureEvent(),Garnish.shake(e.$form,"left"),e.showError((null==t||null===(n=t.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||Craft.t("app","A server error occurred.")),e.submitBtn.failureEvent()}))},showResetPasswordForm:function(){this.clearErrors(),this.$form.addClass("hidden"),this.resetPasswordForm||(this.resetPasswordForm=new Craft.LoginForm.ResetPasswordForm(this,this.$container)),this.resetPasswordForm.$form.removeClass("hidden"),this.resetPasswordForm.$usernameInput.val(this.$usernameInput.val()),Garnish.isMobileBrowser()||this.resetPasswordForm.$usernameInput.focus(),this.onResize()},show2faForm:function(t){var e=this;return qo(Yo().mark((function n(){var i,r,a,s,o,l,c,u,h,d;return Yo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.clearErrors(),e.$form.addClass("hidden"),i=$(t.authForm).insertAfter(e.$form),n.next=5,Craft.appendHeadHtml(t.headHtml);case 5:return n.next=7,Craft.appendBodyHtml(t.bodyHtml);case 7:if(Craft.initUiElements(i),Craft.createAuthFormHandler(t.authMethod,i,(function(){e.settings.onLogin(t.returnUrl)}),(function(t){e.showError(t)})),Garnish.isMobileBrowser()||setTimeout((function(){i.find(":focusable:first").focus()}),100),t.otherMethods.length){r=$("<hr/>").insertAfter(i),a=$('<div class="login-alt-container"/>').insertAfter(r),s=$('<div id="login-alt-menu" class="login-alt-menu menu menu--disclosure"/>').appendTo(a),o=$("<ul/>").appendTo(s),l=zo(t.otherMethods);try{for(l.s();!(c=l.n()).done;)u=c.value,$("<li/>").append($("<button/>",{text:u.name,"data-method":u.class,class:"menu-item"})).appendTo(o)}catch(t){l.e(t)}finally{l.f()}h=$("<button/>",{type:"button","aria-controls":"login-alt-menu",class:"menu-toggle",html:Craft.t("app","Try another way")}).appendTo(a),d=new Garnish.DisclosureMenu(h),o.find("button").on("activate",(function(t){var n=e.$pane.outerHeight();e.$pane.outerHeight(n),e.$spinner.visible=!0,e.$spinner.focus(),d.hide(),i.remove(),r.remove(),a.remove(),Craft.sendActionRequest("post","users/auth-form",{data:{method:$(t.target).data("method")}}).then((function(t){var n=t.data;e.$pane.removeAttr("style"),e.show2faForm(n)})).finally((function(){e.$spinner.visible=!1}))}))}e.onResize();case 12:case"end":return n.stop()}}),n)})))()},showError:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.clearErrors(),e=e||this.$errors.first(),$('<p style="display: none;">'+t+"</p>").appendTo(e).velocity("fadeIn"),e.removeClass("hidden"),Craft.cp.announce(t),this.onResize()},clearErrors:function(){this.$errors.empty().addClass("hidden"),this.onResize()},onResize:function(){var t=this;this.modal&&Garnish.requestAnimationFrame((function(){t.modal.updateSizeAndPosition()}))},loginWithPasskey:function(){var t=this;return qo(Yo().mark((function e(){var n,i,r,a,s;return Yo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$passkeyBtn.hasClass("loading")){e.next=2;break}return e.abrupt("return");case 2:return t.passkeyBtn.busyEvent(),e.prev=3,e.next=6,Craft.sendActionRequest("POST","auth/passkey-request-options");case 6:return n=e.sent,e.next=9,Ao(n.data.options);case 9:return i=e.sent,e.next=12,Craft.sendActionRequest("POST","users/login-with-passkey",{data:{requestOptions:JSON.stringify(n.data.options),response:JSON.stringify(i)}});case 12:r=e.sent,t.passkeyBtn.successEvent(),t.settings.onLogin(r.data.returnUrl),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(3),s=null===e.t0||void 0===e.t0||null===(a=e.t0.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.message,t.passkeyBtn.failureEvent(),s&&t.showError(s);case 22:return e.prev=22,t.passkeyBtn.endBusyState(),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[3,17,22,25]])})))()}},{validateUsernameOrEmail:function(t){return 0===t.length?Craft.useEmailAsUsername?Craft.t("app","Invalid email."):Craft.t("app","Invalid username or email."):!(Craft.useEmailAsUsername&&!t.match(".+@.+..+"))||Craft.t("app","Invalid email.")},defaults:{showPasskeyBtn:!0,onLogin:function(t){window.location.href=t}}}),Craft.LoginForm.ResetPasswordForm=Garnish.Base.extend({loginForm:null,$container:null,$form:null,$usernameInput:null,$submitBtn:null,$errors:null,$backBtn:null,validateOnInput:!1,init:function(t,e){this.loginForm=t,this.$container=$(e),this.$form=this.$container.find(".login-reset-password").removeClass("hidden"),this.$usernameInput=this.$form.find(".login-username"),this.$submitBtn=this.$form.find("button.submit"),this.$errors=this.$form.find(".login-errors"),this.$backBtn=this.$form.find(".login-reset-back-btn"),this.addListener(this.$usernameInput,"input","onInput"),this.addListener(this.$form,"submit","onSubmit"),this.addListener(this.$backBtn,"activate","showLoginForm")},validate:function(){return Craft.LoginForm.validateUsernameOrEmail(this.$usernameInput.val())},onInput:function(){this.validateOnInput&&!0===this.validate()&&this.loginForm.clearErrors()},onSubmit:function(t){var e=this;t.preventDefault();var n=this.validate();if(!0!==n)return this.loginForm.showError(n,this.$errors),void(this.validateOnInput=!0);this.loginForm.clearErrors(),this.$submitBtn.addClass("loading"),Craft.cp.announce(Craft.t("app","Loading"));var i={loginName:this.$usernameInput.val()};Craft.sendActionRequest("POST","users/send-password-reset-email",{data:i}).then((function(t){new Craft.LoginForm.ResetPasswordForm.MessageSentModal})).catch((function(t){e.loginForm.showError(t&&t.response&&t.response.data&&t.response.data.message||Craft.t("app","A server error occurred."),e.$errors)})).finally((function(){e.$submitBtn.removeClass("loading")}))},showLoginForm:function(){this.loginForm.clearErrors(),this.$form.addClass("hidden"),this.loginForm.$form.removeClass("hidden"),this.loginForm.$usernameInput.val(this.$usernameInput.val()),Garnish.isMobileBrowser()||this.loginForm.$usernameInput.focus(),this.loginForm.onResize()}}),Craft.LoginForm.ResetPasswordForm.MessageSentModal=Garnish.Modal.extend({init:function(){var t=$('<div class="modal fitted email-sent"><div class="body">'+Craft.t("app","Check your email for instructions to reset your password.")+"</div></div>").appendTo(Garnish.$bod);this.base(t)},hide:function(){}}),__webpack_require__(714),__webpack_require__(5571),__webpack_require__(4500),__webpack_require__(8413),__webpack_require__(4004),__webpack_require__(3910),__webpack_require__(8723),__webpack_require__(3019),__webpack_require__(5184),__webpack_require__(2107),__webpack_require__(9),__webpack_require__(5335),__webpack_require__(1973),__webpack_require__(8250),__webpack_require__(838),__webpack_require__(9975),__webpack_require__(0),__webpack_require__(6452),__webpack_require__(7337),__webpack_require__(9961),__webpack_require__(555),__webpack_require__(7493);const Ko=Math.min,Xo=Math.max,Jo=Math.round,Qo=Math.floor,Zo=t=>({x:t,y:t}),tl={left:"right",right:"left",bottom:"top",top:"bottom"},el={start:"end",end:"start"};function nl(t,e,n){return Xo(t,Ko(e,n))}function il(t,e){return"function"==typeof t?t(e):t}function rl(t){return t.split("-")[0]}function al(t){return t.split("-")[1]}function sl(t){return"x"===t?"y":"x"}function ol(t){return"y"===t?"height":"width"}function ll(t){return["top","bottom"].includes(rl(t))?"y":"x"}function cl(t){return sl(ll(t))}function ul(t){return t.replace(/start|end/g,(t=>el[t]))}function hl(t){return t.replace(/left|right|bottom|top/g,(t=>tl[t]))}function dl(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function fl(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function pl(t,e,n){let{reference:i,floating:r}=t;const a=ll(e),s=cl(e),o=ol(s),l=rl(e),c="y"===a,u=i.x+i.width/2-r.width/2,h=i.y+i.height/2-r.height/2,d=i[o]/2-r[o]/2;let f;switch(l){case"top":f={x:u,y:i.y-r.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:h};break;case"left":f={x:i.x-r.width,y:h};break;default:f={x:i.x,y:i.y}}switch(al(e)){case"start":f[s]-=d*(n&&c?-1:1);break;case"end":f[s]+=d*(n&&c?-1:1)}return f}async function gl(t,e){var n;void 0===e&&(e={});const{x:i,y:r,platform:a,rects:s,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=il(e,t),p=dl(f),g=o[d?"floating"===h?"reference":"floating":h],m=fl(await a.getClippingRect({element:null==(n=await(null==a.isElement?void 0:a.isElement(g)))||n?g:g.contextElement||await(null==a.getDocumentElement?void 0:a.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===h?{...s.floating,x:i,y:r}:s.reference,y=await(null==a.getOffsetParent?void 0:a.getOffsetParent(o.floating)),b=await(null==a.isElement?void 0:a.isElement(y))&&await(null==a.getScale?void 0:a.getScale(y))||{x:1,y:1},w=fl(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:l}):v);return{top:(m.top-w.top+p.top)/b.y,bottom:(w.bottom-m.bottom+p.bottom)/b.y,left:(m.left-w.left+p.left)/b.x,right:(w.right-m.right+p.right)/b.x}}function ml(){return"undefined"!=typeof window}function vl(t){return wl(t)?(t.nodeName||"").toLowerCase():"#document"}function yl(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function bl(t){var e;return null==(e=(wl(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function wl(t){return!!ml()&&(t instanceof Node||t instanceof yl(t).Node)}function Cl(t){return!!ml()&&(t instanceof Element||t instanceof yl(t).Element)}function $l(t){return!!ml()&&(t instanceof HTMLElement||t instanceof yl(t).HTMLElement)}function _l(t){return!(!ml()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof yl(t).ShadowRoot)}function Sl(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=Ll(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function xl(t){return["table","td","th"].includes(vl(t))}function Il(t){return[":popover-open",":modal"].some((e=>{try{return t.matches(e)}catch(t){return!1}}))}function El(t){const e=Tl(),n=Cl(t)?Ll(t):t;return["transform","translate","scale","rotate","perspective"].some((t=>!!n[t]&&"none"!==n[t]))||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((t=>(n.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(n.contain||"").includes(t)))}function Tl(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Dl(t){return["html","body","#document"].includes(vl(t))}function Ll(t){return yl(t).getComputedStyle(t)}function kl(t){return Cl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Al(t){if("html"===vl(t))return t;const e=t.assignedSlot||t.parentNode||_l(t)&&t.host||bl(t);return _l(e)?e.host:e}function Pl(t){const e=Al(t);return Dl(e)?t.ownerDocument?t.ownerDocument.body:t.body:$l(e)&&Sl(e)?e:Pl(e)}function Fl(t,e,n){var i;void 0===e&&(e=[]),void 0===n&&(n=!0);const r=Pl(t),a=r===(null==(i=t.ownerDocument)?void 0:i.body),s=yl(r);if(a){const t=Ml(s);return e.concat(s,s.visualViewport||[],Sl(r)?r:[],t&&n?Fl(t):[])}return e.concat(r,Fl(r,[],n))}function Ml(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Bl(t){const e=Ll(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=$l(t),a=r?t.offsetWidth:n,s=r?t.offsetHeight:i,o=Jo(n)!==a||Jo(i)!==s;return o&&(n=a,i=s),{width:n,height:i,$:o}}function Ol(t){return Cl(t)?t:t.contextElement}function Hl(t){const e=Ol(t);if(!$l(e))return Zo(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:a}=Bl(e);let s=(a?Jo(n.width):n.width)/i,o=(a?Jo(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),o&&Number.isFinite(o)||(o=1),{x:s,y:o}}const Rl=Zo(0);function jl(t){const e=yl(t);return Tl()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:Rl}function Gl(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1);const r=t.getBoundingClientRect(),a=Ol(t);let s=Zo(1);e&&(i?Cl(i)&&(s=Hl(i)):s=Hl(t));const o=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==yl(t))&&e}(a,n,i)?jl(a):Zo(0);let l=(r.left+o.x)/s.x,c=(r.top+o.y)/s.y,u=r.width/s.x,h=r.height/s.y;if(a){const t=yl(a),e=i&&Cl(i)?yl(i):i;let n=t,r=Ml(n);for(;r&&i&&e!==n;){const t=Hl(r),e=r.getBoundingClientRect(),i=Ll(r),a=e.left+(r.clientLeft+parseFloat(i.paddingLeft))*t.x,s=e.top+(r.clientTop+parseFloat(i.paddingTop))*t.y;l*=t.x,c*=t.y,u*=t.x,h*=t.y,l+=a,c+=s,n=yl(r),r=Ml(n)}}return fl({width:u,height:h,x:l,y:c})}function Nl(t,e){const n=kl(t).scrollLeft;return e?e.left+n:Gl(bl(t)).left+n}function Ul(t,e,n){void 0===n&&(n=!1);const i=t.getBoundingClientRect();return{x:i.left+e.scrollLeft-(n?0:Nl(t,i)),y:i.top+e.scrollTop}}function zl(t,e,n){let i;if("viewport"===e)i=function(t,e){const n=yl(t),i=bl(t),r=n.visualViewport;let a=i.clientWidth,s=i.clientHeight,o=0,l=0;if(r){a=r.width,s=r.height;const t=Tl();(!t||t&&"fixed"===e)&&(o=r.offsetLeft,l=r.offsetTop)}return{width:a,height:s,x:o,y:l}}(t,n);else if("document"===e)i=function(t){const e=bl(t),n=kl(t),i=t.ownerDocument.body,r=Xo(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),a=Xo(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let s=-n.scrollLeft+Nl(t);const o=-n.scrollTop;return"rtl"===Ll(i).direction&&(s+=Xo(e.clientWidth,i.clientWidth)-r),{width:r,height:a,x:s,y:o}}(bl(t));else if(Cl(e))i=function(t,e){const n=Gl(t,!0,"fixed"===e),i=n.top+t.clientTop,r=n.left+t.clientLeft,a=$l(t)?Hl(t):Zo(1);return{width:t.clientWidth*a.x,height:t.clientHeight*a.y,x:r*a.x,y:i*a.y}}(e,n);else{const n=jl(t);i={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return fl(i)}function Wl(t,e){const n=Al(t);return!(n===e||!Cl(n)||Dl(n))&&("fixed"===Ll(n).position||Wl(n,e))}function Yl(t,e,n){const i=$l(e),r=bl(e),a="fixed"===n,s=Gl(t,!0,a,e);let o={scrollLeft:0,scrollTop:0};const l=Zo(0);if(i||!i&&!a)if(("body"!==vl(e)||Sl(r))&&(o=kl(e)),i){const t=Gl(e,!0,a,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else r&&(l.x=Nl(r));const c=!r||i||a?Zo(0):Ul(r,o);return{x:s.left+o.scrollLeft-l.x-c.x,y:s.top+o.scrollTop-l.y-c.y,width:s.width,height:s.height}}function Vl(t){return"static"===Ll(t).position}function ql(t,e){if(!$l(t)||"fixed"===Ll(t).position)return null;if(e)return e(t);let n=t.offsetParent;return bl(t)===n&&(n=n.ownerDocument.body),n}function Kl(t,e){const n=yl(t);if(Il(t))return n;if(!$l(t)){let e=Al(t);for(;e&&!Dl(e);){if(Cl(e)&&!Vl(e))return e;e=Al(e)}return n}let i=ql(t,e);for(;i&&xl(i)&&Vl(i);)i=ql(i,e);return i&&Dl(i)&&Vl(i)&&!El(i)?n:i||function(t){let e=Al(t);for(;$l(e)&&!Dl(e);){if(El(e))return e;if(Il(e))return null;e=Al(e)}return null}(t)||n}const Xl={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const a="fixed"===r,s=bl(i),o=!!e&&Il(e.floating);if(i===s||o&&a)return n;let l={scrollLeft:0,scrollTop:0},c=Zo(1);const u=Zo(0),h=$l(i);if((h||!h&&!a)&&(("body"!==vl(i)||Sl(s))&&(l=kl(i)),$l(i))){const t=Gl(i);c=Hl(i),u.x=t.x+i.clientLeft,u.y=t.y+i.clientTop}const d=!s||h||a?Zo(0):Ul(s,l,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:n.y*c.y-l.scrollTop*c.y+u.y+d.y}},getDocumentElement:bl,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const a=[..."clippingAncestors"===n?Il(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let i=Fl(t,[],!1).filter((t=>Cl(t)&&"body"!==vl(t))),r=null;const a="fixed"===Ll(t).position;let s=a?Al(t):t;for(;Cl(s)&&!Dl(s);){const e=Ll(s),n=El(s);n||"fixed"!==e.position||(r=null),(a?!n&&!r:!n&&"static"===e.position&&r&&["absolute","fixed"].includes(r.position)||Sl(s)&&!n&&Wl(t,s))?i=i.filter((t=>t!==s)):r=e,s=Al(s)}return e.set(t,i),i}(e,this._c):[].concat(n),i],s=a[0],o=a.reduce(((t,n)=>{const i=zl(e,n,r);return t.top=Xo(i.top,t.top),t.right=Ko(i.right,t.right),t.bottom=Ko(i.bottom,t.bottom),t.left=Xo(i.left,t.left),t}),zl(e,s,r));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:Kl,getElementRects:async function(t){const e=this.getOffsetParent||Kl,n=this.getDimensions,i=await n(t.floating);return{reference:Yl(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=Bl(t);return{width:e,height:n}},getScale:Hl,isElement:Cl,isRTL:function(t){return"rtl"===Ll(t).direction}};function Jl(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Ql(t,e,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:a=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,c=Ol(t),u=r||a?[...c?Fl(c):[],...Fl(e)]:[];u.forEach((t=>{r&&t.addEventListener("scroll",n,{passive:!0}),a&&t.addEventListener("resize",n)}));const h=c&&o?function(t,e){let n,i=null;const r=bl(t);function a(){var t;clearTimeout(n),null==(t=i)||t.disconnect(),i=null}return function s(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),a();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(o||e(),!d||!f)return;const p={rootMargin:-Qo(h)+"px "+-Qo(r.clientWidth-(u+d))+"px "+-Qo(r.clientHeight-(h+f))+"px "+-Qo(u)+"px",threshold:Xo(0,Ko(1,l))||1};let g=!0;function m(e){const i=e[0].intersectionRatio;if(i!==l){if(!g)return s();i?s(!1,i):n=setTimeout((()=>{s(!1,1e-7)}),1e3)}1!==i||Jl(c,t.getBoundingClientRect())||s(),g=!1}try{i=new IntersectionObserver(m,{...p,root:r.ownerDocument})}catch(t){i=new IntersectionObserver(m,p)}i.observe(t)}(!0),a}(c,n):null;let d,f=-1,p=null;s&&(p=new ResizeObserver((t=>{let[i]=t;i&&i.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var t;null==(t=p)||t.observe(e)}))),n()})),c&&!l&&p.observe(c),p.observe(e));let g=l?Gl(t):null;return l&&function e(){const i=Gl(t);g&&!Jl(g,i)&&n(),g=i,d=requestAnimationFrame(e)}(),n(),()=>{var t;u.forEach((t=>{r&&t.removeEventListener("scroll",n),a&&t.removeEventListener("resize",n)})),null==h||h(),null==(t=p)||t.disconnect(),p=null,l&&cancelAnimationFrame(d)}}const Zl=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:a,placement:s,middlewareData:o}=e,l=await async function(t,e){const{placement:n,platform:i,elements:r}=t,a=await(null==i.isRTL?void 0:i.isRTL(r.floating)),s=rl(n),o=al(n),l="y"===ll(n),c=["left","top"].includes(s)?-1:1,u=a&&l?-1:1,h=il(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:p}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return o&&"number"==typeof p&&(f="end"===o?-1*p:p),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}(e,t);return s===(null==(n=o.offset)?void 0:n.placement)&&null!=(i=o.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:a+l.y,data:{...l,placement:s}}}}},tc=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:a=!0,crossAxis:s=!1,limiter:o={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=il(t,e),c={x:n,y:i},u=await gl(e,l),h=ll(rl(r)),d=sl(h);let f=c[d],p=c[h];if(a){const t="y"===d?"bottom":"right";f=nl(f+u["y"===d?"top":"left"],f,f-u[t])}if(s){const t="y"===h?"bottom":"right";p=nl(p+u["y"===h?"top":"left"],p,p-u[t])}const g=o.fn({...e,[d]:f,[h]:p});return{...g,data:{x:g.x-n,y:g.y-i}}}}},ec=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:a,platform:s,elements:o,middlewareData:l}=e,{element:c,padding:u=0}=il(t,e)||{};if(null==c)return{};const h=dl(u),d={x:n,y:i},f=cl(r),p=ol(f),g=await s.getDimensions(c),m="y"===f,v=m?"top":"left",y=m?"bottom":"right",b=m?"clientHeight":"clientWidth",w=a.reference[p]+a.reference[f]-d[f]-a.floating[p],C=d[f]-a.reference[f],$=await(null==s.getOffsetParent?void 0:s.getOffsetParent(c));let _=$?$[b]:0;_&&await(null==s.isElement?void 0:s.isElement($))||(_=o.floating[b]||a.floating[p]);const S=w/2-C/2,x=_/2-g[p]/2-1,I=Ko(h[v],x),E=Ko(h[y],x),T=I,D=_-g[p]-E,L=_/2-g[p]/2+S,k=nl(T,L,D),A=!l.arrow&&null!=al(r)&&L!==k&&a.reference[p]/2-(L<T?I:E)-g[p]/2<0,P=A?L<T?L-T:L-D:0;return{[f]:d[f]+P,data:{[f]:k,centerOffset:L-k-P,...A&&{alignmentOffset:P}},reset:A}}});function nc(t){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(t)}function ic(t,e){if(t){if("string"==typeof t)return rc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rc(t,e):void 0}}function rc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ac(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,hc(i.key),i)}}function sc(t){var e="function"==typeof Map?new Map:void 0;return sc=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(oc())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&lc(r,n.prototype),r}(t,arguments,cc(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),lc(n,t)},sc(t)}function oc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oc=function(){return!!t})()}function lc(t,e){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lc(t,e)}function cc(t){return cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cc(t)}function uc(t,e,n){return(e=hc(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hc(t){var e=function(t){if("object"!=nc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=nc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nc(e)?e:e+""}var dc=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return uc(t=function(t,e,n){return e=cc(e),function(t,e){if(e&&("object"==nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oc()?Reflect.construct(e,n||[],cc(t).constructor):e.apply(t,n))}(this,e,[].concat(i)),"handleKeyUp",(function(e){null!=e&&e.key&&"Escape"===e.key&&t.hide()})),uc(t,"handleMouseEnter",(function(){t.isHovering=!0,t.delayTimeout&&clearTimeout(t.delayTimeout),t.delayTimeout=setTimeout((function(){t.isHovering&&t.show()}),t.delay)})),uc(t,"handleMouseLeave",(function(){t.isHovering=!1,t.delayTimeout&&clearTimeout(t.delayTimeout),t.hide()})),uc(t,"handleFocusIn",(function(){var e=Date.now();t.lastShow=e,t.delayTimeout&&clearTimeout(t.delayTimeout),t.showing||(t.delayTimeout=setTimeout((function(){e===t.lastShow&&t.show()}),t.eventDelay)),t.show()})),uc(t,"handleFocusOut",(function(){t.delayTimeout&&clearTimeout(t.delayTimeout),t.hide()})),uc(t,"handleClick",(function(){t.delayTimeout&&clearTimeout(t.delayTimeout);var e=Date.now(),n=e-t.lastShow;t.lastShow=e,n<t.eventDelay?t.show():t.toggle()})),uc(t,"toggle",(function(){t.showing?t.hide():t.show()})),uc(t,"show",(function(){t.triggerElement&&t.tooltip&&(Ql(t.triggerElement,t.tooltip,t.update),Object.assign(t.tooltip.style,{opacity:1,pointerEvents:"auto",zIndex:101}),t.showing=!0)})),uc(t,"hide",(function(){Object.assign(t.tooltip.style,{opacity:0,pointerEvents:"none"}),t.showing=!1})),uc(t,"update",(function(){var e,n;t.triggerElement&&t.tooltip&&((t,e,n)=>{const i=new Map,r={platform:Xl,...n},a={...r.platform,_c:i};return(async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:a=[],platform:s}=n,o=a.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:h}=pl(c,i,l),d=i,f={},p=0;for(let n=0;n<o.length;n++){const{name:a,fn:g}=o[n],{x:m,y:v,data:y,reset:b}=await g({x:u,y:h,initialPlacement:i,placement:d,strategy:r,middlewareData:f,rects:c,platform:s,elements:{reference:t,floating:e}});u=null!=m?m:u,h=null!=v?v:h,f={...f,[a]:{...f[a],...y}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(d=b.placement),b.rects&&(c=!0===b.rects?await s.getElementRects({reference:t,floating:e,strategy:r}):b.rects),({x:u,y:h}=pl(c,d,l))),n=-1)}return{x:u,y:h,placement:d,strategy:r,middlewareData:f}})(t,e,{...r,platform:a})})(t.triggerElement,t.tooltip,{strategy:"fixed",placement:t.placement,middleware:[(void 0===n&&(n={}),{name:"flip",options:n,async fn(t){var e,i;const{placement:r,middlewareData:a,rects:s,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...m}=il(n,t);if(null!=(e=a.arrow)&&e.alignmentOffset)return{};const v=rl(r),y=rl(o)===o,b=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=d||(y||!g?[hl(o)]:function(t){const e=hl(t);return[ul(t),e,ul(e)]}(o));d||"none"===p||w.push(...function(t,e,n,i){const r=al(t);let a=function(t,e,n){const i=["left","right"],r=["right","left"],a=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?a:s;default:return[]}}(rl(t),"start"===n,i);return r&&(a=a.map((t=>t+"-"+r)),e&&(a=a.concat(a.map(ul)))),a}(o,g,p,b));const C=[o,...w],$=await gl(t,m),_=[];let S=(null==(i=a.flip)?void 0:i.overflows)||[];if(u&&_.push($[v]),h){const t=function(t,e,n){void 0===n&&(n=!1);const i=al(t),r=cl(t),a=ol(r);let s="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[a]>e.floating[a]&&(s=hl(s)),[s,hl(s)]}(r,s,b);_.push($[t[0]],$[t[1]])}if(S=[...S,{placement:r,overflows:_}],!_.every((t=>t<=0))){var x,I;const t=((null==(x=a.flip)?void 0:x.index)||0)+1,e=C[t];if(e)return{data:{index:t,overflows:S},reset:{placement:e}};let n=null==(I=S.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:I.placement;if(!n)switch(f){case"bestFit":{var E;const t=null==(E=S.map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:E[0];t&&(n=t);break}case"initialPlacement":n=o}if(r!==n)return{reset:{placement:n}}}return{}}}),tc({padding:10}),Zl(0)].concat((e=t.arrow?[ec({element:t.arrowElement})]:[],function(t){if(Array.isArray(t))return rc(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||ic(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}).then((function(e){var n=e.x,i=e.y,r=e.middlewareData,a=e.placement;if(t.setAttribute("placement",a),Object.assign(t.tooltip.style,uc({left:"".concat(n,"px"),top:"".concat(i,"px"),padding:"0px"},"padding".concat(Craft.uppercaseFirst(t.getStaticSide())),"".concat(t.offset,"px"))),t.arrowElement){var s=r.arrow,o=s.x,l=s.y;t.arrowElement.dataset.placement=a,Object.assign(t.arrowElement.style,uc({left:null!=o?"".concat(o,"px"):"",top:null!=l?"".concat(l,"px"):"",right:"",bottom:""},t.getStaticSide(),"-4px"))}}))})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lc(t,e)}(e,t),function(t,e){return e&&ac(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"triggerElement",get:function(){return this.selfManaged?this:this.getAttribute("trigger")?this.closest(this.getAttribute("trigger")):this.querySelector('a,button,[role="button"]')}},{key:"connectedCallback",value:function(){var t=this;if(this.abortController=new AbortController,this.arrowElement=this.querySelector(".arrow"),this.selfManaged=this.hasAttribute("self-managed"),this.arrow="false"!==this.getAttribute("arrow"),this.offset=this.hasAttribute("offset")?parseInt(this.getAttribute("offset"),10):8,this.placement=this.getAttribute("placement")||"bottom",this.direction=getComputedStyle(this).direction,this.delay=this.getAttribute("delay")||500,this.delayTimeout=null,this.maxWidth=this.getAttribute("max-width")||"220px",this.text=this.getAttribute("text")||this.innerText,this.showing=!1,this.lastShow=0,this.eventDelay=150,this.renderTooltip(),this.renderInner(),this.arrow&&!this.arrowElement&&this.renderArrow(),this.listeners=[["mouseenter",this.handleMouseEnter],["mouseleave",this.handleMouseLeave],["keyup",this.handleKeyUp],["click",this.handleClick],["focusin",this.handleFocusIn],["focusout",this.handleFocusOut]],!this.triggerElement)return console.warn("No trigger found for tooltip",this),!1;this.triggerElement.style.pointerEvents="auto",this.listeners.forEach((function(e){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||ic(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),i=n[0],r=n[1];t.triggerElement.addEventListener(i,(function(t){return r(t)}),{signal:t.abortController.signal})})),this.update(),this.hide()}},{key:"disconnectedCallback",value:function(){this.hide(),this.abortController.abort()}},{key:"attributeChangedCallback",value:function(t,e,n){"text"===t&&this.inner&&(this.inner.innerText=n,this.arrow&&(this.renderArrow(),this.update())),"placement"===t&&(this.placement=n)}},{key:"renderTooltip",value:function(){var t=this;this.tooltip=document.createElement("span"),this.tooltip.classList.add("craft-tooltip"),this.tooltip.style["max-width"]=this.maxWidth,this.tooltip.addEventListener("mouseenter",(function(){return t.show()}),{signal:this.abortController.signal}),this.tooltip.addEventListener("mouseleave",this.hide,{signal:this.abortController.signal}),window.document.body.appendChild(this.tooltip)}},{key:"renderInner",value:function(){this.inner=document.createElement("span"),this.inner.classList.add("inner"),this.inner.innerText=this.text,this.tooltip.appendChild(this.inner)}},{key:"renderArrow",value:function(){this.arrowElement=document.createElement("span"),this.arrowElement.classList.add("arrow"),this.inner.appendChild(this.arrowElement)}},{key:"getStaticSide",value:function(){return{top:"bottom",right:"left",bottom:"top",left:"right"}[this.placement.split("-")[0]]}},{key:"cleanup",value:function(){return Ql(this.triggerElement,this.tooltip,this.update)}}])}(sc(HTMLElement));uc(dc,"observedAttributes",["text","placement"]),customElements.define("craft-tooltip",dc),__webpack_require__(8960),__webpack_require__(876),__webpack_require__(5343)}()})();
//# sourceMappingURL=cp.js.map