!function(){"use strict";var e={3495:function(e,t,i){i.d(t,{v:function(){return r}});class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=e.$form,this.form=this.$form.form,this.settings=e,setTimeout((()=>{this.initObserver()}),500)}initObserver(){const e=new IntersectionObserver((e=>{for(const t of e){const e=t.target;0===t.intersectionRatio?this.onHide(e):this.onShow(e)}}),{root:this.$form,rootMargin:"50px"});this.getPlaceholders().forEach((t=>e.observe(t)))}getPlaceholders(){return[]}onShow(e){}onHide(e){}createContainer(e){const t=document.createElement("div");return e.innerHTML="",e.appendChild(t),t}destroyContainer(e){e.innerHTML=""}}window.FormieCaptchaProvider=r}},t={};function i(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=i(3495);const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||(t=Math.random().toString(36).substr(2,5)),`${e}.${t}`},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const i=Date.now(),r=function(o,n){window[e]?o(window[e]):t&&Date.now()-i>=t?n(new Error("timeout")):setTimeout(r.bind(this,o,n),30)};return new Promise(r)};class o extends e.v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.$form=e.$form,this.form=this.$form.form,this.siteKey=e.siteKey,this.badge=e.badge,this.language=e.language,this.loadingMethod=e.loadingMethod,this.scriptId="FORMIE_RECAPTCHA_SCRIPT",this.providerName="RecaptchaV3",this.widgetIds=new Map}getPlaceholders(){return this.$form.querySelectorAll("[data-recaptcha-placeholder]")}onShow(e){super.onShow(e),this.initCaptcha(e)}onHide(e){super.onHide(e),this.destroyCaptcha(e)}initCaptcha(e){if(document.getElementById(this.scriptId))r("grecaptcha").then((()=>{this.renderCaptcha(e)}));else{const t=document.createElement("script");t.id=this.scriptId,t.src=`https://www.recaptcha.net/recaptcha/api.js?render=explicit&hl=${this.language}`,this.loadingMethod.includes("async")&&(t.async=!0),this.loadingMethod.includes("defer")&&(t.defer=!0),t.onload=()=>{r("grecaptcha",5e3).then((()=>{this.renderCaptcha(e)}))},document.body.appendChild(t)}}destroyCaptcha(e){this.destroyContainer(e),this.form.removeEventListener(t("onFormieCaptchaValidate",this.providerName)),this.form.removeEventListener(t("onAfterFormieSubmit",this.providerName))}renderCaptcha(e){this.$activePlaceholder=e;const i=this.createContainer(e);this.form.addEventListener(this.$form,t("onFormieCaptchaValidate",this.providerName),this.onValidate.bind(this)),this.form.addEventListener(this.$form,t("onAfterFormieSubmit",this.providerName),this.onAfterSubmit.bind(this));try{grecaptcha.ready((()=>{const t=grecaptcha.render(i,{sitekey:this.siteKey,badge:this.badge,size:"invisible",callback:this.onVerify.bind(this),"expired-callback":this.onExpired.bind(this),"error-callback":this.onError.bind(this)});this.widgetIds.set(e,t)}))}catch(e){console.error("Failed to render ReCAPTCHA:",e)}}onValidate(e){if(this.$form.form.formTheme||(e.preventDefault(),this.form.submitAction=this.$form.querySelector('[name="submitAction"]').value||"submit"),"submit"!==this.form.submitAction)return;if(e.detail.invalid)return;if(e.preventDefault(),this.submitHandler=e.detail.submitHandler,!this.$activePlaceholder)return void console.warn("No visible captcha placeholder found to execute.");const t=this.widgetIds.get(this.$activePlaceholder);void 0!==t?grecaptcha.execute(t):console.warn("No widget ID found for the visible captcha placeholder.")}onVerify(e){this.submitHandler&&this.submitHandler.validatePayment()&&this.submitHandler.validateCustom()&&this.submitHandler.submitForm()}onAfterSubmit(){const{hasMultiplePages:e}=this.form.settings;!e&&this.$activePlaceholder&&setTimeout((()=>{this.destroyCaptcha(this.$activePlaceholder),this.renderCaptcha(this.$activePlaceholder)}),300)}onExpired(){console.log("ReCAPTCHA has expired - reloading.")}onError(e){console.error("ReCAPTCHA was unable to load")}}window.FormieRecaptchaV3=o}()}();