{"version":3,"file":"TableFieldSettings.js","mappings":"CAAA,SAAWA,GAGTC,MAAMC,mBAAqBC,QAAQC,KAAKC,OAAO,CAC7CC,iBAAkB,KAClBC,kBAAmB,KACnBC,YAAa,KACbC,eAAgB,KAChBC,gBAAiB,KACjBC,sBAAuB,KACvBC,uBAAwB,KAExBC,SAAU,KACVC,eAAgB,KAEhBC,qBAAsB,KACtBC,qBAAsB,KAEtBC,aAAc,KACdC,cAAe,KAEfC,YAAY,EAEZC,KAAM,SACJd,EACAC,EACAC,EACAK,EACAC,EACAC,EACAC,EACAG,GAEAE,KAAKf,iBAAmBA,EACxBe,KAAKd,kBAAoBA,EACzBc,KAAKb,YAAcA,EACnBa,KAAKF,WAAaA,SAAAA,EAElBE,KAAKZ,eAAiBR,MAAMqB,cAAcD,KAAKf,kBAC/Ce,KAAKX,gBAAkBT,MAAMqB,cAAcD,KAAKd,mBAEhDc,KAAKV,sBAAwBV,MAAMsB,YACjCF,KAAKf,iBAAiBkB,MAAM,YAE9BH,KAAKT,uBAAyBX,MAAMsB,YAClCF,KAAKd,kBAAkBiB,MAAM,YAG/BH,KAAKR,SAAWA,EAChBQ,KAAKP,eAAiBA,EAEtBO,KAAKN,qBAAuBA,EAC5BM,KAAKL,qBAAuBA,EAE5BK,KAAKI,mBACLJ,KAAKK,mBACP,EAEAD,iBAAkB,WAChBJ,KAAKJ,aAAe,IAAIU,EACtBN,KACAA,KAAKZ,eACLY,KAAKf,iBACLe,KAAKP,eACL,CACEc,YAAa,MACbC,cAAe,CACbC,KAAM,cAERC,UAAU,EACVC,cAAc,EACdC,aAAa,EACbC,cAAc,EACdC,SAAUd,KAAKe,YAAYC,KAAKhB,MAChCiB,YAAajB,KAAKkB,yBAAyBF,KAAKhB,OAGtD,EAEAK,kBAAmB,WACjBL,KAAKH,cAAgB,IAAIjB,MAAMuC,cAC7BnB,KAAKX,gBACLW,KAAKd,kBACLc,KAAKb,YACL,CACEoB,YAAa,MACbG,UAAU,EACVC,cAAc,EACdC,aAAa,EACbd,WAAYE,KAAKF,WACjBsB,cAAc,GAGpB,EAEAL,YAAa,SAAUM,GACrBrB,KAAKkB,2BACLlB,KAAKsB,wBAAwBD,EAC/B,EAEAC,wBAAyB,SAAUC,GACjC,IAAMC,EAAaD,EAAWE,KAC5B,qDAEFzB,KAAK0B,YAAYF,EAAY,QAAS,2BACxC,EAEAN,yBAA0B,WACxBlB,KAAKb,YAAcP,MAAM+C,gBACvB7C,QAAQ8C,YAAY5B,KAAKJ,aAAaiC,SAExC,IAAIrC,EAAWZ,MAAM+C,gBACnB7C,QAAQ8C,YAAY5B,KAAKH,cAAcgC,SAIzC,IAAKC,OAAOC,KAAK/B,KAAKb,aAAa6C,OAAQ,CAEzC,IADA,IAAMC,EAAQjC,KAAKH,cAAcgC,OAAOK,WAC/BC,EAAI,EAAGA,EAAIF,EAAMD,OAAQG,IAChCnC,KAAKH,cAAcuC,UACjBpC,KAAKH,cAAcwC,aAAaJ,EAAME,KAK1C,OAFAnC,KAAKH,cAAcyC,WAAWC,IAAI,UAAW,YAC7CvC,KAAKH,cAAcyC,WAAWC,IAAI,iBAAkB,OAEtD,CAEA,IAAK,IAAIC,EAAI,EAAGA,EAAIxC,KAAKV,sBAAsB0C,OAAQQ,IAAK,CAC1D,IAAMC,EAAMzC,KAAKV,sBAAsBkD,QACF,IAA1BxC,KAAKb,YAAYsD,KAC1BzC,KAAKb,YAAca,KAAKb,YAAYsD,GAExC,CAGA,IAAK,IAAMC,KAAS1C,KAAKb,YACvB,GAAIa,KAAKb,YAAYwD,eAAeD,GAClC,OAAQ1C,KAAKb,YAAYuD,GAAOjC,MAC9B,IAAK,SACH,IAAMmC,EAAS5C,KAAKJ,aAAaiD,UAC/B7C,KAAKJ,aAAaiC,OAAOJ,KAAK,eAADqB,OAAgBJ,EAAK,QAEpD1C,KAAKb,YAAYuD,GAAOK,QAAUH,EAAOG,SAAW,GACpD,MACF,IAAK,UAEH/C,KAAKb,YAAYuD,GAAOjC,KAAO,aAC/BT,KAAKb,YAAYuD,GAAOM,MAAQ,UAMxC,IAAK,IAAIR,EAAI,EAAGA,EAAIxC,KAAKT,uBAAuByC,OAAQQ,IAAK,CAC3D,IAAMC,EAAMzC,KAAKT,uBAAuBiD,GAExC,QAA6B,IAAlBhD,EAASiD,GAAsB,CACxCjD,EAAW,CAAC,EACZ,KACF,CACEA,EAAWA,EAASiD,EAExB,CAEA,IAAMQ,EAAStE,EAAE,WAAY,CAC3BuE,GAAIlD,KAAKX,gBACT2D,MAAO,uBAGT,GAAIlB,OAAOqB,OAAOnD,KAAKb,aAAaiE,MAAK,SAACC,GAAC,MAAmB,KAAdA,EAAEC,OAAc,IAAG,CACjE,IAAIC,EAAY,GAEhB,IAAK,IAAMb,KAAS1C,KAAKb,YAClBa,KAAKb,YAAYwD,eAAeD,KAIrCa,GACE,oBACCvD,KAAKb,YAAYuD,GAAOY,QACrB1E,MAAM4E,WAAWxD,KAAKb,YAAYuD,GAAOY,SACzC,UACJ,SAGc,KAAdC,IACFA,GAAa,wBACbN,EAAOQ,OAAO,cAADX,OAAeS,EAAS,kBAEzC,CAEA,IAAM1B,EAASlD,EAAE,YAAY+E,SAAST,GAEtC,IAAK,IAAMU,KAASnE,EACbA,EAASmD,eAAegB,IAI7B/E,MAAMuC,cAAcyC,UAClBD,EACA3D,KAAKb,YACLa,KAAKd,kBACLM,EAASmE,IACT,GACA,GACAD,SAAS7B,GAGb7B,KAAKH,cAAcoD,OAAOY,YAAYZ,GACtCjD,KAAKH,cAAciE,iBACZ9D,KAAKH,cACZG,KAAKK,mBACP,IAGF,IAAMC,EAAc1B,MAAMuC,cAAcnC,OAAO,CAC7C+E,cAAe,KAEfhE,KAAM,SAAUgE,EAAeb,EAAIc,EAAUC,EAASC,GACpDlE,KAAK+D,cAAgBA,EACrB/D,KAAKmE,KAAKjB,EAAIc,EAAUC,EAASC,EACnC,EAEAE,WAAY,WACV,QAAKpE,KAAKmE,SAIVnE,KAAK+D,cAAczC,wBAAwBtB,KAAK6B,QAC5C7B,KAAKqE,SACPrE,KAAKqE,OAAOH,SAASI,aACnBtE,KAAK+D,cAAc7C,yBAAyBF,KAAKhB,KAAK+D,iBAEnD,EACT,EAEA1B,aAAc,SAAUhB,GACtB,OAAO,IAAIf,EAAYiE,IAAIvE,KAAMqB,EACnC,IAGFf,EAAYiE,IAAM3F,MAAMuC,cAAcoD,IAAIvF,OAAO,CAC/CwF,YAAa,KACbC,aAAc,KAEd1B,QAAS,KACT2B,cAAe,KACfC,aAAc,KAEd5E,KAAM,SAAU6E,EAAOC,GACrB7E,KAAKmE,KAAKS,EAAOC,GAEb7E,KAAK4E,MAAMb,cAAc5E,YAAYa,KAAKkD,MAC5ClD,KAAK+C,QACH/C,KAAK4E,MAAMb,cAAc5E,YAAYa,KAAKkD,IAAIH,SAAW,MAG7D,IAAM+B,EAAY9E,KAAKqB,IAAII,KAAK,mBAC1BsD,EAAuBD,EAAUrD,KAAK,WAC5CzB,KAAKyE,aAAeK,EAAUrD,KAAK,aAE9BzB,KAAKyE,aAAazC,SACrBhC,KAAKyE,aAAe9F,EAAE,YAAa,CACjCqE,MAAO,2BACPvC,KAAM,SACN,YAAa,aAEf9B,EAAE,SAAU,CAACqE,MAAO,qBACjBU,SAASoB,GACTrB,OAAOsB,GACPtB,OAAOzD,KAAKyE,eAGjBzE,KAAKwE,YAAcO,EAAqBtD,KAAK,UAC7CzB,KAAK0B,YAAY1B,KAAKwE,YAAa,SAAU,oBAC7CxE,KAAK0B,YAAY1B,KAAKyE,aAAc,QAAS,qBAE7CzE,KAAK0B,YAAY1B,KAAKqB,IAAI2D,QAAQ,QAAS,SAAU,mBACvD,EAEAC,iBAAkB,WACe,WAA3BjF,KAAKwE,YAAYU,MACnBlF,KAAKyE,aAAaU,YAAY,aAE9BnF,KAAKyE,aAAaW,SAAS,aAG7BpF,KAAK4E,MAAMb,cAAc7C,0BAC3B,EAEAmE,kBAAmB,SAAUC,GAAI,IAAAC,EAAA,KAC/B,GAAKvF,KAAK0E,cAoDR1E,KAAK0E,cAAcc,WApDI,CACvB,IAAMtC,EACJ,wBAA0BuC,KAAKC,MAAsB,IAAhBD,KAAKE,UACtCC,EAASjH,EAAE,SAAU,CACzBqE,MAAO,gCACNU,SAAS5E,QAAQ+G,MACdC,EAAQnH,EAAE,SAAU,CAACqE,MAAO,SAC/BU,SAASkC,GACTG,KACC/F,KAAK4E,MAAMb,cAAcrE,qBAAqBsG,QAAQ,UAAW9C,IAgBrE,GAbAlD,KAAK2E,aAAe,IAAI/F,MAAMuC,cAC5B+B,EACA,WACAlD,KAAK4E,MAAMb,cAAcpE,qBACzB,CACEe,UAAU,EACVE,aAAa,EACbD,cAAc,EACdG,SAAUd,KAAKiG,uBAAuBjF,KAAKhB,MAC3CiB,YAAajB,KAAKiG,uBAAuBjF,KAAKhB,QAI9CA,KAAK+C,SAAW/C,KAAK+C,QAAQf,OAC/B,IAAK,IAAIQ,EAAI,EAAGA,EAAIxC,KAAK+C,QAAQf,OAAQQ,IAAK,CAC5C,IAAM0D,EAAMlG,KAAK2E,aAAawB,QAAO,GACrCD,EAAI7E,IAAII,KAAK,0BAA0ByD,IAAIlF,KAAK+C,QAAQP,GAAG4D,OAC3DF,EAAI7E,IAAII,KAAK,0BAA0ByD,IAAIlF,KAAK+C,QAAQP,GAAG6D,OAC3DH,EAAI7E,IACDI,KAAK,0CACL6E,KAAK,YAAatG,KAAK+C,QAAQP,GAAG+D,QACvC,MAEAvG,KAAK2E,aAAawB,QAAO,GAG3B,IAAMK,EAAe7H,EAAE,YAAa,CAClC8B,KAAM,SACNuC,MAAO,aACPyD,KAAM7H,MAAM8H,EAAE,MAAO,UACpBhD,SAASoC,GAEZ9F,KAAK0E,cAAgB,IAAI5F,QAAQ6H,MAAMf,EAAQ,CAC7CgB,OAAQ5G,KAAK6G,wBAAwB7F,KAAKhB,QAG5CA,KAAK0B,YAAY8E,EAAc,SAAS,WACtCxG,KAAK0E,cAAcoC,MACrB,GACF,CAIAC,YAAW,WACTxB,EAAKZ,aAAa9C,OAAOJ,KAAK,YAAYuF,QAAQC,OACpD,GAAG,IACL,EAEAhB,uBAAwB,WAClBjG,KAAK0E,eACP1E,KAAK0E,cAAcwC,uBAEvB,EAEAL,wBAAyB,WACvB7G,KAAK+C,QAAU,GAEf,IADA,IAAMd,EAAQjC,KAAK2E,aAAa1B,OAAOxB,KAAK,YACnCe,EAAI,EAAGA,EAAIP,EAAMD,OAAQQ,IAAK,CACrC,IAAI2E,EAAOlF,EAAMmF,GAAG5E,GACpBxC,KAAK+C,QAAQsE,KAAK,CAChBjB,MAAOe,EAAK1F,KAAK,0BAA0ByD,MAC3CmB,MAAOc,EAAK1F,KAAK,0BAA0ByD,MAC3CqB,QAASY,EACN1F,KAAK,wCACL6E,KAAK,YAEZ,CAEAtG,KAAK4E,MAAMb,cAAc7C,0BAC3B,EAEAoG,iBAAkB,SAAUhC,GACK,WAA3BtF,KAAKwE,YAAYU,OACnBvG,EAAE,WAAY,CACZ8B,KAAM,SACN8G,KACEvH,KAAK4E,MAAMb,cAAc9E,iBACzB,IACAe,KAAKkD,GACL,aACFmD,MAAOmB,KAAKC,UAAUzH,KAAK+C,WAC1BW,SAAS4B,EAAGoC,cAEnB,GAEH,CArYD,CAqYGC","sources":["webpack:///./TableFieldSettings.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  Craft.TableFieldSettings = Garnish.Base.extend({\n    columnsTableName: null,\n    defaultsTableName: null,\n    columnsData: null,\n    columnsTableId: null,\n    defaultsTableId: null,\n    columnsTableInputPath: null,\n    defaultsTableInputPath: null,\n\n    defaults: null,\n    columnSettings: null,\n\n    dropdownSettingsHtml: null,\n    dropdownSettingsCols: null,\n\n    columnsTable: null,\n    defaultsTable: null,\n\n    staticRows: false,\n\n    init: function (\n      columnsTableName,\n      defaultsTableName,\n      columnsData,\n      defaults,\n      columnSettings,\n      dropdownSettingsHtml,\n      dropdownSettingsCols,\n      staticRows\n    ) {\n      this.columnsTableName = columnsTableName;\n      this.defaultsTableName = defaultsTableName;\n      this.columnsData = columnsData;\n      this.staticRows = staticRows ?? false;\n\n      this.columnsTableId = Craft.formatInputId(this.columnsTableName);\n      this.defaultsTableId = Craft.formatInputId(this.defaultsTableName);\n\n      this.columnsTableInputPath = Craft.filterArray(\n        this.columnsTableName.split(/[\\[\\]]+/)\n      );\n      this.defaultsTableInputPath = Craft.filterArray(\n        this.defaultsTableName.split(/[\\[\\]]+/)\n      );\n\n      this.defaults = defaults;\n      this.columnSettings = columnSettings;\n\n      this.dropdownSettingsHtml = dropdownSettingsHtml;\n      this.dropdownSettingsCols = dropdownSettingsCols;\n\n      this.initColumnsTable();\n      this.initDefaultsTable();\n    },\n\n    initColumnsTable: function () {\n      this.columnsTable = new ColumnTable(\n        this,\n        this.columnsTableId,\n        this.columnsTableName,\n        this.columnSettings,\n        {\n          rowIdPrefix: 'col',\n          defaultValues: {\n            type: 'singleline',\n          },\n          allowAdd: true,\n          allowReorder: true,\n          allowDelete: true,\n          lazyInitRows: false,\n          onAddRow: this.onAddColumn.bind(this),\n          onDeleteRow: this.reconstructDefaultsTable.bind(this),\n        }\n      );\n    },\n\n    initDefaultsTable: function () {\n      this.defaultsTable = new Craft.EditableTable(\n        this.defaultsTableId,\n        this.defaultsTableName,\n        this.columnsData,\n        {\n          rowIdPrefix: 'row',\n          allowAdd: true,\n          allowReorder: true,\n          allowDelete: true,\n          staticRows: this.staticRows,\n          includeRowId: true,\n        }\n      );\n    },\n\n    onAddColumn: function ($tr) {\n      this.reconstructDefaultsTable();\n      this.initColumnSettingInputs($tr);\n    },\n\n    initColumnSettingInputs: function ($container) {\n      const $textareas = $container.find(\n        'td:first-child textarea, td:nth-child(3) textarea'\n      );\n      this.addListener($textareas, 'input', 'reconstructDefaultsTable');\n    },\n\n    reconstructDefaultsTable: function () {\n      this.columnsData = Craft.expandPostArray(\n        Garnish.getPostData(this.columnsTable.$tbody)\n      );\n      let defaults = Craft.expandPostArray(\n        Garnish.getPostData(this.defaultsTable.$tbody)\n      );\n\n      // If there are no columns, drop the defaults table rows and disable add row button\n      if (!Object.keys(this.columnsData).length) {\n        const $rows = this.defaultsTable.$tbody.children();\n        for (let r = 0; r < $rows.length; r++) {\n          this.defaultsTable.deleteRow(\n            this.defaultsTable.createRowObj($rows[r])\n          );\n        }\n        this.defaultsTable.$addRowBtn.css('opacity', '0.2');\n        this.defaultsTable.$addRowBtn.css('pointer-events', 'none');\n        return;\n      }\n\n      for (let i = 0; i < this.columnsTableInputPath.length; i++) {\n        const key = this.columnsTableInputPath[i];\n        if (typeof this.columnsData[key] !== 'undefined') {\n          this.columnsData = this.columnsData[key];\n        }\n      }\n\n      // Add in the dropdown options\n      for (const colId in this.columnsData) {\n        if (this.columnsData.hasOwnProperty(colId)) {\n          switch (this.columnsData[colId].type) {\n            case 'select':\n              const rowObj = this.columnsTable.getRowObj(\n                this.columnsTable.$tbody.find(`tr[data-id=\"${colId}\"]`)\n              );\n              this.columnsData[colId].options = rowObj.options || [];\n              break;\n            case 'heading':\n              // Replace with singleline\n              this.columnsData[colId].type = 'singleline';\n              this.columnsData[colId].class = 'heading';\n              break;\n          }\n        }\n      }\n\n      for (let i = 0; i < this.defaultsTableInputPath.length; i++) {\n        const key = this.defaultsTableInputPath[i];\n\n        if (typeof defaults[key] === 'undefined') {\n          defaults = {};\n          break;\n        } else {\n          defaults = defaults[key];\n        }\n      }\n\n      const $table = $('<table/>', {\n        id: this.defaultsTableId,\n        class: 'editable fullwidth',\n      });\n\n      if (Object.values(this.columnsData).some((c) => c.heading !== '')) {\n        let theadHtml = '';\n\n        for (const colId in this.columnsData) {\n          if (!this.columnsData.hasOwnProperty(colId)) {\n            continue;\n          }\n\n          theadHtml +=\n            '<th scope=\"col\">' +\n            (this.columnsData[colId].heading\n              ? Craft.escapeHtml(this.columnsData[colId].heading)\n              : '&nbsp;') +\n            '</th>';\n        }\n\n        if (theadHtml !== '') {\n          theadHtml += '<th colspan=\"2\"></th>';\n          $table.append(`<thead><tr>${theadHtml}</tr></thead>`);\n        }\n      }\n\n      const $tbody = $('<tbody/>').appendTo($table);\n\n      for (const rowId in defaults) {\n        if (!defaults.hasOwnProperty(rowId)) {\n          continue;\n        }\n\n        Craft.EditableTable.createRow(\n          rowId,\n          this.columnsData,\n          this.defaultsTableName,\n          defaults[rowId],\n          true,\n          true\n        ).appendTo($tbody);\n      }\n\n      this.defaultsTable.$table.replaceWith($table);\n      this.defaultsTable.destroy();\n      delete this.defaultsTable;\n      this.initDefaultsTable();\n    },\n  });\n\n  const ColumnTable = Craft.EditableTable.extend({\n    fieldSettings: null,\n\n    init: function (fieldSettings, id, baseName, columns, settings) {\n      this.fieldSettings = fieldSettings;\n      this.base(id, baseName, columns, settings);\n    },\n\n    initialize: function () {\n      if (!this.base()) {\n        return false;\n      }\n\n      this.fieldSettings.initColumnSettingInputs(this.$tbody);\n      if (this.sorter) {\n        this.sorter.settings.onSortChange =\n          this.fieldSettings.reconstructDefaultsTable.bind(this.fieldSettings);\n      }\n      return true;\n    },\n\n    createRowObj: function ($tr) {\n      return new ColumnTable.Row(this, $tr);\n    },\n  });\n\n  ColumnTable.Row = Craft.EditableTable.Row.extend({\n    $typeSelect: null,\n    $settingsBtn: null,\n\n    options: null,\n    settingsModal: null,\n    optionsTable: null,\n\n    init: function (table, tr) {\n      this.base(table, tr);\n\n      if (this.table.fieldSettings.columnsData[this.id]) {\n        this.options =\n          this.table.fieldSettings.columnsData[this.id].options || null;\n      }\n\n      const $typeCell = this.$tr.find('td:nth-child(4)');\n      const $typeSelectContainer = $typeCell.find('.select');\n      this.$settingsBtn = $typeCell.find('.settings');\n\n      if (!this.$settingsBtn.length) {\n        this.$settingsBtn = $('<button/>', {\n          class: 'settings light invisible',\n          type: 'button',\n          'data-icon': 'settings',\n        });\n        $('<div/>', {class: 'flex flex-nowrap'})\n          .appendTo($typeCell)\n          .append($typeSelectContainer)\n          .append(this.$settingsBtn);\n      }\n\n      this.$typeSelect = $typeSelectContainer.find('select');\n      this.addListener(this.$typeSelect, 'change', 'handleTypeChange');\n      this.addListener(this.$settingsBtn, 'click', 'showSettingsModal');\n\n      this.addListener(this.$tr.closest('form'), 'submit', 'handleFormSubmit');\n    },\n\n    handleTypeChange: function () {\n      if (this.$typeSelect.val() === 'select') {\n        this.$settingsBtn.removeClass('invisible');\n      } else {\n        this.$settingsBtn.addClass('invisible');\n      }\n\n      this.table.fieldSettings.reconstructDefaultsTable();\n    },\n\n    showSettingsModal: function (ev) {\n      if (!this.settingsModal) {\n        const id =\n          'dropdownsettingsmodal' + Math.floor(Math.random() * 1000000);\n        const $modal = $('<div/>', {\n          class: 'modal dropdownsettingsmodal',\n        }).appendTo(Garnish.$bod);\n        const $body = $('<div/>', {class: 'body'})\n          .appendTo($modal)\n          .html(\n            this.table.fieldSettings.dropdownSettingsHtml.replace(/__ID__/g, id)\n          );\n\n        this.optionsTable = new Craft.EditableTable(\n          id,\n          '__NAME__',\n          this.table.fieldSettings.dropdownSettingsCols,\n          {\n            allowAdd: true,\n            allowDelete: true,\n            allowReorder: true,\n            onAddRow: this.handleOptionsRowChange.bind(this),\n            onDeleteRow: this.handleOptionsRowChange.bind(this),\n          }\n        );\n\n        if (this.options && this.options.length) {\n          for (let i = 0; i < this.options.length; i++) {\n            const row = this.optionsTable.addRow(false);\n            row.$tr.find('.option-label textarea').val(this.options[i].label);\n            row.$tr.find('.option-value textarea').val(this.options[i].value);\n            row.$tr\n              .find('.option-default input[type=\"checkbox\"]')\n              .prop('checked', !!this.options[i].default);\n          }\n        } else {\n          this.optionsTable.addRow(false);\n        }\n\n        const $closeButton = $('<button/>', {\n          type: 'button',\n          class: 'btn submit',\n          text: Craft.t('app', 'Done'),\n        }).appendTo($body);\n\n        this.settingsModal = new Garnish.Modal($modal, {\n          onHide: this.handleSettingsModalHide.bind(this),\n        });\n\n        this.addListener($closeButton, 'click', function () {\n          this.settingsModal.hide();\n        });\n      } else {\n        this.settingsModal.show();\n      }\n\n      setTimeout(() => {\n        this.optionsTable.$tbody.find('textarea').first().focus();\n      }, 100);\n    },\n\n    handleOptionsRowChange: function () {\n      if (this.settingsModal) {\n        this.settingsModal.updateSizeAndPosition();\n      }\n    },\n\n    handleSettingsModalHide: function () {\n      this.options = [];\n      const $rows = this.optionsTable.$table.find('tbody tr');\n      for (let i = 0; i < $rows.length; i++) {\n        let $row = $rows.eq(i);\n        this.options.push({\n          label: $row.find('.option-label textarea').val(),\n          value: $row.find('.option-value textarea').val(),\n          default: $row\n            .find('.option-default input[type=checkbox]')\n            .prop('checked'),\n        });\n      }\n\n      this.table.fieldSettings.reconstructDefaultsTable();\n    },\n\n    handleFormSubmit: function (ev) {\n      if (this.$typeSelect.val() === 'select') {\n        $('<input/>', {\n          type: 'hidden',\n          name:\n            this.table.fieldSettings.columnsTableName +\n            '[' +\n            this.id +\n            '][options]',\n          value: JSON.stringify(this.options),\n        }).appendTo(ev.currentTarget);\n      }\n    },\n  });\n})(jQuery);\n"],"names":["$","Craft","TableFieldSettings","Garnish","Base","extend","columnsTableName","defaultsTableName","columnsData","columnsTableId","defaultsTableId","columnsTableInputPath","defaultsTableInputPath","defaults","columnSettings","dropdownSettingsHtml","dropdownSettingsCols","columnsTable","defaultsTable","staticRows","init","this","formatInputId","filterArray","split","initColumnsTable","initDefaultsTable","ColumnTable","rowIdPrefix","defaultValues","type","allowAdd","allowReorder","allowDelete","lazyInitRows","onAddRow","onAddColumn","bind","onDeleteRow","reconstructDefaultsTable","EditableTable","includeRowId","$tr","initColumnSettingInputs","$container","$textareas","find","addListener","expandPostArray","getPostData","$tbody","Object","keys","length","$rows","children","r","deleteRow","createRowObj","$addRowBtn","css","i","key","colId","hasOwnProperty","rowObj","getRowObj","concat","options","class","$table","id","values","some","c","heading","theadHtml","escapeHtml","append","appendTo","rowId","createRow","replaceWith","destroy","fieldSettings","baseName","columns","settings","base","initialize","sorter","onSortChange","Row","$typeSelect","$settingsBtn","settingsModal","optionsTable","table","tr","$typeCell","$typeSelectContainer","closest","handleTypeChange","val","removeClass","addClass","showSettingsModal","ev","_this","show","Math","floor","random","$modal","$bod","$body","html","replace","handleOptionsRowChange","row","addRow","label","value","prop","default","$closeButton","text","t","Modal","onHide","handleSettingsModalHide","hide","setTimeout","first","focus","updateSizeAndPosition","$row","eq","push","handleFormSubmit","name","JSON","stringify","currentTarget","jQuery"],"sourceRoot":""}