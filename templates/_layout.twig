{% set pageClass = block('pageClass') ?? 'home' %}
{% set requestSegments = craft.app.request.segments %}
{% set currentSegment = requestSegments|length ? requestSegments|first : '' %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {# SEOMatic handles all meta tags, titles, and structured data #}
    {% hook 'seomatic' %}

    <meta name="theme-color" content="#c58f31">
    <meta name="color-scheme" content="light">

    <link rel="icon" type="image/x-icon" href="/favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="manifest" href="/favicons/manifest.json">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">

    <style>
        html.loading body { visibility: hidden; }
        html.loaded body { visibility: visible; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        .footer-content { display: grid; gap: 2rem; }
    </style>
    {% block criticalCss %}{% endblock %}

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"></noscript>

    {# Load critical CSS on all pages #}
    <link rel="stylesheet" href="/_dist/css/critical.css">

    {# Load page-specific CSS based on current segment #}
    {% set pageSegment = currentSegment|default('home') %}
    {% if pageSegment == '' or pageSegment == 'home' %}
      <link rel="stylesheet" href="/_dist/css/home.css">
    {% elseif pageSegment == 'services' or pageSegment == 'our-services' %}
      <link rel="stylesheet" href="/_dist/css/services.css">
    {% elseif pageSegment == 'contact' %}
      <link rel="stylesheet" href="/_dist/css/contact.css">
    {% endif %}

    {# Load shared components CSS asynchronously for all pages #}
    <link rel="preload" href="/_dist/css/shared.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/_dist/css/shared.css"></noscript>

    <meta name="view-transition" content="same-origin">

    {% block headExtras %}{% endblock %}
</head>
{% import '_components/macros/accessibility.twig' as a11y %}

{% set pageDataAttribute = requestSegments|length ? requestSegments|join('-') : 'home' %}
<body class="{{ pageClass }}-page" data-page="{{ pageDataAttribute }}">

{{ a11y.skipLinks() }}

{% include '_components/header.twig' %}

<main id="main-content" role="main">
    {% block content %}{% endblock %}
</main>

{% include '_components/footer.twig' %}

<script type="module" src="/_dist/js/app.js"></script>

</body>
</html>
